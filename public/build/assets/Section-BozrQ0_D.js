import{Q as M}from"./vue-quill.esm-bundler-DhKZLCtr.js";import{_ as W}from"./PrimaryButton-8HvTERXi.js";import{L as X,H as b,q as H,r as a,o as c,e as d,a as k,b as n,w as o,F as C,y as U,c as _,d as i,t as p,g as l,J,x as A}from"./app-BlBdgDy7.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Z={components:{QuillEditor:M,PrimaryButton:W,Toaster:X},props:{dialogForm:{type:Boolean,required:!0},ct_inspection_uuid:{type:String,required:!0},inspection_uuid:{type:String,required:!0}},data(){return{dialogFormLoading:!1,sectionsForm:[],expandedPanel:[0,1,2,3,4,5,6],ct_risks:[]}},methods:{getForm(){this.dialogFormLoading=!0,b.get("api/inspection/forms/get-form-inspection/"+this.inspection_uuid).then(t=>{this.dialogFormLoading=!1,this.sectionsForm=t.data.data.sections}).catch(t=>{this.dialogFormLoading=!1,this.handleErrors(t)})},closeSectionDialog(){this.$emit("closeSectionDialog")},saveField(t){t.loading=!0;let u={inspection_uuid:this.inspection_uuid,form:[{inspection_form_value:t.content.inspection_form_value,inspection_form_comments:t.content.inspection_form_comments,ct_inspection_form_uuid:t.ct_inspection_form_uuid,ct_risk_id:t.content.ct_risk_id}]};if(this.isEmptyField(u.form[0].inspection_form_value)){H.error("El contenido no puede estar vacío"),t.loading=!1;return}else b.post("api/inspection/forms/set-form-inspection",u).then(h=>{t.loading=!1,H.success("Campo guardado correctamente"),h.data.data.length>0?t.content=h.data.data[0]:this.getForm()}).catch(h=>{t.loading=!1,this.handleErrors(h)})},complementData(t){t.content==null?(t.content={inspection_form_value:"",inspection_form_comments:"",ct_risk_id:null},t.switch_comment=!1,t.switch_ct_risk=!1):(t.switch_comment=t.content.inspection_form_comments!==""&&t.content.inspection_form_comments!==null&&t.content.inspection_form_comments!=="<p><br></p>",t.switch_ct_risk=!!(t.content.ct_risk_id&&t.content.ct_risk_id!==null))},isEmptyField(t){return t==null||t==""||t=="<p><br></p>"},getRisks(){b.get("api/risks").then(t=>{this.ct_risks=t.data.data}).catch(t=>{this.handleErrors(t)})},getBgColor(t){let u=this.ct_risks.filter(h=>t===h.ct_risk_id);return u.length>0?u[0].ct_color:""},setRiesgo(t){t.switch_ct_risk==!0?(t.switch_ct_risk=!1,t.content.ct_risk_id=null):t.switch_ct_risk==!1&&(t.switch_ct_risk=!0)}},mounted(){this.getForm(),this.getRisks()}},$={class:"max-w-7xl mx-auto sm:px-4 lg:px-6 mb-5 pb-5"},S={class:"overflow-hidden shadow-sm sm:rounded-lg"},tt={key:0},et={class:"d-flex align-center"},ot={class:"d-flex align-center gap-3"},nt={class:"text-grey"},st={key:0,class:"mt-3 text-grey"},ct={key:2,class:"mt-3 text-grey"},at={key:1},it={key:0},lt={class:"d-flex align-center"},rt={class:"d-lg-flex align-center gap-3"},_t={class:"text-grey"},mt={key:0,class:"mt-3 text-grey"},dt={key:2,class:"mt-3 text-grey"};function ut(t,u,h,pt,v,m){const y=a("v-chip"),w=a("v-card-subtitle"),q=a("v-expansion-panel-title"),x=a("v-switch"),f=a("v-icon"),L=a("v-card-title"),V=a("QuillEditor"),D=a("v-col"),P=a("v-row"),T=a("v-list-item"),N=a("v-select"),Q=a("PrimaryButton"),E=a("v-card-text"),B=a("v-card"),j=a("v-expansion-panel-text"),G=a("v-expansion-panel"),O=a("v-expansion-panels"),I=a("v-container");return c(),d("div",$,[k("div",S,[n(B,{loading:v.dialogFormLoading},{default:o(()=>[n(E,{class:"padding-0"},{default:o(()=>[n(I,null,{default:o(()=>[n(P,null,{default:o(()=>[n(D,{cols:"12",class:"padding-0"},{default:o(()=>[n(O,{multiple:"",modelValue:v.expandedPanel,"onUpdate:modelValue":u[0]||(u[0]=g=>v.expandedPanel=g)},{default:o(()=>[(c(!0),d(C,null,U(v.sectionsForm,(g,K)=>(c(),_(G,{key:K,class:"my-5 border",expanded:!0},{default:o(()=>[n(q,{class:"text-h6"},{default:o(()=>[n(y,{color:"primary",variant:"elevated"},{default:o(()=>[i(p(g.section_details.ct_inspection_section),1)]),_:2},1024),n(w,{class:"ml-2 mt-0 pt-0"},{default:o(()=>[i(" Sección ")]),_:1})]),_:2},1024),n(j,null,{default:o(()=>[g.fields?(c(),d("div",tt,[(c(!0),d(C,null,U(g.fields,(s,R)=>(c(),_(B,{key:R,class:"my-5 border",loading:s.loading},{default:o(()=>[i(p(m.complementData(s))+" ",1),n(L,{class:"d-lg-flex justify-between"},{default:o(()=>[k("div",et,[n(y,{color:"primary"},{default:o(()=>[i(p(s.ct_inspection_form),1)]),_:2},1024),n(w,null,{default:o(()=>[i("Campo")]),_:1})]),k("div",ot,[n(x,{modelValue:s.switch_comment,"onUpdate:modelValue":e=>s.switch_comment=e,color:"blue",label:"Comentario","hide-details":""},null,8,["modelValue","onUpdate:modelValue"]),n(x,{modelValue:s.switch_ct_risk,"onUpdate:modelValue":e=>s.switch_ct_risk=e,color:"blue",label:"Riesgo","hide-details":"",onClick:e=>m.setRiesgo(s)},null,8,["modelValue","onUpdate:modelValue","onClick"]),m.isEmptyField(s.content.inspection_form_value)?l("",!0):(c(),_(f,{key:0,color:"success"},{default:o(()=>[i("mdi-check")]),_:1})),m.isEmptyField(s.content.inspection_form_value)&&s.required?(c(),_(f,{key:1,color:"red"},{default:o(()=>[i("mdi-alert-circle-outline")]),_:1})):l("",!0)])]),_:2},1024),n(E,{class:"pt-0"},{default:o(()=>[k("p",nt,"Contenido ("+p(s.required?"*Requerido":"Opcional")+"):",1),n(V,{content:s.content.inspection_form_value,"onUpdate:content":e=>s.content.inspection_form_value=e,theme:"snow",toolbar:"essential",heigth:"100%",contentType:"html"},null,8,["content","onUpdate:content"]),s.switch_comment?(c(),d("p",st," Comentarios:")):l("",!0),s.switch_comment?(c(),_(P,{key:1},{default:o(()=>[n(D,{cols:"12"},{default:o(()=>[s.switch_comment?(c(),_(V,{key:0,content:s.content.inspection_form_comments,"onUpdate:content":e=>s.content.inspection_form_comments=e,theme:"snow",toolbar:"essential",contentType:"html"},null,8,["content","onUpdate:content"])):l("",!0)]),_:2},1024)]),_:2},1024)):l("",!0),s.switch_ct_risk?(c(),d("p",ct," Riesgo:")):l("",!0),s.switch_ct_risk?(c(),_(N,{key:3,modelValue:s.content.ct_risk_id,"onUpdate:modelValue":e=>s.content.ct_risk_id=e,items:v.ct_risks,"item-title":"ct_risk","item-value":"ct_risk_id",variant:"outlined","hide-details":"",class:"w-50 rounded",density:"compact",style:J({"background-color":m.getBgColor(s.content.ct_risk_id)})},{item:o(({props:e,item:F})=>[n(T,A(e,{title:F.raw.ct_risk,style:{"background-color":F.raw.ct_color},value:"ct_risk"}),null,16,["title","style"])]),_:2},1032,["modelValue","onUpdate:modelValue","items","style"])):l("",!0),n(Q,{onClick:e=>m.saveField(s),class:"mt-2",disabled:s.loading},{default:o(()=>[i("Guardar ")]),_:2},1032,["onClick","disabled"])]),_:2},1024)]),_:2},1032,["loading"]))),128))])):l("",!0),g.sub_sections?(c(),d("div",at,[n(O,{multiple:""},{default:o(()=>[(c(!0),d(C,null,U(g.sub_sections,(s,R)=>(c(),_(G,{key:R,class:"my-5 border"},{default:o(()=>[n(q,{class:"text-h6"},{default:o(()=>[n(y,{color:"primary",variant:"elevated"},{default:o(()=>[i(p(s.ct_inspection_section),1)]),_:2},1024),n(w,{class:"ml-2 mt-0 pt-0"},{default:o(()=>[i(" Sub-sección ")]),_:1})]),_:2},1024),n(j,null,{default:o(()=>[s.fields?(c(),d("div",it,[(c(!0),d(C,null,U(s.fields,(e,F)=>(c(),_(B,{key:F,class:"my-5 border",loading:e.loading},{default:o(()=>[i(p(m.complementData(e))+" ",1),n(L,{class:"d-lg-flex justify-between"},{default:o(()=>[k("div",lt,[n(y,{color:"primary"},{default:o(()=>[i(p(e.ct_inspection_form),1)]),_:2},1024),n(w,null,{default:o(()=>[i("Campo")]),_:1})]),k("div",rt,[n(x,{modelValue:e.switch_comment,"onUpdate:modelValue":r=>e.switch_comment=r,color:"blue",label:"Comentario","hide-details":""},null,8,["modelValue","onUpdate:modelValue"]),n(x,{modelValue:e.switch_ct_risk,"onUpdate:modelValue":r=>e.switch_ct_risk=r,color:"blue",label:"Riesgo","hide-details":"",onClick:r=>m.setRiesgo(e)},null,8,["modelValue","onUpdate:modelValue","onClick"]),m.isEmptyField(e.content.inspection_form_value)?l("",!0):(c(),_(f,{key:0,color:"success"},{default:o(()=>[i("mdi-check")]),_:1})),m.isEmptyField(e.content.inspection_form_value)&&e.required?(c(),_(f,{key:1,color:"red"},{default:o(()=>[i("mdi-alert-circle-outline")]),_:1})):l("",!0)])]),_:2},1024),n(E,{class:"pt-0"},{default:o(()=>[k("p",_t," Contenido ("+p(e.required?"*Requerido":"Opcional")+"):",1),n(V,{content:e.content.inspection_form_value,"onUpdate:content":r=>e.content.inspection_form_value=r,theme:"snow",toolbar:"essential",heigth:"100%",contentType:"html"},null,8,["content","onUpdate:content"]),e.switch_comment?(c(),d("p",mt,"Comentarios: ")):l("",!0),e.switch_comment?(c(),_(V,{key:1,content:e.content.inspection_form_comments,"onUpdate:content":r=>e.content.inspection_form_comments=r,theme:"snow",toolbar:"essential",heigth:"100%",contentType:"html"},null,8,["content","onUpdate:content"])):l("",!0),e.switch_ct_risk?(c(),d("p",dt," Riesgo:")):l("",!0),e.switch_ct_risk?(c(),_(N,{key:3,modelValue:e.content.ct_risk_id,"onUpdate:modelValue":r=>e.content.ct_risk_id=r,items:v.ct_risks,"item-title":"ct_risk","item-value":"ct_risk_id",variant:"outlined","hide-details":"",class:"w-50 rounded",density:"compact",style:J({"background-color":m.getBgColor(e.content.ct_risk_id)})},{item:o(({props:r,item:z})=>[n(T,A(r,{title:z.raw.ct_risk,style:{"background-color":z.raw.ct_color},value:"ct_risk"}),null,16,["title","style"])]),_:2},1032,["modelValue","onUpdate:modelValue","items","style"])):l("",!0),n(Q,{onClick:r=>m.saveField(e),class:"mt-2",disabled:e.loading},{default:o(()=>[i(" Guardar")]),_:2},1032,["onClick","disabled"])]),_:2},1024)]),_:2},1032,["loading"]))),128))])):l("",!0)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)])):l("",!0)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["loading"])])])}const yt=Y(Z,[["render",ut]]);export{yt as default};
