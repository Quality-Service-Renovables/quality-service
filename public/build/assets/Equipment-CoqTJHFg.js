import{r as o,o as C,e as y,b as e,u as w,w as l,F as O,L as E,l as m,Z as z,a as u,d as n,m as j,t as x,g as A,p as B,q as F}from"./app-COK-H-c1.js";import{_ as P}from"./AuthenticatedLayout-BLHpBXVc.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-D1is4lkj.js";const L=t=>(B("data-v-7ac28006"),t=t(),F(),t),G=L(()=>u("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Equipos",-1)),Z={class:"py-12"},H={class:"max-w-7xl mx-auto sm:px-4 lg:px-6"},J={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},K={class:"text-h5"},Q=["href"],W={components:{Toaster:E},props:{equipments:{type:Array,required:!0}},data:()=>({search:"",dialog:!1,dialogDelete:!1,headers:[{title:"Foto",key:"equipment_image",sortable:!1},{title:"Equipo",align:"start",key:"equipment"},{title:"Marca",key:"trademark.trademark"},{title:"Modelo",key:"model.trademark_model"},{title:"No. Serie",key:"serial_number"},{title:"Categoría",key:"category.ct_equipment"},{title:"Estado",key:"status.status"},{title:"Diagrama",key:"equipment_diagram"},{title:"Activo",key:"active"},{title:"Actions",key:"actions",sortable:!1}],editedIndex:-1,editedItem:{equipment_uuid:"",equipment:"",ct_equipment_code:"",trademark_code:"",trademark_model_code:"",status_code:"",serial_number:"",active:!1,manual:null,equipment_image:null,equipment_diagram:null,models:[]},defaultItem:{equipment_uuid:"",equipment:"",ct_equipment_code:"",trademark_code:"",trademark_model_code:"",status_code:"",serial_number:"",active:!1,manual:null,equipment_image:null,equipment_diagram:null,models:[]},trademarks:[],ct_equipments:[],status:[]}),computed:{formTitle(){return this.editedIndex===-1?"Nuevo equipo":"Editar equipo"}},watch:{dialog(t){t||this.close()},dialogDelete(t){t||this.closeDelete()}},methods:{getItem(t){return{equipment_uuid:t.equipment_uuid,equipment:t.equipment,ct_equipment_code:t.category.ct_equipment_code,trademark_code:t.trademark.trademark_code,trademark_model_code:t.model.trademark_model_code,status_code:t.status.status_code,serial_number:t.serial_number,active:t.active,manual:t.manual,equipment_image:t.equipment_image,equipment_diagram:t.equipment_diagram,models:this.trademarks.find(a=>a.trademark_code===t.trademark.trademark_code).models}},editItem(t){this.editedIndex=this.equipments.indexOf(t),t.active=t.active=="1",this.editedItem=Object.assign({},this.getItem(t)),this.editedItem.manual=null,this.editedItem.equipment_image=null,this.editedItem.equipment_diagram=null,this.dialog=!0},deleteItem(t){this.editedIndex=this.equipments.indexOf(t),this.editedItem=Object.assign({},this.getItem(t)),this.dialogDelete=!0},deleteItemConfirm(t){this.equipments.splice(this.editedIndex,1);const a=()=>axios.delete("api/equipments/"+t);m.promise(a,{loading:"Procesando...",success:i=>(this.closeDelete(),"Equipo eliminado correctamente"),error:i=>{this.handleErrors(i)}})},close(){this.dialog=!1,this.$nextTick(()=>{console.log("Cambiando estatus en close"),this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},closeDelete(){this.dialogDelete=!1,this.$nextTick(()=>{console.log("Cambiando estatus en closeDelete"),this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},save(){let t={equipment:this.editedItem.equipment,ct_equipment_code:this.editedItem.ct_equipment_code,trademark_code:this.editedItem.trademark_code,trademark_model_code:this.editedItem.trademark_model_code,status_code:this.editedItem.status_code,serial_number:this.editedItem.serial_number,active:this.editedItem.active?1:0,manual_storage:this.editedItem.manual,equipment_image_storage:this.editedItem.equipment_image,equipment_diagram_storage:this.editedItem.equipment_diagram};if(this.editedIndex>-1){const a=()=>axios.post("api/equipments/update/"+this.editedItem.equipment_uuid,t,{headers:{"Content-Type":"multipart/form-data"}});m.promise(a(),{loading:"Procesando...",success:i=>(this.close(),this.$inertia.reload(),"Equipo actualizado correctamente"),error:i=>{this.handleErrors(i)}})}else{const a=()=>axios.post("api/equipments",t,{headers:{"Content-Type":"multipart/form-data"}});m.promise(a(),{loading:"Procesando...",success:i=>(this.close(),this.$inertia.reload(),"Equipo creado correctamente"),error:i=>{this.handleErrors(i)}})}},getColor(t){return t?"green":"red"},getTrademarks(){axios.get("api/trademarks").then(t=>{this.trademarks=t.data.data}).catch(t=>{m.error("Error al cargar el catálogo de marcas")})},setTradermarkModels(){this.editedItem.trademark_model_code="",this.editedItem.models=this.trademarks.find(t=>t.trademark_code===this.editedItem.trademark_code).models},getCategories(){axios.get("api/equipment/categories").then(t=>{this.ct_equipments=t.data.data}).catch(t=>{m.error("Error al cargar el catálogo de categorías")})},getStatus(){axios.get("api/status").then(t=>{this.status=t.data.data}).catch(t=>{m.error("Error al cargar el catálogo de estatus")})},downloadManual(t){window.open("../"+t.manual,"_blank")},showImage(t){window.open("../"+t,"_blank")}},mounted(){this.getTrademarks(),this.getCategories(),this.getStatus()}},X=Object.assign(W,{__name:"Equipment",setup(t){return(a,i)=>{const q=o("v-avatar"),c=o("v-icon"),g=o("v-text-field"),D=o("v-toolbar-title"),T=o("v-divider"),p=o("v-spacer"),r=o("v-btn"),k=o("v-card-title"),s=o("v-col"),_=o("v-select"),v=o("v-file-input"),U=o("v-switch"),I=o("v-row"),$=o("v-container"),M=o("v-card-text"),b=o("v-card-actions"),h=o("v-card"),V=o("v-dialog"),N=o("v-toolbar"),S=o("v-data-table");return C(),y(O,null,[e(w(E),{position:"top-right",richColors:"",visibleToasts:10}),e(w(z),{title:"Equipments"}),e(P,null,{header:l(()=>[G]),default:l(()=>[u("div",Z,[u("div",H,[u("div",J,[e(h,null,{default:l(()=>[e(I,null,{default:l(()=>[e(s,{cols:"12",sm:"12"},{default:l(()=>[e(S,{headers:a.headers,items:t.equipments,"fixed-header":"",search:a.search},{"item.equipment_image":l(({item:d})=>[e(q,{image:"../../"+d.equipment_image,size:"40",class:"ma-1 avatar",onClick:f=>a.showImage(d.equipment_image)},null,8,["image","onClick"])]),"item.equipment_diagram":l(({item:d})=>[e(q,{image:"../../"+d.equipment_diagram,size:"40",class:"ma-1 avatar",onClick:f=>a.showImage(d.equipment_diagram)},null,8,["image","onClick"])]),"item.active":l(({value:d})=>[e(c,{color:a.getColor(d)},{default:l(()=>[n("mdi-circle-slice-8")]),_:2},1032,["color"])]),top:l(()=>[e(N,{flat:""},{default:l(()=>[e(D,{class:"ml-1"},{default:l(()=>[e(g,{modelValue:a.search,"onUpdate:modelValue":i[0]||(i[0]=d=>a.search=d),label:"Buscar","hide-details":"",variant:"solo","append-inner-icon":"mdi-magnify",density:"compact"},null,8,["modelValue"])]),_:1}),e(T,{class:"mx-4",inset:"",vertical:""}),e(p),e(V,{modelValue:a.dialog,"onUpdate:modelValue":i[12]||(i[12]=d=>a.dialog=d),"max-width":"500px"},{activator:l(({props:d})=>[e(r,j({class:"mb-2",color:"primary",dark:""},d,{icon:"mdi-plus"}),null,16)]),default:l(()=>[e(h,null,{default:l(()=>[e(k,null,{default:l(()=>[u("span",K,x(a.formTitle),1)]),_:1}),e(M,null,{default:l(()=>[e($,null,{default:l(()=>[e(I,null,{default:l(()=>[e(s,{cols:"12"},{default:l(()=>[e(g,{modelValue:a.editedItem.equipment,"onUpdate:modelValue":i[1]||(i[1]=d=>a.editedItem.equipment=d),label:"Nombre",variant:"solo","hide-details":""},null,8,["modelValue"])]),_:1}),e(s,{cols:"12"},{default:l(()=>[e(_,{modelValue:a.editedItem.ct_equipment_code,"onUpdate:modelValue":i[2]||(i[2]=d=>a.editedItem.ct_equipment_code=d),items:a.ct_equipments,"item-title":"ct_equipment","item-value":"ct_equipment_code",label:"Categoría",variant:"solo","hide-details":""},null,8,["modelValue","items"])]),_:1}),e(s,{cols:"12"},{default:l(()=>[e(_,{modelValue:a.editedItem.trademark_code,"onUpdate:modelValue":[i[3]||(i[3]=d=>a.editedItem.trademark_code=d),i[4]||(i[4]=d=>a.setTradermarkModels())],items:a.trademarks,"item-title":"trademark","item-value":"trademark_code",label:"Marca",variant:"solo","hide-details":""},null,8,["modelValue","items"])]),_:1}),e(s,{cols:"12"},{default:l(()=>[e(_,{modelValue:a.editedItem.trademark_model_code,"onUpdate:modelValue":i[5]||(i[5]=d=>a.editedItem.trademark_model_code=d),items:a.editedItem.models,"item-title":"trademark_model","item-value":"trademark_model_code",label:"Modelo",variant:"solo","hide-details":""},null,8,["modelValue","items"])]),_:1}),e(s,{cols:"12"},{default:l(()=>[e(_,{modelValue:a.editedItem.status_code,"onUpdate:modelValue":i[6]||(i[6]=d=>a.editedItem.status_code=d),items:a.status,"item-title":"status","item-value":"status_code",label:"Estatus",variant:"solo","hide-details":""},null,8,["modelValue","items"])]),_:1}),e(s,{cols:"12"},{default:l(()=>[e(g,{modelValue:a.editedItem.serial_number,"onUpdate:modelValue":i[7]||(i[7]=d=>a.editedItem.serial_number=d),label:"Número de serie",variant:"solo","hide-details":""},null,8,["modelValue"])]),_:1}),e(s,{cols:"12"},{default:l(()=>[e(v,{variant:"solo",label:"Manual",modelValue:a.editedItem.manual,"onUpdate:modelValue":i[8]||(i[8]=d=>a.editedItem.manual=d),accept:".pdf","prepend-icon":"","prepend-inner-icon":"mdi-file-upload","hide-details":""},null,8,["modelValue"])]),_:1}),e(s,{cols:"12"},{default:l(()=>[e(v,{variant:"solo",label:"Imagen",modelValue:a.editedItem.equipment_image,"onUpdate:modelValue":i[9]||(i[9]=d=>a.editedItem.equipment_image=d),accept:"image/*","prepend-icon":"","prepend-inner-icon":"mdi-image-plus","hide-details":""},null,8,["modelValue"])]),_:1}),e(s,{cols:"12"},{default:l(()=>[e(v,{variant:"solo",label:"Diagrama",modelValue:a.editedItem.equipment_diagram,"onUpdate:modelValue":i[10]||(i[10]=d=>a.editedItem.equipment_diagram=d),accept:"image/*","prepend-icon":"","prepend-inner-icon":"mdi-image-plus","hide-details":""},null,8,["modelValue"])]),_:1}),e(s,{cols:"12"},{default:l(()=>[e(U,{label:"Activo",modelValue:a.editedItem.active,"onUpdate:modelValue":i[11]||(i[11]=d=>a.editedItem.active=d),color:"primary"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(b,null,{default:l(()=>[e(p),e(r,{color:"blue-darken-1",variant:"text",onClick:a.close},{default:l(()=>[n(" Cancelar ")]),_:1},8,["onClick"]),e(r,{color:"blue-darken-1",variant:"text",onClick:a.save},{default:l(()=>[n(" Guardar ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(V,{modelValue:a.dialogDelete,"onUpdate:modelValue":i[14]||(i[14]=d=>a.dialogDelete=d),"max-width":"500px"},{default:l(()=>[e(h,null,{default:l(()=>[e(k,{class:"text-h5 text-center"},{default:l(()=>[n("¿Estás seguro de eliminar?")]),_:1}),e(b,null,{default:l(()=>[e(p),e(r,{color:"blue-darken-1",variant:"text",onClick:a.closeDelete},{default:l(()=>[n("Cancel")]),_:1},8,["onClick"]),e(r,{color:"blue-darken-1",variant:"text",onClick:i[13]||(i[13]=d=>a.deleteItemConfirm(a.editedItem.equipment_uuid))},{default:l(()=>[n("Si, eliminar")]),_:1}),e(p)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.actions":l(({item:d})=>[d.manual?(C(),y("a",{key:0,href:d.manual,target:"_blank",class:"v-btn v-btn--depressed"},[e(c,{class:"me-2",size:"small"},{default:l(()=>[n(" mdi-file ")]),_:1})],8,Q)):A("",!0),e(c,{class:"me-2",size:"small",onClick:f=>a.editItem(d)},{default:l(()=>[n(" mdi-pencil ")]),_:2},1032,["onClick"]),e(c,{class:"me-2",size:"small",onClick:f=>a.deleteItem(d)},{default:l(()=>[n(" mdi-delete ")]),_:2},1032,["onClick"])]),_:1},8,["headers","items","search"])]),_:1})]),_:1})]),_:1})])])])]),_:1})],64)}}}),de=R(X,[["__scopeId","data-v-7ac28006"]]);export{de as default};
