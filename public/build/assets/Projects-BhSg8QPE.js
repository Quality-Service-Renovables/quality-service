import{r as l,o as a,e as f,b as i,u as S,w as n,F as U,L as R,q as v,Z as ee,a as m,d as p,t as I,y as z,g as c,c as d,s as ie,x as te,p as oe,h as ne}from"./app-CdXlW3h5.js";import{_ as se}from"./AuthenticatedLayout-DwxykK97.js";import _ from"./ActionButton-CBlIPpyi.js";import{_ as H}from"./PrimaryButton-Gkck9oeO.js";import L from"./Section-BoT19UaR.js";import G from"./Evidence-ipoqy-Tl.js";import M from"./ConclutionAndRecomendation-CqobcY3-.js";import{Q}from"./vue-quill.esm-bundler-2dK6wHVT.js";import{S as A}from"./sweetalert2.all-M4mKF3Ll.js";import{_ as ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-DHcIPpdZ.js";import"./EvidenceForm-B2lt4cea.js";import"./filepond-plugin-image-preview.esm-dR7flX8A.js";import"./api-BD4meRzS.js";const $=s=>(oe("data-v-11d6f996"),s=s(),ne(),s),le=$(()=>m("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Proyectos de inspección",-1)),ce={class:"py-12"},re={class:"max-w-7xl mx-auto sm:px-4 lg:px-6"},de={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},ue={key:0},pe={key:0},me={class:"text-h5"},he={class:"d-flex"},ge={class:"d-flex"},_e=$(()=>m("p",{class:"text-h6 mb-2"},"Estatus:",-1)),fe={class:"mb-4"},ye={class:"font-weight-normal"},ve={key:0,class:"text-h5"},Ie={key:1,class:"text-h5"},ke={key:0,class:"text-h5"},qe={key:1,class:"text-h5"},Ce=$(()=>m("p",{class:"text-grey mb-2"},"Define el resumen de la inspección a realizar ",-1)),je={components:{Toaster:R,ActionButton:_,PrimaryButton:H,QuillEditor:Q,Section:L,Evidence:G,ConclutionAndRecomendation:M},props:{projects:{type:Array,required:!0}},data:()=>({search:"",dialog:!1,dialogHelp:!1,dialogAsignEmployees:!1,dialogDelete:!1,dialogAsignInspection:!1,headers:[{title:"Nombre",key:"project_name"},{title:"Cliente",key:"client.client"},{title:"Técnicos asignados",key:"employees"},{title:"Inspección asignada",key:"inspections"},{title:"Estado",key:"status.status"},{title:"Acciones",key:"actions",sortable:!1},{title:"Inspección",key:"inspection_actions",sortable:!1}],editedIndex:-1,editedItem:{project_uuid:"",project_name:"",description:"",comments:"",client_uuid:"",employees_uuid:[]},defaultItem:{project_uuid:"",project_name:"",description:"",comments:"",client_uuid:"",employees_uuid:[]},helpData:[{title:"Proyecto creado",description:"El proyecto ha sido creado, falta asignar técnico e inspección."},{title:"Proyecto asignado",description:"El proyecto ha sido asignado a un técnico, ya se puede iniciar."},{title:"Proyecto iniciado",description:"El proyecto ha sido iniciado, ya se puede comenzar a cargar información para el reporte final."},{title:"Proyecto finalizado",description:"El proyecto ha sido finalizado, ya puede comenzar la fase de validación de información."},{title:"Proyecto validado",description:"El proyecto ha sido validado, en este punto el cliente podrá visualizar el reporte final."},{title:"Proyecto cerrado",description:"El proyecto ha sido cerrado y no se podrá realizar más cambios."},{title:"Proyecto cancelado",description:"El proyecto ha sido cancelado y no se podrá realizar más cambios."}],clients:[],employees:[],editingProjectUuid:"",inspections:[],inspectionsEquipmentsCategories:[],inspectionsEquipmentsToUseInInspections:[],loadingInspectionDialog:!1,equipmentsByCategory:[],inspectionForm:{isUpdating:!1,inspection_uuid:"",project_name:"",resume:"",ct_inspection_code:null,status_code:"proyecto_iniciado",project_id:null,client_uuid:null,ct_equipment_uuid:null,equipment_uuid:[],equipments_uuid:[]},defaultInspectionForm:{isUpdating:!1,inspection_uuid:"",project_name:"",resume:"",ct_inspection_code:null,status_code:"proyecto_iniciado",project_id:null,client_uuid:null,ct_equipment_uuid:null,equipment_uuid:[],equipments_uuid:[]},errorAssigningInspection:!1,dialogForm:!1,ctInspectionUuid:"",tab:"sections",inspectionUuid:null}),computed:{formTitle(){return this.editedIndex===-1?"Nuevo proyecto":"Editar proyecto"}},watch:{dialog(s){s||this.close()},dialogDelete(s){s||this.closeDelete()}},mounted(){this.getClients(),this.getTechniciens(),this.getInspections(),this.getinspectionsEquipmentsCategories()},methods:{save(){this.editedIndex>-1?this.updateProject(this.editedItem):this.saveProject(this.editedItem)},saveProject(s){let e={project_name:s.project_name,description:s.description,comments:s.comments,client_uuid:s.client_uuid};const t=()=>axios.post("api/projects",e);v.promise(t(),{loading:"Procesando...",success:r=>(this.$inertia.reload(),this.close(),"Proyecto creado correctamente"),error:r=>{this.handleErrors(r)}})},updateProject(s,e=null){console.log("Item: "),console.log(s);let t={project_name:s.project_name,description:s.description,comments:s.comments,client_uuid:e?s.client.client_uuid:s.client_uuid,status_code:e||s.status.status_code};const r=()=>axios.put("api/projects/"+s.project_uuid,t);v.promise(r(),{loading:"Procesando...",success:h=>(this.$inertia.reload(),this.close(),"Proyecto actualizado correctamente"),error:h=>{this.handleErrors(h)}})},updateStatus(s,e){e=="proyecto_cancelado"?A.fire({title:"Mótivo de cancelación",input:"text",inputAttributes:{autocapitalize:"off"},showCancelButton:!0,confirmButtonText:"Cancelar proyecto",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:async t=>{t===""?A.showValidationMessage("El motivo de cancelación es requerido"):s.comments=t},allowOutsideClick:()=>!A.isLoading()}).then(t=>{t.isConfirmed&&this.updateProject(s,e)}):A.fire({icon:"question",title:"Confirmación",text:"¿Estás seguro de cambiar el estatus del proyecto?",showCancelButton:!0,confirmButtonText:"Continuar",denyButtonText:"Cancelar"}).then(t=>{t.isConfirmed&&this.updateProject(s,e)})},close(){this.dialog=!1,this.$nextTick(()=>{console.log("Cambiando estatus en close"),this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},editItem(s){this.dialog=!0,this.editedIndex=this.projects.indexOf(s),this.getProject(s.project_uuid)},getProject(s){axios.get("api/projects/"+s).then(e=>{this.editedItem=e.data.data,this.editedItem.client_uuid=this.editedItem.client.client_uuid,this.editedItem.employees_uuid=this.editedItem.employees.map(t=>t.user.uuid)}).catch(e=>{this.handleErrors(e)})},deleteItem(s){this.editedIndex=this.projects.indexOf(s),this.editedItem=Object.assign({},s),this.dialogDelete=!0},deleteItemConfirm(s){this.projects.splice(this.editedIndex,1);const e=()=>axios.delete("api/projects/"+s);v.promise(e,{loading:"Procesando...",success:t=>(this.closeDelete(),"Proyecto eliminado correctamente"),error:t=>{this.handleErrors(t)}})},closeDelete(){this.dialogDelete=!1,this.$nextTick(()=>{console.log("Cambiando estatus en closeDelete"),this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},asignTechniciensDialog(s,e){this.dialogAsignEmployees=!0,this.editingProjectUuid=e.project_uuid,s==="update"?(this.editedItem.action="update",this.editedItem.employees_uuid=e.employees.map(t=>t.user.uuid)):(this.editedItem.action="create",this.editedItem.employees_uuid=[]),console.log("Asignar técnico")},asignTechniciens(){let s=this.editedItem.action,e={project_uuid:this.editingProjectUuid,employees:[]};if(this.editedItem.employees_uuid.forEach(t=>{e.employees.push({employee_uuid:t})}),s==="update"){const t=()=>axios.put("api/project/employees/"+e.project_uuid,e);v.promise(t(),{loading:"Procesando...",success:r=>(this.$inertia.reload(),this.closeAsignTechniciens(),"Técnicos actualizados correctamente"),error:r=>{this.handleErrors(r)}})}else if(s==="create"){const t=()=>axios.post("api/project/employees",e);v.promise(t(),{loading:"Procesando...",success:r=>(this.$inertia.reload(),this.closeAsignTechniciens(),"Técnicos asignados correctamente"),error:r=>{this.handleErrors(r)}})}},closeAsignTechniciens(){this.dialogAsignEmployees=!1,this.editingProjectUuid=""},async asignInspectionDialog(s,e){this.dialogAsignInspection=!0,this.editingProjectUuid=e.project_uuid,s=="update"?(this.inspectionForm.isUpdating=!0,this.inspectionForm.inspection_uuid=e.inspections[0].inspection_uuid,this.inspectionForm.project_name=e.project_name,this.inspectionForm.resume=e.inspections[0].resume,this.inspectionForm.ct_inspection_code=e.inspections[0].category.ct_inspection_code,this.inspectionForm.status_code=e.status.status_code,this.inspectionForm.project_id=e.project_uuid,this.inspectionForm.client_uuid=e.client.client_uuid,this.inspectionForm.ct_equipment_uuid=e.inspections[0].equipment.category.ct_equipment_uuid,this.getInspectionEquipmentsByCategory(this.inspectionForm.ct_equipment_uuid),this.inspectionForm.equipment_uuid=e.inspections[0].equipment.equipment_uuid,this.inspectionForm.equipments_uuid=e.inspections[0].inspection_equipments.map(t=>t.equipment.equipment_uuid)):s=="create"&&(this.inspectionForm.isUpdating=!1,this.inspectionForm.project_name=e.project_name,this.inspectionForm.project_id=e.project_uuid,this.inspectionForm.client_uuid=e.client.client_uuid)},async asignInspection(){console.log("Asignar inspección"),this.loadingInspectionDialog=!0;try{await this.createInspection(),await this.asignEquipmentToInspection()}catch{v.error("Error al asignar inspección, favor de verificar los datos ingresados.")}this.loadingInspectionDialog=!1,this.errorAssigningInspection||(console.log("this.errorAssigningInspection: "+this.errorAssigningInspection),this.$inertia.reload(),this.closeAsignInspection())},createInspection(){return new Promise((s,e)=>{let t=null;if(this.inspectionForm.isUpdating){t=()=>axios.put("api/inspections/"+this.inspectionForm.inspection_uuid,r);let r={resume:this.inspectionForm.resume,conclusion:"Por definir",ct_inspection_code:this.inspectionForm.ct_inspection_code,status_code:this.inspectionForm.status_code,equipment_uuid:this.inspectionForm.equipment_uuid,project_uuid:this.inspectionForm.project_id,client_uuid:this.inspectionForm.client_uuid}}else{let r={resume:this.inspectionForm.resume,conclusion:"Por definir",ct_inspection_code:this.inspectionForm.ct_inspection_code,status_code:this.inspectionForm.status_code,equipment_uuid:this.inspectionForm.equipment_uuid,project_uuid:this.inspectionForm.project_id,client_uuid:this.inspectionForm.client_uuid};t=()=>axios.post("api/inspections",r)}v.promise(t(),{loading:this.inspectionForm.isUpdating?"Actualizando inspección...":"Asignando inspección...",success:r=>{this.inspectionForm.inspection_uuid=r.data.data.inspection_uuid;let h=this.inspectionForm.isUpdating?"Inspección actualizada correctamente":"Inspección asignada correctamente";return s(h),h},error:r=>{this.errorAssigningInspection=!0,this.handleErrors(r),e(r)}})})},asignEquipmentToInspection(){return new Promise((s,e)=>{let t=this.inspectionForm.equipments_uuid.map(h=>({equipment_uuid:h}));const r=()=>this.inspectionForm.isUpdating?axios.put("api/inspection/equipments/"+this.inspectionForm.inspection_uuid,{inspection_uuid:this.inspectionForm.inspection_uuid,equipments:t}):axios.post("api/inspection/equipments",{inspection_uuid:this.inspectionForm.inspection_uuid,equipments:t});v.promise(r(),{loading:this.inspectionForm.isUpdating?"Actualizando equipos de inspección...":"Asignando equipos a inspección...",success:h=>{let b=this.inspectionForm.isUpdating?"Actualización completada correctamente":"Asignación completada correctamente";return s(b),b},error:h=>{this.errorAssigningInspection=!0,this.handleErrors(h),e(h)}})})},closeAsignInspection(){this.dialogAsignInspection=!1,this.inspectionForm=Object.assign({},this.defaultInspectionForm)},formDialog(s){this.dialogForm=!0,this.ctInspectionUuid=s.inspections[0].category.ct_inspection_uuid,this.inspectionUuid=s.inspections[0].inspection_uuid,this.inspectionForm.project_name=s.project_name},closeSectionDialog(){this.dialogForm=!1,this.ctInspectionUuid=""},getClients(){axios.get("api/clients").then(s=>{this.clients=s.data.data}).catch(s=>{console.log(s)})},getTechniciens(){axios.get("api/users/get-rol-users/tecnico").then(s=>{this.employees=s.data.data}).catch(s=>{console.log(s)})},getInspections(){axios.get("api/inspection/categories").then(s=>{this.inspections=s.data.data}).catch(s=>{this.handleErrors(s)})},getinspectionsEquipmentsCategories(){axios.get("api/equipment/categories").then(s=>{this.inspectionsEquipmentsCategories=s.data.data,this.inspectionsEquipmentsToUseInInspections=this.inspectionsEquipmentsCategories.filter(e=>e.ct_equipment_code==="inspeccion"),this.inspectionsEquipmentsToUseInInspections=this.inspectionsEquipmentsToUseInInspections.length?this.inspectionsEquipmentsToUseInInspections[0].equipments:[]}).catch(s=>{this.handleErrors(s)})},checkStatus(s,e){return e.includes(s.status.status_code)},getInspectionEquipmentsByCategory(s){this.inspectionForm.equipment_uuid=null;let e=this.inspectionsEquipmentsCategories.find(t=>t.ct_equipment_uuid===s).equipments;this.equipmentsByCategory=e.length>0?e:[]},generatePdf(s){v.warning("Solicitando documento, espere..."),axios.get("inspection/get-document/"+s.inspections[0].inspection_uuid).then(e=>{window.open(e.data.data.path_storage,"_blank")}).catch(e=>{v.error("No fue posible recuperar el documento"),console.log(e)})}}},be=Object.assign(je,{__name:"Projects",setup(s){return(e,t)=>{const r=l("v-chip"),h=l("v-icon"),b=l("v-text-field"),B=l("v-toolbar-title"),Z=l("v-divider"),k=l("v-spacer"),y=l("v-btn"),F=l("v-card-title"),g=l("v-col"),O=l("v-textarea"),C=l("v-select"),P=l("v-row"),T=l("v-container"),V=l("v-card-text"),E=l("v-card-actions"),q=l("v-card"),j=l("v-dialog"),N=l("v-toolbar"),J=l("v-data-table"),K=l("v-timeline-item"),W=l("v-timeline"),D=l("v-tab"),X=l("v-tabs"),w=l("v-tabs-window-item"),Y=l("v-tabs-window");return a(),f(U,null,[i(S(R),{position:"top-right",richColors:"",visibleToasts:10}),i(S(ee),{title:"Proyectos de inspección"}),i(se,null,{header:n(()=>[le]),default:n(()=>[m("div",ce,[m("div",re,[m("div",de,[i(q,null,{default:n(()=>[i(P,null,{default:n(()=>[i(g,{cols:"12",sm:"12"},{default:n(()=>[i(J,{headers:e.headers,items:s.projects,"fixed-header":"",search:e.search},{"item.status.status":n(({value:o,item:u})=>[i(r,{size:"small",class:"m-1"},{default:n(()=>[p(I(o),1)]),_:2},1024)]),"item.employees":n(({value:o})=>[(a(!0),f(U,null,z(o,(u,x)=>(a(),f("p",{key:x},[i(h,{class:"mdi mdi-vector-point text-primary"}),p(" "+I(u.user.name),1)]))),128)),o.length?c("",!0):(a(),f("p",ue,"Por asignar"))]),"item.inspections":n(({value:o})=>[(a(!0),f(U,null,z(o,u=>(a(),f("p",{key:u.ct_inspection_uuid},I(u.category.ct_inspection),1))),128)),o.length?c("",!0):(a(),f("p",pe,"Por asignar"))]),top:n(()=>[i(N,{flat:""},{default:n(()=>[i(B,{class:"ml-1"},{default:n(()=>[i(b,{modelValue:e.search,"onUpdate:modelValue":t[0]||(t[0]=o=>e.search=o),label:"Buscar","hide-details":"",variant:"solo","append-inner-icon":"mdi-magnify",density:"compact"},null,8,["modelValue"])]),_:1}),i(Z,{class:"mx-4",inset:"",vertical:""}),i(k),e.hasPermissionTo("projects.create")||e.hasPermissionTo("projects.update")?(a(),d(j,{key:0,modelValue:e.dialog,"onUpdate:modelValue":t[6]||(t[6]=o=>e.dialog=o),width:"auto"},ie({default:n(()=>[i(q,{loading:!1},{default:n(()=>[i(F,null,{default:n(()=>[m("span",me,I(e.formTitle),1)]),_:1}),i(V,null,{default:n(()=>[i(T,null,{default:n(()=>[i(P,null,{default:n(()=>[i(g,{cols:"12"},{default:n(()=>[i(b,{modelValue:e.editedItem.project_name,"onUpdate:modelValue":t[2]||(t[2]=o=>e.editedItem.project_name=o),label:"Nombre",variant:"outlined","hide-details":"",required:""},null,8,["modelValue"])]),_:1}),i(g,{cols:"6"},{default:n(()=>[i(O,{modelValue:e.editedItem.description,"onUpdate:modelValue":t[3]||(t[3]=o=>e.editedItem.description=o),label:"Descripción",variant:"outlined","hide-details":"",required:""},null,8,["modelValue"])]),_:1}),i(g,{cols:"6"},{default:n(()=>[i(O,{modelValue:e.editedItem.comments,"onUpdate:modelValue":t[4]||(t[4]=o=>e.editedItem.comments=o),label:"Comentarios",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),i(g,{cols:"12"},{default:n(()=>[i(C,{modelValue:e.editedItem.client_uuid,"onUpdate:modelValue":t[5]||(t[5]=o=>e.editedItem.client_uuid=o),items:e.clients,"item-title":"client","item-value":"client_uuid",label:"Cliente",variant:"outlined","hide-details":"",required:""},null,8,["modelValue","items"])]),_:1}),i(g,{cols:"12",class:"text-right"},{default:n(()=>[i(H,{onClick:e.save},{default:n(()=>[p("Guardar")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1}),i(E,null,{default:n(()=>[i(k),i(y,{color:"blue-darken-1",variant:"text",onClick:e.close},{default:n(()=>[p(" Cerrar ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:2},[e.hasPermissionTo("projects.create")?{name:"activator",fn:n(({props:o})=>[i(y,{class:"mb-2",color:"primary",dark:"",icon:"mdi-lightbulb-on-outline",onClick:t[1]||(t[1]=u=>e.dialogHelp=!0)}),i(y,te({class:"mb-2",color:"primary",dark:""},o,{icon:"mdi-plus"}),null,16)]),key:"0"}:void 0]),1032,["modelValue"])):c("",!0),i(j,{modelValue:e.dialogDelete,"onUpdate:modelValue":t[8]||(t[8]=o=>e.dialogDelete=o),"max-width":"500px"},{default:n(()=>[i(q,null,{default:n(()=>[i(F,{class:"text-h5 text-center"},{default:n(()=>[p("¿Estás seguro de eliminar?")]),_:1}),i(E,null,{default:n(()=>[i(k),i(y,{color:"blue-darken-1",variant:"text",onClick:e.closeDelete},{default:n(()=>[p("Cancel")]),_:1},8,["onClick"]),i(y,{color:"blue-darken-1",variant:"text",onClick:t[7]||(t[7]=o=>e.deleteItemConfirm(e.editedItem.project_uuid))},{default:n(()=>[p("Si, eliminar")]),_:1}),i(k)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.actions":n(({item:o})=>[m("div",he,[e.hasPermissionTo("projects.update")&&e.checkStatus(o,["proyecto_creado","proyecto_asignado","proyecto_iniciado"])?(a(),d(_,{key:0,text:"Editar",icon:"mdi-pencil",onClick:u=>e.editItem(o),size:"small"},null,8,["onClick"])):c("",!0),e.hasPermissionTo("projects.update")&&e.checkStatus(o,["proyecto_creado","proyecto_asignado","proyecto_iniciado"])?(a(),d(_,{key:1,text:"Cancelar proyecto",icon:"mdi-table-cancel",size:"small",onClick:u=>e.updateStatus(o,"proyecto_cancelado")},null,8,["onClick"])):c("",!0),e.hasPermissionTo("projects.delete")&&e.checkStatus(o,["proyecto_creado","proyecto_asignado"])?(a(),d(_,{key:2,text:"Eliminar",icon:"mdi-delete",onClick:u=>e.deleteItem(o),size:"small"},null,8,["onClick"])):c("",!0),e.hasPermissionTo("projects.update")&&e.checkStatus(o,["proyecto_asignado","proyecto_iniciado"])?(a(),d(_,{key:3,text:"Asignar técnico",icon:"mdi-account-plus-outline",size:"small",onClick:u=>e.asignTechniciensDialog("update",o),color:"text-success"},null,8,["onClick"])):c("",!0),e.hasPermissionTo("projects.update")&&e.checkStatus(o,["proyecto_asignado","proyecto_iniciado"])&&o.inspections.length?(a(),d(_,{key:4,text:"Asignar inspección",icon:"mdi-table-plus",size:"small",onClick:u=>e.asignInspectionDialog("update",o),color:"text-success"},null,8,["onClick"])):c("",!0),e.hasPermissionTo("projects.update")&&e.checkStatus(o,["proyecto_iniciado","proyecto_finalizado","proyecto_validado","proyecto_cerrado"])&&o.inspections.length?(a(),d(_,{key:5,text:"Generar PDF",icon:"mdi-file-eye",size:"small",onClick:u=>e.generatePdf(o),color:"text-success"},null,8,["onClick"])):c("",!0)])]),"item.inspection_actions":n(({item:o})=>[m("div",ge,[e.hasPermissionTo("projects.update")&&e.checkStatus(o,["proyecto_creado"])?(a(),d(_,{key:0,text:"Asignar técnico",icon:"mdi-account-plus-outline",size:"small",onClick:u=>e.asignTechniciensDialog("create",o),color:"text-primary"},null,8,["onClick"])):c("",!0),e.hasPermissionTo("projects.update")&&e.checkStatus(o,["proyecto_asignado"])&&!o.inspections.length?(a(),d(_,{key:1,text:"Asignar inspección",icon:"mdi-table-plus",size:"small",onClick:u=>e.asignInspectionDialog("create",o),color:"text-primary"},null,8,["onClick"])):c("",!0),e.hasPermissionTo("projects.update")&&e.checkStatus(o,["proyecto_iniciado"])?(a(),d(_,{key:2,text:"Cargar información",icon:"mdi-file-edit",size:"small",onClick:u=>e.formDialog(o),color:"text-primary"},null,8,["onClick"])):c("",!0),e.hasPermissionTo("projects.finalize")&&e.checkStatus(o,["proyecto_iniciado"])&&o.inspections.length>0?(a(),d(_,{key:3,text:"Finalizar proyecto",icon:"mdi-note-check",size:"small",color:"text-primary",onClick:u=>e.updateStatus(o,"proyecto_finalizado")},null,8,["onClick"])):c("",!0),e.hasPermissionTo("projects.validate")&&e.checkStatus(o,["proyecto_finalizado"])?(a(),d(_,{key:4,text:"Validar proyecto",icon:"mdi-check-circle-outline",size:"small",onClick:u=>e.updateStatus(o,"proyecto_validado")},null,8,["onClick"])):c("",!0),e.hasPermissionTo("projects.close")&&e.checkStatus(o,["proyecto_validado"])?(a(),d(_,{key:5,text:"Cerrar proyecto",icon:"mdi-close-circle-outline",size:"small",color:"text-primary",onClick:u=>e.updateStatus(o,"proyecto_cerrado")},null,8,["onClick"])):c("",!0)])]),_:1},8,["headers","items","search"]),i(j,{modelValue:e.dialogHelp,"onUpdate:modelValue":t[10]||(t[10]=o=>e.dialogHelp=o),width:"auto"},{default:n(()=>[i(q,null,{default:n(()=>[i(F,{class:"text-h5 text-center"},{default:n(()=>[p("Ayuda")]),_:1}),i(V,null,{default:n(()=>[i(T,null,{default:n(()=>[i(P,null,{default:n(()=>[i(g,{cols:"12"},{default:n(()=>[_e,i(W,{align:"start",density:"compact"},{default:n(()=>[(a(!0),f(U,null,z(e.helpData,o=>(a(),d(K,{key:o.title,size:"x-small","dot-color":"grey"},{default:n(()=>[m("div",fe,[m("div",ye,[m("strong",null,I(o.title),1)]),m("div",null,I(o.description),1)])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),i(E,null,{default:n(()=>[i(k),i(y,{color:"blue-darken-1",variant:"text",onClick:t[9]||(t[9]=o=>e.dialogHelp=!1)},{default:n(()=>[p("Cerrar")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e.hasPermissionTo("projects.update")?(a(),d(j,{key:0,modelValue:e.dialogAsignEmployees,"onUpdate:modelValue":t[13]||(t[13]=o=>e.dialogAsignEmployees=o),width:"400"},{default:n(()=>[i(q,null,{default:n(()=>[i(F,null,{default:n(()=>[e.editedItem.action=="create"?(a(),f("span",ve,"Asignar técnicos")):c("",!0),e.editedItem.action=="update"?(a(),f("span",Ie,"Actualizar técnicos")):c("",!0)]),_:1}),i(V,null,{default:n(()=>[i(T,null,{default:n(()=>[i(P,null,{default:n(()=>[i(g,{cols:"12"},{default:n(()=>[i(C,{modelValue:e.editedItem.employees_uuid,"onUpdate:modelValue":t[11]||(t[11]=o=>e.editedItem.employees_uuid=o),items:e.employees,"item-title":"name","item-value":"uuid",label:"Seleccionar técnicos",variant:"outlined","hide-details":"",required:"",multiple:"",chips:""},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),_:1}),i(E,null,{default:n(()=>[i(k),i(y,{color:"blue-darken-1",variant:"text",onClick:e.closeAsignTechniciens},{default:n(()=>[p(" Cerrar ")]),_:1},8,["onClick"]),i(y,{color:"blue-darken-1",variant:"text",onClick:t[12]||(t[12]=o=>e.asignTechniciens()),disabled:!e.editedItem.employees_uuid.length},{default:n(()=>[p(" Guardar ")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):c("",!0),e.hasPermissionTo("projects.update")?(a(),d(j,{key:1,modelValue:e.dialogAsignInspection,"onUpdate:modelValue":t[21]||(t[21]=o=>e.dialogAsignInspection=o),width:"auto","min-height":"600",scrollable:""},{default:n(()=>[i(q,{loading:e.loadingInspectionDialog,disabled:e.loadingInspectionDialog},{default:n(()=>[i(F,null,{default:n(()=>[this.inspectionForm.isUpdating?c("",!0):(a(),f("span",ke,'Asignando inspección al proyecto "'+I(e.inspectionForm.project_name)+'"',1)),this.inspectionForm.isUpdating?(a(),f("span",qe,'Actualizando inspección al proyecto "'+I(e.inspectionForm.project_name)+'"',1)):c("",!0)]),_:1}),i(V,null,{default:n(()=>[i(T,null,{default:n(()=>[i(P,null,{default:n(()=>[i(g,{cols:"12"},{default:n(()=>[i(C,{modelValue:e.inspectionForm.ct_inspection_code,"onUpdate:modelValue":t[14]||(t[14]=o=>e.inspectionForm.ct_inspection_code=o),items:e.inspections,"item-title":"ct_inspection","item-value":"ct_inspection_code",label:"Seleccionar inspección",variant:"outlined","hide-details":"",required:""},null,8,["modelValue","items"])]),_:1}),i(g,{cols:"6"},{default:n(()=>[i(C,{modelValue:e.inspectionForm.ct_equipment_uuid,"onUpdate:modelValue":[t[15]||(t[15]=o=>e.inspectionForm.ct_equipment_uuid=o),t[16]||(t[16]=o=>e.getInspectionEquipmentsByCategory(e.inspectionForm.ct_equipment_uuid))],items:e.inspectionsEquipmentsCategories,"item-title":"ct_equipment","item-value":"ct_equipment_uuid",label:"Seleccionar categoría de equipo",variant:"outlined","hide-details":"",required:""},null,8,["modelValue","items"])]),_:1}),i(g,{cols:"6"},{default:n(()=>[i(C,{modelValue:e.inspectionForm.equipment_uuid,"onUpdate:modelValue":t[17]||(t[17]=o=>e.inspectionForm.equipment_uuid=o),items:e.equipmentsByCategory,"item-title":"equipment","item-value":"equipment_uuid",label:"Seleccionar equipo a inspeccionar",variant:"outlined","hide-details":"",clearable:""},null,8,["modelValue","items"])]),_:1}),i(g,{cols:"12"},{default:n(()=>[i(C,{modelValue:e.inspectionForm.equipments_uuid,"onUpdate:modelValue":t[18]||(t[18]=o=>e.inspectionForm.equipments_uuid=o),items:e.inspectionsEquipmentsToUseInInspections,"item-title":"equipment","item-value":"equipment_uuid",label:"Seleccionar equipos a utilizar en la inspcección",variant:"outlined","hide-details":"",multiple:"",chips:"",clearable:""},null,8,["modelValue","items"])]),_:1}),i(g,{cols:"12"},{default:n(()=>[Ce,i(S(Q),{content:e.inspectionForm.resume,"onUpdate:content":t[19]||(t[19]=o=>e.inspectionForm.resume=o),theme:"snow",toolbar:"essential",heigth:"100%",contentType:"html"},null,8,["content"])]),_:1})]),_:1})]),_:1})]),_:1}),i(E,null,{default:n(()=>[i(k),i(y,{color:"blue-darken-1",variant:"text",onClick:e.closeAsignInspection},{default:n(()=>[p(" Cerrar ")]),_:1},8,["onClick"]),i(y,{color:"blue-darken-1",variant:"text",onClick:t[20]||(t[20]=o=>e.asignInspection()),disabled:!1,loading:e.loadingInspectionDialog},{default:n(()=>[p(" Guardar ")]),_:1},8,["loading"])]),_:1})]),_:1},8,["loading","disabled"])]),_:1},8,["modelValue"])):c("",!0),e.hasPermissionTo("projects.update")?(a(),d(j,{key:2,modelValue:e.dialogForm,"onUpdate:modelValue":t[25]||(t[25]=o=>e.dialogForm=o),transition:"dialog-bottom-transition",fullscreen:""},{default:n(()=>[i(N,null,{default:n(()=>[i(y,{icon:"mdi-close",onClick:t[22]||(t[22]=o=>e.closeSectionDialog())}),i(B,{class:"w-100"},{default:n(()=>[p(" Carga de información "),m("p",null,[m("small",null,'Proyecto: "'+I(this.inspectionForm.project_name)+'"',1)])]),_:1}),i(k)]),_:1}),i(q,null,{default:n(()=>[i(X,{modelValue:e.tab,"onUpdate:modelValue":t[23]||(t[23]=o=>e.tab=o),"align-tabs":"center",class:"position-fixed w-100 bg-primary-color"},{default:n(()=>[i(D,{value:"sections"},{default:n(()=>[p("Secciones")]),_:1}),i(D,{value:"evidences"},{default:n(()=>[p("Evidencias")]),_:1}),i(D,{value:"recomendations"},{default:n(()=>[p("Concluciones y Recomendaciones")]),_:1})]),_:1},8,["modelValue"]),i(V,{class:"mt-10"},{default:n(()=>[i(Y,{modelValue:e.tab,"onUpdate:modelValue":t[24]||(t[24]=o=>e.tab=o)},{default:n(()=>[e.tab==="sections"?(a(),d(w,{key:0},{default:n(()=>[i(L,{dialogForm:e.dialogForm,ct_inspection_uuid:e.ctInspectionUuid,inspection_uuid:e.inspectionUuid,onCloseSectionDialog:e.closeSectionDialog},null,8,["dialogForm","ct_inspection_uuid","inspection_uuid","onCloseSectionDialog"])]),_:1})):c("",!0),e.tab==="evidences"?(a(),d(w,{key:1},{default:n(()=>[i(G,{inspection_uuid:e.inspectionUuid},null,8,["inspection_uuid"])]),_:1})):c("",!0),e.tab==="recomendations"?(a(),d(w,{key:2},{default:n(()=>[i(M,{inspection_uuid:e.inspectionUuid},null,8,["inspection_uuid"])]),_:1})):c("",!0)]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):c("",!0)]),_:1})]),_:1})]),_:1})])])])]),_:1})],64)}}}),Ne=ae(be,[["__scopeId","data-v-11d6f996"]]);export{Ne as default};
