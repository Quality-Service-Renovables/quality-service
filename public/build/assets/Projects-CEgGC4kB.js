import{r as c,o as a,e as f,b as i,u as w,w as n,F as U,L as R,q as v,Z as ee,a as m,d as p,t as k,y as z,g as l,c as d,s as ie,x as te,p as oe,h as ne}from"./app-BLZv_gJ1.js";import{_ as se}from"./AuthenticatedLayout-DxEDoREL.js";import h from"./ActionButton-B4nCLp3E.js";import{_ as H}from"./PrimaryButton-CR9qNMnR.js";import L from"./Section-BEujBcPd.js";import G from"./Evidence-horODrDu.js";import M from"./ConclutionAndRecomendation-CO2iPKd1.js";import{Q}from"./vue-quill.esm-bundler-BKngau-X.js";import{S as A}from"./sweetalert2.all-C1Ty1wsW.js";import{_ as ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-Dn_PHM0t.js";import"./EvidenceForm--jFTfbuI.js";import"./filepond-plugin-image-transform.esm-CaNECEkG.js";import"./ImageEditor-BNiM5bd3.js";import"./api-BC_cMD_u.js";const $=s=>(oe("data-v-85ed3221"),s=s(),ne(),s),le=$(()=>m("h2",{class:"font-semibold text-xl leading-tight"},"Proyectos de inspección",-1)),ce={class:"py-12"},re={class:"max-w-7xl mx-auto sm:px-4 lg:px-6"},de={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},ue={key:0},pe={key:0},me={class:"text-h5"},he={class:"d-flex"},ge={class:"d-flex"},_e=$(()=>m("p",{class:"text-h6 mb-2"},"Estatus:",-1)),fe={class:"mb-4"},ye={class:"font-weight-normal"},ve={key:0,class:"text-h5"},ke={key:1,class:"text-h5"},Ie={key:0,class:"text-h5"},Ce={key:1,class:"text-h5"},qe=$(()=>m("p",{class:"text-grey mb-2"},"Define el resumen de la inspección a realizar ",-1)),je={components:{Toaster:R,ActionButton:h,PrimaryButton:H,QuillEditor:Q,Section:L,Evidence:G,ConclutionAndRecomendation:M},props:{projects:{type:Array,required:!0}},data:()=>({search:"",dialog:!1,dialogHelp:!1,dialogAsignEmployees:!1,dialogDelete:!1,dialogAsignInspection:!1,headers:[{title:"Nombre",key:"project_name"},{title:"Cliente",key:"client.client"},{title:"Técnicos asignados",key:"employees"},{title:"Inspección asignada",key:"inspections"},{title:"Estado",key:"status.status"},{title:"Acciones",key:"actions",sortable:!1},{title:"Inspección",key:"inspection_actions",sortable:!1}],editedIndex:-1,editedItem:{project_uuid:"",project_name:"",description:"",comments:"",client_uuid:"",employees_uuid:[]},defaultItem:{project_uuid:"",project_name:"",description:"",comments:"",client_uuid:"",employees_uuid:[]},helpData:[{title:"Proyecto creado",description:"El proyecto ha sido creado, falta asignar técnico e inspección."},{title:"Proyecto asignado",description:"El proyecto ha sido asignado a un técnico, ya se puede iniciar."},{title:"Proyecto iniciado",description:"El proyecto ha sido iniciado, ya se puede comenzar a cargar información para el reporte final."},{title:"Proyecto finalizado",description:"El proyecto ha sido finalizado, ya puede comenzar la fase de validación de información."},{title:"Proyecto validado",description:"El proyecto ha sido validado, en este punto el cliente podrá visualizar el reporte final."},{title:"Proyecto cerrado",description:"El proyecto ha sido cerrado y no se podrá realizar más cambios."},{title:"Proyecto cancelado",description:"El proyecto ha sido cancelado y no se podrá realizar más cambios."}],clients:[],employees:[],editingProjectUuid:"",inspections:[],inspectionsEquipmentsCategories:[],inspectionsEquipmentsToUseInInspections:[],loadingInspectionDialog:!1,equipmentsByCategory:[],inspectionForm:{isUpdating:!1,inspection_uuid:"",project_name:"",resume:"",ct_inspection_code:null,status_code:"proyecto_iniciado",project_id:null,client_uuid:null,ct_equipment_uuid:null,equipment_uuid:[],equipments_uuid:[]},defaultInspectionForm:{isUpdating:!1,inspection_uuid:"",project_name:"",resume:"",ct_inspection_code:null,status_code:"proyecto_iniciado",project_id:null,client_uuid:null,ct_equipment_uuid:null,equipment_uuid:[],equipments_uuid:[]},errorAssigningInspection:!1,dialogForm:!1,ctInspectionUuid:"",tab:"sections",inspectionUuid:null}),computed:{formTitle(){return this.editedIndex===-1?"Nuevo proyecto":"Editar proyecto"}},watch:{dialog(s){s||this.close()},dialogDelete(s){s||this.closeDelete()}},mounted(){this.getClients(),this.getTechniciens(),this.getInspections(),this.getinspectionsEquipmentsCategories()},methods:{save(){this.editedIndex>-1?this.updateProject(this.editedItem):this.saveProject(this.editedItem)},saveProject(s){let e={project_name:s.project_name,description:s.description,comments:s.comments,client_uuid:s.client_uuid};const o=()=>axios.post("api/projects",e);v.promise(o(),{loading:"Procesando...",success:r=>(this.$inertia.reload(),this.close(),"Proyecto creado correctamente"),error:r=>{this.handleErrors(r)}})},updateProject(s,e=null){console.log("Item: "),console.log(s);let o={project_name:s.project_name,description:s.description,comments:s.comments,client_uuid:e?s.client.client_uuid:s.client_uuid,status_code:e||s.status.status_code};const r=()=>axios.put("api/projects/"+s.project_uuid,o);v.promise(r(),{loading:"Procesando...",success:g=>(this.$inertia.reload(),this.close(),"Proyecto actualizado correctamente"),error:g=>{this.handleErrors(g)}})},updateStatus(s,e){e=="proyecto_cancelado"?A.fire({title:"Mótivo de cancelación",input:"text",inputAttributes:{autocapitalize:"off"},showCancelButton:!0,confirmButtonText:"Cancelar proyecto",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:async o=>{o===""?A.showValidationMessage("El motivo de cancelación es requerido"):s.comments=o},allowOutsideClick:()=>!A.isLoading()}).then(o=>{o.isConfirmed&&this.updateProject(s,e)}):A.fire({icon:"question",title:"Confirmación",text:"¿Estás seguro de cambiar el estatus del proyecto?",showCancelButton:!0,confirmButtonText:"Continuar",denyButtonText:"Cancelar"}).then(o=>{o.isConfirmed&&this.updateProject(s,e)})},close(){this.dialog=!1,this.$nextTick(()=>{console.log("Cambiando estatus en close"),this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},editItem(s){this.dialog=!0,this.editedIndex=this.projects.indexOf(s),this.getProject(s.project_uuid)},getProject(s){axios.get("api/projects/"+s).then(e=>{this.editedItem=e.data.data,this.editedItem.client_uuid=this.editedItem.client.client_uuid,this.editedItem.employees_uuid=this.editedItem.employees.map(o=>o.user.uuid)}).catch(e=>{this.handleErrors(e)})},deleteItem(s){this.editedIndex=this.projects.indexOf(s),this.editedItem=Object.assign({},s),this.dialogDelete=!0},deleteItemConfirm(s){this.projects.splice(this.editedIndex,1);const e=()=>axios.delete("api/projects/"+s);v.promise(e,{loading:"Procesando...",success:o=>(this.closeDelete(),"Proyecto eliminado correctamente"),error:o=>{this.handleErrors(o)}})},closeDelete(){this.dialogDelete=!1,this.$nextTick(()=>{console.log("Cambiando estatus en closeDelete"),this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},asignTechniciensDialog(s,e){this.dialogAsignEmployees=!0,this.editingProjectUuid=e.project_uuid,s==="update"?(this.editedItem.action="update",this.editedItem.employees_uuid=e.employees.map(o=>o.user.uuid)):(this.editedItem.action="create",this.editedItem.employees_uuid=[]),console.log("Asignar técnico")},asignTechniciens(){let s=this.editedItem.action,e={project_uuid:this.editingProjectUuid,employees:[]};if(this.editedItem.employees_uuid.forEach(o=>{e.employees.push({employee_uuid:o})}),s==="update"){const o=()=>axios.put("api/project/employees/"+e.project_uuid,e);v.promise(o(),{loading:"Procesando...",success:r=>(this.$inertia.reload(),this.closeAsignTechniciens(),"Técnicos actualizados correctamente"),error:r=>{this.handleErrors(r)}})}else if(s==="create"){const o=()=>axios.post("api/project/employees",e);v.promise(o(),{loading:"Procesando...",success:r=>(this.$inertia.reload(),this.closeAsignTechniciens(),"Técnicos asignados correctamente"),error:r=>{this.handleErrors(r)}})}},closeAsignTechniciens(){this.dialogAsignEmployees=!1,this.editingProjectUuid=""},async asignInspectionDialog(s,e){this.dialogAsignInspection=!0,this.editingProjectUuid=e.project_uuid,s=="update"?(this.inspectionForm.isUpdating=!0,this.inspectionForm.inspection_uuid=e.inspections[0].inspection_uuid,this.inspectionForm.project_name=e.project_name,this.inspectionForm.resume=e.inspections[0].resume,this.inspectionForm.ct_inspection_code=e.inspections[0].category.ct_inspection_code,this.inspectionForm.status_code=e.status.status_code,this.inspectionForm.project_id=e.project_uuid,this.inspectionForm.client_uuid=e.client.client_uuid,this.inspectionForm.ct_equipment_uuid=e.inspections[0].equipment.category.ct_equipment_uuid,this.getInspectionEquipmentsByCategory(this.inspectionForm.ct_equipment_uuid),this.inspectionForm.equipment_uuid=e.inspections[0].equipment.equipment_uuid,this.inspectionForm.equipments_uuid=e.inspections[0].inspection_equipments.map(o=>o.equipment.equipment_uuid)):s=="create"&&(this.inspectionForm.isUpdating=!1,this.inspectionForm.project_name=e.project_name,this.inspectionForm.project_id=e.project_uuid,this.inspectionForm.client_uuid=e.client.client_uuid)},async asignInspection(){console.log("Asignar inspección"),this.loadingInspectionDialog=!0;try{await this.createInspection(),await this.asignEquipmentToInspection()}catch{v.error("Error al asignar inspección, favor de verificar los datos ingresados.")}this.loadingInspectionDialog=!1,this.errorAssigningInspection||(console.log("this.errorAssigningInspection: "+this.errorAssigningInspection),this.$inertia.reload(),this.closeAsignInspection())},createInspection(){return new Promise((s,e)=>{let o=null;if(this.inspectionForm.isUpdating){o=()=>axios.put("api/inspections/"+this.inspectionForm.inspection_uuid,r);let r={resume:this.inspectionForm.resume,conclusion:"Por definir",ct_inspection_code:this.inspectionForm.ct_inspection_code,status_code:this.inspectionForm.status_code,equipment_uuid:this.inspectionForm.equipment_uuid,project_uuid:this.inspectionForm.project_id,client_uuid:this.inspectionForm.client_uuid}}else{let r={resume:this.inspectionForm.resume,conclusion:"Por definir",ct_inspection_code:this.inspectionForm.ct_inspection_code,status_code:this.inspectionForm.status_code,equipment_uuid:this.inspectionForm.equipment_uuid,project_uuid:this.inspectionForm.project_id,client_uuid:this.inspectionForm.client_uuid};o=()=>axios.post("api/inspections",r)}v.promise(o(),{loading:this.inspectionForm.isUpdating?"Actualizando inspección...":"Asignando inspección...",success:r=>{this.inspectionForm.inspection_uuid=r.data.data.inspection_uuid;let g=this.inspectionForm.isUpdating?"Inspección actualizada correctamente":"Inspección asignada correctamente";return s(g),g},error:r=>{this.errorAssigningInspection=!0,this.handleErrors(r),e(r)}})})},asignEquipmentToInspection(){return new Promise((s,e)=>{let o=this.inspectionForm.equipments_uuid.map(g=>({equipment_uuid:g}));const r=()=>this.inspectionForm.isUpdating?axios.put("api/inspection/equipments/"+this.inspectionForm.inspection_uuid,{inspection_uuid:this.inspectionForm.inspection_uuid,equipments:o}):axios.post("api/inspection/equipments",{inspection_uuid:this.inspectionForm.inspection_uuid,equipments:o});v.promise(r(),{loading:this.inspectionForm.isUpdating?"Actualizando equipos de inspección...":"Asignando equipos a inspección...",success:g=>{let b=this.inspectionForm.isUpdating?"Actualización completada correctamente":"Asignación completada correctamente";return s(b),b},error:g=>{this.errorAssigningInspection=!0,this.handleErrors(g),e(g)}})})},closeAsignInspection(){this.dialogAsignInspection=!1,this.inspectionForm=Object.assign({},this.defaultInspectionForm)},formDialog(s){this.dialogForm=!0,this.ctInspectionUuid=s.inspections[0].category.ct_inspection_uuid,this.inspectionUuid=s.inspections[0].inspection_uuid,this.inspectionForm.project_name=s.project_name},closeSectionDialog(){this.dialogForm=!1,this.ctInspectionUuid=""},getClients(){axios.get("api/clients").then(s=>{this.clients=s.data.data}).catch(s=>{console.log(s)})},getTechniciens(){axios.get("api/users/get-rol-users/tecnico").then(s=>{this.employees=s.data.data}).catch(s=>{console.log(s)})},getInspections(){axios.get("api/inspection/categories").then(s=>{this.inspections=s.data.data}).catch(s=>{this.handleErrors(s)})},getinspectionsEquipmentsCategories(){axios.get("api/equipment/categories").then(s=>{this.inspectionsEquipmentsCategories=s.data.data,this.inspectionsEquipmentsToUseInInspections=this.inspectionsEquipmentsCategories.filter(e=>e.ct_equipment_code==="inspeccion"),this.inspectionsEquipmentsToUseInInspections=this.inspectionsEquipmentsToUseInInspections.length?this.inspectionsEquipmentsToUseInInspections[0].equipments:[]}).catch(s=>{this.handleErrors(s)})},checkStatus(s,e){return e.includes(s.status.status_code)},getInspectionEquipmentsByCategory(s){this.inspectionForm.equipment_uuid=null;let e=this.inspectionsEquipmentsCategories.find(o=>o.ct_equipment_uuid===s).equipments;this.equipmentsByCategory=e.length>0?e:[]},generatePdf(s){v.warning("Solicitando documento, espere..."),axios.get("inspection/get-document/"+s.inspections[0].inspection_uuid).then(e=>{window.open(e.data.data.path_storage,"_blank")}).catch(e=>{v.error("No fue posible recuperar el documento"),console.log(e)})},checkPermissionToPdf(s){return this.$page.props.auth.role.name==="admin"||this.$page.props.auth.role.name==="tecnico"?this.hasPermissionTo("projects.read")&&this.checkStatus(s,["proyecto_iniciado","proyecto_finalizado","proyecto_validado","proyecto_cerrado"])&&s.inspections.length:this.hasPermissionTo("projects.read")&&this.checkStatus(s,["proyecto_cerrado"])&&s.inspections.length}}},be=Object.assign(je,{__name:"Projects",setup(s){return(e,o)=>{const r=c("v-chip"),g=c("v-icon"),b=c("v-text-field"),B=c("v-toolbar-title"),Z=c("v-divider"),I=c("v-spacer"),y=c("v-btn"),F=c("v-card-title"),_=c("v-col"),O=c("v-textarea"),q=c("v-select"),P=c("v-row"),E=c("v-container"),V=c("v-card-text"),T=c("v-card-actions"),C=c("v-card"),j=c("v-dialog"),N=c("v-toolbar"),J=c("v-data-table"),K=c("v-timeline-item"),W=c("v-timeline"),S=c("v-tab"),X=c("v-tabs"),D=c("v-tabs-window-item"),Y=c("v-tabs-window");return a(),f(U,null,[i(w(R),{position:"top-right",richColors:"",visibleToasts:10}),i(w(ee),{title:"Proyectos de inspección"}),i(se,null,{header:n(()=>[le]),default:n(()=>[m("div",ce,[m("div",re,[m("div",de,[i(C,null,{default:n(()=>[i(P,null,{default:n(()=>[i(_,{cols:"12",sm:"12"},{default:n(()=>[i(J,{headers:e.headers,items:s.projects,"fixed-header":"",search:e.search},{"item.status.status":n(({value:t,item:u})=>[i(r,{size:"small",class:"m-1"},{default:n(()=>[p(k(t),1)]),_:2},1024)]),"item.employees":n(({value:t})=>[(a(!0),f(U,null,z(t,(u,x)=>(a(),f("p",{key:x},[i(g,{class:"mdi mdi-vector-point text-primary"}),p(" "+k(u.user.name),1)]))),128)),t.length?l("",!0):(a(),f("p",ue,"Por asignar"))]),"item.inspections":n(({value:t})=>[(a(!0),f(U,null,z(t,u=>(a(),f("p",{key:u.ct_inspection_uuid},k(u.category.ct_inspection),1))),128)),t.length?l("",!0):(a(),f("p",pe,"Por asignar"))]),top:n(()=>[i(N,{flat:""},{default:n(()=>[i(B,{class:"ml-1"},{default:n(()=>[i(b,{modelValue:e.search,"onUpdate:modelValue":o[0]||(o[0]=t=>e.search=t),label:"Buscar","hide-details":"",variant:"solo","append-inner-icon":"mdi-magnify",density:"compact"},null,8,["modelValue"])]),_:1}),i(Z,{class:"mx-4",inset:"",vertical:""}),i(I),e.hasPermissionTo("projects.create")||e.hasPermissionTo("projects.update")?(a(),d(j,{key:0,modelValue:e.dialog,"onUpdate:modelValue":o[6]||(o[6]=t=>e.dialog=t),width:"auto"},ie({default:n(()=>[i(C,{loading:!1},{default:n(()=>[i(F,null,{default:n(()=>[m("span",me,k(e.formTitle),1)]),_:1}),i(V,null,{default:n(()=>[i(E,null,{default:n(()=>[i(P,null,{default:n(()=>[i(_,{cols:"12"},{default:n(()=>[i(b,{modelValue:e.editedItem.project_name,"onUpdate:modelValue":o[2]||(o[2]=t=>e.editedItem.project_name=t),label:"Nombre",variant:"outlined","hide-details":"",required:""},null,8,["modelValue"])]),_:1}),i(_,{cols:"6"},{default:n(()=>[i(O,{modelValue:e.editedItem.description,"onUpdate:modelValue":o[3]||(o[3]=t=>e.editedItem.description=t),label:"Descripción",variant:"outlined","hide-details":"",required:""},null,8,["modelValue"])]),_:1}),i(_,{cols:"6"},{default:n(()=>[i(O,{modelValue:e.editedItem.comments,"onUpdate:modelValue":o[4]||(o[4]=t=>e.editedItem.comments=t),label:"Comentarios",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),i(_,{cols:"12"},{default:n(()=>[i(q,{modelValue:e.editedItem.client_uuid,"onUpdate:modelValue":o[5]||(o[5]=t=>e.editedItem.client_uuid=t),items:e.clients,"item-title":"client","item-value":"client_uuid",label:"Cliente",variant:"outlined","hide-details":"",required:""},null,8,["modelValue","items"])]),_:1}),i(_,{cols:"12",class:"text-right"},{default:n(()=>[i(H,{onClick:e.save},{default:n(()=>[p("Guardar")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1}),i(T,null,{default:n(()=>[i(I),i(y,{color:"blue-darken-1",variant:"text",onClick:e.close},{default:n(()=>[p(" Cerrar ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:2},[e.hasPermissionTo("projects.create")?{name:"activator",fn:n(({props:t})=>[i(y,{class:"mb-2",color:"primary",dark:"",icon:"mdi-lightbulb-on-outline",onClick:o[1]||(o[1]=u=>e.dialogHelp=!0)}),i(y,te({class:"mb-2",color:"primary",dark:""},t,{icon:"mdi-plus"}),null,16)]),key:"0"}:void 0]),1032,["modelValue"])):l("",!0),i(j,{modelValue:e.dialogDelete,"onUpdate:modelValue":o[8]||(o[8]=t=>e.dialogDelete=t),"max-width":"500px"},{default:n(()=>[i(C,null,{default:n(()=>[i(F,{class:"text-h5 text-center"},{default:n(()=>[p("¿Estás seguro de eliminar?")]),_:1}),i(T,null,{default:n(()=>[i(I),i(y,{color:"blue-darken-1",variant:"text",onClick:e.closeDelete},{default:n(()=>[p("Cancel")]),_:1},8,["onClick"]),i(y,{color:"blue-darken-1",variant:"text",onClick:o[7]||(o[7]=t=>e.deleteItemConfirm(e.editedItem.project_uuid))},{default:n(()=>[p("Si, eliminar")]),_:1}),i(I)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.actions":n(({item:t})=>[m("div",he,[e.hasPermissionTo("projects.update")&&e.checkStatus(t,["proyecto_creado","proyecto_asignado","proyecto_iniciado"])?(a(),d(h,{key:0,text:"Editar",icon:"mdi-pencil",onClick:u=>e.editItem(t),size:"small"},null,8,["onClick"])):l("",!0),e.hasPermissionTo("projects.update")&&e.checkStatus(t,["proyecto_creado","proyecto_asignado","proyecto_iniciado"])?(a(),d(h,{key:1,text:"Cancelar proyecto",icon:"mdi-table-cancel",size:"small",onClick:u=>e.updateStatus(t,"proyecto_cancelado")},null,8,["onClick"])):l("",!0),e.hasPermissionTo("projects.delete")&&e.checkStatus(t,["proyecto_creado","proyecto_asignado"])?(a(),d(h,{key:2,text:"Eliminar",icon:"mdi-delete",onClick:u=>e.deleteItem(t),size:"small"},null,8,["onClick"])):l("",!0),e.hasPermissionTo("projects.update")&&e.checkStatus(t,["proyecto_asignado","proyecto_iniciado"])?(a(),d(h,{key:3,text:"Asignar técnico",icon:"mdi-account-plus-outline",size:"small",onClick:u=>e.asignTechniciensDialog("update",t),color:"text-success"},null,8,["onClick"])):l("",!0),e.hasPermissionTo("projects.update")&&e.checkStatus(t,["proyecto_asignado","proyecto_iniciado"])&&t.inspections.length?(a(),d(h,{key:4,text:"Asignar inspección",icon:"mdi-table-plus",size:"small",onClick:u=>e.asignInspectionDialog("update",t),color:"text-success"},null,8,["onClick"])):l("",!0),e.checkPermissionToPdf(t)?(a(),d(h,{key:5,text:"Generar PDF",icon:"mdi-file-eye",size:"small",onClick:u=>e.generatePdf(t),color:"text-success"},null,8,["onClick"])):l("",!0)])]),"item.inspection_actions":n(({item:t})=>[m("div",ge,[e.hasPermissionTo("projects.update")&&e.checkStatus(t,["proyecto_creado"])?(a(),d(h,{key:0,text:"Asignar técnico",icon:"mdi-account-plus-outline",size:"small",onClick:u=>e.asignTechniciensDialog("create",t),color:"text-primary"},null,8,["onClick"])):l("",!0),e.hasPermissionTo("projects.update")&&e.checkStatus(t,["proyecto_asignado"])&&!t.inspections.length?(a(),d(h,{key:1,text:"Asignar inspección",icon:"mdi-table-plus",size:"small",onClick:u=>e.asignInspectionDialog("create",t),color:"text-primary"},null,8,["onClick"])):l("",!0),e.hasPermissionTo("projects.update")&&e.checkStatus(t,["proyecto_iniciado"])?(a(),d(h,{key:2,text:"Cargar información",icon:"mdi-file-edit",size:"small",onClick:u=>e.formDialog(t),color:"text-primary"},null,8,["onClick"])):l("",!0),e.hasPermissionTo("projects.finalize")&&e.checkStatus(t,["proyecto_iniciado"])&&t.inspections.length>0?(a(),d(h,{key:3,text:"Finalizar proyecto",icon:"mdi-note-check",size:"small",color:"text-primary",onClick:u=>e.updateStatus(t,"proyecto_finalizado")},null,8,["onClick"])):l("",!0),e.hasPermissionTo("projects.validate")&&e.checkStatus(t,["proyecto_finalizado"])?(a(),d(h,{key:4,text:"Validar proyecto",icon:"mdi-check-circle-outline",size:"small",onClick:u=>e.updateStatus(t,"proyecto_validado")},null,8,["onClick"])):l("",!0),e.hasPermissionTo("projects.validate")&&e.checkStatus(t,["proyecto_finalizado"])?(a(),d(h,{key:5,text:"Regresar estatus",icon:"mdi-restore",size:"small",onClick:u=>e.updateStatus(t,"proyecto_iniciado"),color:"text-red"},null,8,["onClick"])):l("",!0),e.hasPermissionTo("projects.close")&&e.checkStatus(t,["proyecto_validado"])?(a(),d(h,{key:6,text:"Cerrar proyecto",icon:"mdi-close-circle-outline",size:"small",color:"text-primary",onClick:u=>e.updateStatus(t,"proyecto_cerrado")},null,8,["onClick"])):l("",!0)])]),_:1},8,["headers","items","search"]),i(j,{modelValue:e.dialogHelp,"onUpdate:modelValue":o[10]||(o[10]=t=>e.dialogHelp=t),width:"auto"},{default:n(()=>[i(C,null,{default:n(()=>[i(F,{class:"text-h5 text-center"},{default:n(()=>[p("Ayuda")]),_:1}),i(V,null,{default:n(()=>[i(E,null,{default:n(()=>[i(P,null,{default:n(()=>[i(_,{cols:"12"},{default:n(()=>[_e,i(W,{align:"start",density:"compact"},{default:n(()=>[(a(!0),f(U,null,z(e.helpData,t=>(a(),d(K,{key:t.title,size:"x-small","dot-color":"grey"},{default:n(()=>[m("div",fe,[m("div",ye,[m("strong",null,k(t.title),1)]),m("div",null,k(t.description),1)])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),i(T,null,{default:n(()=>[i(I),i(y,{color:"blue-darken-1",variant:"text",onClick:o[9]||(o[9]=t=>e.dialogHelp=!1)},{default:n(()=>[p("Cerrar")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e.hasPermissionTo("projects.update")?(a(),d(j,{key:0,modelValue:e.dialogAsignEmployees,"onUpdate:modelValue":o[13]||(o[13]=t=>e.dialogAsignEmployees=t),width:"400"},{default:n(()=>[i(C,null,{default:n(()=>[i(F,null,{default:n(()=>[e.editedItem.action=="create"?(a(),f("span",ve,"Asignar técnicos")):l("",!0),e.editedItem.action=="update"?(a(),f("span",ke,"Actualizar técnicos")):l("",!0)]),_:1}),i(V,null,{default:n(()=>[i(E,null,{default:n(()=>[i(P,null,{default:n(()=>[i(_,{cols:"12"},{default:n(()=>[i(q,{modelValue:e.editedItem.employees_uuid,"onUpdate:modelValue":o[11]||(o[11]=t=>e.editedItem.employees_uuid=t),items:e.employees,"item-title":"name","item-value":"uuid",label:"Seleccionar técnicos",variant:"outlined","hide-details":"",required:"",multiple:"",chips:""},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),_:1}),i(T,null,{default:n(()=>[i(I),i(y,{color:"blue-darken-1",variant:"text",onClick:e.closeAsignTechniciens},{default:n(()=>[p(" Cerrar ")]),_:1},8,["onClick"]),i(y,{color:"blue-darken-1",variant:"text",onClick:o[12]||(o[12]=t=>e.asignTechniciens()),disabled:!e.editedItem.employees_uuid.length},{default:n(()=>[p(" Guardar ")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):l("",!0),e.hasPermissionTo("projects.update")?(a(),d(j,{key:1,modelValue:e.dialogAsignInspection,"onUpdate:modelValue":o[21]||(o[21]=t=>e.dialogAsignInspection=t),width:"auto","min-height":"600",scrollable:""},{default:n(()=>[i(C,{loading:e.loadingInspectionDialog,disabled:e.loadingInspectionDialog},{default:n(()=>[i(F,null,{default:n(()=>[this.inspectionForm.isUpdating?l("",!0):(a(),f("span",Ie,'Asignando inspección al proyecto "'+k(e.inspectionForm.project_name)+'"',1)),this.inspectionForm.isUpdating?(a(),f("span",Ce,'Actualizando inspección al proyecto "'+k(e.inspectionForm.project_name)+'"',1)):l("",!0)]),_:1}),i(V,null,{default:n(()=>[i(E,null,{default:n(()=>[i(P,null,{default:n(()=>[i(_,{cols:"12"},{default:n(()=>[i(q,{modelValue:e.inspectionForm.ct_inspection_code,"onUpdate:modelValue":o[14]||(o[14]=t=>e.inspectionForm.ct_inspection_code=t),items:e.inspections,"item-title":"ct_inspection","item-value":"ct_inspection_code",label:"Seleccionar inspección",variant:"outlined","hide-details":"",required:""},null,8,["modelValue","items"])]),_:1}),i(_,{cols:"6"},{default:n(()=>[i(q,{modelValue:e.inspectionForm.ct_equipment_uuid,"onUpdate:modelValue":[o[15]||(o[15]=t=>e.inspectionForm.ct_equipment_uuid=t),o[16]||(o[16]=t=>e.getInspectionEquipmentsByCategory(e.inspectionForm.ct_equipment_uuid))],items:e.inspectionsEquipmentsCategories,"item-title":"ct_equipment","item-value":"ct_equipment_uuid",label:"Seleccionar categoría de equipo",variant:"outlined","hide-details":"",required:""},null,8,["modelValue","items"])]),_:1}),i(_,{cols:"6"},{default:n(()=>[i(q,{modelValue:e.inspectionForm.equipment_uuid,"onUpdate:modelValue":o[17]||(o[17]=t=>e.inspectionForm.equipment_uuid=t),items:e.equipmentsByCategory,"item-title":"equipment","item-value":"equipment_uuid",label:"Seleccionar equipo a inspeccionar",variant:"outlined","hide-details":"",clearable:""},null,8,["modelValue","items"])]),_:1}),i(_,{cols:"12"},{default:n(()=>[i(q,{modelValue:e.inspectionForm.equipments_uuid,"onUpdate:modelValue":o[18]||(o[18]=t=>e.inspectionForm.equipments_uuid=t),items:e.inspectionsEquipmentsToUseInInspections,"item-title":"equipment","item-value":"equipment_uuid",label:"Seleccionar equipos a utilizar en la inspcección",variant:"outlined","hide-details":"",multiple:"",chips:"",clearable:""},null,8,["modelValue","items"])]),_:1}),i(_,{cols:"12"},{default:n(()=>[qe,i(w(Q),{content:e.inspectionForm.resume,"onUpdate:content":o[19]||(o[19]=t=>e.inspectionForm.resume=t),theme:"snow",toolbar:"essential",heigth:"100%",contentType:"html"},null,8,["content"])]),_:1})]),_:1})]),_:1})]),_:1}),i(T,null,{default:n(()=>[i(I),i(y,{color:"blue-darken-1",variant:"text",onClick:e.closeAsignInspection},{default:n(()=>[p(" Cerrar ")]),_:1},8,["onClick"]),i(y,{color:"blue-darken-1",variant:"text",onClick:o[20]||(o[20]=t=>e.asignInspection()),disabled:!1,loading:e.loadingInspectionDialog},{default:n(()=>[p(" Guardar ")]),_:1},8,["loading"])]),_:1})]),_:1},8,["loading","disabled"])]),_:1},8,["modelValue"])):l("",!0),e.hasPermissionTo("projects.update")?(a(),d(j,{key:2,modelValue:e.dialogForm,"onUpdate:modelValue":o[25]||(o[25]=t=>e.dialogForm=t),transition:"dialog-bottom-transition",fullscreen:"",persistent:""},{default:n(()=>[i(N,null,{default:n(()=>[i(y,{icon:"mdi-close",onClick:o[22]||(o[22]=t=>e.closeSectionDialog())}),i(B,{class:"w-100"},{default:n(()=>[p(" Carga de información "),m("p",null,[m("small",null,'Proyecto: "'+k(this.inspectionForm.project_name)+'"',1)])]),_:1}),i(I)]),_:1}),i(C,null,{default:n(()=>[i(X,{modelValue:e.tab,"onUpdate:modelValue":o[23]||(o[23]=t=>e.tab=t),"align-tabs":"center",class:"position-fixed w-100 bg-primary-color"},{default:n(()=>[i(S,{value:"sections"},{default:n(()=>[p("Secciones")]),_:1}),i(S,{value:"evidences"},{default:n(()=>[p("Evidencias")]),_:1}),i(S,{value:"recomendations"},{default:n(()=>[p("Concluciones y Recomendaciones")]),_:1})]),_:1},8,["modelValue"]),i(V,{class:"mt-10"},{default:n(()=>[i(Y,{modelValue:e.tab,"onUpdate:modelValue":o[24]||(o[24]=t=>e.tab=t)},{default:n(()=>[e.tab==="sections"?(a(),d(D,{key:0},{default:n(()=>[i(L,{dialogForm:e.dialogForm,ct_inspection_uuid:e.ctInspectionUuid,inspection_uuid:e.inspectionUuid,onCloseSectionDialog:e.closeSectionDialog},null,8,["dialogForm","ct_inspection_uuid","inspection_uuid","onCloseSectionDialog"])]),_:1})):l("",!0),e.tab==="evidences"?(a(),d(D,{key:1},{default:n(()=>[i(G,{inspection_uuid:e.inspectionUuid},null,8,["inspection_uuid"])]),_:1})):l("",!0),e.tab==="recomendations"?(a(),d(D,{key:2},{default:n(()=>[i(M,{inspection_uuid:e.inspectionUuid},null,8,["inspection_uuid"])]),_:1})):l("",!0)]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):l("",!0)]),_:1})]),_:1})]),_:1})])])])]),_:1})],64)}}}),Re=ae(be,[["__scopeId","data-v-85ed3221"]]);export{Re as default};
