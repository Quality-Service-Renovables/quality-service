import{r,o as l,e as g,b as i,u as B,w as n,F as E,L,q as v,Z as x,a as m,d as p,t as k,y as A,g as c,c as u,s as ee,x as ie,p as te,h as oe}from"./app-CjLPoRMk.js";import{_ as ne}from"./AuthenticatedLayout-CAQa14Tg.js";import f from"./ActionButton--txDrMdp.js";import{_ as H}from"./PrimaryButton-B84KU01C.js";import G from"./Section-CqFVMTPO.js";import se from"./Evidence-Bf4CeBjl.js";import le from"./Information-DW8fnqbv.js";import J from"./ConclutionAndRecomendation-prkzx32J.js";import{Q as M}from"./vue-quill.esm-bundler-CDSfNZEB.js";/* empty css                       */import{S as w}from"./sweetalert2.all-0oUSlYVc.js";import{_ as ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-DarURmLE.js";import"./EvidenceForm-CSnJINRC.js";import"./filepond-plugin-image-transform.esm-CJnK_Hyb.js";import"./ImageEditor-CuhZ8ul7.js";import"./api-kShYN9M8.js";const T=t=>(te("data-v-283008f7"),t=t(),oe(),t),re=T(()=>m("h2",{class:"font-semibold text-xl leading-tight"},"Proyectos de inspección",-1)),ce={class:"py-12"},de={class:"max-w-7xl mx-auto sm:px-4 lg:px-6"},ue={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},pe={key:0},me={key:0},he={class:"text-h5"},_e={class:"d-flex"},ge={class:"d-flex"},fe=T(()=>m("p",{class:"text-h6 mb-2"},"Estatus:",-1)),ye={class:"mb-4"},ve={class:"font-weight-normal"},Ie={key:0,class:"text-h5"},ke={key:1,class:"text-h5"},qe={key:0,class:"text-h5"},je={key:1,class:"text-h5"},be=T(()=>m("p",{class:"text-grey mb-2"},"Define el resumen de la inspección a realizar (opcional) ",-1)),Fe=T(()=>m("p",{class:"text-grey mb-2"},"Define los datos del equipo a inspeccionar ",-1)),Ce=T(()=>m("p",{class:"text-red mb-2"},"*No se han definido campos para la categoría seleccionada",-1)),Pe={components:{Toaster:L,ActionButton:f,PrimaryButton:H,QuillEditor:M,Section:G,Evidence:se,ConclutionAndRecomendation:J},props:{projects:{type:Array,required:!0}},data:()=>({search:"",dialog:!1,dialogHelp:!1,dialogAsignEmployees:!1,dialogDelete:!1,dialogAsignInspection:!1,headers:[{title:"Nombre",key:"project_name"},{title:"Cliente",key:"client.client"},{title:"Técnicos asignados",key:"employees"},{title:"Inspección asignada",key:"inspections"},{title:"Estado",key:"status.status"},{title:"Acciones",key:"actions",sortable:!1},{title:"Inspección",key:"inspection_actions",sortable:!1}],editedIndex:-1,editedItem:{project_uuid:"",project_name:"",description:"",comments:"",client_uuid:"",employees_uuid:[]},defaultItem:{project_uuid:"",project_name:"",description:"",comments:"",client_uuid:"",employees_uuid:[]},helpData:[{title:"Proyecto creado",description:"El proyecto ha sido creado, falta asignar técnico e inspección."},{title:"Proyecto asignado",description:"El proyecto ha sido asignado a un técnico, ya se puede iniciar."},{title:"Proyecto iniciado",description:"El proyecto ha sido iniciado, ya se puede comenzar a cargar información para el reporte final."},{title:"Proyecto finalizado",description:"El proyecto ha sido finalizado, ya puede comenzar la fase de validación de información."},{title:"Proyecto validado",description:"El proyecto ha sido validado, en este punto el cliente podrá visualizar el reporte final."},{title:"Proyecto cerrado",description:"El proyecto ha sido cerrado y no se podrá realizar más cambios."},{title:"Proyecto cancelado",description:"El proyecto ha sido cancelado y no se podrá realizar más cambios."}],clients:[],employees:[],editingProjectUuid:"",inspections:[],inspectionsEquipmentsCategories:[],inspectionsEquipmentsToUseInInspections:[],loadingInspectionDialog:!1,equipmentsByCategory:[],inspectionForm:{isUpdating:!1,inspection_uuid:"",project_name:"",resume:"",ct_inspection_code:null,status_code:"proyecto_iniciado",project_id:null,client_uuid:null,ct_equipment_uuid:null,equipment_uuid:[],equipments_uuid:[],location,fields:[]},defaultInspectionForm:{isUpdating:!1,inspection_uuid:"",project_name:"",resume:"",ct_inspection_code:null,status_code:"proyecto_iniciado",project_id:null,client_uuid:null,ct_equipment_uuid:null,equipment_uuid:[],equipments_uuid:[],location,fields:[]},errorAssigningInspection:!1,dialogForm:!1,ctInspectionUuid:"",tab:"information",inspectionUuid:null,project:null}),computed:{formTitle(){return this.editedIndex===-1?"Nuevo proyecto":"Editar proyecto"}},watch:{dialog(t){t||this.close()},dialogDelete(t){t||this.closeDelete()}},mounted(){this.getClients(),this.getTechniciens(),this.getInspections(),this.getinspectionsEquipmentsCategories()},methods:{save(){this.editedIndex>-1?this.updateProject(this.editedItem):this.saveProject(this.editedItem)},saveProject(t){let e={project_name:t.project_name,description:t.description,comments:t.comments,client_uuid:t.client_uuid};const o=()=>axios.post("api/projects",e);v.promise(o(),{loading:"Procesando...",success:a=>(this.$inertia.reload(),this.close(),"Proyecto creado correctamente"),error:a=>{this.handleErrors(a)}})},updateProject(t,e=null){console.log("Item: "),console.log(t);let o={project_name:t.project_name,description:t.description,comments:t.comments,client_uuid:e?t.client.client_uuid:t.client_uuid,status_code:e||t.status.status_code};const a=()=>axios.put("api/projects/"+t.project_uuid,o);v.promise(a(),{loading:"Procesando...",success:h=>(this.$inertia.reload(),this.close(),"Proyecto actualizado correctamente"),error:h=>{this.handleErrors(h)}})},updateStatus(t,e){e=="proyecto_cancelado"?w.fire({title:"Mótivo de cancelación",input:"text",inputAttributes:{autocapitalize:"off"},showCancelButton:!0,confirmButtonText:"Cancelar proyecto",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:async o=>{o===""?w.showValidationMessage("El motivo de cancelación es requerido"):t.comments=o},allowOutsideClick:()=>!w.isLoading()}).then(o=>{o.isConfirmed&&this.updateProject(t,e)}):w.fire({icon:"question",title:"Confirmación",text:"¿Estás seguro de cambiar el estatus del proyecto?",showCancelButton:!0,confirmButtonText:"Continuar",denyButtonText:"Cancelar"}).then(o=>{o.isConfirmed&&this.updateProject(t,e)})},close(){this.dialog=!1,this.$nextTick(()=>{console.log("Cambiando estatus en close"),this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},editItem(t){this.dialog=!0,this.editedIndex=this.projects.indexOf(t),this.getProject(t.project_uuid)},getProject(t){axios.get("api/projects/"+t).then(e=>{this.editedItem=e.data.data,this.editedItem.client_uuid=this.editedItem.client.client_uuid,this.editedItem.employees_uuid=this.editedItem.employees.map(o=>o.user.uuid)}).catch(e=>{this.handleErrors(e)})},deleteItem(t){this.editedIndex=this.projects.indexOf(t),this.editedItem=Object.assign({},t),this.dialogDelete=!0},deleteItemConfirm(t){this.projects.splice(this.editedIndex,1);const e=()=>axios.delete("api/projects/"+t);v.promise(e,{loading:"Procesando...",success:o=>(this.closeDelete(),"Proyecto eliminado correctamente"),error:o=>{this.handleErrors(o)}})},closeDelete(){this.dialogDelete=!1,this.$nextTick(()=>{console.log("Cambiando estatus en closeDelete"),this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},asignTechniciensDialog(t,e){this.dialogAsignEmployees=!0,this.editingProjectUuid=e.project_uuid,t==="update"?(this.editedItem.action="update",this.editedItem.employees_uuid=e.employees.map(o=>o.user.uuid)):(this.editedItem.action="create",this.editedItem.employees_uuid=[]),console.log("Asignar técnico")},asignTechniciens(){let t=this.editedItem.action,e={project_uuid:this.editingProjectUuid,employees:[]};if(this.editedItem.employees_uuid.forEach(o=>{e.employees.push({employee_uuid:o})}),t==="update"){const o=()=>axios.put("api/project/employees/"+e.project_uuid,e);v.promise(o(),{loading:"Procesando...",success:a=>(this.$inertia.reload(),this.closeAsignTechniciens(),"Técnicos actualizados correctamente"),error:a=>{this.handleErrors(a)}})}else if(t==="create"){const o=()=>axios.post("api/project/employees",e);v.promise(o(),{loading:"Procesando...",success:a=>(this.$inertia.reload(),this.closeAsignTechniciens(),"Técnicos asignados correctamente"),error:a=>{this.handleErrors(a)}})}},closeAsignTechniciens(){this.dialogAsignEmployees=!1,this.editingProjectUuid=""},async asignInspectionDialog(t,e){this.dialogAsignInspection=!0,this.editingProjectUuid=e.project_uuid,t=="update"?(this.inspectionForm.equipments_uuid=[],console.log("Asignar inspección - update"),console.log("INSPECCIÓN: "),console.log(e.inspections[0]),this.inspectionForm.isUpdating=!0,this.inspectionForm.inspection_uuid=e.inspections[0].inspection_uuid,this.inspectionForm.project_name=e.project_name,this.inspectionForm.resume=e.inspections[0].resume,this.inspectionForm.ct_inspection_code=e.inspections[0].category.ct_inspection_code,this.inspectionForm.status_code=e.status.status_code,this.inspectionForm.project_id=e.project_uuid,this.inspectionForm.client_uuid=e.client.client_uuid,this.inspectionForm.ct_equipment_uuid=e.inspections[0].inspection_equipments.length>0?e.inspections[0].inspection_equipments[0].equipment.category.ct_equipment_uuid:null,console.log("item.inspections[0].inspection_equipments:"),console.log(e.inspections[0].inspection_equipments),this.inspectionForm.equipments_uuid=e.inspections[0].inspection_equipments.map(o=>o.equipment.equipment_uuid),this.inspectionForm.location=e.inspections[0].location,this.inspectionForm.equipment_fields_report=e.inspections[0].equipment_fields_report,this.setEquipmentFields(this.inspectionForm.ct_equipment_uuid)):t=="create"&&(console.log("Asignar inspección - create"),this.inspectionForm.isUpdating=!1,this.inspectionForm.project_name=e.project_name,this.inspectionForm.project_id=e.project_uuid,this.inspectionForm.client_uuid=e.client.client_uuid)},async asignInspection(){console.log("Asignar inspección"),this.loadingInspectionDialog=!0;try{await this.createInspection(),await this.asignEquipmentToInspection()}catch{v.error("Error al asignar inspección, favor de verificar los datos ingresados.")}this.loadingInspectionDialog=!1,this.errorAssigningInspection||(console.log("this.errorAssigningInspection: "+this.errorAssigningInspection),this.$inertia.reload(),this.closeAsignInspection())},createInspection(){return new Promise((t,e)=>{let o=null;if(this.inspectionForm.isUpdating){o=()=>axios.put("api/inspections/"+this.inspectionForm.inspection_uuid,a);let a={resume:this.inspectionForm.resume,conclusion:"Por definir",ct_inspection_code:this.inspectionForm.ct_inspection_code,status_code:this.inspectionForm.status_code,equipment_uuid:this.inspectionForm.equipment_uuid,project_uuid:this.inspectionForm.project_id,client_uuid:this.inspectionForm.client_uuid,location:this.inspectionForm.location,equipment_fields_report:JSON.stringify(this.inspectionForm.fields)}}else{let a={resume:this.inspectionForm.resume,conclusion:"Por definir",ct_inspection_code:this.inspectionForm.ct_inspection_code,status_code:this.inspectionForm.status_code,equipment_uuid:this.inspectionForm.equipment_uuid,project_uuid:this.inspectionForm.project_id,client_uuid:this.inspectionForm.client_uuid,location:this.inspectionForm.location,equipment_fields_report:JSON.stringify(this.inspectionForm.fields)};o=()=>axios.post("api/inspections",a)}v.promise(o(),{loading:this.inspectionForm.isUpdating?"Actualizando inspección...":"Asignando inspección...",success:a=>{this.inspectionForm.inspection_uuid=a.data.data.inspection_uuid;let h=this.inspectionForm.isUpdating?"Inspección actualizada correctamente":"Inspección asignada correctamente";return t(h),h},error:a=>{this.errorAssigningInspection=!0,this.handleErrors(a),e(a)}})})},asignEquipmentToInspection(){return new Promise((t,e)=>{let o=this.inspectionForm.equipments_uuid.map(h=>({equipment_uuid:h}));const a=()=>this.inspectionForm.isUpdating?axios.put("api/inspection/equipments/"+this.inspectionForm.inspection_uuid,{inspection_uuid:this.inspectionForm.inspection_uuid,equipments:o}):axios.post("api/inspection/equipments",{inspection_uuid:this.inspectionForm.inspection_uuid,equipments:o});v.promise(a(),{loading:this.inspectionForm.isUpdating?"Actualizando equipos de inspección...":"Asignando equipos a inspección...",success:h=>{let I=this.inspectionForm.isUpdating?"Actualización completada correctamente":"Asignación completada correctamente";return t(I),I},error:h=>{this.errorAssigningInspection=!0,this.handleErrors(h),e(h)}})})},closeAsignInspection(){this.dialogAsignInspection=!1,this.inspectionForm=Object.assign({},this.defaultInspectionForm)},formDialog(t){this.dialogForm=!0,this.ctInspectionUuid=t.inspections.length>0?t.inspections[0].category.ct_inspection_uuid:null,this.inspectionUuid=t.inspections.length>0?t.inspections[0].inspection_uuid:null,this.inspectionForm.project_name=t.project_name,this.project=t},closeSectionDialog(){this.dialogForm=!1,this.ctInspectionUuid=""},getClients(){axios.get("api/clients").then(t=>{this.clients=t.data.data}).catch(t=>{console.log(t)})},getTechniciens(){axios.get("api/users/get-rol-users/tecnico").then(t=>{this.employees=t.data.data}).catch(t=>{console.log(t)})},getInspections(){axios.get("api/inspection/categories").then(t=>{this.inspections=t.data.data}).catch(t=>{this.handleErrors(t)})},getinspectionsEquipmentsCategories(){axios.get("api/equipment/categories").then(t=>{this.inspectionsEquipmentsCategories=t.data.data,this.inspectionsEquipmentsToUseInInspections=this.inspectionsEquipmentsCategories.filter(e=>e.ct_equipment_code==="inspeccion"),this.inspectionsEquipmentsToUseInInspections=this.inspectionsEquipmentsToUseInInspections.length?this.inspectionsEquipmentsToUseInInspections[0].equipments:[]}).catch(t=>{this.handleErrors(t)})},checkStatus(t,e){return e.includes(t.status.status_code)},setEquipmentFields(t){if(t){this.inspectionForm.fields=null;let e=this.inspectionsEquipmentsCategories.find(a=>a.ct_equipment_uuid===t);this.inspectionForm.fields=e.required_fields_report&&e.required_fields_report.length>0?JSON.parse(e.required_fields_report).fields:[];let o=JSON.parse(this.inspectionForm.equipment_fields_report);this.inspectionForm.fields.forEach(a=>{if(o&&o.length>0){let h=o.find(I=>I.key===a.key);a.value=h?h.value:""}else a.value=""}),this.equipmentsByCategory=e.equipments.length>0?e.equipments:[]}},generatePdf(t){v.warning("Solicitando documento, espere..."),axios.get("inspection/get-document/"+t.inspections[0].inspection_uuid).then(e=>{window.open(e.data.data.path_storage,"_blank")}).catch(e=>{v.error("No fue posible recuperar el documento"),console.log(e)})},checkPermissionToPdf(t){return this.$page.props.auth.role.name==="admin"||this.$page.props.auth.role.name==="tecnico"?this.hasPermissionTo("projects.read")&&this.checkStatus(t,["proyecto_iniciado","proyecto_finalizado","proyecto_validado","proyecto_cerrado"])&&t.inspections.length:this.hasPermissionTo("projects.read")&&this.checkStatus(t,["proyecto_cerrado"])&&t.inspections.length},isRequiredLabel(t){return t?"Requerido":"Opcional"},setInspectionUuid(t){this.inspectionUuid=t}}},Ve=Object.assign(Pe,{__name:"Projects",setup(t){return(e,o)=>{const a=r("v-chip"),h=r("v-icon"),I=r("v-text-field"),N=r("v-toolbar-title"),Q=r("v-divider"),q=r("v-spacer"),y=r("v-btn"),C=r("v-card-title"),_=r("v-col"),O=r("v-textarea"),P=r("v-select"),j=r("v-row"),S=r("v-container"),V=r("v-card-text"),U=r("v-card-actions"),b=r("v-card"),F=r("v-dialog"),R=r("v-toolbar"),Z=r("v-data-table"),K=r("v-timeline-item"),W=r("v-timeline"),D=r("v-tab"),X=r("v-tabs"),z=r("v-tabs-window-item"),Y=r("v-tabs-window");return l(),g(E,null,[i(B(L),{position:"top-right",richColors:"",visibleToasts:10}),i(B(x),{title:"Proyectos de inspección"}),i(ne,null,{header:n(()=>[re]),default:n(()=>[m("div",ce,[m("div",de,[m("div",ue,[i(b,null,{default:n(()=>[i(j,null,{default:n(()=>[i(_,{cols:"12",sm:"12"},{default:n(()=>[i(Z,{headers:e.headers,items:t.projects,"fixed-header":"",search:e.search,mobile:e.isMobile()},{"item.status.status":n(({value:s,item:d})=>[i(a,{size:"small",class:"m-1"},{default:n(()=>[p(k(s),1)]),_:2},1024)]),"item.employees":n(({value:s})=>[(l(!0),g(E,null,A(s,(d,$)=>(l(),g("p",{key:$},[i(h,{class:"mdi mdi-vector-point text-primary"}),p(" "+k(d.user.name),1)]))),128)),s.length?c("",!0):(l(),g("p",pe,"Por asignar"))]),"item.inspections":n(({value:s})=>[(l(!0),g(E,null,A(s,d=>(l(),g("p",{key:d.ct_inspection_uuid},k(d.category.ct_inspection),1))),128)),s.length?c("",!0):(l(),g("p",me,"Por asignar"))]),top:n(()=>[i(R,{flat:""},{default:n(()=>[i(N,{class:"ml-1"},{default:n(()=>[i(I,{modelValue:e.search,"onUpdate:modelValue":o[0]||(o[0]=s=>e.search=s),label:"Buscar","hide-details":"",variant:"solo","append-inner-icon":"mdi-magnify",density:"compact"},null,8,["modelValue"])]),_:1}),i(Q,{class:"mx-4",inset:"",vertical:""}),i(q),e.hasPermissionTo("projects.create")||e.hasPermissionTo("projects.update")?(l(),u(F,{key:0,modelValue:e.dialog,"onUpdate:modelValue":o[6]||(o[6]=s=>e.dialog=s),width:"auto"},ee({default:n(()=>[i(b,{loading:!1},{default:n(()=>[i(C,null,{default:n(()=>[m("span",he,k(e.formTitle),1)]),_:1}),i(V,null,{default:n(()=>[i(S,null,{default:n(()=>[i(j,null,{default:n(()=>[i(_,{cols:"12"},{default:n(()=>[i(I,{modelValue:e.editedItem.project_name,"onUpdate:modelValue":o[2]||(o[2]=s=>e.editedItem.project_name=s),label:"Nombre",variant:"outlined","hide-details":"",required:""},null,8,["modelValue"])]),_:1}),i(_,{cols:"6"},{default:n(()=>[i(O,{modelValue:e.editedItem.description,"onUpdate:modelValue":o[3]||(o[3]=s=>e.editedItem.description=s),label:"Descripción",variant:"outlined","hide-details":"",required:""},null,8,["modelValue"])]),_:1}),i(_,{cols:"6"},{default:n(()=>[i(O,{modelValue:e.editedItem.comments,"onUpdate:modelValue":o[4]||(o[4]=s=>e.editedItem.comments=s),label:"Comentarios",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),i(_,{cols:"12"},{default:n(()=>[i(P,{modelValue:e.editedItem.client_uuid,"onUpdate:modelValue":o[5]||(o[5]=s=>e.editedItem.client_uuid=s),items:e.clients,"item-title":"client","item-value":"client_uuid",label:"Cliente",variant:"outlined","hide-details":"",required:""},null,8,["modelValue","items"])]),_:1}),i(_,{cols:"12",class:"text-right"},{default:n(()=>[i(H,{onClick:e.save},{default:n(()=>[p("Guardar")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1}),i(U,null,{default:n(()=>[i(q),i(y,{color:"blue-darken-1",variant:"text",onClick:e.close},{default:n(()=>[p(" Cerrar ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:2},[e.hasPermissionTo("projects.create")?{name:"activator",fn:n(({props:s})=>[i(y,{class:"mb-2",color:"primary",dark:"",icon:"mdi-lightbulb-on-outline",onClick:o[1]||(o[1]=d=>e.dialogHelp=!0)}),i(y,ie({class:"mb-2",color:"primary",dark:""},s,{icon:"mdi-plus"}),null,16)]),key:"0"}:void 0]),1032,["modelValue"])):c("",!0),i(F,{modelValue:e.dialogDelete,"onUpdate:modelValue":o[8]||(o[8]=s=>e.dialogDelete=s),"max-width":"500px"},{default:n(()=>[i(b,null,{default:n(()=>[i(C,{class:"text-h5 text-center"},{default:n(()=>[p("¿Estás seguro de eliminar?")]),_:1}),i(U,null,{default:n(()=>[i(q),i(y,{color:"blue-darken-1",variant:"text",onClick:e.closeDelete},{default:n(()=>[p("Cancel")]),_:1},8,["onClick"]),i(y,{color:"blue-darken-1",variant:"text",onClick:o[7]||(o[7]=s=>e.deleteItemConfirm(e.editedItem.project_uuid))},{default:n(()=>[p("Si, eliminar")]),_:1}),i(q)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.actions":n(({item:s})=>[m("div",_e,[e.hasPermissionTo("projects.update")&&e.checkStatus(s,["proyecto_creado","proyecto_asignado","proyecto_iniciado"])?(l(),u(f,{key:0,text:"Editar",icon:"mdi-pencil",onClick:d=>e.editItem(s),size:"small"},null,8,["onClick"])):c("",!0),e.hasPermissionTo("projects.update")&&e.checkStatus(s,["proyecto_creado","proyecto_asignado","proyecto_iniciado"])?(l(),u(f,{key:1,text:"Cancelar proyecto",icon:"mdi-table-cancel",size:"small",onClick:d=>e.updateStatus(s,"proyecto_cancelado")},null,8,["onClick"])):c("",!0),e.hasPermissionTo("projects.delete")&&e.checkStatus(s,["proyecto_creado","proyecto_asignado"])?(l(),u(f,{key:2,text:"Eliminar",icon:"mdi-delete",onClick:d=>e.deleteItem(s),size:"small"},null,8,["onClick"])):c("",!0),e.hasPermissionTo("projects.update")&&e.checkStatus(s,["proyecto_asignado","proyecto_iniciado"])?(l(),u(f,{key:3,text:"Asignar técnico",icon:"mdi-account-plus-outline",size:"small",onClick:d=>e.asignTechniciensDialog("update",s),color:"text-success"},null,8,["onClick"])):c("",!0),e.checkPermissionToPdf(s)?(l(),u(f,{key:4,text:"Generar PDF",icon:"mdi-file-eye",size:"small",onClick:d=>e.generatePdf(s),color:"text-success"},null,8,["onClick"])):c("",!0)])]),"item.inspection_actions":n(({item:s})=>[m("div",ge,[e.hasPermissionTo("projects.update")&&e.checkStatus(s,["proyecto_creado"])?(l(),u(f,{key:0,text:"Asignar técnico",icon:"mdi-account-plus-outline",size:"small",onClick:d=>e.asignTechniciensDialog("create",s),color:"text-primary"},null,8,["onClick"])):c("",!0),e.hasPermissionTo("projects.update")&&e.checkStatus(s,["proyecto_asignado","proyecto_iniciado"])?(l(),u(f,{key:1,text:"Cargar información",icon:"mdi-file-edit",size:"small",onClick:d=>e.formDialog(s),color:"text-primary"},null,8,["onClick"])):c("",!0),e.hasPermissionTo("projects.finalize")&&e.checkStatus(s,["proyecto_iniciado"])&&s.inspections.length>0?(l(),u(f,{key:2,text:"Finalizar proyecto",icon:"mdi-note-check",size:"small",color:"text-primary",onClick:d=>e.updateStatus(s,"proyecto_finalizado")},null,8,["onClick"])):c("",!0),e.hasPermissionTo("projects.validate")&&e.checkStatus(s,["proyecto_finalizado"])?(l(),u(f,{key:3,text:"Validar proyecto",icon:"mdi-check-circle-outline",size:"small",onClick:d=>e.updateStatus(s,"proyecto_validado")},null,8,["onClick"])):c("",!0),e.hasPermissionTo("projects.validate")&&e.checkStatus(s,["proyecto_finalizado"])?(l(),u(f,{key:4,text:"Regresar estatus",icon:"mdi-restore",size:"small",onClick:d=>e.updateStatus(s,"proyecto_iniciado"),color:"text-red"},null,8,["onClick"])):c("",!0),e.hasPermissionTo("projects.close")&&e.checkStatus(s,["proyecto_validado"])?(l(),u(f,{key:5,text:"Cerrar proyecto",icon:"mdi-close-circle-outline",size:"small",color:"text-primary",onClick:d=>e.updateStatus(s,"proyecto_cerrado")},null,8,["onClick"])):c("",!0)])]),_:1},8,["headers","items","search","mobile"]),i(F,{modelValue:e.dialogHelp,"onUpdate:modelValue":o[10]||(o[10]=s=>e.dialogHelp=s),width:"auto"},{default:n(()=>[i(b,null,{default:n(()=>[i(C,{class:"text-h5 text-center"},{default:n(()=>[p("Ayuda")]),_:1}),i(V,null,{default:n(()=>[i(S,null,{default:n(()=>[i(j,null,{default:n(()=>[i(_,{cols:"12"},{default:n(()=>[fe,i(W,{align:"start",density:"compact"},{default:n(()=>[(l(!0),g(E,null,A(e.helpData,s=>(l(),u(K,{key:s.title,size:"x-small","dot-color":"grey"},{default:n(()=>[m("div",ye,[m("div",ve,[m("strong",null,k(s.title),1)]),m("div",null,k(s.description),1)])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),i(U,null,{default:n(()=>[i(q),i(y,{color:"blue-darken-1",variant:"text",onClick:o[9]||(o[9]=s=>e.dialogHelp=!1)},{default:n(()=>[p("Cerrar")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e.hasPermissionTo("projects.update")?(l(),u(F,{key:0,modelValue:e.dialogAsignEmployees,"onUpdate:modelValue":o[13]||(o[13]=s=>e.dialogAsignEmployees=s),width:"400"},{default:n(()=>[i(b,null,{default:n(()=>[i(C,null,{default:n(()=>[e.editedItem.action=="create"?(l(),g("span",Ie,"Asignar técnicos")):c("",!0),e.editedItem.action=="update"?(l(),g("span",ke,"Actualizar técnicos")):c("",!0)]),_:1}),i(V,null,{default:n(()=>[i(S,null,{default:n(()=>[i(j,null,{default:n(()=>[i(_,{cols:"12"},{default:n(()=>[i(P,{modelValue:e.editedItem.employees_uuid,"onUpdate:modelValue":o[11]||(o[11]=s=>e.editedItem.employees_uuid=s),items:e.employees,"item-title":"name","item-value":"uuid",label:"Seleccionar técnicos",variant:"outlined","hide-details":"",required:"",multiple:"",chips:""},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),_:1}),i(U,null,{default:n(()=>[i(q),i(y,{color:"blue-darken-1",variant:"text",onClick:e.closeAsignTechniciens},{default:n(()=>[p(" Cerrar ")]),_:1},8,["onClick"]),i(y,{color:"blue-darken-1",variant:"text",onClick:o[12]||(o[12]=s=>e.asignTechniciens()),disabled:!e.editedItem.employees_uuid.length},{default:n(()=>[p(" Guardar ")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):c("",!0),e.hasPermissionTo("projects.update")?(l(),u(F,{key:1,modelValue:e.dialogAsignInspection,"onUpdate:modelValue":o[21]||(o[21]=s=>e.dialogAsignInspection=s),width:"auto","min-height":"600",scrollable:""},{default:n(()=>[i(b,{loading:e.loadingInspectionDialog,disabled:e.loadingInspectionDialog},{default:n(()=>[i(C,null,{default:n(()=>[e.inspectionForm.isUpdating?c("",!0):(l(),g("span",qe,'Asignando inspección al proyecto "'+k(e.inspectionForm.project_name)+'"',1)),e.inspectionForm.isUpdating?(l(),g("span",je,'Actualizando inspección al proyecto "'+k(e.inspectionForm.project_name)+'"',1)):c("",!0)]),_:1}),i(V,null,{default:n(()=>[i(S,null,{default:n(()=>[i(j,null,{default:n(()=>[i(_,{cols:"12"},{default:n(()=>[i(P,{modelValue:e.inspectionForm.ct_inspection_code,"onUpdate:modelValue":o[14]||(o[14]=s=>e.inspectionForm.ct_inspection_code=s),items:e.inspections,"item-title":"ct_inspection","item-value":"ct_inspection_code",label:"Seleccionar inspección",variant:"outlined","hide-details":"",required:""},null,8,["modelValue","items"])]),_:1}),i(_,{cols:"6"},{default:n(()=>[i(P,{modelValue:e.inspectionForm.ct_equipment_uuid,"onUpdate:modelValue":[o[15]||(o[15]=s=>e.inspectionForm.ct_equipment_uuid=s),o[16]||(o[16]=s=>e.setEquipmentFields(e.inspectionForm.ct_equipment_uuid))],items:e.inspectionsEquipmentsCategories,"item-title":"ct_equipment","item-value":"ct_equipment_uuid",label:"Seleccionar categoría de equipo a inspeccionar",variant:"outlined","hide-details":"",required:""},null,8,["modelValue","items"])]),_:1}),i(_,{cols:"6"},{default:n(()=>[i(P,{modelValue:e.inspectionForm.equipments_uuid,"onUpdate:modelValue":o[17]||(o[17]=s=>e.inspectionForm.equipments_uuid=s),items:e.equipmentsByCategory,"item-title":"equipment","item-value":"equipment_uuid",label:"Seleccionar equipos a utilizar en la inspección",variant:"outlined","hide-details":"",multiple:"",chips:"",clearable:""},null,8,["modelValue","items"])]),_:1}),i(_,{cols:"12"},{default:n(()=>[i(I,{modelValue:e.inspectionForm.location,"onUpdate:modelValue":o[18]||(o[18]=s=>e.inspectionForm.location=s),label:"Ubicación",variant:"outlined","hide-details":"",required:""},null,8,["modelValue"])]),_:1}),i(_,{cols:"12"},{default:n(()=>[be,i(B(M),{content:e.inspectionForm.resume,"onUpdate:content":o[19]||(o[19]=s=>e.inspectionForm.resume=s),theme:"snow",toolbar:"essential",heigth:"100%",contentType:"html"},null,8,["content"])]),_:1}),i(_,{cols:"12"},{default:n(()=>[Fe,e.inspectionForm.fields.length?(l(),u(j,{key:0},{default:n(()=>[(l(!0),g(E,null,A(e.inspectionForm.fields,(s,d)=>(l(),u(_,{cols:"6",key:d},{default:n(()=>[i(I,{modelValue:s.value,"onUpdate:modelValue":$=>s.value=$,label:s.name+" ("+e.isRequiredLabel(s.required)+")",variant:"outlined","hide-details":"",required:""},null,8,["modelValue","onUpdate:modelValue","label"])]),_:2},1024))),128))]),_:1})):(l(),u(j,{key:1},{default:n(()=>[i(_,{cols:"12"},{default:n(()=>[Ce]),_:1})]),_:1}))]),_:1})]),_:1})]),_:1})]),_:1}),i(U,null,{default:n(()=>[i(q),i(y,{color:"blue-darken-1",variant:"text",onClick:e.closeAsignInspection},{default:n(()=>[p(" Cerrar ")]),_:1},8,["onClick"]),i(y,{color:"blue-darken-1",variant:"text",onClick:o[20]||(o[20]=s=>e.asignInspection()),disabled:!1,loading:e.loadingInspectionDialog},{default:n(()=>[p(" Guardar ")]),_:1},8,["loading"])]),_:1})]),_:1},8,["loading","disabled"])]),_:1},8,["modelValue"])):c("",!0),e.hasPermissionTo("projects.update")?(l(),u(F,{key:2,modelValue:e.dialogForm,"onUpdate:modelValue":o[25]||(o[25]=s=>e.dialogForm=s),transition:"dialog-bottom-transition",fullscreen:"",persistent:""},{default:n(()=>[i(R,null,{default:n(()=>[i(y,{icon:"mdi-close",onClick:o[22]||(o[22]=s=>e.closeSectionDialog())}),i(N,{class:"w-100"},{default:n(()=>[p(" Carga de información "),m("p",null,[m("small",null,'Proyecto: "'+k(e.inspectionForm.project_name)+'"',1)])]),_:1}),i(q)]),_:1}),i(b,null,{default:n(()=>[i(X,{modelValue:e.tab,"onUpdate:modelValue":o[23]||(o[23]=s=>e.tab=s),"align-tabs":"center",class:"position-fixed w-100 bg-primary-color"},{default:n(()=>[i(D,{value:"information"},{default:n(()=>[p("Información")]),_:1}),i(D,{value:"sections"},{default:n(()=>[p("Secciones")]),_:1}),i(D,{value:"recomendations"},{default:n(()=>[p("Concluciones y Recomendaciones")]),_:1})]),_:1},8,["modelValue"]),i(V,{class:"mt-10"},{default:n(()=>[i(Y,{modelValue:e.tab,"onUpdate:modelValue":o[24]||(o[24]=s=>e.tab=s)},{default:n(()=>[i(z,{value:"information"},{default:n(()=>[i(le,{inspection_uuid:e.inspectionUuid,project:e.project,onSetInspectionUuid:e.setInspectionUuid},null,8,["inspection_uuid","project","onSetInspectionUuid"])]),_:1}),i(z,{value:"sections"},{default:n(()=>[i(G,{dialogForm:e.dialogForm,ct_inspection_uuid:e.ctInspectionUuid,inspection_uuid:e.inspectionUuid,onCloseSectionDialog:e.closeSectionDialog},null,8,["dialogForm","ct_inspection_uuid","inspection_uuid","onCloseSectionDialog"])]),_:1}),i(z,{value:"recomendations"},{default:n(()=>[i(J,{inspection_uuid:e.inspectionUuid},null,8,["inspection_uuid"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):c("",!0)]),_:1})]),_:1})]),_:1})])])])]),_:1})],64)}}}),Me=ae(Ve,[["__scopeId","data-v-283008f7"]]);export{Me as default};
