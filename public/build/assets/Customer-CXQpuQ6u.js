import{r as d,o as m,e as A,b as e,u as T,w as l,F as B,L as D,q as g,Z as x,a as u,c as p,d as n,t as _,s as F,x as L,g as I}from"./app-DdZPrK9i.js";import{_ as R}from"./AuthenticatedLayout-CZ9l2kzp.js";import"./sweetalert2.all-BQx39Jbw.js";import{h as S}from"./moment-Cl4UOzQZ.js";import"./ApplicationLogo-Deri-oUf.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const W=u("h2",{class:"font-semibold text-xl leading-tight"},"Clientes",-1),H={class:"py-12"},G={class:"max-w-7xl mx-auto sm:px-4 lg:px-6"},M={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Z={class:"text-h5"},J={components:{Toaster:D},props:{customers:{type:Array,required:!0}},data:()=>({search:"",dialog:!1,dialogDelete:!1,headers:[{title:"",key:"logo",sortable:!1},{title:"Cliente",key:"client"},{title:"Nombre fiscal",key:"legal_name",minWidth:"200"},{title:"Dirección",key:"address",minWidth:"200"},{title:"Tels.",value:"phone",minWidth:"200"},{title:"Email",key:"email"},{title:"Activo",key:"active"},{title:"Actions",key:"actions",sortable:!1}],editedIndex:-1,editedItem:{client_uuid:"",client:"",logo:null,legal_name:"",address:"",zip_code:"",phone:"",email:"",active:!1},defaultItem:{client_uuid:"",client:"",logo:null,legal_name:"",address:"",zip_code:"",phone:"",email:"",active:!1}}),computed:{formTitle(){return this.editedIndex===-1?"Nueva cliente":"Editar cliente"}},watch:{dialog(i){i||this.close()},dialogDelete(i){i||this.closeDelete()}},methods:{editItem(i){this.editedIndex=this.customers.indexOf(i),i.active=i.active=="1",this.editedItem=Object.assign({},i),this.editedItem.logo=null,this.dialog=!0},deleteItem(i){this.editedIndex=this.customers.indexOf(i),this.editedItem=Object.assign({},i),this.dialogDelete=!0},deleteItemConfirm(i){this.customers.splice(this.editedIndex,1);const t=()=>axios.delete("api/clients/"+i);g.promise(t,{loading:"Procesando...",success:a=>(this.closeDelete(),"Cliente eliminado correctamente"),error:a=>{this.handleErrors(a)}})},close(){this.dialog=!1,this.$nextTick(()=>{console.log("Cambiando estatus en close"),this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},closeDelete(){this.dialogDelete=!1,this.$nextTick(()=>{console.log("Cambiando estatus en closeDelete"),this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},save(){let i={client:this.editedItem.client,logo_store:this.editedItem.logo,legal_name:this.editedItem.legal_name,address:this.editedItem.address,zip_code:this.editedItem.zip_code,phone:this.editedItem.phone,email:this.editedItem.email,active:this.editedItem.active?1:0};if(this.editedIndex>-1){const t=()=>axios.post("api/clients/update/"+this.editedItem.client_uuid,i,{headers:{"Content-Type":"multipart/form-data"}});g.promise(t(),{loading:"Procesando...",success:a=>(this.$inertia.reload(),this.close(),"Cliente actualizado correctamente"),error:a=>{this.handleErrors(a)}})}else{this.customers.push(this.editedItem);const t=()=>axios.post("api/clients",i,{headers:{"Content-Type":"multipart/form-data"}});g.promise(t(),{loading:"Procesando...",success:a=>(this.$inertia.reload(),this.close(),"Cliente creado correctamente"),error:a=>{this.handleErrors(a)}})}},getColor(i){return i?"green":"red"},formatTime(i){return S(i,"HH:mm:ss").format("hh:mm A")},showImage(i){window.open("../"+i.logo,"_blank")},setEmail(){this.editedItem.email=this.editedItem.client.toLowerCase().replace(/ /g,"_")+"@qsr.mx"}}},le=Object.assign(J,{__name:"Customer",setup(i){return(t,a)=>{const b=d("v-avatar"),h=d("v-icon"),r=d("v-text-field"),z=d("v-toolbar-title"),U=d("v-divider"),v=d("v-spacer"),c=d("v-btn"),k=d("v-card-title"),E=d("v-file-input"),s=d("v-col"),P=d("v-textarea"),$=d("v-switch"),C=d("v-row"),N=d("v-container"),O=d("v-card-text"),V=d("v-card-actions"),f=d("v-card"),y=d("v-dialog"),q=d("v-toolbar"),j=d("v-data-table");return m(),A(B,null,[e(T(D),{position:"top-right",richColors:"",visibleToasts:10}),e(T(x),{title:"Clientes"}),e(R,null,{header:l(()=>[W]),default:l(()=>[u("div",H,[u("div",G,[u("div",M,[e(f,null,{default:l(()=>[e(C,null,{default:l(()=>[e(s,{cols:"12",sm:"12"},{default:l(()=>[e(j,{headers:t.headers,items:i.customers,"fixed-header":"",search:t.search,mobile:t.isMobile()},{"item.logo":l(({item:o})=>[o.logo?(m(),p(b,{key:0,image:"../../"+o.logo,size:"40",class:"ma-1 avatar",onClick:w=>t.showImage(o)},null,8,["image","onClick"])):(m(),p(b,{key:1,color:"secondary"},{default:l(()=>[e(h,{icon:"mdi-account-circle"})]),_:1}))]),"item.active":l(({value:o})=>[e(h,{color:t.getColor(o)},{default:l(()=>[n("mdi-circle-slice-8")]),_:2},1032,["color"])]),"item.address":l(({item:o})=>[u("p",null,_(o.address)+", "+_(o.zip_code),1)]),"item.phone":l(({item:o})=>[n(_(o.phone),1)]),top:l(()=>[e(q,{flat:""},{default:l(()=>[e(z,{class:"ml-1"},{default:l(()=>[e(r,{modelValue:t.search,"onUpdate:modelValue":a[0]||(a[0]=o=>t.search=o),label:"Buscar","hide-details":"",variant:"solo","append-inner-icon":"mdi-magnify",density:"compact"},null,8,["modelValue"])]),_:1}),e(U,{class:"mx-4",inset:"",vertical:""}),e(v),t.hasPermissionTo("clients.create")||t.hasPermissionTo("clients.update")?(m(),p(y,{key:0,modelValue:t.dialog,"onUpdate:modelValue":a[9]||(a[9]=o=>t.dialog=o)},F({default:l(()=>[e(f,null,{default:l(()=>[e(k,null,{default:l(()=>[u("span",Z,_(t.formTitle),1)]),_:1}),e(O,null,{default:l(()=>[e(N,null,{default:l(()=>[e(C,null,{default:l(()=>[e(s,{cols:"12",md:"4"},{default:l(()=>[e(E,{variant:"solo",label:"Imagen",modelValue:t.editedItem.logo,"onUpdate:modelValue":a[1]||(a[1]=o=>t.editedItem.logo=o),accept:"image/*","prepend-icon":"","prepend-inner-icon":"mdi-image-plus","hide-details":""},null,8,["modelValue"])]),_:1}),e(s,{cols:"12",md:"4"},{default:l(()=>[e(r,{modelValue:t.editedItem.client,"onUpdate:modelValue":a[2]||(a[2]=o=>t.editedItem.client=o),label:"Cliente","hide-details":"",variant:"solo",onInput:t.setEmail},null,8,["modelValue","onInput"])]),_:1}),e(s,{cols:"12",md:"4"},{default:l(()=>[e(r,{modelValue:t.editedItem.legal_name,"onUpdate:modelValue":a[3]||(a[3]=o=>t.editedItem.legal_name=o),label:"Nombre fiscal","hide-details":"",variant:"solo"},null,8,["modelValue"])]),_:1}),e(s,{cols:"12",md:"4"},{default:l(()=>[e(P,{modelValue:t.editedItem.address,"onUpdate:modelValue":a[4]||(a[4]=o=>t.editedItem.address=o),label:"Dirección","hide-details":"",variant:"solo",rows:"1"},null,8,["modelValue"])]),_:1}),e(s,{cols:"12",md:"4"},{default:l(()=>[e(r,{modelValue:t.editedItem.zip_code,"onUpdate:modelValue":a[5]||(a[5]=o=>t.editedItem.zip_code=o),label:"C.P.","hide-details":"",variant:"solo",type:"number"},null,8,["modelValue"])]),_:1}),e(s,{cols:"12",md:"4"},{default:l(()=>[e(r,{modelValue:t.editedItem.phone,"onUpdate:modelValue":a[6]||(a[6]=o=>t.editedItem.phone=o),label:"Teléfono","hide-details":"",variant:"solo",type:"phone"},null,8,["modelValue"])]),_:1}),e(s,{cols:"12",md:"4"},{default:l(()=>[e(r,{modelValue:t.editedItem.email,"onUpdate:modelValue":a[7]||(a[7]=o=>t.editedItem.email=o),label:"Email","hide-details":"",type:"email",variant:"solo"},null,8,["modelValue"])]),_:1}),e(s,{cols:"12",md:"4"},{default:l(()=>[e($,{label:"Activo",modelValue:t.editedItem.active,"onUpdate:modelValue":a[8]||(a[8]=o=>t.editedItem.active=o),color:"primary"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(v),e(c,{color:"blue-darken-1",variant:"text",onClick:t.close},{default:l(()=>[n(" Cancelar ")]),_:1},8,["onClick"]),e(c,{color:"blue-darken-1",variant:"text",onClick:t.save},{default:l(()=>[n(" Guardar ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:2},[t.hasPermissionTo("clients.create")?{name:"activator",fn:l(({props:o})=>[e(c,L({class:"mb-2",color:"primary",dark:""},o,{icon:"mdi-plus"}),null,16)]),key:"0"}:void 0]),1032,["modelValue"])):I("",!0),e(y,{modelValue:t.dialogDelete,"onUpdate:modelValue":a[11]||(a[11]=o=>t.dialogDelete=o),"max-width":"500px"},{default:l(()=>[e(f,null,{default:l(()=>[e(k,{class:"text-h5 text-center"},{default:l(()=>[n("¿Estás seguro de eliminar?")]),_:1}),e(V,null,{default:l(()=>[e(v),e(c,{color:"blue-darken-1",variant:"text",onClick:t.closeDelete},{default:l(()=>[n("Cancel")]),_:1},8,["onClick"]),e(c,{color:"blue-darken-1",variant:"text",onClick:a[10]||(a[10]=o=>t.deleteItemConfirm(t.editedItem.client_uuid))},{default:l(()=>[n("Si, eliminar")]),_:1}),e(v)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.actions":l(({item:o})=>[t.hasPermissionTo("clients.update")?(m(),p(h,{key:0,class:"me-2",size:"small",onClick:w=>t.editItem(o)},{default:l(()=>[n(" mdi-pencil ")]),_:2},1032,["onClick"])):I("",!0),t.hasPermissionTo("clients.delete")?(m(),p(h,{key:1,size:"small",onClick:w=>t.deleteItem(o)},{default:l(()=>[n(" mdi-delete ")]),_:2},1032,["onClick"])):I("",!0)]),_:1},8,["headers","items","search","mobile"])]),_:1})]),_:1})]),_:1})])])])]),_:1})],64)}}});export{le as default};
