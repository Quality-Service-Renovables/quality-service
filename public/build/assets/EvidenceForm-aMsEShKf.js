import{H as Al,q as Lm,L as fb,r as Oa,o as Om,e as $b,b as so,w as Jo,F as yb,n as xb,c as bb,d as qd,t as vb,g as wb}from"./app-DKkm_uk5.js";import"./sweetalert2.all-BMTt8jQR.js";import{v as Sb,b as Tb,p as Cb,a as Mb}from"./filepond-plugin-image-transform.esm-BxoXjDAA.js";import{_ as kb}from"./_plugin-vue_export-helper-DlAUqK2U.js";/*!
 * Pintura v8.82.7 - Test version
 * (c) 2018-2024 PQINA Inc. - All Rights Reserved
 * License: https://pqina.nl/pintura/license/
 * 
 * This version of Pintura is for testing purposes only.
 * Visit https://pqina.nl/pintura/ to obtain a commercial license.
 */const Eb=[{value:65504,name:"jfif"},{value:65498,name:"sos"},{value:65505,subvalue:17784,name:"exif"},{value:65505,subvalue:26740,name:"xmp"},{value:65506,subvalue:19792,name:"mpf"},{value:65506,name:"app2"}];var zh=(t,e,n)=>{if(!t)return;const i=new DataView(t),r=(a=>{if(a.getUint16(0)!==65496)return;const s=a.byteLength;let l,c=2,d;for(;c<s&&a.getUint8(c)===255;){l=a.getUint16(c);const u=Eb.find(p=>p.value===l&&(!p.subvalue||p.subvalue===a.getUint16(c+2+2)));if(u){const{name:p}=u;d||(d={}),d[p]||(d[p]={offset:c,size:a.getUint16(c+2)})}if(l===65498)break;c+=2+a.getUint16(c+2)}return d})(i);if(!r||!r.exif)return;const o=((a,s)=>{if(a.getUint16(s)!==65505)return;const l=a.getUint16(s+2);if(s+=4,a.getUint32(s)!==1165519206)return;s+=6;const c=a.getUint16(s);if(c!==18761&&c!==19789)return;const d=c===18761;if(s+=2,a.getUint16(s,d)!==42)return;s+=a.getUint32(s+2,d);const u=p=>{const h=[];let y=s;const m=Math.min(a.byteLength,s+l-16);for(;y<m;y+=12){const f=y;a.getUint16(f,d)===p&&h.push(f)}return h};return{read:p=>{const h=u(p);if(h.length)return a.getUint16(h[0]+8,d)},write:(p,h)=>{const y=u(p);return!!y.length&&(y.forEach(m=>a.setUint16(m+8,h,d)),!0)}}})(i,r.exif.offset);return o?n===void 0?o.read(e):o.write(e,n):void 0},Bh=t=>window.__pqina_webapi__?window.__pqina_webapi__[t]:window[t],ae=(...t)=>{};const Pb={ArrayBuffer:"readAsArrayBuffer"};var vy=(t,e=ae,n={})=>new Promise((i,r)=>{const{dataFormat:o=Pb.ArrayBuffer}=n,a=new(Bh("FileReader"));a.onload=()=>i(a.result),a.onerror=()=>r(a.error),a.onprogress=e,a[o](t)}),wy=async(t,e=[0,t.size],n)=>await vy(t.slice(...e),n),Ib=async(t,e)=>{const n=await wy(t,[0,262144],e);return zh(n,274)||1};let yp=null;var ir=()=>(yp===null&&(yp=typeof window<"u"&&window.document!==void 0),yp);let Yd=null;var Uu=()=>new Promise(t=>{if(Yd===null){const e="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/4QA6RXhpZgAATU0AKgAAAAgAAwESAAMAAAABAAYAAAEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAD/2wBDAP//////////////////////////////////////////////////////////////////////////////////////wAALCAABAAIBASIA/8QAJgABAAAAAAAAAAAAAAAAAAAAAxABAAAAAAAAAAAAAAAAAAAAAP/aAAgBAQAAPwBH/9k=";let n=ir()?new Image:{};return n.onload=()=>{Yd=n.naturalWidth===1,n=void 0,t(Yd)},void(n.src=e)}return t(Yd)}),Qc=t=>t.getContext("2d").getImageData(0,0,t.width,t.height),fi=(t,e,n=[])=>{const i=document.createElement(t),r=Object.getOwnPropertyDescriptors(i.__proto__);for(const o in e)o==="style"?i.style.cssText=e[o]:r[o]&&r[o].set||/textContent|innerHTML/.test(o)||typeof e[o]=="function"?i[o]=e[o]:i.setAttribute(o,e[o]);return n.forEach(o=>i.appendChild(o)),i};const Rb={1:()=>[1,0,0,1,0,0],2:t=>[-1,0,0,1,t,0],3:(t,e)=>[-1,0,0,-1,t,e],4:(t,e)=>[1,0,0,-1,0,e],5:()=>[0,1,1,0,0,0],6:(t,e)=>[0,1,-1,0,e,0],7:(t,e)=>[0,-1,-1,0,e,t],8:t=>[0,-1,1,0,0,t]};var dr=t=>{t.width=1,t.height=1;const e=t.getContext("2d");e&&e.clearRect(0,0,1,1)},Vc=t=>"data"in t,Nh=t=>ir()?RegExp(t).test(window.navigator.userAgent):void 0;let xp=null;var Gu=()=>(xp===null&&(xp=Nh(/Android/)),xp),Sy=(t,e)=>{const n=fi("canvas",{width:t.width,height:t.height});return n.getContext("2d",e).drawImage(t,0,0),n},Xl=async(t,e=1)=>{const n=await Uu(),[i,r]=n||e<5?[t.width,t.height]:[t.height,t.width],o=fi("canvas",{width:i,height:r}),a=o.getContext("2d",{willReadFrequently:!0});if(Vc(t)&&!n&&e>1){const s=fi("canvas",{width:t.width,height:t.height});s.getContext("2d",{willReadFrequently:!0}).putImageData(t,0,0),t=s}if(!n&&e>1&&a.transform.apply(a,((s,l,c=-1)=>(c===-1&&(c=1),Rb[c](s,l)))(t.width,t.height,e)),Vc(t)){if(a.putImageData(t,0,0),Gu())return Sy(o)}else a.drawImage(t,0,0);return t instanceof HTMLCanvasElement&&dr(t),o},Ty=async(t,e=1)=>e===1||await Uu()?t:Qc(await Xl(t,e)),Fs=t=>typeof t=="object";const Fm=t=>t instanceof HTMLElement?t:Fs(t)?Cy(t):t,Cy=t=>{let e;return Array.isArray(t)?(e=[],t.forEach((n,i)=>{e[i]=Fm(n)})):(e={},t!==null&&Object.keys(t).forEach(n=>{const i=t[n];e[n]=Fm(i)})),e};var Qe=t=>typeof t=="string",Si=t=>typeof t=="function",Ab=(t,e)=>new Promise((n,i)=>{const r=()=>n(((o,{width:a,height:s,canvasMemoryLimit:l,contextOptions:c})=>{let d=a||o.naturalWidth,u=s||o.naturalHeight;d||u||(d=300,u=150);const p=d*u;if(l&&p>l){const y=Math.sqrt(l)/Math.sqrt(p);d=Math.floor(d*y),u=Math.floor(u*y)}const h=fi("canvas");return h.width=d,h.height=u,h.getContext("2d",c).drawImage(o,0,0,d,u),h})(t,e));t.complete&&t.width?r():(t.onload=r,t.onerror=()=>i(new Error("Failed to load image")))}),My=()=>"createImageBitmap"in window,ky=t=>/svg/.test(t.type),ba=()=>Math.random().toString(36).substring(2,9);const bp=new Map;var ju=(t,e,n)=>new Promise((i,r)=>{const o=t.toString();let a=bp.get(o);if(!a){const l=(p=>`function () {self.onmessage = function (message) {(${p.toString()}).apply(null, message.data.content.concat([function (err, response) {
    response = response || {};
    const transfer = 'data' in response ? [response.data.buffer] : 'width' in response ? [response] : [];
    return self.postMessage({ id: message.data.id, content: response, error: err }, transfer);
}]))}}`)(t),c=URL.createObjectURL((p=>new Blob(["(",typeof p=="function"?p.toString():p,")()"],{type:"application/javascript"}))(l)),d=new Map,u=new Worker(c);a={url:c,worker:u,messages:d,terminationTimeout:void 0,terminate:()=>{clearTimeout(a.terminationTimeout),a.worker.terminate(),URL.revokeObjectURL(c),bp.delete(o)}},u.onmessage=function(p){const{id:h,content:y,error:m}=p.data;if(clearTimeout(a.terminationTimeout),a.terminationTimeout=setTimeout(()=>{d.size>0||a.terminate()},500),!d.has(h))return;const f=d.get(h);d.delete(h),m!=null?f.reject(m):f.resolve(y)},bp.set(o,a)}const s=ba();a.messages.set(s,{resolve:i,reject:r}),a.worker.postMessage({id:s,content:e},n)});let vp=null;var va=()=>(vp===null&&(vp=Nh(/Firefox/)),vp);const _m=async(t,e)=>{const n=await(async(r,o)=>{const a=fi("img",{src:URL.createObjectURL(r)}),s=await Ab(a,o);return URL.revokeObjectURL(a.src),s})(t,{canvasMemoryLimit:e,contextOptions:{willReadFrequently:!0}}),i=Qc(n);return dr(n),i};var Ey=async(t,e)=>{if(Gu()&&!va())return await _m(t,e);let n;if(My()&&!ky(t)&&"OffscreenCanvas"in window)try{n=await ju((i,r,o)=>{createImageBitmap(i).then(a=>{let s=a.width,l=a.height;const c=s*l;if(r&&c>r){const h=Math.sqrt(r)/Math.sqrt(c);s=Math.floor(s*h),l=Math.floor(l*h)}const d=new OffscreenCanvas(s,l),u=d.getContext("2d",{willReadFrequently:!0});u.drawImage(a,0,0,s,l);const p=u.getImageData(0,0,d.width,d.height);o(null,p)}).catch(a=>{o(a)})},[t,e])}catch{}return n&&n.width?n:await _m(t,e)},Wh=(t,e,n)=>new Promise((i,r)=>{try{t.toBlob(o=>{if(!o)return r(new Error("Failed to create blob"));i(o)},e,n)}catch(o){r(o)}}),Lb=async(t,e,n)=>{const i=await Xl(t),r=await Wh(i,e,n);return dr(i),r};const Ob={matroska:"mkv"};var Py=t=>{const e=(t.match(/\/([a-z0-9]+)/)||[])[1];if(/^x/.test(e)){const[,n=""]=t.split("/x-");return Ob[n]}return e},Iy=t=>t.substring(0,t.lastIndexOf("."))||t;const Fb=/avif|bmp|gif|jpg|jpeg|jpe|jif|jfif|png|svg|tiff|webp/;var Vh=t=>{return t&&(e=(n=t,n.split(".").pop()).toLowerCase(),Fb.test(e)?"image/"+(/jfif|jif|jpe|jpg/.test(e)?"jpeg":e==="svg"?"svg+xml":e):"");var e,n},Hc=(t,e,n)=>{const i=new Date().getTime(),r=t.type.length&&!/null|text/.test(t.type),o=r?t.type:n,a=((s,l)=>{const c=Vh(s);if(c===l)return s;const d=Py(l)||c;return`${Iy(s)}.${d}`})(e,o);try{return new(Bh("File"))([t],a,{lastModified:i,type:r?t.type:o})}catch{const l=r?t.slice():t.slice(0,t.size,o);return l.lastModified=i,l.name=a,l}},as=(t,e)=>t/e,ni=t=>t;const wp=Math.PI,No=Math.PI/2,Qo=No/2;var Fa=t=>{const e=Math.abs(t)%Math.PI;return e>Qo&&e<Math.PI-Qo};const uh={Top:"t",Right:"r",Bottom:"b",Left:"l",TopLeft:"tl",TopRight:"tr",BottomRight:"br",BottomLeft:"bl"},{Top:Es,Right:Ps,Bottom:Is,Left:Rs,TopLeft:na,TopRight:ia,BottomRight:ra,BottomLeft:oa}=uh;var Uc={[Es]:[.5,0],[Ps]:[1,.5],[Is]:[.5,1],[Rs]:[0,.5],[na]:[0,0],[ia]:[1,0],[ra]:[1,1],[oa]:[0,1]},en=(t,e=12)=>parseFloat(t.toFixed(e));const Iu=(t,e,n)=>n+(t-n)*e,Dm=t=>({x:t.x+.5*t.width,y:t.y+.5*t.height,rx:.5*t.width,ry:.5*t.height}),hi=()=>pt(0,0),pt=(t,e)=>({x:t,y:e}),zm=t=>pt(t.pageX,t.pageY),Ue=t=>pt(t.x,t.y),_c=t=>(t.x=-t.x,t.y=-t.y,t),Gr=(t,e,n=hi())=>{const i=Math.cos(e),r=Math.sin(e),o=t.x-n.x,a=t.y-n.y;return t.x=n.x+i*o-r*a,t.y=n.y+r*o+i*a,t},Ts=t=>Math.sqrt(t.x*t.x+t.y*t.y),bo=t=>{const e=Math.sqrt(t.x*t.x+t.y*t.y);return e===0?hi():(t.x/=e,t.y/=e,t)},Kd=(t,e)=>Math.atan2(e.y-t.y,e.x-t.x),ws=(t,e)=>t.x===e.x&&t.y===e.y,Eo=(t,e)=>(t.x=e(t.x),t.y=e(t.y),t),nr=(t,e)=>(t.x+=e.x,t.y+=e.y,t),Oi=(t,e)=>(t.x-=e.x,t.y-=e.y,t),Bm=(t,e)=>(t.x/=e,t.y/=e,t),Po=(t,e)=>(t.x*=e,t.y*=e,t),$u=(t,e)=>t.x*e.x+t.y*e.y,yu=(t,e)=>t.x*e.y-t.y*e.x,yo=(t,e=hi())=>{const n=t.x-e.x,i=t.y-e.y;return n*n+i*i},Yr=(t,e=hi())=>Math.sqrt(yo(t,e)),_b=(t,e,n)=>(t.x=Iu(t.x,e,n.x),t.y=Iu(t.y,e,n.y),t),zo=t=>{let e=0,n=0;return t.forEach(i=>{e+=i.x,n+=i.y}),pt(e/t.length,n/t.length)},Nl=(t,e,n,i,r)=>(t.forEach(o=>{o.x=e?i-(o.x-i):o.x,o.y=n?r-(o.y-r):o.y}),t),ls=(t,e,n,i)=>{const r=Math.sin(e),o=Math.cos(e);return t.forEach(a=>{a.x-=n,a.y-=i;const s=a.x*o-a.y*r,l=a.x*r+a.y*o;a.x=n+s,a.y=i+l}),t},ql=(t,e)=>({width:t,height:e}),co=t=>ql(t.width,t.height),Wa=t=>ql(t.width,t.height),dl=t=>ql(t.width,t.height),Db=t=>ql(t[0],t[1]),Dc=t=>{return/img/i.test(t.nodeName)?ql((e=t).naturalWidth,e.naturalHeight):Wa(t);var e},sr=(t,e)=>ql(t,e),Gc=(t,e,n=ni)=>n(t.width)===n(e.width)&&n(t.height)===n(e.height),Jd=(t,e)=>(t.width*=e,t.height*=e,t),ul=t=>pt(.5*t.width,.5*t.height),Ry=(t,e)=>{const n=Math.abs(e),i=Math.abs(Math.cos(n)),r=Math.abs(Math.sin(n)),o=i*t.width+r*t.height,a=r*t.width+i*t.height;return t.width=o,t.height=a,t},Nm=(t,e)=>t.width>=e.width&&t.height>=e.height,cs=(t,e)=>(t.width=e(t.width),t.height=e(t.height),t),As=(t,e)=>({start:t,end:e}),Ay=t=>As(Ue(t.start),Ue(t.end)),Hh=(t,e)=>{if(e===0)return t;const n=pt(t.start.x-t.end.x,t.start.y-t.end.y),i=bo(n),r=Po(i,e);return t.start.x+=r.x,t.start.y+=r.y,t.end.x-=r.x,t.end.y-=r.y,t},zb=[pt(-1,-1),pt(-1,1),pt(1,1),pt(1,-1)],sa=(t,e,n,i)=>({x:t,y:e,width:n,height:i}),Mn=t=>sa(t.x,t.y,t.width,t.height),Cs=()=>sa(0,0,0,0),Fr=t=>sa(0,0,t.width,t.height),Bb=t=>sa(t[3],t[0],t[1]-t[3],t[2]-t[0]),vs=t=>sa(t.x||0,t.y||0,t.width||0,t.height||0),Vi=t=>{let e=t[0].x,n=t[0].x,i=t[0].y,r=t[0].y;return t.forEach(o=>{e=Math.min(e,o.x),n=Math.max(n,o.x),i=Math.min(i,o.y),r=Math.max(r,o.y)}),sa(e,i,n-e,r-i)},Sp=t=>Ci(t.x-t.rx,t.y-t.ry,2*t.rx,2*t.ry),Wm=(t,e)=>sa(t.x-.5*e.width,t.y-.5*e.height,e.width,e.height),Ci=(t,e,n,i)=>sa(t,e,n,i),wn=t=>pt(t.x+.5*t.width,t.y+.5*t.height),ta=(t,e)=>(t.x+=e.x,t.y+=e.y,t),Sr=(t,e,n)=>(n=n||wn(t),t.x=e*(t.x-n.x)+n.x,t.y=e*(t.y-n.y)+n.y,t.width=e*t.width,t.height=e*t.height,t),Vm=(t,e,n,i)=>{const r=(i.x-t.x)/t.width,o=(i.y-t.y)/t.height;let a=Math.max(e.width,t.width),s=Math.max(e.height,t.height);return a=Math.min(n.width,a),s=Math.min(n.height,s),t.x=i.x-r*a,t.y=i.y-o*s,t.width=a,t.height=s,t},Hm=(t,e)=>{const[n,i]=Uc[e],r=n*t.width,o=i*t.height;return pt(t.x+r,t.y+o)},Ms=(t,e)=>(t.x*=e,t.y*=e,t.width*=e,t.height*=e,t),ea=(t,e,n=ni)=>n(t.x)===n(e.x)&&n(t.y)===n(e.y)&&n(t.width)===n(e.width)&&n(t.height)===n(e.height),lr=t=>as(t.width,t.height),Ly=(t,e,n,i,r)=>(t.x=e,t.y=n,t.width=i,t.height=r,t),Zu=(t,e)=>(t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,t),$r=(t,e,n)=>(n||(n=wn(t)),Mo(t).map(i=>Gr(i,e,n))),xu=(t,e)=>sa(.5*t.width-.5*e.width,.5*t.height-.5*e.height,e.width,e.height),Ru=(t,e)=>!(e.x<t.x)&&!(e.y<t.y)&&!(e.x>t.x+t.width)&&!(e.y>t.y+t.height),Ls=(t,e,n=hi())=>{if(t.width===0||t.height===0)return Cs();const i=lr(t);e||(e=i);let r=t.width,o=t.height;return e>i?r=o*e:o=r/e,sa(n.x+.5*(t.width-r),n.y+.5*(t.height-o),r,o)},Kr=(t,e=lr(t),n=hi())=>{if(t.width===0||t.height===0)return Cs();let i=t.width,r=i/e;return r>t.height&&(r=t.height,i=r*e),sa(n.x+.5*(t.width-i),n.y+.5*(t.height-r),i,r)},pl=t=>[Math.min(t.y,t.y+t.height),Math.max(t.x,t.x+t.width),Math.max(t.y,t.y+t.height),Math.min(t.x,t.x+t.width)],Mo=t=>[pt(t.x,t.y),pt(t.x+t.width,t.y),pt(t.x+t.width,t.y+t.height),pt(t.x,t.y+t.height)],Bo=(t,e)=>{if(t)return t.x=e(t.x),t.y=e(t.y),t.width=e(t.width),t.height=e(t.height),t},Oy=(t,e,n=wn(t))=>Mo(t).map((i,r)=>{const o=zb[r];return pt(Iu(i.x,1+o.x*e.x,n.x),Iu(i.y,1+o.y*e.y,n.y))}),jc=t=>(t.x=0,t.y=0,t),Um=t=>{const e=t[0],n=t[t.length-1];t=ws(e,n)?t:[...t,e];const i=e.x,r=e.y;let o,a,s,l=0,c=0,d=0,u=0;const p=t.length;for(;c<p;c++)o=t[c],a=t[c+1>p-1?0:c+1],s=(o.y-r)*(a.x-i)-(a.y-r)*(o.x-i),l+=s,d+=(o.x+a.x-2*i)*s,u+=(o.y+a.y-2*r)*s;return s=3*l,pt(i+d/s,r+u/s)},Uh=(t,e)=>Fy(t.start,t.end,e.start,e.end),Fy=(t,e,n,i)=>{const r=(i.y-n.y)*(e.x-t.x)-(i.x-n.x)*(e.y-t.y);if(r===0)return;const o=((i.x-n.x)*(t.y-n.y)-(i.y-n.y)*(t.x-n.x))/r,a=((e.x-t.x)*(t.y-n.y)-(e.y-t.y)*(t.x-n.x))/r;return o<0||o>1||a<0||a>1?void 0:pt(t.x+o*(e.x-t.x),t.y+o*(e.y-t.y))},_y=(t,e,{ignoreIdenticalLines:n=!1,breakOnIntersection:i=!1}={})=>{const r=e.length,o=[];for(let a=0;a<r-1;a++){if(n&&(ws(t.start,e[a])||ws(t.start,e[a+1])||ws(t.end,e[a])||ws(t.end,e[a+1])))continue;const s=Fy(t.start,t.end,e[a],e[a+1]);if(s){if(i)return[s];o.push(s)}}return o.length?o:void 0},ph=(t,e)=>{let n=0,i=0,r=!1;const o=e.length;for(n=0,i=o-1;n<o;i=n++)e[n].y>t.y!=e[i].y>t.y&&t.x<(e[i].x-e[n].x)*(t.y-e[n].y)/(e[i].y-e[n].y)+e[n].x&&(r=!r);return r},Dy=t=>{const e=[];for(let n=0;n<t.length;n++){let i=n+1;i===t.length&&(i=0),e.push(As(Ue(t[n]),Ue(t[i])))}return e},zy=(t,e=0)=>Dy(t).map(n=>Hh(n,e)),Au=(t,e,n,i=0,r=!1,o=!1,a=12)=>{const s=[];for(let l=0;l<a;l++)s.push(pt(t.x+e*Math.cos(l*(2*Math.PI)/a),t.y+n*Math.sin(l*(2*Math.PI)/a)));return(r||o)&&Nl(s,r,o,t.x,t.y),i&&ls(s,i,t.x,t.y),s},Lu=(t,e,n,i)=>{const r=pt(t.x-n.x,t.y-n.y),o=pt(i.x-n.x,i.y-n.y),a=$u(o,o);let s=$u(r,o)/a;s=s<0?0:s,s=s>1?1:s;const l=pt(o.x*s+n.x-t.x,o.y*s+n.y-t.y);return $u(l,l)<=e*e},By=(t,e,n)=>{const i=n.length;for(let r=0;r<i-1;r++)if(Lu(t,e,n[r],n[r+1]))return!0;return!1},hh=(t,e,n)=>!!ph(t,n)||!!By(t,e,n)||Lu(t,e,n[0],n[n.length-1]),Tp=(t,e,n,i,r)=>hh(t,e,$r(n,i,r||wn(n)));var Ny=(t,e)=>{const n=Fr(t),i=wn(n),r=$r(n,e,i);return jc(Vi(r))},Zc=(t,e)=>t instanceof HTMLElement&&(!e||new RegExp(`^${e}$`,"i").test(t.nodeName)),td=t=>t instanceof File,Gm=async(t,e,n)=>{const i=await Wh(t,e,n);return Hc(i,"canvas")},Gh=t=>t.split("/").pop().split(/\?|\#/).shift();const Nb=ir()&&Node.prototype.replaceChildren?(t,e)=>t.replaceChildren(e):(t,e)=>{for(;t.lastChild;)t.removeChild(t.lastChild);e!==void 0&&t.append(e)},Qd=ir()&&fi("div",{class:"PinturaMeasure",style:"position:absolute;left:0;top:0;width:99999px;height:0;pointer-events:none;contain:strict;margin:0;padding:0;"});let jm;var jh=t=>(Nb(Qd,t),Qd.parentNode||document.body.append(Qd),clearTimeout(jm),jm=setTimeout(()=>{Qd.remove()},500),t);let Cp=null;var Ba=()=>(Cp===null&&(Cp=ir()&&/^((?!chrome|android).)*(safari|iphone|ipad)/i.test(navigator.userAgent)),Cp),Wy=t=>new Promise((e,n)=>{let i=!1;!t.parentNode&&Ba()&&(i=!0,t.style.cssText="position:absolute;visibility:hidden;pointer-events:none;left:0;top:0;width:0;height:0;",jh(t));const r=()=>{const a=t.naturalWidth,s=t.naturalHeight;a&&s&&(i&&t.remove(),clearInterval(o),e({width:a,height:s}))};t.onerror=a=>{clearInterval(o),n(a)};const o=setInterval(r,1);r()}),Vy=t=>new Promise((e,n)=>{const i=()=>{e({width:t.videoWidth,height:t.videoHeight})};if(t.readyState>=1)return i();t.onloadedmetadata=i,t.onerror=()=>n(t.error)}),Xu=t=>/^image/.test(t.type),Zh=t=>new Promise(e=>{const n=Qe(t)?t:URL.createObjectURL(t),i=()=>{const o=new Image;o.src=n,e(o)};if(t instanceof Blob&&Xu(t))return i();const r=document.createElement("video");r.preload="metadata",r.onloadedmetadata=()=>e(r),r.onerror=i,r.src=n}),Ou=t=>t.nodeName==="VIDEO",Hy=async t=>{let e,n;e=t.src?t:await Zh(t);try{n=Ou(e)?await Vy(e):await Wy(e)}finally{td(t)&&URL.revokeObjectURL(e.src)}return n},Wb=async t=>{const e=await Hy(t),n=await(o=>new Promise((a,s)=>{if(o.complete)return a(o);o.onload=()=>a(o),o.onerror=()=>s(new Error("Failed to load image"))}))(t),i=fi("canvas",e);i.getContext("2d",{willReadFrequently:!0}).drawImage(n,0,0);const r=await Wh(i);return Hc(r,Gh(n.src))},Dl=(t=0,e=!0)=>new(Bh("ProgressEvent"))("progress",{loaded:100*t,total:100,lengthComputable:e}),Zm=(t,e,n=i=>i)=>t.getAllResponseHeaders().indexOf(e)>=0?n(t.getResponseHeader(e)):void 0,Vb=t=>{if(!t)return null;const e=t.split(/filename=|filename\*=.+''/).splice(1).map(n=>n.trim().replace(/^["']|[;"']{0,2}$/g,"")).filter(n=>n.length);return e.length?decodeURI(e[e.length-1]):null};const Hb="URL_REQUEST";class zc extends Error{constructor(e,n,i){super(e),this.name="EditorError",this.code=n,this.metadata=i}}var Uy=(t,e)=>{const{headers:n={},credentials:i}=e||{};Object.entries(n).forEach(([r,o])=>t.setRequestHeader(r,o)),i&&(t.withCredentials=i!=="omit")},Ub=(t,e,n)=>/^data:/.test(t)?(async(i,r="data-uri",o=ae)=>{o(Dl(0));const a=await fetch(i);o(Dl(.33));const s=await a.blob();let l;Xu(s)||(l="image/"+(i.includes(",/9j/")?"jpeg":"png")),o(Dl(.66));const c=Hc(s,r,l);return o(Dl(1)),c})(t,void 0,e):((i,r,o)=>new Promise((a,s)=>{const l=()=>s(new zc("Error fetching image",Hb,c)),c=new XMLHttpRequest;c.onprogress=r,c.onerror=l,c.onload=()=>{if(!c.response||c.status>=300||c.status<200)return l();const u=Zm(c,"Content-Type"),p=Zm(c,"Content-Disposition",Vb)||Gh(i);a(Hc(c.response,p,u||Vh(p)))};const{willRequest:d}=o;Promise.resolve(d&&d(i,{resourceType:"image"})).then(u=>{if(u===!1)return s("Image load rejected");c.open("GET",i,!0),Uy(c,u),c.responseType="blob",c.send()}).catch(console.error)}))(t,e,n),Xh=t=>t instanceof Blob&&!(t instanceof File),Gy=t=>"close"in t,Gb=async(t,e,n)=>{if(td(t)||Xh(t))return t;if(Qe(t))return await Ub(t,e,n);if(Zc(t,"canvas"))return await Gm(t);if(Zc(t,"img"))return await Wb(t);if(Vc(t)||Gy(t))return await Gm(await Xl(t));throw new zc("Invalid image source","invalid-image-source")};let Mp=null;var qu=()=>(Mp===null&&(Mp=ir()&&/^mac/i.test(navigator.platform)),Mp);let kp=null;var Io=()=>(kp===null&&(kp=ir()&&(Nh(/iPhone|iPad|iPod/)||qu()&&navigator.maxTouchPoints>=1)),kp),jb=async(t,e=1)=>await Uu()||Io()||e<5?t:sr(t.height,t.width),jy=t=>/jpeg/.test(t.type),Zb=t=>{return typeof(e=t)!="object"||e.constructor!=Object?t:JSON.stringify(t);var e},qh=(t,e=0,n)=>(e===0||(t.translate(n.x,n.y),t.rotate(e),t.translate(-n.x,-n.y)),t),Zy=(t,e,n)=>(t.scale(e,n),t),Xb=async(t,e={})=>{const{flipX:n,flipY:i,rotation:r,crop:o}=e,a=Wa(t),s=n||i,l=!!r,c=o&&(o.x||o.y||o.width||o.height),d=c&&ea(o,Fr(a)),u=c&&!d;if(!s&&!l&&!u)return t;let p,h=fi("canvas",{width:t.width,height:t.height});if(h.getContext("2d",{willReadFrequently:!0}).putImageData(t,0,0),s){const y=fi("canvas",{width:h.width,height:h.height}).getContext("2d",{willReadFrequently:!0});Zy(y,n?-1:1,i?-1:1),y.drawImage(h,n?-h.width:0,i?-h.height:0),y.restore(),dr(h),h=y.canvas}if(l){const y=cs(dl(Vi($r(vs(h),r))),Math.floor),m=fi("canvas",{width:o.width,height:o.height}).getContext("2d",{willReadFrequently:!0});((f,b,v)=>{f.translate(b,v)})(m,-o.x,-o.y),qh(m,r,ul(y)),m.drawImage(h,.5*(y.width-h.width),.5*(y.height-h.height)),m.restore(),dr(h),h=m.canvas}else if(u)return p=h.getContext("2d",{willReadFrequently:!0}).getImageData(o.x,o.y,o.width,o.height),dr(h),p;return p=h.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,h.width,h.height),dr(h),p},qb=(t,e)=>{const{imageData:n,width:i,height:r}=t,o=n.width,a=n.height,s=Math.round(i),l=Math.round(r),c=n.data,d=new Uint8ClampedArray(s*l*4),u=o/s,p=a/l,h=Math.ceil(.5*u),y=Math.ceil(.5*p);for(let m=0;m<l;m++)for(let f=0;f<s;f++){const b=4*(f+m*s);let v=0,w=0,T=0,I=0,P=0,_=0,C=0;const F=(m+.5)*p;for(let G=Math.floor(m*p);G<(m+1)*p;G++){const O=Math.abs(F-(G+.5))/y,$=(f+.5)*u,N=O*O;for(let it=Math.floor(f*u);it<(f+1)*u;it++){let M=Math.abs($-(it+.5))/h;const W=Math.sqrt(N+M*M);if(W<-1||W>1||(v=2*W*W*W-3*W*W+1,v<=0))continue;M=4*(it+G*o);const ot=c[M+3];C+=v*ot,T+=v,ot<255&&(v=v*ot/250),I+=v*c[M],P+=v*c[M+1],_+=v*c[M+2],w+=v}}d[b]=I/w,d[b+1]=P/w,d[b+2]=_/w,d[b+3]=C/T}e(null,{data:d,width:s,height:l})},Xy=t=>{if(t instanceof ImageData)return t;let e;try{e=new ImageData(t.width,t.height)}catch{e=fi("canvas").getContext("2d").createImageData(t.width,t.height)}return e.data.set(t.data),e},Yb=async(t,e={},n)=>{const{width:i,height:r,fit:o,upscale:a}=e;if(!i&&!r)return t;let s=i,l=r;if(i?r||(l=i):s=r,o!=="force"){const c=s/t.width,d=l/t.height;let u=1;if(o==="cover"?u=Math.max(c,d):o==="contain"&&(u=Math.min(c,d)),u>1&&a===!1)return t;s=Math.round(t.width*u),l=Math.round(t.height*u)}return s=Math.max(s,1),l=Math.max(l,1),t.width===s&&t.height===l?t:n?n(t,s,l):(t=await ju(qb,[{imageData:t,width:s,height:l}],[t.data.buffer]),Xy(t))},Kb=(t,e)=>{const{imageData:n,matrix:i}=t;if(!i)return e(null,n);const r=new Uint8ClampedArray(n.width*n.height*4),o=n.data,a=o.length,s=i[0],l=i[1],c=i[2],d=i[3],u=i[4],p=i[5],h=i[6],y=i[7],m=i[8],f=i[9],b=i[10],v=i[11],w=i[12],T=i[13],I=i[14],P=i[15],_=i[16],C=i[17],F=i[18],G=i[19];let O=0,$=0,N=0,it=0,M=0,W=0,ot=0,at=0,q=0,ct=0,V=0,ut=0;for(;O<a;O+=4)$=o[O]/255,N=o[O+1]/255,it=o[O+2]/255,M=o[O+3]/255,W=$*s+N*l+it*c+M*d+u,ot=$*p+N*h+it*y+M*m+f,at=$*b+N*v+it*w+M*T+I,q=$*P+N*_+it*C+M*F+G,ct=Math.max(0,W*q)+(1-q),V=Math.max(0,ot*q)+(1-q),ut=Math.max(0,at*q)+(1-q),r[O]=255*Math.max(0,Math.min(1,ct)),r[O+1]=255*Math.max(0,Math.min(1,V)),r[O+2]=255*Math.max(0,Math.min(1,ut)),r[O+3]=255*M;e(null,{data:r,width:n.width,height:n.height})},Jb=(t,e)=>{const{imageData:n,matrix:i}=t;if(!i)return e(null,n);let r=i.reduce((C,F)=>C+F);r=r<=0?1:r;const o=n.width,a=n.height,s=n.data;let l=0,c=0,d=0;const u=Math.round(Math.sqrt(i.length)),p=Math.floor(u/2);let h=0,y=0,m=0,f=0,b=0,v=0,w=0,T=0,I=0,P=0;const _=new Uint8ClampedArray(o*a*4);for(d=0;d<a;d++)for(c=0;c<o;c++){for(h=0,y=0,m=0,f=0,v=0;v<u;v++)for(b=0;b<u;b++)w=d+v-p,T=c+b-p,w<0&&(w=a-1),w>=a&&(w=0),T<0&&(T=o-1),T>=o&&(T=0),I=4*(w*o+T),P=i[v*u+b],h+=s[I]*P,y+=s[I+1]*P,m+=s[I+2]*P,f+=s[I+3]*P;_[l]=h/r,_[l+1]=y/r,_[l+2]=m/r,_[l+3]=f/r,l+=4}e(null,{data:_,width:o,height:a})},Qb=(t,e)=>{let{imageData:n,strength:i}=t;if(!i)return e(null,n);const r=new Uint8ClampedArray(n.width*n.height*4),o=n.width,a=n.height,s=n.data,l=(N,it)=>(c=N-P,d=it-_,Math.sqrt(c*c+d*d));let c,d,u,p,h,y,m,f,b,v,w,T=0,I=0,P=.5*o,_=.5*a,C=l(0,0);for(i>0?(u=0,p=0,h=0):(i=Math.abs(i),u=1,p=1,h=1),I=0;I<a;I++)for(T=0;T<o;T++)F=4*(T+I*o),G=s,O=r,$=l(T,I)*i/C,y=G[F]/255,m=G[F+1]/255,f=G[F+2]/255,b=G[F+3]/255,v=1-$,w=v*b+$,O[F]=(v*b*y+$*u)/w*255,O[F+1]=(v*b*m+$*p)/w*255,O[F+2]=(v*b*f+$*h)/w*255,O[F+3]=255*w;var F,G,O,$;e(null,{data:r,width:n.width,height:n.height})},tv=(t,e)=>{const{imageData:n,level:i,monochrome:r=!1}=t;if(!i)return e(null,n);const o=new Uint8ClampedArray(n.width*n.height*4),a=n.data,s=a.length;let l,c,d,u=0;const p=()=>255*(2*Math.random()-1)*i,h=r?()=>{const y=p();return[y,y,y]}:()=>[p(),p(),p()];for(;u<s;u+=4)[l,c,d]=h(),o[u]=a[u]+l,o[u+1]=a[u+1]+c,o[u+2]=a[u+2]+d,o[u+3]=a[u+3];e(null,{data:o,width:n.width,height:n.height})},ev=(t,e)=>{const{imageData:n,level:i}=t;if(!i)return e(null,n);const r=new Uint8ClampedArray(n.width*n.height*4),o=n.data,a=o.length;let s,l,c,d=0;for(;d<a;d+=4)s=o[d]/255,l=o[d+1]/255,c=o[d+2]/255,r[d]=255*Math.pow(s,i),r[d+1]=255*Math.pow(l,i),r[d+2]=255*Math.pow(c,i),r[d+3]=o[d+3];e(null,{data:r,width:n.width,height:n.height})},nv=async(t,e={})=>{const{colorMatrix:n,convolutionMatrix:i,gamma:r,noise:o,vignette:a}=e,s=[];if(i&&s.push([Jb,{matrix:i.clarity}]),r>0&&s.push([ev,{level:1/r}]),n&&!(d=>{const u=d.length;let p;const h=u>=20?6:u>=16?5:3;for(let y=0;y<u;y++)if(p=d[y],p===1&&y%h!=0||p!==0&&p!==1)return!1;return!0})(n)&&s.push([Kb,{matrix:n}]),(o>0||o<0)&&s.push([tv,{level:o}]),(a>0||a<0)&&s.push([Qb,{strength:a}]),!s.length)return t;const l=(d,u)=>`(err, imageData) => {
            (${d[u][0].toString()})(Object.assign({ imageData: imageData }, filterInstructions[${u}]), 
                ${d[u+1]?l(d,u+1):"done"})
        }`,c=`function (options, done) {
        const filterInstructions = options.filterInstructions;
        const imageData = options.imageData;
        (${l(s,0)})(null, imageData)
    }`;return t=await ju(c,[{imageData:t,filterInstructions:s.map(d=>d[1])}],[t.data.buffer]),Xy(t)},dn=t=>typeof t=="number",Fu=t=>Qe(t)&&t.match(/(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|\ud83c[\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|\ud83c[\ude32-\ude3a]|\ud83c[\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|\u25b6|\u25c0|[\u25fb-\u25fe]|\u00a9|\u00ae|\u2122|\u2139|\ud83c\udc04|[\u2600-\u26FF]|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]|\ud83c\udccf|\u2934|\u2935|[\u2190-\u21ff])/g)!==null,Ee=(t,e)=>t.hasOwnProperty(e),qi=t=>Array.isArray(t);let Xm=64,Ep=102,qm=112,Ym=!1;var qy=(t,e)=>(!Ym&&ir()&&(/^win/i.test(navigator.platform)&&(Ep=103),(Io()||qu())&&(Xm=63.5,Ep=110,qm=123),Ym=!0),`<svg${e?` aria-label="${e}"`:""} width="128" height="128" viewBox="0 0 128 128" preserveAspectRatio="xMinYMin meet" xmlns="http://www.w3.org/2000/svg"><text x="${Xm}" y="${Ep}" alignment-baseline="text-top" dominant-baseline="text-top" text-anchor="middle" font-size="${qm}px">${t}</text></svg>`),jl=t=>t instanceof Blob,Ur=(t,e)=>t/e*100+"%",Lr=t=>`rgba(${Math.round(255*t[0])}, ${Math.round(255*t[1])}, ${Math.round(255*t[2])}, ${dn(t[3])?t[3]:1})`,bu=t=>Object.values(t).join("_");const Yy=async(t,e=0)=>{const n=fi("canvas",{width:80,height:80}).getContext("2d");return await((i=0)=>new Promise(r=>{setTimeout(r,i)}))(e),n.drawImage(t,0,0,80,80),!((i=>!new Uint32Array(i.getImageData(0,0,i.canvas.width,i.canvas.height).data.buffer).some(r=>r!==0))(n)&&e<=256)||await Yy(t,e+16)},Km=new Map;var iv=t=>new Promise((e,n)=>{const i=new FileReader;i.onerror=()=>n(i.error),i.onload=()=>e(i.result),i.readAsDataURL(t)}),za=()=>{let t=[];return{sub:(e,n)=>(t.push({event:e,callback:n}),()=>t=t.filter(i=>i.event!==e||i.callback!==n)),pub:(e,n)=>{t.filter(i=>i.event===e).forEach(i=>i.callback(n))}}};const _a=32,Yh=({color:t=[0,0,0],fontSize:e=16,fontFamily:n="sans-serif",fontVariant:i="normal",fontWeight:r="normal",fontStyle:o="normal",textAlign:a="left",letterSpacing:s="normal",lineHeight:l=20},c=1)=>`font-size:${e*c}px;font-style:${o};font-weight:${r};font-family:${n};font-variant:${i};line-height:${l*c}px;text-align:${a};letter-spacing:${dn(s)?s+"px":"normal"};color:${Lr(t)};`,Kh=(t,e,n=1)=>{const{width:i,height:r,disableNewline:o}=e,a=!i,s=o===!1?((d="")=>d.split(`
`).length)(t):void 0,l=a?"normal":"break-word",c=a&&!s?"nowrap":"pre-line";return`max-width:none;min-width:auto;width:${a?"auto":i*n+"px"};height:${r?r*n+"px":"auto"};margin-top:0;margin-bottom:0;padding-top:${(({fontSize:d=16,lineHeight:u=20}={})=>.5*Math.max(0,d-u))(e)*n}px;word-break:${l};word-wrap:normal;white-space:${c};`},Jm=new Map,Ky=t=>{const e=[];for(const n of Array.from(t.childNodes))n.nodeType===Node.TEXT_NODE?e.push(rv(n)):e.push(...Ky(n));return e},Jy="pointer-events:none;visibility:hidden;position:absolute;left:0;top:0;",rv=t=>{const e=t.nodeValue;if(!e)return[];const n=e.length,i=document.createRange();i.selectNodeContents(t);const r=[];for(let a=0;a<n;a++){i.setStart(t,0),i.setEnd(t,a+1);const s=i.getClientRects().length-1,l=e.charAt(a);r[s]?r[s]+=l:r.push(l)}const o=i.getClientRects();return r.map((a,s)=>({rect:o[s],text:a}))},Qm=new Map,Do=(t="",e)=>{const{width:n=0,height:i=0}=e;if(n&&i)return sr(n,i);let{fontSize:r=16,fontFamily:o,lineHeight:a=20,fontWeight:s,fontStyle:l,fontVariant:c,letterSpacing:d}=e;const u=bu({text:t,fontFamily:o,fontWeight:s,fontStyle:l,fontVariant:c,fontSize:r,letterSpacing:d,lineHeight:a,width:n});let p=Qm.get(u);if(p)return p;let h=1;r>1e3&&va()&&(h=r/1e3,r=1e3,a/=h);const y=jh(fi("pre",{contenteditable:"true",spellcheck:"false",style:`${Jy}${Yh({...e,fontSize:r,lineHeight:a})};${Kh(t,e)}"`,innerHTML:t})).getBoundingClientRect();return p=Wa(y),p=cs(p,m=>m*h),n&&(p.width=n),Qm.set(u,p),p},tg=new Map,ov=(t,e)=>new Promise((n,i)=>{let r=tg.get(t);r===void 0&&(r=((o,a)=>{const{sub:s,pub:l}=za();let c,d;return Promise.resolve(a&&a(o,{resourceType:"stylesheet"})).then(u=>{if(u===!1)return d="requestPrevented",l("error",d);const{headers:p,credentials:h}=u||{};fetch(o,{headers:p,credentials:h}).then(y=>y.text()).then(y=>{c=y,l("load",c)}).catch(y=>{d=y,l("error",d)})}),{sub:(u,p)=>u==="load"&&c?p(c):u==="error"&&d?p(d):void s(u,p)}})(t,e),tg.set(t,r)),r.sub("load",n),r.sub("error",i)}),eg=async(t,e,n)=>{let i;try{i=await ov(t,e)}catch{return[]}const r={innerHTML:i,id:ba()};n&&(r.nonce=n);const o=fi("style",r);document.head.append(o);const a=Array.from(document.styleSheets).find(s=>s.ownerNode.id===o.id);return o.remove(),Array.from(a.cssRules)},Ll=new Map,av=async(t,e,n)=>{if(Ll.has(t.href))return Ll.get(t.href);let i;try{i=Array.from(t.cssRules);for(const r of(o=>o.filter(a=>a instanceof CSSImportRule))(i)){const o=r.href;if(Ll.has(o)){const s=Ll.get(o);i=[...i,...s];continue}const a=await eg(o,e,n);Ll.set(o,a),i=[...i,...a]}}catch{const o=t.href;i=await eg(o,e,n),Ll.set(o,i)}return(r=>r.filter(o=>o instanceof CSSFontFaceRule))(i)},Qy=(t,e)=>t.style.getPropertyValue(e),sv=(t,e)=>t.style?Qy(t,"font-family").replace(/^"|"$/g,"")==e:!1,lv=async(t,e,n)=>{const i=((r,o)=>{const a=[];for(const s of r)sv(s,o)&&a.push(s);return a})(await(async(r,o)=>{const a=Array.from(document.styleSheets).map(c=>av(c,r,o)),s=await Promise.all(a),l=[];return s.forEach(c=>l.push(...c)),l})(e,n),t);return i.length?i.map(r=>{const o=r.parentStyleSheet&&r.parentStyleSheet.href&&new URL(r.parentStyleSheet.href),a=o?o.origin+(c=>c.pathname.split("/").slice(0,-1).join("/"))(o)+"/":"",s=r.style.getPropertyValue("src").match(/url\("?(.*?)"?\)/)[1],l=Array.from(r.style).filter(c=>c!="src").reduce((c,d)=>c+=d+":"+Qy(r,d)+";","");return[/^http/.test(s)?s:a+s,l]}):[]},ng=new Map,ig=new Map;var t2=async(t="",e)=>{if(!t.length)return;let{color:n,imageWidth:i=300,imageHeight:r=150,paddingTop:o=0,paddingRight:a=_a,paddingBottom:s=0,paddingLeft:l=_a,fontFamily:c,fontSize:d,pixelRatio:u=1,willRequest:p,outline:h,blur:y,styleNonce:m}=e,f=1,b="";d>1e3&&va()&&(f=d/1e3,b=`transform-origin:0 0;transform:scale(${f})`);const v=u/f,w=(i+l+a)*u,T=(r+s+o)*u,I=await(async($,N,it)=>{if(ng.get($))return;let M=ig.get($);if(!M){const ot=await lv($,N,it);if(!ot.length)return void ng.set($,!0);const at=[];for(const[q,ct]of ot){const V=await fetch(q).then(K=>K.blob()),ut=!(W=V.type)||/woff2/.test(W)?"woff2":/woff/.test(W)?"woff":/ttf|truetype/.test(W)?"truetype":/otf|opentype/.test(W)?"opentype":/svg/.test(W)?"svg":"woff2",bt=await iv(V);at.push(`@font-face { src:url(${bt}) format('${ut}');${ct};font-display:block; }`)}M=at.join(""),ig.set($,M)}var W;return M})(c,p,m);let P="";I&&(P=`<style${m?` nonce="${m}"`:""}>${I}</style>`);const _=t.replace(/%/g,"%25").replace(/#/g,"%23").replace(/&nbsp;/g," ").replace(/&(?!#\d{4};|[a-z]+;)/gi,"&amp;").replace(/<br>|\n/g,"<br/>"),C=`top:${o*v}px;right:${a*v}px;bottom:${s*v}px;left:${l*v}px`;let F=n,G="",O="";if(h||y){const $=Lr(n);h&&(F=[0,0,0,0],G=`-webkit-text-stroke: ${2*h*v}px ${$}`),y&&(Ba()?O=`filter:blur(${y*v*.4}px)`:(F=[0,0,0,0],O=`text-shadow: 0 0 ${y*v}px ${$}`))}return(($,{safariCacheKey:N="*"}={})=>new Promise((it,M)=>{const W=new Image;W.onerror=()=>M(new Error("Failed to load SVG")),W.onload=()=>{if(!Ba()||!$.includes("@font-face")||Km.has(N))return it(W);Yy(W).then(()=>{Km.set(N,!0),it(W)})},W.src="data:image/svg+xml,"+$}))(`<svg xmlns="http://www.w3.org/2000/svg" width="${w}" height="${T}" viewBox="0 0 ${w} ${T}"><foreignObject x="0" y="0" width="${w}" height="${T}"><div xmlns="http://www.w3.org/1999/xhtml">${P}<pre contenteditable="true" spellcheck="false" style="position:absolute;${C};${Yh({...e,color:F,fontSize:d},v)};${Kh(t,e,v)};${b};${G};${O}">${_}</pre></div></foreignObject></svg>`,{safariCacheKey:c})};const Li=t=>{const e={...t};return Cy(e)},rg=(t,e={})=>{const n=lr(t);let i,r;const o=e.width||e.rx,a=e.height||e.ry;if(o&&a)return co(e);if(o||a){i=parseFloat(o||Number.MAX_SAFE_INTEGER),r=parseFloat(a||Number.MAX_SAFE_INTEGER);const s=Math.min(i,r);Qe(o)||Qe(a)?(i=s+"%",r=s*n+"%"):(i=s,r=s)}else i="10%",r=10*n+"%";return{[(e.width?"width":e.rx?"rx":void 0)||"width"]:i,[(e.width?"height":e.rx?"ry":void 0)||"height"]:r}},og=(t,e={})=>{return{width:void 0,height:void 0,...e,aspectRatio:1,backgroundImage:(n=qy(t),"data:image/svg+xml,"+n.replace("<","%3C").replace(">","%3E"))};var n},ag=(t,e={})=>({backgroundColor:[0,0,0,0],...er(e)?{}:{width:void 0,height:void 0,aspectRatio:void 0},...e,backgroundImage:Qe(t)?t:jl(t)?URL.createObjectURL(t):t}),sg=(t,e)=>{let n;if(Qe(t)||jl(t)){const i={...rg(e),backgroundSize:"contain"};n=Fu(t)?og(t,i):ag(t,i)}else if(t.src){const i=rg(e,t.shape||t),r={...t.shape,...i};if(t.width&&t.height&&!Ee(r,"aspectRatio")){const o=bh(i,"width",e),a=bh(i,"height",e);r.aspectRatio=as(o,a)}r.backgroundSize||t.shape||t.width&&t.height||(r.backgroundSize="contain"),n=Fu(t.src)?og(t.src,r):ag(t.src,r)}else t.shape&&(n=Li(t.shape));return Ee(n,"backgroundImage")&&(Ee(n,"backgroundColor")||(n.backgroundColor=[0,0,0,0]),Ee(n,"disableStyle")||(n.disableStyle=["cornerRadius","backgroundColor","strokeColor","strokeWidth"])),e?Ai(n,e):n},rs=t=>pt(t.x1,t.y1),os=t=>pt(t.x2,t.y2),tr=t=>Ee(t,"text"),_u=t=>tr(t)&&!(Yu(t)||Ee(t,"width")),vu=t=>tr(t)&&(Yu(t)||Ee(t,"width")),ko=t=>!tr(t)&&cv(t),er=t=>Ee(t,"rx"),ar=t=>Ee(t,"x1"),Ni=t=>Ee(t,"points"),is=t=>tr(t)&&t.isEditing,tu=t=>!Ee(t,"opacity")||t.opacity>0,$a=t=>t.isSelected,Pp=t=>t.isEditing,lo=t=>t._isDraft,al=t=>Ee(t,"width")&&Ee(t,"height"),e2=t=>{const e=Ee(t,"right"),n=Ee(t,"bottom");return e||n},Yu=t=>(Ee(t,"x")||Ee(t,"left"))&&Ee(t,"right")||(Ee(t,"y")||Ee(t,"top"))&&Ee(t,"bottom"),cv=t=>al(t)||Yu(t),mh=t=>(t._isDraft=!0,t),lg=t=>(t._isDraft=!1,t),gh=(t,e)=>t.disableStyle!==!0&&(!qi(t.disableStyle)||!e||!t.disableStyle.includes(e)),ga=t=>t.disableSelect!==!0,Ip=t=>t.disableRemove!==!0,cg=t=>t.disableDuplicate!==!0&&cl(t),dv=t=>!t.disableFlip&&!lo(t)&&!e2(t)&&(e=>Ee(e,"backgroundImage")||Ee(e,"text"))(t),Ol=(t,e)=>!!tr(t)&&t.disableInput!==!0&&(Si(t.disableInput)?t.disableInput(e??t.text):e||!0),el=(t,e)=>t.disableTextLayout!==!0&&(!qi(t.disableTextLayout)||!e||!t.disableTextLayout.includes(e)),Rp=t=>n2(t)&&t.points.length>3,n2=t=>!!Ni(t)&&t.disableAddPoints!==void 0&&t.disableAddPoints!==!0,fh=t=>t.disableManipulate!==!0&&!lo(t)&&!e2(t),cl=t=>fh(t)&&t.disableMove!==!0,$h=t=>(delete t.left,delete t.right,delete t.top,delete t.bottom,t),dg=t=>(delete t.rotation,t),ug=t=>(t.strokeWidth=t.strokeWidth||1,t.strokeColor=t.strokeColor||[0,0,0],t),pg=t=>(t.backgroundColor=t.backgroundColor?t.backgroundColor:t.strokeWidth||t.backgroundImage?void 0:[0,0,0],t),hg=t=>{let e=t.text;e=e.replace(/&(#[0-9]+|[a-z]+);/gi,(n,i)=>`___${i}___`),e=e.replace(/&/,"&amp;"),t.text=e.replace(/___(#[0-9]+|[a-z]+)___/gi,(n,i)=>`&${i};`)},uv=t=>{if(t.fontSize=t.fontSize||"4%",t.fontFamily=t.fontFamily||"sans-serif",t.fontWeight=t.fontWeight||"normal",t.fontStyle=t.fontStyle||"normal",t.fontVariant=t.fontVariant||"normal",t.lineHeight=t.lineHeight||"120%",t.color=t.color||[0,0,0],t.format=t.format==="html"?"html":"text",t.textShadow){const[e,n,i,r]=t.textShadow;t.textShadowX=e,t.textShadowY=n,t.textShadowBlur=i,t.textShadowColor=r,delete t.textShadow}if(t.textOutline){const[e,n]=t.textOutline;t.textOutlineWidth=e,t.textOutlineColor=n,delete t.textOutline}return t.format==="html"?hg(t):(e=>{hg(e);let n=e.text;n=n.replace(/</g,"&gt;"),n=n.replace(/>/g,"&lt;"),e.text=n})(t),_u(t)?pv(t):hv(t)},pv=t=>(t.disableNewline!==!1&&(delete t.textAlign,t.text=t.text.replace(/\n/g," ")),$h(t)),hv=t=>(t.textAlign=t.textAlign||"left",t),i2=t=>((e=>{Qe(e.id)||(e.id=ba()),Ee(e,"rotation")||(e.rotation=0),Ee(e,"opacity")||(e.opacity=1),Ee(e,"disableErase")||(e.disableErase=!0)})(t),tr(t)?uv(t):ko(t)?(e=>{e.cornerRadius=e.cornerRadius||0,e.strokeWidth=e.strokeWidth||0,e.strokeColor=e.strokeColor||[0,0,0],pg(e)})(t):Ni(t)?(e=>{ug(e),dg(e),Ee(e,"pathClose")||(e.disableResize=!0,Ee(e,"disableMove")||(e.disableMove=!0)),$h(e)})(t):ar(t)?(e=>{ug(e),e.lineStart=e.lineStart||void 0,e.lineEnd=e.lineEnd||void 0,dg(e),$h(e)})(t):er(t)&&(e=>{e.strokeWidth=e.strokeWidth||0,e.strokeColor=e.strokeColor||[0,0,0],pg(e)})(t),t),mv=t=>tr(t)?"text":ko(t)?"rectangle":Ni(t)?"path":ar(t)?"line":er(t)?"ellipse":void 0,yh=(t,e)=>parseFloat(t)/100*e,gv=new RegExp(/^x|left|right|^width|rx|fontSize|eraseRadius|feather|cornerRadius|strokeWidth|strokeDash/,"i"),fv=new RegExp(/^y|top|bottom|^height|ry/,"i"),Jh=(t,e,{width:n,height:i})=>{if(Array.isArray(e))return e.map(o=>(Fs(o)&&r2(o,{width:n,height:i}),Qe(o)&&(o=Jh(t,o,{width:n,height:i})),o));if(typeof e!="string"||!e.endsWith("%"))return e;const r=parseFloat(e)/100;return gv.test(t)?en(n*r,6):fv.test(t)?en(i*r,6):e},$v=Jh,yv=["lineHeight","textOutlineWidth","textShadowX","textShadowY","textShadowBlur"],r2=(t,e)=>{Object.entries(t).map(([n,i])=>{t[n]=Jh(n,i,e)}),t.text&&yv.filter(n=>Qe(t[n])).forEach(n=>{var i,r;t[n]=(i=t[n],r=t.fontSize,Math.round(r*(parseFloat(i)/100)))})},Ai=(t,e)=>(r2(t,e),s2(t,e),t),xh=(t,e)=>{let n;return/^x|width|rx|fontSize|strokeWidth|cornerRadius/.test(t)?n=e.width:/^y|height|ry/.test(t)&&(n=e.height),n},bh=(t,e,n)=>Array.isArray(t[e])?t[e].map(i=>Object.entries(i).reduce((r,[o,a])=>(r[o]=Qe(a)?yh(a,xh(o,n)):a,r),{})):Qe(t[e])?yh(t[e],xh(e,n)):t[e],Wl=(t,e,n)=>e.reduce((i,r)=>{const o=bh(t,r,n);return i[r]=o,i},{}),Da=(t,e,n)=>(Object.keys(e).forEach(i=>((r,o,a,s)=>{if(!Qe(r[o]))return r[o]=a,r;const l=xh(o,s);return r[o]=l===void 0?a:Ur(a,l),r})(t,i,e[i],n)),t),o2=(t,e)=>{const n=t.filter(i=>i.x<0||i.y<0||i.x1<0||i.y1<0).reduce((i,r)=>{const[o,a,s,l]=(c=>{const d=Cs(),u=c.strokeWidth||0;if(ko(c))d.x=c.x-.5*u,d.y=c.y-.5*u,d.width=c.width+u,d.height=c.height+u;else if(ar(c)){const{x1:p,y1:h,x2:y,y2:m}=c,f=Math.abs(Math.min(p,y)),b=Math.abs(Math.max(p,y)),v=Math.abs(Math.min(h,m)),w=Math.abs(Math.min(h,m));d.x=f+.5*u,d.y=b+.5*u,d.width=b-f+u,d.height=w-v+u}else er(c)&&(d.x=c.x-c.rx+.5*u,d.y=c.y-c.ry+.5*u,d.width=2*c.rx+u,d.height=2*c.ry+u);return d&&Ee(c,"rotation")&&$r(d,c.rotation),pl(d)})(r);return i.top=Math.min(o,i.top),i.left=Math.min(l,i.left),i.bottom=Math.max(s,i.bottom),i.right=Math.max(a,i.right),i},{top:0,right:0,bottom:0,left:0});return n.right>0&&(n.right-=e.width),n.bottom>0&&(n.bottom-=e.height),n},a2=(t,e,n)=>{const i=Li(t);Ai(i,e);const r=n(i);return Array.isArray(r)?r:[r]},s2=(t,e)=>{if(Ee(t,"left")&&(t.x=t.left),Ee(t,"right")&&!Qe(t.right)){const n=e.width-t.right;Ee(t,"left")?(t.x=t.left,t.width=Math.max(0,n-t.left)):Ee(t,"width")&&(t.x=n-t.width)}if(Ee(t,"top")&&(t.y=t.top),Ee(t,"bottom")&&!Qe(t.bottom)){const n=e.height-t.bottom;Ee(t,"top")?(t.y=t.top,t.height=Math.max(0,n-t.top)):Ee(t,"height")&&(t.y=n-t.height)}return t},l2=(t,e)=>(Ni(t)&&t.points.filter(n=>dn(n.x)).forEach(n=>{n.x*=e,n.y*=e}),ar(t)&&dn(t.x1)&&(t.x1*=e,t.y1*=e,t.x2*=e,t.y2*=e),dn(t.x)&&dn(t.y)&&(t.x*=e,t.y*=e),dn(t.width)&&dn(t.height)&&(t.width*=e,t.height*=e),dn(t.rx)&&dn(t.ry)&&(t.rx*=e,t.ry*=e),(n=>dn(n.strokeWidth)&&n.strokeWidth>0)(t)&&(t.strokeWidth*=e),tr(t)&&(t._scale=e,dn(t.fontSize)&&(t.fontSize*=e),dn(t.lineHeight)&&(t.lineHeight*=e),dn(t.width)&&!dn(t.height)&&(t.width*=e)),Ee(t,"cornerRadius")&&dn(t.cornerRadius)&&(t.cornerRadius*=e),t),c2=t=>{if(ko(t))return pt(t.x+.5*t.width,t.y+.5*t.height);if(er(t))return pt(t.x,t.y);if(t.text){if(vu(t)){const n=t.height||Do(t.text,t).height;return pt(t.x+.5*t.width,t.y+.5*n)}const e=Do(t.text,t);return pt(t.x+.5*e.width,t.y+.5*e.height)}return Ni(t)?zo(t.points):ar(t)?zo([rs(t),os(t)]):void 0};var ed=t=>/canvas/i.test(t.nodeName),xv=(t,e)=>new Promise((n,i)=>{let r=t,o=!1;const a=()=>{o||(o=!0,Si(e)&&Promise.resolve().then(()=>e(sr(r.naturalWidth,r.naturalHeight))))};if(r.src||(r=new Image,Qe(t)&&new URL(t,location.href).origin!==location.origin&&(r.crossOrigin="anonymous"),r.src=Qe(t)?t:URL.createObjectURL(t)),r.complete)return a(),n(r);Si(e)&&Wy(r).then(a).catch(i),r.onload=()=>{a(),n(r)},r.onerror=()=>i(new Error("Failed to load image"))});const mg=new Map([]),Qh=(t,e={})=>new Promise((n,i)=>{const{onMetadata:r=ae,onLoad:o=n,onError:a=i,onComplete:s=ae}=e;let l=mg.get(t);if(l||(l={loading:!1,complete:!1,error:!1,image:void 0,size:void 0,bus:za()},mg.set(t,l)),l.bus.sub("meta",r),l.bus.sub("load",o),l.bus.sub("error",a),l.bus.sub("complete",s),ed(t)){const c=t,d=c.cloneNode();l.complete=!0,l.image=d,l.size=Dc(c)}if(l.complete)return l.bus.pub("meta",{size:l.size}),l.error?l.bus.pub("error",l.error):l.bus.pub("load",l.image),l.bus.pub("complete"),void(l.bus=za());l.loading||(l.loading=!0,xv(t,c=>{l.size=c,l.bus.pub("meta",{size:c})}).then(c=>{l.image=c,l.bus.pub("load",c)}).catch(c=>{l.error=c,l.bus.pub("error",c)}).finally(()=>{l.complete=!0,l.loading=!1,l.bus.pub("complete"),l.bus=za()}))}),bv=(t,e,n,i)=>t.drawImage(e,n.x,n.x,n.width,n.height,i.x,i.y,i.width,i.height);var d2=async(t,e,n,i,r=bv,o)=>{t.save(),t.clip(),await r(t,e,n,i,o),t.restore()};const Du=(t,e,n,i,r)=>{const o=Mn(t);if(i){const s=Bo(Vi(i),en);return s.x*=n.width,s.width*=n.width,s.y*=n.height,s.height*=n.height,{srcRect:s,destRect:o}}const a=Ci(0,0,n.width,n.height);if(e==="contain"){const s=Kr(t,lr(a));o.width=s.width,o.height=s.height,r?(o.x+=r.x,o.y+=r.y):(o.x+=s.x,o.y+=s.y)}else if(e==="cover"){const s=Ls(o,a.width/a.height);o.width=s.width,o.height=s.height,r?(o.x+=r.x,o.y+=r.y):(o.x+=s.x,o.y+=s.y)}else e?(o.width=e.width,o.height=e.height,r&&(o.x+=r.x,o.y+=r.y)):r&&(o.width=n.width,o.height=n.height,o.x+=r.x,o.y+=r.y);return{srcRect:a,destRect:o}},Ap=(t,e)=>(e.cornerRadius>0?((n,i,r,o,a,s)=>{o<2*s&&(s=o/2),a<2*s&&(s=a/2),n.beginPath(),n.moveTo(i+s,r),n.arcTo(i+o,r,i+o,r+a,s),n.arcTo(i+o,r+a,i,r+a,s),n.arcTo(i,r+a,i,r,s),n.arcTo(i,r,i+o,r,s),n.closePath()})(t,e.x,e.y,e.width,e.height,e.cornerRadius):t.rect(e.x,e.y,e.width,e.height),t),gg=(t,e)=>(e.backgroundColor&&t.fill(),t),fg=(t,e)=>(e.strokeWidth&&t.stroke(),t);var t0=async(t,e,n={})=>{const{drawImage:i}=n;if(t.lineWidth=e.strokeWidth?e.strokeWidth:1,t.strokeStyle=e.strokeColor?Lr(e.strokeColor):"none",t.fillStyle=e.backgroundColor?Lr(e.backgroundColor):"none",t.globalAlpha=e.opacity,e.backgroundImage){let r;if(r=ed(e.backgroundImage)?e.backgroundImage:await Qh(e.backgroundImage),Ap(t,e),gg(t,e),e.backgroundRepeat==="repeat"){const o=e.backgroundPosition||{x:0,y:0},{srcRect:a,destRect:s}=Du(e,e.backgroundSize||Dc(r),Dc(r),e.backgroundCorners,{x:0,y:0}),l=document.createElement("canvas");l.width=s.width,l.height=s.height;const c=l.getContext("2d",{willReadFrequently:!1,desynchronized:!0});await i(c,r,a,{...s,x:0,y:0});const d=t.createPattern(l,"repeat");t.fillStyle=d,t.save(),t.beginPath(),t.rect(e.x+o.x,e.y+o.y,e.width-o.x,e.height-o.y),t.clip(),t.translate(s.x+o.x,s.y+o.y),t.fill(),dr(l),t.restore()}else{const{srcRect:o,destRect:a}=Du(e,e.backgroundSize,Dc(r),e.backgroundCorners,e.backgroundPosition);await d2(t,r,o,a,i,{feather:e.feather})}return t.beginPath(),Ap(t,e),fg(t,e),[]}return Ap(t,e),gg(t,e),fg(t,e),[]},e0=async(t,e,n={})=>new Promise(async(i,r)=>{const{drawImage:o}=n;if(t.lineWidth=e.strokeWidth||1,t.strokeStyle=e.strokeColor?Lr(e.strokeColor):"none",t.fillStyle=e.backgroundColor?Lr(e.backgroundColor):"none",t.globalAlpha=e.opacity,t.ellipse(e.x,e.y,e.rx,e.ry,0,0,2*Math.PI),e.backgroundColor&&t.fill(),e.backgroundImage){let a;try{a=await Qh(e.backgroundImage)}catch(d){r(d)}const s=Ci(e.x-e.rx,e.y-e.ry,2*e.rx,2*e.ry),{srcRect:l,destRect:c}=Du(s,e.backgroundSize,Dc(a),e.backgroundCorners,e.backgroundPosition);await d2(t,a,l,c,o),e.strokeWidth&&t.stroke(),i([])}else e.strokeWidth&&t.stroke(),i([])}),vv=async(t,e,n)=>{const i=e.width&&e.height?Wa(e):Do(e.text,e),r={x:e.x,y:e.y,width:i.width,height:i.height};if(t0(t,{...e,...r,options:n}),!e.text.length)return[];const{textOutlineWidth:o=0,textShadowX:a=0,textShadowY:s=0,textShadowBlur:l=0,textShadowColor:c,outline:d,blur:u,...p}=e,h=!!e.height;if(h&&(t.rect(r.x,r.y,r.width,r.height),t.save(),t.clip()),a||s||l){t.save(),t.translate(a,s);const y={...r};h||(y.height+=_a+l),await Lp(t,y,e,{...n,paddingLeft:_a+l,paddingRight:_a+l,paddingTop:l,paddingBottom:l+(h?-1*s:e.fontSize),shapeExtendedProps:{color:c,blur:l}}),t.restore()}if(o){const y={...r};h||(y.height+=_a+o),await Lp(t,y,e,{...n,paddingLeft:_a+o,paddingRight:_a+o,paddingTop:o,paddingBottom:o+h?0:e.fontSize,shapeExtendedProps:{color:e.textOutlineColor,outline:o}})}return h&&t.restore(),await Lp(t,r,p,{...n,paddingLeft:_a,paddingRight:_a,paddingTop:0,paddingBottom:h?0:e.fontSize}),[]};const Lp=async(t,e,n,i)=>{const{willRequest:r,shapeExtendedProps:o,paddingLeft:a,paddingRight:s,paddingTop:l,paddingBottom:c,styleNonce:d}=i,u=await t2(n.text,{...n,...o,...e,paddingLeft:a,paddingRight:s,paddingTop:l,paddingBottom:c,imageWidth:e.width,imageHeight:e.height,willRequest:r,styleNonce:d});t.drawImage(u,n.x-a,n.y-l,u.width,u.height)};var wv=async(t,e)=>new Promise(async n=>{t.lineWidth=e.strokeWidth||1,t.strokeStyle=e.strokeColor?Lr(e.strokeColor):"none",t.globalAlpha=e.opacity,e.bitmap&&(t.lineCap=e.strokeCap,t.lineJoin=e.strokeJoin,t.setLineDash(e.strokeDash||[]));let i=rs(e),r=os(e);t.moveTo(i.x,i.y),t.lineTo(r.x,r.y),e.strokeWidth&&t.stroke(),n([])}),vh=async(t,e)=>new Promise((n,i)=>{if(e.bitmap&&e.points.length===1)return void e0(t,{x:e.points[0].x,y:e.points[0].y,rx:.5*e.strokeWidth,ry:.5*e.strokeWidth,backgroundColor:e.strokeColor}).then(()=>n([]));t.lineWidth=e.strokeWidth||1,t.strokeStyle=e.strokeColor?Lr(e.strokeColor):"none",t.fillStyle=e.backgroundColor?Lr(e.backgroundColor):"none",t.globalAlpha=e.opacity;const{points:r}=e;e.bitmap&&(t.lineCap=e.strokeCap,t.lineJoin=e.strokeJoin,t.setLineDash(e.strokeDash||[])),e.pathClose&&t.beginPath(),t.moveTo(r[0].x,r[0].y);const o=r.length;for(let a=1;a<o;a++)t.lineTo(r[a].x,r[a].y);e.pathClose&&t.closePath(),e.strokeWidth&&t.stroke(),e.backgroundColor&&t.fill(),n([])}),u2=(t,e,n,i)=>((e||n)&&(t.translate(i.x,i.y),t.scale(e?-1:1,n?-1:1),t.translate(-i.x,-i.y)),t);const Sv=async(t,e,n)=>{t.globalCompositeOperation=e.drawMode==="subtract"?"destination-out":"source-over";const i=c2(e);let r;if(qh(t,e.rotation,i),u2(t,e.flipX,e.flipY,i),ko(e)?r=t0:er(e)?r=e0:ar(e)?r=wv:Ni(e)?r=vh:tr(e)&&(r=vv),r){const o=await r(t,e,n);return o.length?[e,...await p2(t,o,n)]:[]}return[]};var p2=async(t,e,n)=>{let i=[];for(const r of e)t.save(),t.beginPath(),i=[...i,...await Sv(t,r,n)],t.restore();return i},n0=async(t,e={})=>{const{shapes:n=[],contextBounds:i=t,transform:r=ae,drawImage:o,willRequest:a,styleNonce:s,canvasMemoryLimit:l,computeShape:c=ni,preprocessShape:d=ni}=e;if(!n.length)return t;const u=fi("canvas");u.width=i.width,u.height=i.height;const p=u.getContext("2d",{willReadFrequently:!0});p.putImageData(t,i.x||0,i.y||0);const h=n.map(Li).map(c).map(d).flat();r(p),await p2(p,h,{drawImage:o,canvasMemoryLimit:l,willRequest:a,styleNonce:s});const y=p.getImageData(0,0,u.width,u.height);return dr(u),y},Tv=async(t,e={})=>{const{backgroundColor:n,backgroundImage:i}=e,r=!(!n||n&&n[3]===0);if(!i&&!r)return t;const o=fi("canvas");o.width=t.width,o.height=t.height;const a=o.getContext("2d",{willReadFrequently:!0});if(a.putImageData(t,0,0),a.globalCompositeOperation="destination-over",r&&(a.fillStyle=Lr(n),a.fillRect(0,0,o.width,o.height)),i){let l;l=ed(i)?i:await Qh(i);const{srcRect:c,destRect:d}=Du({x:0,y:0,width:t.width,height:t.height},"cover",{width:l.width,height:l.height});a.drawImage(l,c.x,c.y,c.width,c.height,d.x,d.y,d.width,d.height)}const s=a.getImageData(0,0,o.width,o.height);return dr(o),s},i0=t=>t.length?t.reduce((e,n)=>((i,r)=>{const o=new Array(20);return o[0]=i[0]*r[0]+i[1]*r[5]+i[2]*r[10]+i[3]*r[15],o[1]=i[0]*r[1]+i[1]*r[6]+i[2]*r[11]+i[3]*r[16],o[2]=i[0]*r[2]+i[1]*r[7]+i[2]*r[12]+i[3]*r[17],o[3]=i[0]*r[3]+i[1]*r[8]+i[2]*r[13]+i[3]*r[18],o[4]=i[0]*r[4]+i[1]*r[9]+i[2]*r[14]+i[3]*r[19]+i[4],o[5]=i[5]*r[0]+i[6]*r[5]+i[7]*r[10]+i[8]*r[15],o[6]=i[5]*r[1]+i[6]*r[6]+i[7]*r[11]+i[8]*r[16],o[7]=i[5]*r[2]+i[6]*r[7]+i[7]*r[12]+i[8]*r[17],o[8]=i[5]*r[3]+i[6]*r[8]+i[7]*r[13]+i[8]*r[18],o[9]=i[5]*r[4]+i[6]*r[9]+i[7]*r[14]+i[8]*r[19]+i[9],o[10]=i[10]*r[0]+i[11]*r[5]+i[12]*r[10]+i[13]*r[15],o[11]=i[10]*r[1]+i[11]*r[6]+i[12]*r[11]+i[13]*r[16],o[12]=i[10]*r[2]+i[11]*r[7]+i[12]*r[12]+i[13]*r[17],o[13]=i[10]*r[3]+i[11]*r[8]+i[12]*r[13]+i[13]*r[18],o[14]=i[10]*r[4]+i[11]*r[9]+i[12]*r[14]+i[13]*r[19]+i[14],o[15]=i[15]*r[0]+i[16]*r[5]+i[17]*r[10]+i[18]*r[15],o[16]=i[15]*r[1]+i[16]*r[6]+i[17]*r[11]+i[18]*r[16],o[17]=i[15]*r[2]+i[16]*r[7]+i[17]*r[12]+i[18]*r[17],o[18]=i[15]*r[3]+i[16]*r[8]+i[17]*r[13]+i[18]*r[18],o[19]=i[15]*r[4]+i[16]*r[9]+i[17]*r[14]+i[18]*r[19]+i[19],o})([...e],n),t.shift()):[],h2=(t,e)=>{const n=t.width*t.height,i=e.reduce((o,a)=>(a.width>o.width&&a.height>o.height&&(o.width=a.width,o.height=a.height),o),{width:0,height:0}),r=i.width*i.height;return((o,a=2)=>Math.round(o*a)/a)(Math.max(.5,.5+(1-r/n)/2),5)};function tn(){}const m2=t=>t;function ki(t,e){for(const n in e)t[n]=e[n];return t}function g2(t){return t()}function $g(){return Object.create(null)}function Zn(t){t.forEach(g2)}function Hn(t){return typeof t=="function"}function yn(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function xo(t,...e){if(t==null)return tn;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function xa(t){let e;return xo(t,n=>e=n)(),e}function D(t,e,n){t.$$.on_destroy.push(xo(e,n))}function ur(t,e,n,i){if(t){const r=f2(t,e,n,i);return t[0](r)}}function f2(t,e,n,i){return t[1]&&i?ki(n.ctx.slice(),t[1](i(e))):n.ctx}function pr(t,e,n,i){if(t[2]&&i){const r=t[2](i(n));if(e.dirty===void 0)return r;if(typeof r=="object"){const o=[],a=Math.max(e.dirty.length,r.length);for(let s=0;s<a;s+=1)o[s]=e.dirty[s]|r[s];return o}return e.dirty|r}return e.dirty}function hr(t,e,n,i,r,o){if(r){const a=f2(e,n,i,o);t.p(a,r)}}function mr(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let i=0;i<n;i++)e[i]=-1;return e}return-1}function Xc(t){const e={};for(const n in t)n[0]!=="$"&&(e[n]=t[n]);return e}function yg(t,e){const n={};e=new Set(e);for(const i in t)e.has(i)||i[0]==="$"||(n[i]=t[i]);return n}function At(t,e,n){return t.set(n),e}function qn(t){return t&&Hn(t.destroy)?t.destroy:tn}const $2=typeof window<"u";let y2=$2?()=>window.performance.now():()=>Date.now(),r0=$2?t=>requestAnimationFrame(t):tn;const Vl=new Set;function x2(t){Vl.forEach(e=>{e.c(t)||(Vl.delete(e),e.f())}),Vl.size!==0&&r0(x2)}function o0(t){let e;return Vl.size===0&&r0(x2),{promise:new Promise(n=>{Vl.add(e={c:t,f:n})}),abort(){Vl.delete(e)}}}function Et(t,e){t.appendChild(e)}function b2(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function Cv(t){const e=ft("style");return function(n,i){Et(n.head||n,i),i.sheet}(b2(t),e),e.sheet}function tt(t,e,n){t.insertBefore(e,n||null)}function Q(t){t.parentNode.removeChild(t)}function ft(t){return document.createElement(t)}function Or(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function Mi(t){return document.createTextNode(t)}function pe(){return Mi(" ")}function Ei(){return Mi("")}function St(t,e,n,i){return t.addEventListener(e,n,i),()=>t.removeEventListener(e,n,i)}function Mv(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function S(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function xg(t,e){const n=Object.getOwnPropertyDescriptors(t.__proto__);for(const i in e)e[i]==null?t.removeAttribute(i):i==="style"?t.style.cssText=e[i]:i==="__value"?t.value=t[i]=e[i]:n[i]&&n[i].set?t[i]=e[i]:S(t,i,e[i])}function bg(t,e){Object.keys(e).forEach(n=>{(function(i,r,o){r in i?i[r]=typeof i[r]=="boolean"&&o===""||o:S(i,r,o)})(t,n,e[n])})}function Yi(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function vg(t,e){t.value=e??""}function v2(t,e,{bubbles:n=!1,cancelable:i=!1}={}){const r=document.createEvent("CustomEvent");return r.initCustomEvent(t,n,i,e),r}class w2{constructor(e=!1){this.is_svg=!1,this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,n,i=null){this.e||(this.is_svg?this.e=Or(n.nodeName):this.e=ft(n.nodeName),this.t=n,this.c(e)),this.i(i)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.childNodes)}i(e){for(let n=0;n<this.n.length;n+=1)tt(this.t,this.n[n],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(Q)}}function zu(t,e){return new t(e)}const Bu=new Map;let qc,wu=0;function wg(t,e,n,i,r,o,a,s=0){const l=16.666/i;let c=`{
`;for(let f=0;f<=1;f+=l){const b=e+(n-e)*o(f);c+=100*f+`%{${a(b,1-b)}}
`}const d=c+`100% {${a(n,1-n)}}
}`,u=`__svelte_${function(f){let b=5381,v=f.length;for(;v--;)b=(b<<5)-b^f.charCodeAt(v);return b>>>0}(d)}_${s}`,p=b2(t),{stylesheet:h,rules:y}=Bu.get(p)||function(f,b){const v={stylesheet:Cv(b),rules:{}};return Bu.set(f,v),v}(p,t);y[u]||(y[u]=!0,h.insertRule(`@keyframes ${u} ${d}`,h.cssRules.length));const m=t.style.animation||"";return t.style.animation=`${m?m+", ":""}${u} ${i}ms linear ${r}ms 1 both`,wu+=1,u}function kv(t,e){const n=(t.style.animation||"").split(", "),i=n.filter(e?o=>o.indexOf(e)<0:o=>o.indexOf("__svelte")===-1),r=n.length-i.length;r&&(t.style.animation=i.join(", "),wu-=r,wu||r0(()=>{wu||(Bu.forEach(o=>{const{ownerNode:a}=o.stylesheet;a&&Q(a)}),Bu.clear())}))}function Bc(t){qc=t}function gl(){if(!qc)throw new Error("Function called outside component initialization");return qc}function ds(t){gl().$$.on_mount.push(t)}function S2(t){gl().$$.after_update.push(t)}function Ho(t){gl().$$.on_destroy.push(t)}function la(){const t=gl();return(e,n,{cancelable:i=!1}={})=>{const r=t.$$.callbacks[e];if(r){const o=v2(e,n,{cancelable:i});return r.slice().forEach(a=>{a.call(t,o)}),!o.defaultPrevented}return!0}}function $o(t,e){return gl().$$.context.set(t,e),e}function yi(t){return gl().$$.context.get(t)}function aa(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach(i=>i.call(this,e))}const Rc=[],Nn=[],Su=[],wh=[],T2=Promise.resolve();let Sh=!1;function C2(){Sh||(Sh=!0,T2.then(U))}function M2(){return C2(),T2}function hl(t){Su.push(t)}function Wo(t){wh.push(t)}const Op=new Set;let wc,eu=0;function U(){const t=qc;do{for(;eu<Rc.length;){const e=Rc[eu];eu++,Bc(e),Ev(e.$$)}for(Bc(null),Rc.length=0,eu=0;Nn.length;)Nn.pop()();for(let e=0;e<Su.length;e+=1){const n=Su[e];Op.has(n)||(Op.add(n),n())}Su.length=0}while(Rc.length);for(;wh.length;)wh.pop()();Sh=!1,Op.clear(),Bc(t)}function Ev(t){if(t.fragment!==null){t.update(),Zn(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(hl)}}function Fp(t,e,n){t.dispatchEvent(v2(`${e?"intro":"outro"}${n}`))}const Tu=new Set;let ss;function Te(){ss={r:0,c:[],p:ss}}function Ce(){ss.r||Zn(ss.c),ss=ss.p}function k(t,e){t&&t.i&&(Tu.delete(t),t.i(e))}function A(t,e,n,i){if(t&&t.o){if(Tu.has(t))return;Tu.add(t),ss.c.push(()=>{Tu.delete(t),i&&(n&&t.d(1),i())}),t.o(e)}else i&&i()}const Pv={duration:0};function Sg(t,e,n,i){let r=e(t,n),o=i?0:1,a=null,s=null,l=null;function c(){l&&kv(t,l)}function d(p,h){const y=p.b-o;return h*=Math.abs(y),{a:o,b:p.b,d:y,duration:h,start:p.start,end:p.start+h,group:p.group}}function u(p){const{delay:h=0,duration:y=300,easing:m=m2,tick:f=tn,css:b}=r||Pv,v={start:y2()+h,b:p};p||(v.group=ss,ss.r+=1),a||s?s=v:(b&&(c(),l=wg(t,o,p,y,h,m,b)),p&&f(0,1),a=d(v,y),hl(()=>Fp(t,p,"start")),o0(w=>{if(s&&w>s.start&&(a=d(s,y),s=null,Fp(t,a.b,"start"),b&&(c(),l=wg(t,o,a.b,a.duration,0,m,r.css))),a){if(w>=a.end)f(o=a.b,1-o),Fp(t,a.b,"end"),s||(a.b?c():--a.group.r||Zn(a.group.c)),a=null;else if(w>=a.start){const T=w-a.start;o=a.a+a.d*m(T/a.duration),f(o,1-o)}}return!(!a&&!s)}))}return{run(p){Hn(r)?(wc||(wc=Promise.resolve(),wc.then(()=>{wc=null})),wc).then(()=>{r=r(),u(p)}):u(p)},end(){c(),a=s=null}}}const a0=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function k2(t,e){t.d(1),e.delete(t.key)}function _s(t,e){A(t,1,1,()=>{e.delete(t.key)})}function Va(t,e,n,i,r,o,a,s,l,c,d,u){let p=t.length,h=o.length,y=p;const m={};for(;y--;)m[t[y].key]=y;const f=[],b=new Map,v=new Map;for(y=h;y--;){const P=u(r,o,y),_=n(P);let C=a.get(_);C?i&&C.p(P,e):(C=c(_,P),C.c()),b.set(_,f[y]=C),_ in m&&v.set(_,Math.abs(y-m[_]))}const w=new Set,T=new Set;function I(P){k(P,1),P.m(s,d),a.set(P.key,P),d=P.first,h--}for(;p&&h;){const P=f[h-1],_=t[p-1],C=P.key,F=_.key;P===_?(d=P.first,p--,h--):b.has(F)?!a.has(C)||w.has(C)?I(P):T.has(F)?p--:v.get(C)>v.get(F)?(T.add(C),I(P)):(w.add(F),p--):(l(_,a),p--)}for(;p--;){const P=t[p];b.has(P.key)||l(P,a)}for(;h;)I(f[h-1]);return f}function Tr(t,e){const n={},i={},r={$$scope:1};let o=t.length;for(;o--;){const a=t[o],s=e[o];if(s){for(const l in a)l in s||(i[l]=1);for(const l in s)r[l]||(n[l]=s[l],r[l]=1);t[o]=s}else for(const l in a)r[l]=1}for(const a in i)a in n||(n[a]=void 0);return n}function _r(t){return typeof t=="object"&&t!==null?t:{}}function Ro(t,e,n){const i=t.$$.props[e];i!==void 0&&(t.$$.bound[i]=n,n(t.$$.ctx[i]))}function zt(t){t&&t.c()}function Ft(t,e,n,i){const{fragment:r,after_update:o}=t.$$;r&&r.m(e,n),i||hl(()=>{const a=t.$$.on_mount.map(g2).filter(Hn);t.$$.on_destroy?t.$$.on_destroy.push(...a):Zn(a),t.$$.on_mount=[]}),o.forEach(hl)}function _t(t,e){const n=t.$$;n.fragment!==null&&(Zn(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Sn(t,e,n,i,r,o,a,s=[-1]){const l=qc;Bc(t);const c=t.$$={fragment:null,ctx:[],props:o,update:tn,not_equal:r,bound:$g(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:$g(),dirty:s,skip_bound:!1,root:e.target||l.$$.root};a&&a(c.root);let d=!1;if(c.ctx=n?n(t,e.props||{},(u,p,...h)=>{const y=h.length?h[0]:p;return c.ctx&&r(c.ctx[u],c.ctx[u]=y)&&(!c.skip_bound&&c.bound[u]&&c.bound[u](y),d&&function(m,f){m.$$.dirty[0]===-1&&(Rc.push(m),C2(),m.$$.dirty.fill(0)),m.$$.dirty[f/31|0]|=1<<f%31}(t,u)),p}):[],c.update(),d=!0,Zn(c.before_update),c.fragment=!!i&&i(c.ctx),e.target){if(e.hydrate){const u=function(p){return Array.from(p.childNodes)}(e.target);c.fragment&&c.fragment.l(u),u.forEach(Q)}else c.fragment&&c.fragment.c();e.intro&&k(t.$$.fragment),Ft(t,e.target,e.anchor,e.customElement),U()}Bc(l)}class Tn{$destroy(){_t(this,1),this.$destroy=tn}$on(e,n){if(!Hn(n))return tn;const i=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return i.push(n),()=>{const r=i.indexOf(n);r!==-1&&i.splice(r,1)}}$set(e){var n;this.$$set&&(n=e,Object.keys(n).length!==0)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Fl=[];function zl(t,e){return{subscribe:me(t,e).subscribe}}function me(t,e=tn){let n;const i=new Set;function r(o){if(yn(t,o)&&(t=o,n)){const a=!Fl.length;for(const s of i)s[1](),Fl.push(s,t);if(a){for(let s=0;s<Fl.length;s+=2)Fl[s][0](Fl[s+1]);Fl.length=0}}}return{set:r,update:function(o){r(o(t))},subscribe:function(o,a=tn){const s=[o,a];return i.add(s),i.size===1&&(n=e(r)||tn),o(t),()=>{i.delete(s),i.size===0&&(n(),n=null)}}}}function Vn(t,e,n){const i=!Array.isArray(t),r=i?[t]:t,o=e.length<2;return zl(n,a=>{let s=!1;const l=[];let c=0,d=tn;const u=()=>{if(c)return;d();const h=e(i?l[0]:l,a);o?a(h):d=Hn(h)?h:tn},p=r.map((h,y)=>xo(h,m=>{l[y]=m,c&=~(1<<y),s&&u()},()=>{c|=1<<y}));return s=!0,u(),function(){Zn(p),d()}})}var Iv=t=>t.reduce((e,n)=>Object.assign(e,n),{});const _l=t=>({updateValue:t}),_o=t=>({defaultValue:t}),E2=t=>({store:t}),nu=t=>({store:(e,n)=>Vn(...t(n))}),iu=t=>({store:(e,n)=>{const[i,r,o=()=>!1]=t(n);let a,s=!0;return Vn(i,(l,c)=>{r(l,d=>{!s&&o(a,d)||(a=d,s=!1,c(d))})})}}),Sc=t=>({store:(e,n)=>{const[i,r={},o]=t(n);let a=[];const s={},l=h=>i(h,s),c=h=>{(a.length||h.length)&&(a=h,d())},d=()=>{const h=a.map(l);o&&h.sort(o),a=[...h],p(h)};Object.entries(r).map(([h,y])=>y.subscribe(m=>{s[h]=m,m&&d()}));const{subscribe:u,set:p}=me(e||[]);return{set:c,update:h=>c(h(a)),subscribe:u}}});var Tg=t=>{const e={},n={};return t.forEach(([i,...r])=>{const o=Iv(r),a=e[i]=((l,c,d)=>{const{store:u=T=>me(T),defaultValue:p=ae,updateValue:h}=d,y=u(p(),c,l),{subscribe:m,update:f=ae}=y;let b;const v=T=>{let I=!0;b&&b(),b=m(P=>{if(I)return I=!1;T(P),b(),b=void 0})},w=h?h(l):ni;return y.set=T=>f(I=>w(T,I,v)),y.defaultValue=p,y})(n,e,o),s={get:()=>xa(a),set:a.set};Object.defineProperty(n,i,s)}),{stores:e,accessors:n}},Rv=[["src",E2(()=>{let t;const{subscribe:e,set:n}=me(),i=r=>{t!==r&&(t=r,n(t))};return{set:i,subscribe:e,update:r=>i(r(t))}})],["imageReader"],["imageWriter"],["imageScrambler"],["imageRedactionRendering",_o(()=>"pixelated")],["images",_o(()=>[])],["shapePreprocessor"],["willRequestResource"],["willRequest"],["csp"]],P2=t=>t.charAt(0).toUpperCase()+t.slice(1),Yc=(t,e)=>{Object.keys(e).forEach(n=>{const i=Si(e[n])?{value:e[n],writable:!1}:e[n];Object.defineProperty(t,n,i)})};const Cg=(t,e)=>{let n,i,r,o,a,s,l,c,d,u;const p=e.length;for(n=0;n<p;n++)if(i=e[n],r=e[n+1>p-1?0:n+1],o=i.x-t.x,a=i.y-t.y,s=r.x-t.x,l=r.y-t.y,c=o-s,d=a-l,u=c*a-d*o,u<-1e-5)return!1;return!0};var Mg=(t,e)=>{const n=Dy(e),i=hi();Mo(t).forEach(o=>{nr(o,i),Cg(o,e)||n.forEach(a=>{const s=Math.atan2(a.start.y-a.end.y,a.start.x-a.end.x),l=1e4*Math.sin(Math.PI-s),c=1e4*Math.cos(Math.PI-s),d=pt(o.x+l,o.y+c),u=Hh(Ay(a),1e4),p=Uh(As(o,d),u);p&&nr(i,Oi(Ue(p),o))})});const r=Mn(t);return nr(r,i),!!Mo(r).every(o=>Cg(o,e))&&(Zu(t,r),!0)},I2=(t,e)=>{const n=Mo(t),i=zy(e,5),r=wn(t),o=[];n.forEach(l=>{const c=((u,p)=>{if(p===0)return u;const h=pt(u.start.x-u.end.x,u.start.y-u.end.y),y=bo(h),m=Po(y,p);return u.end.x+=m.x,u.end.y+=m.y,u})(As(Ue(r),Ue(l)),1e6);let d=!1;i.map(Ay).forEach(u=>{const p=Uh(c,u);p&&!d&&(o.push(p),d=!0)})});const a=Yr(o[0],o[2])<Yr(o[1],o[3])?[o[0],o[2]]:[o[1],o[3]],s=Vi(a);return s.width<t.width&&(Zu(t,s),!0)},R2=(t,e,n={x:0,y:0})=>{const i=Fr(t),r=wn(i),o=Oy(i,n,r).map(s=>Gr(s,e,r)),a=Vi(o);return o.map(s=>Oi(s,a))},Bl=(t,e=0,n=lr(t))=>{let i,r;if(e!==0){const o=Math.atan2(1,n),a=Math.sign(e)*e,s=a%Math.PI,l=a%No;let c;c=s>Qo&&s<No+Qo?l>Qo?a:No-l:l>Qo?No-l:a;const d=Math.min(Math.abs(t.height/Math.sin(o+c)),Math.abs(t.width/Math.cos(o-c)));i=Math.cos(o)*d,r=i/n}else i=t.width,r=i/n,r>t.height&&(r=t.height,i=r*n);return sr(i,r)},Av=(t,e,n,i,r,o,a,s)=>{const l=co(a),c=co(s),d=en(Math.max(e.width/c.width,e.height/c.height)),u=en(Math.min(e.width/l.width,e.height/l.height)),p=Mn(e);if(u<1||d>1){const h=wn(t),y=wn(e),m=u<1?u:d,f=(y.x+h.x)/2,b=(y.y+h.y)/2,v=p.width/m,w=p.height/m;Ly(p,f-.5*v,b-.5*w,v,w)}return o?(((h,y,m=0,f=hi(),b)=>{if(dn(m)&&m!==0||f.x||f.y){const v=lr(h),w=R2(y,m,f),T=Bl(y,m,v);if(!(h.width<T.width&&h.height<T.height)){const I=.5*h.width-.5*T.width,P=.5*h.height-.5*T.height;h.width>T.width&&(h.width=T.width,h.x+=I),h.height>T.height&&(h.height=T.height,h.y+=P)}Mg(h,w),I2(h,w)&&Mg(h,w)}else{const v=lr(h);h.width=Math.min(h.width,y.width),h.height=Math.min(h.height,y.height),h.x=Math.max(h.x,0),h.x+h.width>y.width&&(h.x-=h.x+h.width-y.width),h.y=Math.max(h.y,0),h.y+h.height>y.height&&(h.y-=h.y+h.height-y.height);const w=wn(h),T=Kr(h,v);T.width=Math.max(b.width,T.width),T.height=Math.max(b.height,T.height),T.x=w.x-.5*T.width,T.y=w.y-.5*T.height,Zu(h,T)}})(p,n,i,r,l),{crop:p}):{crop:p}},s0=(t,e,n)=>{const i=Fr(t),r=wn(i),o=$r(i,n,r),a=wn(jc(Vi(o))),s=wn(e),l=Gr(s,-n,a),c=Oi(l,a),d=Eo(nr(r,c),en);return Ci(d.x-.5*e.width,d.y-.5*e.height,e.width,e.height)},oi=(t,e,n)=>Math.max(e,Math.min(t,n));const _p=["cropLimitToImage","cropMinSize","cropMaxSize","cropAspectRatio","flipX","flipY","rotation","crop","colorMatrix","convolutionMatrix","gamma","vignette","manipulation","redaction","annotation","decoration","selection","frame","backgroundColor","backgroundImage","targetSize","metadata","trim","volume","minDuration","maxDuration","currentTime"],Th=t=>qi(t)?t.map(Th):Xh(t)||td(t)?t:Fs(t)?{...t}:t,Tc=t=>t.map(e=>Object.entries(e).reduce((n,[i,r])=>(i.startsWith("_")||(n[i]=r),n),{})),Lv=(t,e)=>t===e;var Os=(t,e,n=Lv)=>{if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!n(t[i],e[i]))return!1;return!0};const kg=(t,e,n)=>{const i=Eo(wn(t),d=>en(d,8)),r=Fr(e),o=wn(r),a=$r(r,n,o),s=Eo(ul(Vi(a)),d=>en(d,8)),l=Math.abs(s.x-i.x),c=Math.abs(s.y-i.y);return l<1&&c<1},Ov=(t,e,n,i,r)=>{if(!r)return[-1/0,1/0];const o=Math.max(n.width/i.width,n.height/i.height),a=sr(i.width*o,i.height*o),s=(l=a,Math.sqrt(l.width*l.width+l.height*l.height));var l;if(s<Math.min(t.width,t.height))return[-1/0,1/0];const c=e?t.height:t.width,d=e?t.width:t.height,u=Math.acos(a.height/s),p=u-Math.acos(d/s),h=Math.asin(c/s)-u;if(Number.isNaN(p)&&Number.isNaN(h))return[-1/0,1/0];const y=Number.isNaN(p)?h:Number.isNaN(h)?p:Math.min(p,h);return[-y,y]},Ac=(t,e)=>{const{context:n,props:i}=e;return t._isFormatted||((t=i2(t))._isFormatted=!0,Object.assign(t,i)),t._isDraft||!Yu(t)||t._context&&ea(n,t._context)||(s2(t,n),t._context={...n}),t},Fv=(t,e)=>(t._isFormatted||(t.disableMove=!0,t.disableSelect=!0,t.disableResize=!0,t.disableRotate=!0),Ac(t,e));var l0=[["file"],["size"],["loadState"],["processState"],["aspectRatio",nu(({size:t})=>[t,e=>e?lr(e):void 0])],["perspectiveX",_o(()=>0)],["perspectiveY",_o(()=>0)],["perspective",nu(({perspectiveX:t,perspectiveY:e})=>[[t,e],([n,i])=>({x:n,y:i})])],["rotation",_o(()=>0),_l(t=>(e,n,i)=>{if(e===n)return e;const{loadState:r,size:o,rotationRange:a,cropMinSize:s,cropMaxSize:l,crop:c,perspective:d,cropLimitToImage:u,cropOrigin:p}=t;if(!c||!r||!r.beforeComplete)return e;const h=u&&((f,b,v)=>{const w=Bl(b,v,lr(f));return Gc(cs(w,Math.round),cs(co(f),Math.round))})(c,o,n),y=u&&kg(c,o,n),m=((f,b,v,w,T,I,P,_,C,F)=>{const G=co(C),O=co(F);P&&(O.width=Math.min(F.width,T.width),O.height=Math.min(F.height,T.height));let $=!1;const N=(W,ot)=>{const at=s0(T,w,W),q=Fr(T),ct=wn(q),V=Oy(q,I,ct),ut=Oi(Ue(ct),Um(V)),bt=Gr(wn(at),ot,ct),K=Oi(Ue(ct),bt);V.forEach(gt=>Gr(gt,ot,ct));const vt=Vi(V),X=Um(V),Z=nr(Oi(Oi(X,K),vt),ut),mt=Ci(Z.x-.5*at.width,Z.y-.5*at.height,at.width,at.height);if(_&&Sr(mt,_.width/mt.width),P){const gt=R2(T,ot,I);I2(mt,gt)}const Bt=en(Math.min(mt.width/G.width,mt.height/G.height),8),st=en(Math.max(mt.width/O.width,mt.height/O.height),8);return(Bt<1||st>1)&&en(Math.abs(ot-W))===en(Math.PI/2)&&!$?($=!0,N(f,f+Math.sign(ot-W)*Math.PI)):{rotation:ot,crop:Bo(mt,gt=>en(gt,8))}},it=Math.sign(b)*Math.round(Math.abs(b)/No)*No,M=oi(b,it+v[0],it+v[1]);return N(f,M)})(n,e,a,c,o,d,u,p,s,l);if(h&&y){const f=Bl(o,e,lr(m.crop));m.crop.x+=.5*m.crop.width,m.crop.y+=.5*m.crop.height,m.crop.x-=.5*f.width,m.crop.y-=.5*f.height,m.crop.width=f.width,m.crop.height=f.height}return i(()=>{t.crop=Bo(m.crop,f=>en(f,8))}),m.rotation})],["flipX",_o(()=>!1)],["flipY",_o(()=>!1)],["flip",nu(({flipX:t,flipY:e})=>[[t,e],([n,i])=>({x:n,y:i})])],["isRotatedSideways",iu(({rotation:t})=>[[t],([e],n)=>n(Fa(e)),(e,n)=>e!==n])],["crop",_l(t=>(e,n=e)=>{const{loadState:i,size:r,cropMinSize:o,cropMaxSize:a,cropLimitToImage:s,cropAspectRatio:l,rotation:c,perspective:d}=t;if(!e&&!n||!i||!i.beforeComplete)return e;e||(e=Fr(Bl(r,c,l||lr(r))));const u=Av(n,e,r,c,d,s,o,a),p=Bo(u.crop,h=>en(h,8));return ea(n,p)?n:p})],["cropAspectRatio",_l(t=>(e,n)=>{const{loadState:i,crop:r,size:o,rotation:a,cropLimitToImage:s}=t,l=(d=>{if(d){if(/:/.test(d)){const[u,p]=d.split(":");return u/p}return parseFloat(d)}})(e);if(!l)return;if(!r||!i||!i.beforeComplete)return l;const c=n?Math.abs(e-n):1;if(kg(r,o,a)&&s&&c>=.1){const d=((u,p)=>{const h=u.width,y=u.height;return Fa(p)&&(u.width=y,u.height=h),u})(co(o),a);t.crop=Bo(Kr(Fr(d),e),en)}else{const d={width:r.height*l,height:r.height},u=.5*(r.width-d.width),p=.5*(r.height-d.height);t.crop=Bo(Ci(r.x+u,r.y+p,d.width,d.height),en)}return l})],["cropOrigin"],["cropMinSize",_o(()=>({width:1,height:1}))],["cropMaxSize",_o(()=>({width:32768,height:32768}))],["cropLimitToImage",_o(()=>!0),_l(t=>(e,n,i)=>{const{crop:r}=t;return r&&!n&&e&&i(()=>t.crop=Mn(t.crop)),e})],["cropSize",iu(({crop:t})=>[[t],([e],n)=>{e&&n(sr(e.width,e.height))},(e,n)=>Gc(e,n)])],["cropRectAspectRatio",nu(({cropSize:t})=>[[t],([e],n)=>{e&&n(en(lr(e),5))}])],["cropRange",iu(({size:t,rotation:e,cropRectAspectRatio:n,cropMinSize:i,cropMaxSize:r,cropLimitToImage:o})=>[[t,e,n,i,r,o],([a,s,l,c,d,u],p)=>{a&&p(((h,y,m,f,b,v)=>{const w=co(f),T=co(b);return v?[w,cs(Bl(h,y,m),Math.round)]:[w,T]})(a,s,l,c,d,u))},(a,s)=>Os(a,s)])],["rotationRange",iu(({size:t,isRotatedSideways:e,cropMinSize:n,cropSize:i,cropLimitToImage:r})=>[[t,e,n,i,r],([o,a,s,l,c],d)=>{!o||!l||d(Ov(o,a,s,l,c))},(o,a)=>Os(o,a)])],["backgroundColor",_l(()=>t=>((e=[0,0,0,0],n=1)=>e.length===4?e:[...e,n])(t))],["backgroundImage"],["targetSize"],["colorMatrix"],["convolutionMatrix"],["gamma"],["noise"],["vignette"],["duration"],["currentTime"],["minDuration",_o(()=>1/24)],["maxDuration",_o(()=>1/0)],["volume",_o(()=>1)],["trim"],["redaction",Sc(({size:t})=>[Ac,{context:t}])],["manipulation",Sc(({size:t})=>[Ac,{context:t}])],["annotation",Sc(({size:t})=>[Ac,{context:t}])],["decoration",Sc(({crop:t})=>[Ac,{context:t}])],["selection",Sc(({size:t})=>[Fv,{context:t}])],["frame",_l(()=>t=>{if(!t)return;const e={frameStyle:void 0,x:0,y:0,width:"100%",height:"100%",disableStyle:["backgroundColor","strokeColor","strokeWidth"]};return Qe(t)?e.frameStyle=t:Object.assign(e,t),e})],["metadata"],["state",E2((t,e,n)=>{const i=_p.map(l=>e[l]);let r=!1;const o=me({}),{subscribe:a}=Vn([...i,o],(l,c)=>{if(r)return;const d=_p.reduce((u,p,h)=>(u[p]=Th(l[h]),u),{});d.crop&&Bo(d.crop,Math.round),d.manipulation=d.manipulation&&Tc(d.manipulation),d.redaction=d.redaction&&Tc(d.redaction),d.annotation=d.annotation&&Tc(d.annotation),d.decoration=d.decoration&&Tc(d.decoration),d.selection=d.selection&&Tc(d.selection),c(d)}),s=l=>{l&&(r=!0,n.cropOrigin=void 0,_p.filter(c=>Ee(l,c)).forEach(c=>{const d=l[c];n[c]=d===null?void 0:Th(d)}),r=!1,o.set({}))};return{set:s,update:l=>s(l(null)),subscribe:a}})]],Eg=async(t,e,n={},i)=>{const{ontaskstart:r,ontaskprogress:o,ontaskend:a,token:s}=i;let l=!1;const c={cancel:ae};s.cancel=()=>{l=!0,c.cancel()};for(const[d,u]of e.entries()){if(l)return;const[p,h]=u;r(d,h);try{t=await p(t,{...n,taskCancelToken:c},y=>o(d,h,y))}catch(y){throw l=!0,y}a(d,h)}return t};const A2=["loadstart","loadabort","loaderror","loadprogress","load","processstart","processabort","processerror","processprogress","process"],_v=["flip","cropOrigin","isRotatedSideways","perspective","perspectiveX","perspectiveY","cropRange"],Dv=l0.map(([t])=>t).filter(t=>!_v.includes(t)),Dp=t=>"image"+P2(t),Pg=t=>Ee(t,"crop");var L2=()=>{const{stores:t,accessors:e}=Tg(Rv),{sub:n,pub:i}=za(),r=()=>e.images?e.images[0]:{};let o={};const a={};Dv.forEach(m=>{Object.defineProperty(e,Dp(m),{get:()=>{const f=r();if(f)return f.accessors[m]},set:f=>{o[Dp(m)]=f,a[Dp(m)]=f;const b=r();b&&(b.accessors[m]=f)}})});const s=()=>e.images&&e.images[0],l=t.src.subscribe(m=>{if(!m)return e.images=[];e.imageReader&&(e.images.length&&(o={}),d(m))}),c=t.imageReader.subscribe(m=>{m&&(e.images.length||e.src&&d(e.src))}),d=m=>{Promise.resolve().then(()=>p(m,o)).catch(()=>{})};let u;const p=(m,f={})=>new Promise((b,v)=>{let w=s();const T=!(f.cropLimitToImage===!1||f.imageCropLimitToImage===!1||a.imageCropLmitedToImage===!1),I=f.cropMinSize||f.imageCropMinSize||a.imageCropMinSize,P=T?I:w&&w.accessors.cropMinSize,_=f.minDuration||f.imageMinDuration;w&&y(),w=(({minSize:G={width:1,height:1},minDuration:O=0}={})=>{const{stores:$,accessors:N}=Tg(l0),{pub:it,sub:M}=za(),W=(ot,at)=>{const q=()=>N[ot]||{},ct=bt=>{N[ot]={...q(),...bt,timeStamp:Date.now()}},V=()=>q().error,ut=bt=>{V()||(ct({error:bt}),it(at+"error",{...q()}))};return{start(){it(at+"start")},onabort(){ct({abort:!0}),it(at+"abort",{...q()})},ontaskstart(bt,K){V()||(ct({index:bt,task:K,taskProgress:void 0,taskLengthComputable:void 0}),it(at+"taskstart",{...q()}))},ontaskprogress(bt,K,vt){V()||(ct({index:bt,task:K,taskProgress:vt.loaded/vt.total,taskLengthComputable:vt.lengthComputable}),it(at+"taskprogress",{...q()}),it(at+"progress",{...q()}))},ontaskend(bt,K){V()||(ct({index:bt,task:K}),it(at+"taskend",{...q()}))},ontaskerror(bt){ut(bt)},error(bt){ut(bt)},beforeComplete(bt){V()||(ct({beforeComplete:!0}),it("before"+at,bt))},complete(bt){V()||(ct({complete:!0}),it(at,bt))}}};return Yc(N,{read:(ot,{reader:at},q={})=>{if(!at)return;Object.assign(N,{file:void 0,size:void 0,loadState:void 0});let ct={cancel:ae},V=!1;const ut=W("loadState","load"),bt={token:ct,...ut},K={src:ot,size:void 0,dest:void 0,duration:void 0};return Promise.resolve().then(async()=>{try{if(ut.start(),V)return ut.onabort();const vt=await Eg(K,at,q,bt);if(V)return ut.onabort();const{size:X,duration:Z,dest:mt}=vt||{};if(!X||!X.width||!X.height)throw new zc("Image size missing","IMAGE_SIZE_MISSING",vt);if(Z>0&&Z<O)throw new zc("Video too short","VIDEO_TOO_SHORT",{...vt,minDuration:O});if(X.width<G.width||X.height<G.height)throw new zc("Image too small","IMAGE_TOO_SMALL",{...vt,minWidth:G.width,minHeight:G.height});Object.assign(N,{file:mt,size:X,duration:Z}),ut.beforeComplete(vt),ut.complete(vt)}catch(vt){ut.error(vt)}finally{ct=void 0}}),()=>{V=!0,ct&&ct.cancel(),ut.onabort()}},write:(ot,at)=>{if(!N.loadState.complete)return;N.processState=void 0;const q=W("processState","process"),ct={src:N.file,imageState:N.state,dest:void 0};if(Si(ot)&&(ot=ot(N.file,N.state)),!ot)return q.start(),void q.complete(ct);let V={cancel:ae},ut=!1;const bt=at,K={token:V,...q};return Promise.resolve().then(async()=>{try{if(q.start(),ut)return q.onabort();const vt=await Eg(ct,ot,bt,K);if(ut)return q.onabort();q.complete(vt)}catch(vt){q.error(vt)}finally{V=void 0}}),()=>{ut=!0,V&&V.cancel()}},on:M}),{accessors:N,stores:$}})({minSize:P,minDuration:_}),A2.map(G=>{return w.accessors.on(G,(O=G,$=>i(O,$)));var O});const C=()=>{o={},F.forEach(G=>G())},F=[];F.push(w.accessors.on("loaderror",G=>{C(),v(G)})),F.push(w.accessors.on("loadabort",()=>{C(),v({name:"AbortError"})})),F.push(w.accessors.on("load",G=>{u=void 0,C(),b(G)})),F.push(w.accessors.on("beforeload",()=>((G,O)=>{if(Pg(O))return void(e.imageState=O);if(!O.imageCrop){const it=G.accessors.size,M=O.imageRotation||0,W=Ry(co(it),M),ot=Fr(W);ot.width=en(Math.abs(ot.width),6),ot.height=en(Math.abs(ot.height),6);const at=O.imageCropAspectRatio||(O.imageCropLimitToImage?lr(it):lr(ot));let q;O.imageCropLimitToImage?q=Kr(ot,at):(q=Ls(ot,at),q.x=(it.width-q.width)/2,q.y=(it.height-q.height)/2),O.imageCrop=q}if(G.accessors.duration&&!O.imageTrim&&O.imageMaxDuration){const{duration:it}=G.accessors;O.imageTrim=[[0,Math.min(O.imageMaxDuration/it,1)]]}const $=["imageCropLimitToImage","imageCrop","imageCropAspectRatio","imageRotation"];$.filter(it=>Ee(O,it)).forEach(it=>{e[it]=O[it],delete O[it]});const N=Object.keys(O).filter(it=>!$.includes(it)).reduce((it,M)=>(it[M]=O[M],it),{});Object.assign(e,N)})(w,f))),e.images=[w],f.imageReader&&(e.imageReader=f.imageReader),f.imageWriter&&(e.imageWriter=f.imageWriter),u=w.accessors.read(m,{reader:e.imageReader},{willRequest:e.willRequest})});let h;const y=()=>{const m=s();m&&(u&&u(),m.accessors.loadState=void 0,e.images=[])};return Object.defineProperty(e,"stores",{get:()=>t}),Yc(e,{on:n,loadImage:p,abortLoadImage:()=>{u&&u(),e.images=[]},editImage:(m,f)=>new Promise((b,v)=>{p(m,f).then(()=>{const{images:w}=e,T=w[0],I=()=>{P(),_()},P=T.accessors.on("processerror",C=>{I(),v(C)}),_=T.accessors.on("process",C=>{I(),b(C)})}).catch(v)}),removeImage:y,processImage:(m,f)=>new Promise((b,v)=>{try{const w=[],T=()=>{h=void 0,w.forEach(I=>I())};(async()=>{if((P=>Qe(P)||jl(P)||Zc(P))(m))try{await p(m,f)}catch(P){v(P)}else m&&(Pg(m)?e.imageState=m:Object.assign(e,m));const I=s();if(!I)return v("no image");w.push(I.accessors.on("processerror",P=>{T(),v(P)})),w.push(I.accessors.on("processabort",()=>{T(),v({name:"AbortError"})})),w.push(I.accessors.on("process",P=>{T(),b(P)})),h=I.accessors.write(e.imageWriter,{redactionRenderStyle:e.imageRedactionRendering,shapePreprocessor:e.shapePreprocessor||ni,imageScrambler:e.imageScrambler,willRequest:e.willRequest,csp:e.csp||{},willRequestResource:e.willRequestResource})})()}catch(w){v(w)}}),abortProcessImage:()=>{const m=s();m&&(h&&h(),m.accessors.processState=void 0)},destroy:()=>{l&&l(),c&&c()}}),e};const O2=(t,e)=>{const{processImage:n}=L2();return n(t,e)};var F2=()=>Ba()?Io()?/15_|16_/.test(navigator.userAgent)?14745600:16777216:/15_/.test(navigator.userAgent)?16777216:1/0:1/0,_2=(t,e)=>Object.keys(t).filter(n=>!e.includes(n)).reduce((n,i)=>(n[i]=t[i],n),{}),D2=t=>new Promise(e=>{if(t.duration===1/0)return t.ontimeupdate=()=>{t.ontimeupdate=void 0,e(t)},void(t.currentTime=Number.MAX_SAFE_INTEGER);e(t)});const zv=t=>new Promise(e=>{const n=new FileReader;n.onload=()=>e(n.result),n.readAsArrayBuffer(t)}),zp=(t,e=0,n=t.byteLength)=>{const i=[],r=e+n;for(;e<r;){const o=t.getUint32(e);if(o<0)break;const a=t.getUint32(e+4);if(i.push({type:a,size:o,offset:e,bodyOffset:e+8,bodySize:o-8}),o<8)break;e+=o}return i},Bv=(t,{limit:e=1024}={})=>{let n=0;if(n+=4,t.getUint32(n)!==1718909296)return 0;n+=4;const i=t.getUint32(n);return i===1836069938?((r,o,a)=>{let s=!1,l=-1;for(let h=o;h<a;h++)if(s||r.getUint32(h)!==1953653099||(s=!0,h+=4),s&&r.getUint8(h)==64){l=h;break}if(l<0)return 0;const c=r.getUint32(l-28),d=r.getUint32(l-20),u=r.getUint32(l-32),p=r.getUint32(l-16);return c===65536&&d===4294901760?90:u===4294901760&&p===4294901760?180:c===4294901760&&d===65536?270:0})(t,n,e):i===1903435808?(r=>{const o=zp(r).find(c=>c.type===1836019574);if(!o)return 0;const a=zp(r,o.bodyOffset,o.bodySize);a.filter(c=>c.type===1953653099).forEach(c=>{a.push(...zp(r,c.bodyOffset,c.bodySize))});const s=[1836476516,1953196132],l=a.filter(c=>s.includes(c.type));for(const{type:c,bodyOffset:d}of l){const u=r.getUint8(d);let p=d+4;p+=c===1836476516?32:36,p+=u===1?12:0;const h=r.getInt32(p),y=r.getInt32(p+4);if(h===0&&y>0)return 90;if(h<0&&y===0)return 180;if(h===0&&y<0)return 270}return 0})(t):0};var z2=t=>new Promise((e,n)=>{(va()?(async i=>{const r=await zv(i),o=new DataView(r);return Bv(o)})(t):Promise.resolve(0)).then(i=>{const r=document.createElement("video");r.onerror=()=>n(r.error),r.playsInline=!0,r.preload="auto",r.onseeked=()=>{r.onseeked=void 0,e(r)},r.onloadeddata=()=>{r.onloadeddata=void 0,r.dataset.rotation=i?""+i:"0",D2(r).then(e),r.currentTime=0},r.src=URL.createObjectURL(t),(o=>{Io()&&(o.load(),o.play().catch(()=>{}),o.pause())})(r)})}),B2=(t,e)=>new Promise(n=>{if(t.currentTime===e)return n(t);let i=t.onseeked;t.onseeked=()=>{t.onseeked=i,n(t)},t.currentTime=oi(e,0,t.duration)}),N2=(t,e=0)=>new Promise((n,i)=>{z2(t).then(r=>{B2(r,e).then(o=>{const a=fi("canvas");Vy(o).then(({width:s,height:l})=>{a.width=s,a.height=l;const c=a.getContext("2d",{willReadFrequently:!0}),d=()=>{c.drawImage(o,0,0,a.width,a.height);const u=c.getImageData(0,0,a.width,a.height);dr(a),URL.revokeObjectURL(o.src),n(u)};Ba()?setTimeout(d,16):d()})})})}),c0=t=>/video/.test(t.type);const d0=({imageDataResizer:t,canvasMemoryLimit:e}={})=>async(n,i,r,o,a)=>{r.width=Math.max(r.width,1),r.height=Math.max(r.height,1),o.width=Math.max(o.width,1),o.height=Math.max(o.height,1);const{dest:s}=await O2(i,{imageReader:j2(),imageWriter:Z2({format:"canvas",targetSize:{...o,upscale:!0},imageDataResizer:t,canvasMemoryLimit:e}),imageCrop:r}),{feather:l=0}=a||{};if(l>0){const c=fi("canvas");c.width=s.width,c.height=s.height;const d=c.getContext("2d",{willReadFrequently:!0}),u=1/l;let p=0;for(p=0;p<l;p++){const y=p*u;d.strokeStyle=`rgba(0,0,0,${y*y})`,d.strokeRect(p+.5,p+.5,s.width-2*p-1,s.height-2*p-1)}d.fillStyle="#000",d.fillRect(p,p,s.width+.5-2*p,s.height+.5-2*p);const h=s.getContext("2d");h.globalCompositeOperation="destination-in",h.drawImage(c,0,0),dr(c)}n.drawImage(s,o.x,o.y,o.width,o.height),dr(s)},Ti=(t,e=(...i)=>i,n)=>async(i,r,o)=>{o(Dl(0,!1));let a=!1;const s=await t(...e(i,r,l=>{a=!0,o(l)}));return n&&n(i,s),a||o(Dl(1,!1)),i},Nv=({willRequest:t,srcProp:e="src",destProp:n="dest"}={})=>[Ti(Gb,(i,r,o)=>[i[e],o,{...r,willRequest:t}],(i,r)=>i[n]=r),"any-to-file"],Wv=({srcProp:t="dest",destProp:e="dest"}={})=>[Ti(async n=>{if(/octet-stream/.test(n.type)){console.warn(`Pintura: File has unknown mime type "${n.type}", make sure your server sets the correct Content-Type header.`);let i="image";const r=await Zh(n);/video/i.test(r.nodeName)&&(i="video");const o={type:i+"/unknown"};return td(n)?new File([n],n.name,{...o,lastModified:n.lastModified}):new Blob([n],o)}return n},n=>[n[t]],(n,i)=>n[e]=i),"any-to-file"],W2=({srcProp:t="src",destProp:e="size"}={})=>[Ti(Hy,n=>[n[t]],(n,i)=>n[e]=i),"read-image-size"],Vv=async t=>{const e=await Zh(t);if(Ou(e))return await(n=>new Promise((i,r)=>{const o=()=>{D2(n).then(()=>{i(n.duration)})};if(n.readyState>=1)return o();n.onloadedmetadata=o,n.onerror=()=>r(n.error)}))(e)},Hv=({srcProp:t="src",destProp:e="duration"}={})=>[Ti(Vv,n=>[n[t]],(n,i)=>n[e]=i),"read-media-duration"],V2=({srcSize:t="size",srcOrientation:e="orientation",destSize:n="size"}={})=>[Ti(jb,i=>[i[t],i[e]],(i,r)=>i[n]=r),"image-size-match-orientation"],H2=({srcProp:t="src",destProp:e="head"}={})=>[Ti((n,i)=>jy(n)?wy(n,i):void 0,n=>[n[t],[0,262144],onprogress],(n,i)=>n[e]=i),"read-image-head"],U2=({srcProp:t="head",destProp:e="orientation"}={})=>[Ti(zh,n=>[n[t],274],(n,i=1)=>n[e]=i),"read-exif-orientation-tag"],Uv=({srcProp:t="head"}={})=>[Ti(zh,e=>[e[t],274,1]),"clear-exif-orientation-tag"],Gv=({srcImageSize:t="size",srcCanvasSize:e="imageData",srcImageState:n="imageState",destImageSize:i="size",destScalar:r="scalar"}={})=>[Ti((o,a)=>[Math.min(a.width/o.width,a.height/o.height),Wa(a)],o=>[o[t],o[e],o[n]],(o,[a,s])=>{o[r]=a,o[i]=s}),"calculate-canvas-scalar"],jv=({srcProp:t="src",destProp:e="imageData",canvasMemoryLimit:n,srcImageState:i="imageState"}={})=>[Ti((r,o,a)=>c0(r)?N2(r,a.currentTime):Ey(r,o),r=>[r[t],n,r[i]],(r,o)=>r[e]=o),"blob-to-image-data"],Zv=({srcImageData:t="imageData",srcOrientation:e="orientation"}={})=>[Ti(Ty,n=>[n[t],n[e]],(n,i)=>n.imageData=i),"image-data-match-orientation"],Xv=({srcImageData:t="imageData",srcImageState:e="imageState"}={})=>[Ti(Tv,n=>[n[t],{backgroundColor:n[e].backgroundColor,backgroundImage:n[e].backgroundImage}],(n,i)=>n.imageData=i),"image-data-fill"],qv=({srcImageData:t="imageData",srcImageState:e="imageState",destScalar:n="scalar"}={})=>[Ti(Xb,i=>{const r=i[n];let{crop:o}=i[e];return o&&r!==1&&(o=Sr(Mn(o),r,hi())),[i[t],{crop:o,rotation:i[e].rotation,flipX:i[e].flipX,flipY:i[e].flipY}]},(i,r)=>i.imageData=r),"image-data-crop"],Yv=({targetSize:t={width:void 0,height:void 0,fit:void 0,upscale:void 0},imageDataResizer:e,srcProp:n="imageData",srcImageState:i="imageState",destImageScaledSize:r="imageScaledSize"})=>[Ti(Yb,o=>{const a=Math.min(t.width||Number.MAX_SAFE_INTEGER,o[i].targetSize&&o[i].targetSize.width||Number.MAX_SAFE_INTEGER),s=Math.min(t.height||Number.MAX_SAFE_INTEGER,o[i].targetSize&&o[i].targetSize.height||Number.MAX_SAFE_INTEGER);return[o[n],{width:a,height:s,fit:t.fit||"contain",upscale:(l=o[i],!!(l.targetSize&&l.targetSize.width||l.targetSize&&l.targetSize.height)||t.upscale||!1)},e];var l},(o,a)=>{Gc(o.imageData,a)||(o[r]=Wa(a)),o.imageData=a}),"image-data-resize"],Kv=({srcImageData:t="imageData",srcImageState:e="imageState",destImageData:n="imageData"}={})=>[Ti(nv,i=>{const{colorMatrix:r}=i[e],o=r&&Object.keys(r).map(a=>r[a]).filter(Boolean);return[i[t],{colorMatrix:o&&i0(o),convolutionMatrix:i[e].convolutionMatrix,gamma:i[e].gamma,noise:i[e].noise,vignette:i[e].vignette}]},(i,r)=>i[n]=r),"image-data-filter"],Jv=({srcImageData:t="imageData",srcImageState:e="imageState",destImageData:n="imageData",destScalar:i="scalar"}={})=>[Ti(async(r,o,a,s,l,c)=>{if(!o||!s.length)return r;let d;try{const m={dataSizeScalar:h2(r,s)};a&&a[3]>0&&(m.backgroundColor=[...a]),d=await o(r,m)}catch{}const u=fi("canvas");u.width=r.width,u.height=r.height;const p=u.getContext("2d",{willReadFrequently:!0});if(p.putImageData(r,0,0),c==="auto"){const m=Math.sqrt(r.width*r.height);p.filter=`blur(${Math.round(m/100)}px)`}const h=new Path2D;s.forEach(m=>{const f=Ci(m.x,m.y,m.width,m.height);Ms(f,l);const b=$r(Mn(f),m.rotation),v=new Path2D;b.forEach((w,T)=>{if(T===0)return v.moveTo(w.x,w.y);v.lineTo(w.x,w.y)}),h.addPath(v)}),p.clip(h,"nonzero"),p.imageSmoothingEnabled=!1,p.drawImage(d,0,0,u.width,u.height),dr(d);const y=p.getImageData(0,0,u.width,u.height);return dr(u),y},(r,{imageScrambler:o,redactionRenderStyle:a})=>[r[t],o,r[e].backgroundColor,r[e].redaction,r[i],a],(r,o)=>r[n]=o),"image-data-redact"],Bp=({srcImageData:t="imageData",srcSize:e="size",srcImageState:n="imageState",srcShapes:i="annotation",destImageData:r="imageData",destImageScaledSize:o="imageScaledSize",destScalar:a="scalar",imageDataResizer:s,canvasMemoryLimit:l,shapeFilter:c=ni,shapeClip:d=!0,destImageContext:u="imageContext"}={})=>[Ti(n0,(p,{shapePreprocessor:h,willRequestResource:y,csp:m,willRequest:f})=>{const b=p[n][i].filter(c);if(!b.length)return[p[t]];const v=p[a],{crop:w}=p[n],T=p[e];let I=v;const P=p[o];P&&(I=Math.min(P.width/w.width,P.height/w.height));const _={width:T.width/v,height:T.height/v};return[p[t],{shapes:b,computeShape:C=>(C=Ai(C,_),C=_2(C,["left","right","top","bottom"]),C=l2(C,I)),transform:C=>{const F=p[e],{rotation:G=0,flipX:O,flipY:$,cropLimitToImage:N}=p[n],{crop:it=Fr(F)}=p[n];let M=1;M=p[o]?I:v;const W={width:F.width/v*M,height:F.height/v*M},ot=Ny(W,G),at=ot.width,q=ot.height,ct=.5*W.width-.5*at,V=.5*W.height-.5*q,ut=ul(W);C.translate(-ct,-V),C.translate(-it.x*M,-it.y*M),C.translate(ut.x,ut.y),C.rotate(G),C.translate(-ut.x,-ut.y);const bt=p[u]||{x:0,y:0};C.translate(bt.x,bt.y),C.scale(O?-1:1,$?-1:1),C.translate(O?-W.width*v:0,$?-W.height*v:0),N&&d&&(C.rect(0,0,W.width,W.height),C.clip())},drawImage:d0({imageDataResizer:s,canvasMemoryLimit:l}),preprocessShape:C=>h(C,{isPreview:!1,...p[n]}),canvasMemoryLimit:l,willRequest:f||y,styleNonce:m.styleNonce}]},(p,h)=>p[r]=h),"image-data-annotate"],Ig=({srcImageData:t="imageData",srcImageState:e="imageState",destImageData:n="imageData",destImageScaledSize:i="imageScaledSize",imageDataResizer:r,canvasMemoryLimit:o,destScalar:a="scalar",shapeFilter:s=ni,destImageContext:l="imageContext"}={})=>[Ti(n0,(c,{shapePreprocessor:d,willRequestResource:u,willRequest:p,csp:h})=>{let y=c[e].decoration.filter(s);if(typeof window<"u"&&(v=>{if(v&&v._l052uvt)return;const[w]=[[85,110,108,105,99,101,110,115,101,100,32,80,105,110,116,117,114,97,32,105,110,115,116,97,110,99,101,32]].map(_=>_.map(C=>String.fromCharCode(C)).join("")),{width:T,height:I}=c[e].crop,P=I/15;y=[...y,{x:.5*-P,y:.5*-P,width:1.5*T,height:1.25*I,text:Array(50).fill(w).join(""),fontWeight:900,lineHeight:P,fontSize:P,color:[1,1,1,.05]}]})(window),!y.length)return[c[t]];let m=c[a];const{crop:f}=c[e],b=c[i];return b&&(m=Math.min(b.width/f.width,b.height/f.height)),[c[t],{shapes:y,drawImage:d0({imageDataResizer:r,canvasMemoryLimit:o}),computeShape:v=>(v=Ai(v,f),v=_2(v,["left","right","top","bottom"]),v=l2(v,m)),preprocessShape:v=>d(v,{isPreview:!1,...c[e]}),canvasMemoryLimit:o,willRequest:p||u,styleNonce:h.styleNonce,transform:v=>{const w=c[l]||{x:0,y:0};v.translate(w.x,w.y)}}]},(c,d)=>c[n]=d),"image-data-decorate"],Qv=({srcImageData:t="imageData",srcImageState:e="imageState",destImageData:n="imageData",destImageScaledSize:i="imageScaledSize",imageDataResizer:r,canvasMemoryLimit:o,destScalar:a="scalar",destImageContext:s="imageContext"}={})=>[Ti((l,c)=>new Promise(d=>{if(!c)return d([l]);n0(l,c).then(u=>{d([u,c.contextBounds])})}),(l,{shapePreprocessor:c,willRequestResource:d,willRequest:u,csp:p})=>{const h=l[e].frame;if(!h)return[l[t]];const y=l[a];let{crop:m}=l[e];m&&y!==1&&(m=Sr(Mn(m),y,hi()));const f={...m},b=o2(a2(h,f,c),f);f.x=Math.abs(b.left),f.y=Math.abs(b.top),f.width+=Math.abs(b.left)+Math.abs(b.right),f.height+=Math.abs(b.top)+Math.abs(b.bottom);const v=l[i],w=v?Math.min(v.width/m.width,v.height/m.height):1;return Ms(f,w),f.x=Math.floor(f.x),f.y=Math.floor(f.y),f.width=Math.floor(f.width),f.height=Math.floor(f.height),[l[t],{shapes:[h],contextBounds:f,computeShape:T=>Ai(T,l[t]),transform:T=>{T.translate(f.x,f.y)},drawImage:d0({imageDataResizer:r,canvasMemoryLimit:o}),preprocessShape:T=>c(T,{isPreview:!1,...l[e]}),canvasMemoryLimit:o,willRequest:u||d,styleNonce:p.styleNonce}]},(l,[c,d])=>{l[s]=d,l[n]=c}),"image-data-frame"],tw=({mimeType:t,quality:e,srcImageData:n="imageData",srcFile:i="src",destBlob:r="blob"}={})=>[Ti(Lb,o=>[o[n],t||Vh(o[i].name)||o[i].type,e],(o,a)=>o[r]=a),"image-data-to-blob"],ew=({srcImageData:t="imageData",srcOrientation:e="orientation",destCanvas:n="dest"}={})=>[Ti(Xl,i=>[i[t],i[e]],(i,r)=>i[n]=r),"image-data-to-canvas"],nw=async(t,e)=>{if(!jy(t)||!e)return t;const n=(a,s)=>{let l=2;const c=new DataView(a);for(s(c.getUint8(0),0,2,c.byteLength);l<c.byteLength&&c.getUint8(l)==255;){const d=c.getUint8(l+1),u=c.getUint16(l+2)+2;if(s(d,l,u,c.byteLength)===!1)break;l+=u}},i=a=>a===224||a===225||a===226,r=(a=>{const s=[];return n(a,(l,c,d)=>{if(l===218)return!1;i(l)&&s.push(new Uint8Array(a,c,d))}),s})(e),o=((a,s)=>{const l=[];n(a,(p,h,y,m)=>h===0?(l.push(new Uint8Array(a,h,y)),void l.push(...s)):p===218?(l.push(new Uint8Array(a,h,m-h)),!1):void(i(p)||l.push(new Uint8Array(a,h,y))));let c=l.reduce((p,h)=>p+h.length,0),d=new Uint8Array(c),u=0;return l.forEach(p=>{d.set(p,u),u+=p.length}),d})(await vy(t),r);return new Blob([o],{type:"image/jpeg"})},iw=(t="blob",e="head",n="blob")=>[Ti(nw,i=>[i[t],i[e]],(i,r)=>i[n]=r),"blob-write-image-head"],rw=({renameFile:t,srcBlob:e="blob",srcFile:n="src",destFile:i="dest",defaultFilename:r}={})=>[Ti(Hc,o=>[o[e],t?t(o[n]):o[n].name||`${r}.${Py(o[e].type)}`],(o,a)=>o[i]=a),"blob-to-file"],Rg=({url:t="./",dataset:e=o=>[["dest",o.dest,o.dest.name],["imageState",o.imageState]],destStore:n="store",credentials:i,headers:r={}})=>[Ti(async(o,a)=>await((s,l,c)=>new Promise((d,u)=>{const{token:p={},beforeSend:h=ae,onprogress:y=ae}=c;p.cancel=()=>m.abort();const m=new XMLHttpRequest;m.upload.onprogress=y,m.onload=()=>m.status>=200&&m.status<300?d(m):u(m),m.onerror=()=>u(m),m.ontimeout=()=>u(m),m.open("POST",encodeURI(s)),h(m),m.send(l instanceof FormData?l:l.reduce((f,b)=>(f.append(...b.map(Zb)),f),new FormData))}))(t,o,{onprogress:a,beforeSend:s=>Uy(s,{headers:r,credentials:i})}),(o,a,s)=>[e(o),s],(o,a)=>o[n]=a),"store"],G2=t=>[Ti(e=>(t&&t.length&&Object.keys(e).forEach(n=>{t.includes(n)||delete e[n]}),e)),"prop-filter"],j2=(t={})=>{const{orientImage:e=!0,outputProps:n=["src","dest","size","duration"],preprocessImageFile:i,request:r={}}=t;return[Nv({willRequest:()=>r}),Wv(),i&&[Ti(i,(o,a,s)=>[o.dest,a,s],(o,a)=>o.dest=a),"preprocess-image-file"],W2({srcProp:"dest"}),Hv({srcProp:"dest"}),e&&H2({srcProp:"dest"}),e&&U2(),e&&V2(),G2(n)].filter(Boolean)},ow=t=>t&&(Qe(t)?Rg({url:t}):Si(t)?[t,"store"]:Rg(t)),Z2=(t={})=>(e,n,i={})=>{let{canvasMemoryLimit:r=F2(),orientImage:o=!0,copyImageHead:a=!0,mimeType:s,quality:l,renameFile:c,targetSize:d,imageDataResizer:u,store:p,format:h="file",outputProps:y=["src","dest","imageState","store"],preprocessImageSource:m,preprocessImageState:f,postprocessImageData:b,postprocessImageBlob:v,testSrcSupport:w=!1}={...t,...i};if(!w||Xu(e))return h==="blob"&&(h="file"),[m&&[Ti(m,(T,I,P)=>[T.src,I,P,T.imageState],(T,I)=>T.src=I),"preprocess-image-source"],(o||a)&&H2(),o&&U2(),W2(),f&&[Ti(f,(T,I,P,_)=>[T.imageState,I,P,{size:T.size,orientation:T.orientation}],(T,I)=>T.imageState=I),"preprocess-image-state"],jv({canvasMemoryLimit:r}),o&&V2(),o&&Zv(),Gv(),Jv(),qv(),Yv({imageDataResizer:u,targetSize:d}),Bp({imageDataResizer:u,canvasMemoryLimit:r,srcShapes:"manipulation"}),Kv(),Xv(),Bp({imageDataResizer:u,canvasMemoryLimit:r,srcShapes:"annotation",shapeFilter:T=>!T.aboveFrame}),Ig({imageDataResizer:u,canvasMemoryLimit:r,shapeFilter:T=>!T.aboveFrame}),Qv({imageDataResizer:u,canvasMemoryLimit:r}),Bp({imageDataResizer:u,canvasMemoryLimit:r,srcShapes:"annotation",shapeFilter:T=>T.aboveFrame,shapeClip:!1}),Ig({imageDataResizer:u,canvasMemoryLimit:r,shapeFilter:T=>T.aboveFrame}),b&&[Ti(b,(T,I,P)=>[T.imageData,I,P],(T,I)=>T.imageData=I),"postprocess-image-data"],h==="file"?tw({mimeType:s,quality:l}):h==="canvas"?ew():[T=>(T.dest=T.imageData,T)],h==="file"&&o&&Uv(),h==="file"&&a&&iw(),v&&[Ti(v,({blob:T,imageData:I,src:P},_,C)=>[{blob:T,imageData:I,src:P},_,C],(T,I)=>T.blob=I),"postprocess-image-file"],h==="file"&&rw({defaultFilename:"image",renameFile:c}),h==="file"?ow(p):Si(p)&&[p,"store"],G2(y)].filter(Boolean)};var aw=(t,e,n,i,r,o,a,s,l,c,d)=>{if(!(t&&e&&n&&i&&s))return;s*=o;const u=jc(Mn(e)),p=wn(u),h=wn(t),y=Fr(n),m=wn(y),f=s0(n,i,l),b=wn(f),v=Oi(Ue(m),b),w=Oi(Ue(h),p);v.x+=w.x,v.y+=w.y;const T=_c(Ue(v));T.x+=w.x,T.y+=w.y;const I=wn(ta(ta(Mn(r),a),t)),P=Oi(I,h);return nr(v,P),{origin:T,translation:v,rotation:{x:d?Math.PI:0,y:c?Math.PI:0,z:l},scale:s}};let Cc=null;var u0=()=>{if(Cc===null)if("WebGL2RenderingContext"in window){let t;try{t=fi("canvas"),Cc=!!t.getContext("webgl2")}catch{Cc=!1}t&&dr(t),t=void 0}else Cc=!1;return Cc},Ag=t=>(t&t-1)==0,p0=(t,e={},n="",i="")=>Object.keys(e).filter(r=>!Fs(e[r])).reduce((r,o)=>r.replace(new RegExp(n+o+i),e[o]),t);const sw={head:`#version 300 es

in vec4 aPosition;uniform mat4 uMatrix;`,text:`
in vec2 aTexCoord;out vec2 vTexCoord;`,matrix:`
gl_Position=uMatrix*vec4(aPosition.x,aPosition.y,0,1);`},lw={head:`#version 300 es
precision highp float;

out vec4 fragColor;`,mask:`
uniform float uMaskFeather[8];uniform float uMaskBounds[4];uniform float uMaskOpacity;float mask(float x,float y,float bounds[4],float opacity){return 1.0-(1.0-(smoothstep(bounds[3],bounds[3]+1.0,x)*(1.0-smoothstep(bounds[1]-1.0,bounds[1],x))*(1.0-step(bounds[0],y))*step(bounds[2],y)))*(1.0-opacity);}`,init:`
float a=1.0;vec4 fillColor=uColor;vec4 textureColor=texture(uTexture,vTexCoord);textureColor*=(1.0-step(uRepeat.y,vTexCoord.y))*step(0.0,vTexCoord.y)*(1.0-step(uRepeat.x,vTexCoord.x))*step(0.0,vTexCoord.x);`,colorize:`
if(uTextureColor.a!=0.0&&textureColor.a>0.0){vec3 colorFlattened=textureColor.rgb/textureColor.a;if(colorFlattened.r>=.9999&&colorFlattened.g==0.0&&colorFlattened.b>=.9999){textureColor.rgb=uTextureColor.rgb*textureColor.a;}textureColor*=uTextureColor.a;}`,maskapply:`
float m=mask(gl_FragCoord.x,gl_FragCoord.y,uMaskBounds,uMaskOpacity);`,maskfeatherapply:`
float leftFeatherOpacity=step(uMaskFeather[1],gl_FragCoord.x)*uMaskFeather[0]+((1.0-uMaskFeather[0])*smoothstep(uMaskFeather[1],uMaskFeather[3],gl_FragCoord.x));float rightFeatherOpacity=(1.0-step(uMaskFeather[7],gl_FragCoord.x))*uMaskFeather[4]+((1.0-uMaskFeather[4])*smoothstep(uMaskFeather[7],uMaskFeather[5],gl_FragCoord.x));a*=leftFeatherOpacity*rightFeatherOpacity;`,rectaa:`
vec2 scaledPoint=vec2(vRectCoord.x*uSize.x,vRectCoord.y*uSize.y);a*=smoothstep(0.0,uEdgeFeather,uSize.x-scaledPoint.x);a*=smoothstep(0.0,uEdgeFeather,uSize.y-scaledPoint.y);a*=smoothstep(0.0,uEdgeFeather,scaledPoint.x);a*=smoothstep(0.0,uEdgeFeather,scaledPoint.y);`,cornerradius:`
vec2 s=(uSize-2.0)*.5;vec2 r=(vRectCoord*uSize)-1.0;vec2 p=r-s;float cornerRadius=uCornerRadius[0];bool left=r.x<s.x;bool top=r.y<s.y;if(!left&&top){cornerRadius=uCornerRadius[1];}if(!left&&!top){cornerRadius=uCornerRadius[3];}if(left&&!top){cornerRadius=uCornerRadius[2];}a*=1.0-clamp(length(max(abs(p)-(s-cornerRadius),0.0))-cornerRadius,0.0,1.0);`,fragcolor:`
if(m<=0.0)discard;fillColor.a*=a;fillColor.rgb*=fillColor.a;fillColor.rgb*=m;fillColor.rgb+=(1.0-m)*(uCanvasColor.rgb*fillColor.a);textureColor*=uTextureOpacity;textureColor.a*=a;textureColor.rgb*=m*a;textureColor.rgb+=(1.0-m)*(uCanvasColor.rgb*textureColor.a);fragColor=textureColor+(fillColor*(1.0-textureColor.a));`},Lg=(t,e,n)=>{const i=t.createShader(n),r=((o,a,s)=>(a=p0(a,s===o.VERTEX_SHADER?sw:lw,"##").trim(),u0()?a:(a=(a=a.replace(/#version.+/gm,"").trim()).replace(/^\/\/\#/gm,"#"),s===o.VERTEX_SHADER&&(a=a.replace(/in /gm,"attribute ").replace(/out /g,"varying ")),s===o.FRAGMENT_SHADER&&(a=a.replace(/in /gm,"varying ").replace(/out.*?;/gm,"").replace(/texture\(/g,"texture2D(").replace(/fragColor/g,"gl_FragColor")),""+a)))(t,e,n);return t.shaderSource(i,r),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS)||console.error(t.getShaderInfoLog(i)),i},Mc=(t,e,n,i,r)=>{const o=Lg(t,e,t.VERTEX_SHADER),a=Lg(t,n,t.FRAGMENT_SHADER),s=t.createProgram();t.attachShader(s,o),t.attachShader(s,a),t.linkProgram(s);const l={};return i.forEach(c=>{l[c]=t.getAttribLocation(s,c)}),r.forEach(c=>{l[c]=t.getUniformLocation(s,c)}),{program:s,locations:l,destroy(){t.detachShader(s,o),t.detachShader(s,a),t.deleteShader(o),t.deleteShader(a),t.deleteProgram(s)}}},Og=t=>t.nodeName!=="VIDEO"&&(!!u0()||Ag(t.width)&&Ag(t.height)),cw=(t,e,n,i)=>(t.bindTexture(t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n),((r,o,a)=>{r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,Og(o)?r.LINEAR_MIPMAP_LINEAR:r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,a.filterParam),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,a.wrapParam),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,a.wrapParam),Og(o)&&r.generateMipmap(r.TEXTURE_2D)})(t,n,i),t.bindTexture(t.TEXTURE_2D,null),e),nl=(t,e=1)=>t?[t[0],t[1],t[2],dn(t[3])?e*t[3]:e]:[0,0,0,0],Np=()=>{const t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},Wp=(t,e,n,i,r,o,a)=>{const s=1/(e-n),l=1/(i-r),c=1/(o-a);t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(r+i)*l,t[14]=(a+o)*c,t[15]=1},il=(t,e,n,i)=>{t[12]=t[0]*e+t[4]*n+t[8]*i+t[12],t[13]=t[1]*e+t[5]*n+t[9]*i+t[13],t[14]=t[2]*e+t[6]*n+t[10]*i+t[14],t[15]=t[3]*e+t[7]*n+t[11]*i+t[15]},Fg=(t,e)=>{t[0]*=e,t[1]*=e,t[2]*=e,t[3]*=e,t[4]*=e,t[5]*=e,t[6]*=e,t[7]*=e,t[8]*=e,t[9]*=e,t[10]*=e,t[11]*=e},_g=(t,e)=>{const n=Math.sin(e),i=Math.cos(e),r=t[4],o=t[5],a=t[6],s=t[7],l=t[8],c=t[9],d=t[10],u=t[11];t[4]=r*i+l*n,t[5]=o*i+c*n,t[6]=a*i+d*n,t[7]=s*i+u*n,t[8]=l*i-r*n,t[9]=c*i-o*n,t[10]=d*i-a*n,t[11]=u*i-s*n},Dg=(t,e)=>{const n=Math.sin(e),i=Math.cos(e),r=t[0],o=t[1],a=t[2],s=t[3],l=t[8],c=t[9],d=t[10],u=t[11];t[0]=r*i-l*n,t[1]=o*i-c*n,t[2]=a*i-d*n,t[3]=s*i-u*n,t[8]=r*n+l*i,t[9]=o*n+c*i,t[10]=a*n+d*i,t[11]=s*n+u*i},zg=(t,e)=>{const n=Math.sin(e),i=Math.cos(e),r=t[0],o=t[1],a=t[2],s=t[3],l=t[4],c=t[5],d=t[6],u=t[7];t[0]=r*i+l*n,t[1]=o*i+c*n,t[2]=a*i+d*n,t[3]=s*i+u*n,t[4]=l*i-r*n,t[5]=c*i-o*n,t[6]=d*i-a*n,t[7]=u*i-s*n};var dw=t=>t*Math.PI/180,Ku=(t,e)=>u0()?t.getContext("webgl2",e):t.getContext("webgl",e)||t.getContext("experimental-webgl",e);const Vp=(t,e)=>{const n=t.length;return e>=n?t[e%n]:e<0?t[e%n+n]:t[e]},uw=(t,e,n,i)=>{const r=pt(n.x-e.x,n.y-e.y),o=pt(i.x-n.x,i.y-n.y),a=pt(e.x-i.x,e.y-i.y),s=pt(t.x-e.x,t.y-e.y),l=pt(t.x-n.x,t.y-n.y),c=pt(t.x-i.x,t.y-i.y),d=yu(r,s),u=yu(o,l),p=yu(a,c);return d<=0&&u<=0&&p<=0},pw=t=>{if(t.length<3)return[];if((b=>{const v=b.length;for(let w=0;w<v;w++){const T=As(b[w],Vp(b,w+1));if(_y(T,b,{ignoreIdenticalLines:!0,breakOnIntersection:!0}))return!0}return!1})(t))return[];(b=>{let v,w,T,I,P,_=0;const C=b.length;for(v=0;v<C;v++)w=b[v],T=b[(v+1)%C],I=T.x-w.x,P=(T.y+w.y)/2,_+=I*P;return _})(t)<0&&t.reverse();const e=t.length,n=[...Array(e).keys()],i=[];let r,o,a,s,l,c,d,u,p,h,y,m,f=1024;for(;n.length>3;){if(f<=0)return[];for(f--,r=0;r<n.length;r++)if(a=n[r],s=Vp(n,r-1),l=Vp(n,r+1),c=t[a],d=t[s],u=t[l],p=pt(d.x-c.x,d.y-c.y),h=pt(u.x-c.x,u.y-c.y),!(yu(p,h)<0)){for(y=!0,o=0;o<e;o++)if(o!==a&&o!==s&&o!==l&&(m=t[o],uw(m,d,c,u))){y=!1;break}if(y){i.push([d,c,u]),n.splice(r,1);break}}}return i.push([t[n[0]],t[n[1]],t[n[2]]]),i},Bg=(t,e,n,i,r)=>{const o=bo(pt(i.x-n.x,i.y-n.y)),a=bo(pt(r.x-i.x,r.y-i.y)),s=bo(pt(o.x+a.x,o.y+a.y)),l=pt(-s.y,s.x),c=pt(-o.y,o.x),d=Math.min(1/$u(l,c),5);t[e]=i.x,t[e+1]=i.y,t[e+2]=l.x*d,t[e+3]=l.y*d,t[e+4]=-1,t[e+5]=i.x,t[e+6]=i.y,t[e+7]=l.x*d,t[e+8]=l.y*d,t[e+9]=1},Ng=t=>{const e=new Float32Array(8);return e[0]=t[3].x,e[1]=t[3].y,e[2]=t[0].x,e[3]=t[0].y,e[4]=t[2].x,e[5]=t[2].y,e[6]=t[1].x,e[7]=t[1].y,e},Wg=(t,e=0,n,i)=>{const r=Mo(t),o=t.x+.5*t.width,a=t.y+.5*t.height;return(n||i)&&Nl(r,n,i,o,a),e!==0&&ls(r,e,o,a),r},ru=(t,e,n,i,r)=>{const o=Math.min(20,Math.max(4,Math.round(i/2)));let a=0,s=0,l=0,c=0,d=0;for(;d<o;d++)a=d/o,s=r*No+a*No,l=i*Math.cos(s),c=i*Math.sin(s),t.push(pt(e+l,n+c))};let ou=null;var h0=()=>{if(ou!==null)return ou;let t=fi("canvas");const e=Ku(t);return ou=e?e.getParameter(e.MAX_TEXTURE_SIZE):void 0,dr(t),t=void 0,ou},m0=()=>ir()&&!!window.chrome;const Lc=new Float32Array([0,1,0,0,1,1,1,0]),hw=new Float32Array([1,0,0,0,1,1,0,1]),mw=ir()&&va(),Vg=[0,0,0,0,1,0,0,0,0],gw=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],Hp=[0,0,0,0],fw=[0,0,0,0],Hg=(t,e,n,i,r)=>{if(!n||!i)return Lc;let o=i.x/n.width,a=i.y/n.height,s=t/n.width/r,l=e/n.height/r;return s-=o,l-=a,new Float32Array([-o,l,-o,-a,s,l,s,-a])};var $w=(t,e={})=>{const{alpha:n=!1}=e,i={width:0,height:0},r={width:0,height:0},o=h0()||1024;let a,s,l;const c=Np(),d=Np();let u,p,h,y,m,f,b,v,w,T=0,I=0,P=0,_=1;const C=new Map([]),F=()=>{$.stencilOp($.KEEP,$.KEEP,$.KEEP),$.stencilFunc($.ALWAYS,1,255),$.stencilMask(255)},G=dw(30),O=Math.tan(G/2),$=Ku(t,{alpha:n,antialias:!1,premultipliedAlpha:!0,stencil:!0});if(!$)return;$.getExtension("OES_standard_derivatives"),$.disable($.DEPTH_TEST),$.enable($.STENCIL_TEST),$.enable($.BLEND),$.blendFunc($.ONE,$.ONE_MINUS_SRC_ALPHA),$.pixelStorei($.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!(!n&&va())),F();const N=$.createTexture();$.bindTexture($.TEXTURE_2D,N),$.texImage2D($.TEXTURE_2D,0,$.RGBA,1,1,0,$.RGBA,$.UNSIGNED_BYTE,new Uint8Array(Hp)),C.set(0,N);const it=$.createTexture();C.set(2,it);const M=$.createFramebuffer(),W=$.createTexture();C.set(1,W);const ot=$.createFramebuffer(),at=Mc($,`
##head
##text
void main(){vTexCoord=aTexCoord;gl_Position=uMatrix*aPosition;}`,`
##head
in vec2 vTexCoord;uniform sampler2D uTexture;uniform sampler2D uTextureOverlay;uniform sampler2D uTextureBlend;uniform vec2 uTextureSize;uniform float uOpacity;uniform int uAntialias;uniform vec4 uOverlayColor;uniform mat4 uColorMatrix;uniform vec4 uColorOffset;uniform float uClarityKernel[9];uniform float uClarityKernelWeight;uniform float uColorGamma;uniform float uColorVignette;uniform float uMaskClip;uniform float uMaskOpacity;uniform float uMaskBounds[4];uniform float uMaskCornerRadius[4];uniform float uMaskFeather[8];vec4 applyGamma(vec4 c,float g){c.r=pow(c.r,g);c.g=pow(c.g,g);c.b=pow(c.b,g);return c;}vec4 applyColorMatrix(vec4 c,mat4 m,vec4 o){vec4 res=(c*m)+(o*c.a);res=clamp(res,0.0,1.0);return res;}vec4 applyConvolutionMatrix(vec4 c,float k0,float k1,float k2,float k3,float k4,float k5,float k6,float k7,float k8,float w){vec2 pixel=vec2(1)/uTextureSize;vec4 colorSum=texture(uTexture,vTexCoord-pixel)*k0+texture(uTexture,vTexCoord+pixel*vec2(0.0,-1.0))*k1+texture(uTexture,vTexCoord+pixel*vec2(1.0,-1.0))*k2+texture(uTexture,vTexCoord+pixel*vec2(-1.0,0.0))*k3+texture(uTexture,vTexCoord)*k4+texture(uTexture,vTexCoord+pixel*vec2(1.0,0.0))*k5+texture(uTexture,vTexCoord+pixel*vec2(-1.0,1.0))*k6+texture(uTexture,vTexCoord+pixel*vec2(0.0,1.0))*k7+texture(uTexture,vTexCoord+pixel)*k8;vec4 color=vec4(clamp((colorSum/w),0.0,1.0).rgb,c.a);return color;}vec4 blendPremultipliedAlpha(vec4 back,vec4 front){return front+(back*(1.0-front.a));}vec4 applyVignette(vec4 c,vec2 pos,vec2 center,float v){float d=distance(pos,center)/length(center);float f=1.0-(d*abs(v));if(v>0.0){c.rgb*=f;}else if(v<0.0){c.rgb+=(1.0-f)*(1.0-c.rgb);}return c;}void main(){float x=gl_FragCoord.x;float y=gl_FragCoord.y;float a=1.0;float maskTop=uMaskBounds[0];float maskRight=uMaskBounds[1];float maskBottom=uMaskBounds[2];float maskLeft=uMaskBounds[3];float leftFeatherOpacity=step(uMaskFeather[1],x)*uMaskFeather[0]+((1.0-uMaskFeather[0])*smoothstep(uMaskFeather[1],uMaskFeather[3],x));float rightFeatherOpacity=(1.0-step(uMaskFeather[7],x))*uMaskFeather[4]+((1.0-uMaskFeather[4])*smoothstep(uMaskFeather[7],uMaskFeather[5],x));a*=leftFeatherOpacity*rightFeatherOpacity;float overlayColorAlpha=(smoothstep(maskLeft,maskLeft+1.0,x)*(1.0-smoothstep(maskRight-1.0,maskRight,x))*(1.0-step(maskTop,y))*step(maskBottom,y));if(uOverlayColor.a==0.0){a*=overlayColorAlpha;}vec2 offset=vec2(maskLeft,maskBottom);vec2 size=vec2(maskRight-maskLeft,maskTop-maskBottom)*.5;vec2 center=offset.xy+size.xy;int pixelX=int(step(center.x,x));int pixelY=int(step(y,center.y));float cornerRadius=0.0;if(pixelX==0&&pixelY==0)cornerRadius=uMaskCornerRadius[0];if(pixelX==1&&pixelY==0)cornerRadius=uMaskCornerRadius[1];if(pixelX==0&&pixelY==1)cornerRadius=uMaskCornerRadius[2];if(pixelX==1&&pixelY==1)cornerRadius=uMaskCornerRadius[3];float cornerOffset=sign(cornerRadius)*length(max(abs(gl_FragCoord.xy-size-offset)-size+cornerRadius,0.0))-cornerRadius;float cornerOpacity=1.0-smoothstep(0.0,1.0,cornerOffset);a*=cornerOpacity;if(uAntialias==1){vec2 scaledPoint=vec2(vTexCoord.x*uTextureSize.x,vTexCoord.y*uTextureSize.y);a*=smoothstep(0.0,1.0,uTextureSize.x-scaledPoint.x);a*=smoothstep(0.0,1.0,uTextureSize.y-scaledPoint.y);a*=smoothstep(0.0,1.0,scaledPoint.x);a*=smoothstep(0.0,1.0,scaledPoint.y);}vec4 color=texture(uTexture,vTexCoord);if(uClarityKernelWeight!=-1.0){color=applyConvolutionMatrix(color,uClarityKernel[0],uClarityKernel[1],uClarityKernel[2],uClarityKernel[3],uClarityKernel[4],uClarityKernel[5],uClarityKernel[6],uClarityKernel[7],uClarityKernel[8],uClarityKernelWeight);}color=blendPremultipliedAlpha(color,texture(uTextureBlend,vTexCoord));color=applyGamma(color,uColorGamma);color=applyColorMatrix(color,uColorMatrix,uColorOffset);color*=a;if(uColorVignette!=0.0){vec2 pos=gl_FragCoord.xy-offset;color=applyVignette(color,pos,center-offset,uColorVignette);}color=blendPremultipliedAlpha(color,texture(uTextureOverlay,vTexCoord));if(overlayColorAlpha<=0.0){color*=1.0-uOverlayColor.a;}color*=uOpacity;fragColor=color;}`,["aPosition","aTexCoord"],["uMatrix","uTexture","uTextureBlend","uTextureOverlay","uTextureSize","uColorGamma","uColorVignette","uColorOffset","uColorMatrix","uClarityKernel","uClarityKernelWeight","uOpacity","uMaskOpacity","uMaskBounds","uMaskCornerRadius","uMaskFeather","uOverlayColor","uAntialias"]),q=$.createBuffer(),ct=$.createBuffer();$.bindBuffer($.ARRAY_BUFFER,ct),$.bufferData($.ARRAY_BUFFER,Lc,$.STATIC_DRAW);const V=$.createBuffer();$.bindBuffer($.ARRAY_BUFFER,V),$.bufferData($.ARRAY_BUFFER,hw,$.STATIC_DRAW);const ut=Mc($,`#version 300 es

in vec4 aPosition;in vec2 aNormal;in float aMiter;out vec2 vNormal;out float vMiter;out float vWidth;uniform float uWidth;uniform float uSharpness;uniform mat4 uMatrix;void main(){vMiter=aMiter;vNormal=aNormal;vWidth=(uWidth*.5)+uSharpness;gl_Position=uMatrix*vec4(aPosition.x+(aNormal.x*vWidth*aMiter),aPosition.y+(aNormal.y*vWidth*aMiter),0,1);}`,`
##head
##mask
in vec2 vNormal;in float vMiter;in float vWidth;uniform float uWidth;uniform vec4 uColor;uniform vec4 uCanvasColor;void main(){vec4 fillColor=uColor;float m=mask(gl_FragCoord.x,gl_FragCoord.y,uMaskBounds,uMaskOpacity);if(m<=0.0)discard;fillColor.a*=clamp(smoothstep(vWidth-.5,vWidth-1.0,abs(vMiter)*vWidth),0.0,1.0);fillColor.rgb*=fillColor.a;fillColor.rgb*=m;fillColor.rgb+=(1.0-m)*(uCanvasColor.rgb*fillColor.a);fragColor=fillColor;}`,["aPosition","aNormal","aMiter"],["uColor","uCanvasColor","uMatrix","uWidth","uSharpness","uMaskBounds","uMaskOpacity"]),bt=$.createBuffer();m0()&&($.bindBuffer($.ARRAY_BUFFER,bt),$.bufferData($.ARRAY_BUFFER,1,$.DYNAMIC_DRAW));const K=(nt,Ut,qt,Dt=!1)=>{const{program:ve,locations:It}=ut;$.useProgram(ve),$.enableVertexAttribArray(It.aPosition),$.enableVertexAttribArray(It.aNormal),$.enableVertexAttribArray(It.aMiter);const Ie=((he,Ke)=>{let Ae,We,xn,xt=0;const de=he.length,Ve=new Float32Array(10*(Ke?de+1:de)),Oe=he[0],Ne=he[de-1];for(xt=0;xt<de;xt++)Ae=he[xt-1],We=he[xt],xn=he[xt+1],Ae||(Ae=Ke?Ne:pt(We.x+(We.x-xn.x),We.y+(We.y-xn.y))),xn||(xn=Ke?Oe:pt(We.x+(We.x-Ae.x),We.y+(We.y-Ae.y))),Bg(Ve,10*xt,Ae,We,xn);return Ke&&Bg(Ve,10*de,Ne,Oe,he[1]),Ve})(nt,Dt),lt=5*Float32Array.BYTES_PER_ELEMENT,Ze=2*Float32Array.BYTES_PER_ELEMENT,nn=4*Float32Array.BYTES_PER_ELEMENT;$.uniform1f(It.uWidth,Ut),$.uniform1f(It.uSharpness,l),$.uniform4fv(It.uColor,qt),$.uniformMatrix4fv(It.uMatrix,!1,u),$.uniform4f(It.uCanvasColor,T,I,P,_),$.uniform1fv(It.uMaskBounds,b),$.uniform1f(It.uMaskOpacity,f),$.bindBuffer($.ARRAY_BUFFER,bt),$.bufferData($.ARRAY_BUFFER,Ie,$.STATIC_DRAW),$.vertexAttribPointer(It.aPosition,2,$.FLOAT,!1,lt,0),$.vertexAttribPointer(It.aNormal,2,$.FLOAT,!1,lt,Ze),$.vertexAttribPointer(It.aMiter,1,$.FLOAT,!1,lt,nn),$.drawArrays($.TRIANGLE_STRIP,0,Ie.length/5),$.disableVertexAttribArray(It.aPosition),$.disableVertexAttribArray(It.aNormal),$.disableVertexAttribArray(It.aMiter)},vt=Mc($,`
##head
void main(){
##matrix
}`,`
##head
##mask
uniform vec4 uColor;uniform vec4 uCanvasColor;void main(){vec4 fillColor=uColor;
##maskapply
fillColor.rgb*=fillColor.a;fillColor.rgb*=m;fillColor.rgb+=(1.0-m)*(uCanvasColor.rgb*fillColor.a);fragColor=fillColor;}`,["aPosition"],["uColor","uCanvasColor","uMatrix","uMaskBounds","uMaskOpacity"]),X=$.createBuffer(),Z=Mc($,`
##head
##text
in vec2 aRectCoord;out vec2 vRectCoord;void main(){vTexCoord=aTexCoord;vRectCoord=aRectCoord;
##matrix
}`,`
##head
##mask
in vec2 vTexCoord;in vec2 vRectCoord;uniform sampler2D uTexture;uniform vec4 uTextureColor;uniform float uTextureOpacity;uniform vec2 uRepeat;uniform vec4 uColor;uniform float uCornerRadius[4];uniform vec2 uSize;uniform vec2 uPosition;uniform vec4 uCanvasColor;uniform int uInverted;uniform float uEdgeFeather;void main(){
##init
##colorize
##rectaa
##cornerradius
##maskfeatherapply
if(uInverted==1)a=1.0-a;
##maskapply
##fragcolor
}`,["aPosition","aTexCoord","aRectCoord"],["uTexture","uColor","uMatrix","uCanvasColor","uTextureColor","uTextureOpacity","uRepeat","uPosition","uSize","uMaskBounds","uMaskOpacity","uMaskFeather","uCornerRadius","uInverted","uEdgeFeather"]),mt=$.createBuffer(),Bt=$.createBuffer(),st=$.createBuffer(),gt=Mc($,`
##head
##text
out vec2 vTexCoordDouble;void main(){vTexCoordDouble=vec2(aTexCoord.x*2.0-1.0,aTexCoord.y*2.0-1.0);vTexCoord=aTexCoord;
##matrix
}`,`
##head
##mask
in vec2 vTexCoord;in vec2 vTexCoordDouble;uniform sampler2D uTexture;uniform float uTextureOpacity;uniform vec2 uRepeat;uniform vec2 uRadius;uniform vec4 uColor;uniform int uInverted;uniform vec4 uCanvasColor;void main(){
##init
float ar=uRadius.x/uRadius.y;vec2 rAA=vec2(uRadius.x-1.0,uRadius.y-(1.0/ar));vec2 scaledPointSq=vec2((vTexCoordDouble.x*uRadius.x)*(vTexCoordDouble.x*uRadius.x),(vTexCoordDouble.y*uRadius.y)*(vTexCoordDouble.y*uRadius.y));float p=(scaledPointSq.x/(uRadius.x*uRadius.x))+(scaledPointSq.y/(uRadius.y*uRadius.y));float pAA=(scaledPointSq.x/(rAA.x*rAA.x))+(scaledPointSq.y/(rAA.y*rAA.y));a=smoothstep(1.0,p/pAA,p);if(uInverted==1)a=1.0-a;
##maskapply
##fragcolor
}`,["aPosition","aTexCoord"],["uTexture","uTextureOpacity","uRepeat","uColor","uCanvasColor","uMatrix","uRadius","uInverted","uMaskBounds","uMaskOpacity"]),Jt=$.createBuffer(),le=$.createBuffer(),rt=new Map,kt={2:{width:0,height:0},1:{width:0,height:0}},Nt=(nt,Ut,qt,Dt=1)=>{const ve=Math.min(Math.min(4096,o)/qt.width,Math.min(4096,o)/qt.height,Dt),It=Math.floor(ve*qt.width),Ie=Math.floor(ve*qt.height);Gc(qt,kt[nt])?$.bindFramebuffer($.FRAMEBUFFER,Ut):($.bindTexture($.TEXTURE_2D,C.get(nt)),$.texImage2D($.TEXTURE_2D,0,$.RGBA,It,Ie,0,$.RGBA,$.UNSIGNED_BYTE,null),$.texParameteri($.TEXTURE_2D,$.TEXTURE_MIN_FILTER,$.LINEAR),$.texParameteri($.TEXTURE_2D,$.TEXTURE_WRAP_S,$.CLAMP_TO_EDGE),$.texParameteri($.TEXTURE_2D,$.TEXTURE_WRAP_T,$.CLAMP_TO_EDGE),$.bindFramebuffer($.FRAMEBUFFER,Ut),$.framebufferTexture2D($.FRAMEBUFFER,$.COLOR_ATTACHMENT0,$.TEXTURE_2D,C.get(nt),0),kt[nt]=qt);const lt=qt.width*s,Ze=qt.height*s;var nn,he;Wp(d,0,lt,Ze,0,-1,1),il(d,0,Ze,0),he=1,(nn=d)[0]*=he,nn[1]*=he,nn[2]*=he,nn[3]*=he,((Ke,Ae)=>{Ke[4]*=Ae,Ke[5]*=Ae,Ke[6]*=Ae,Ke[7]*=Ae})(d,-1),u=d,$.viewport(0,0,It,Ie),$.colorMask(!0,!0,!0,!0),$.clearColor(0,0,0,0),$.clear($.COLOR_BUFFER_BIT),w=[1,0,1,0,1,Math.max(i.width,qt.width),1,Math.max(i.width,qt.width)]},$t=(nt,Ut)=>{const{forceRelease:qt=!1}=Ut||{},{src:Dt}=rt.get(nt);Dt instanceof HTMLCanvasElement&&(qt||Dt.dataset.retain||dr(Dt)),rt.delete(nt),$.deleteTexture(nt)},Be=nt=>rt.get(nt).isRotatedVideo;return{drawPath:(nt,Ut=0,qt=!1,Dt=!1,ve,It,Ie,lt,Ze)=>{if(nt.length<2)return;const nn=nt.map(We=>({x:We.x*s,y:We.y*s})),he=ve*s;if(he>0&&K(nn,he,nl(It,Ze),Ie),nn.length<3||!lt||lt[3]===0||!Ie)return;const Ke=pw(nn),Ae=new Float32Array(6*Ke.length);Ke.forEach(([We,xn,xt],de)=>{const Ve=6*de;Ae[Ve+0]=We.x,Ae[Ve+1]=We.y,Ae[Ve+2]=xn.x,Ae[Ve+3]=xn.y,Ae[Ve+4]=xt.x,Ae[Ve+5]=xt.y}),((We,xn)=>{const{program:xt,locations:de}=vt;$.useProgram(xt),$.enableVertexAttribArray(de.aPosition),$.uniform4fv(de.uColor,xn),$.uniformMatrix4fv(de.uMatrix,!1,u),$.uniform1fv(de.uMaskBounds,b),$.uniform1f(de.uMaskOpacity,f),$.uniform4f(de.uCanvasColor,T,I,P,_),$.bindBuffer($.ARRAY_BUFFER,X),$.bufferData($.ARRAY_BUFFER,We,$.STATIC_DRAW),$.vertexAttribPointer(de.aPosition,2,$.FLOAT,!1,0,0),$.drawArrays($.TRIANGLES,0,We.length/2),$.disableVertexAttribArray(de.aPosition)})(Ae,nl(lt,Ze))},drawRect:(nt,Ut=0,qt=!1,Dt=!1,ve,It,Ie,lt,Ze,nn=!1,he,Ke,Ae,We,xn,xt=1/s,de,Ve)=>{const Oe=Ms(Mn(nt),s),Ne=ve.map(_e=>((Je,kn)=>Math.floor(oi(Je,0,Math.min(.5*(kn.width-1),.5*(kn.height-1)))))(_e||0,nt)).map(_e=>_e*s);if(It||Ie){const _e=Mn(Oe);_e.x-=.5,_e.y-=.5,_e.width+=1,_e.height+=1;const Je=Wg(_e,Ut,qt,Dt),kn=Ng(Je);let En;de&&(En=nl(de),En[3]===0&&(En[3]=.001));const Zt=lt&&nn?[_e.width/lt.width,_e.height/lt.height]:[1,1];((Dn,H,Wt,z,Qt,ce=N,ye,ue=1,Yt=Hp,Gt=Lc,hn=w,Xe=1,on)=>{const{program:xe,locations:Me}=Z;$.useProgram(xe),$.enableVertexAttribArray(Me.aPosition),$.enableVertexAttribArray(Me.aTexCoord),$.enableVertexAttribArray(Me.aRectCoord),$.uniform4fv(Me.uColor,Qt),$.uniform2fv(Me.uSize,[H,Wt]),$.uniform2fv(Me.uPosition,[Dn[2],Dn[3]]),$.uniform2fv(Me.uRepeat,ye),$.uniform1i(Me.uInverted,on?1:0),$.uniform1fv(Me.uCornerRadius,z),$.uniform4f(Me.uCanvasColor,T,I,P,_),$.uniform1fv(Me.uMaskFeather,hn.map((Yn,Se)=>Se%2==0?Yn:Yn*s)),$.uniform1fv(Me.uMaskBounds,b),$.uniform1f(Me.uMaskOpacity,f),$.uniform1f(Me.uEdgeFeather,Math.max(0,Xe)),$.uniformMatrix4fv(Me.uMatrix,!1,u),$.uniform1i(Me.uTexture,4),$.uniform4fv(Me.uTextureColor,Yt),$.uniform1f(Me.uTextureOpacity,ue),$.activeTexture($.TEXTURE0+4),$.bindTexture($.TEXTURE_2D,ce),$.bindBuffer($.ARRAY_BUFFER,Bt),$.bufferData($.ARRAY_BUFFER,Gt,$.STATIC_DRAW),$.vertexAttribPointer(Me.aTexCoord,2,$.FLOAT,!1,0,0),$.bindBuffer($.ARRAY_BUFFER,st),$.bufferData($.ARRAY_BUFFER,Lc,$.STATIC_DRAW),$.vertexAttribPointer(Me.aRectCoord,2,$.FLOAT,!1,0,0),$.bindBuffer($.ARRAY_BUFFER,mt),$.bufferData($.ARRAY_BUFFER,Dn,$.STATIC_DRAW),$.vertexAttribPointer(Me.aPosition,2,$.FLOAT,!1,0,0),$.drawArrays($.TRIANGLE_STRIP,0,Dn.length/2),$.disableVertexAttribArray(Me.aPosition),$.disableVertexAttribArray(Me.aTexCoord),$.disableVertexAttribArray(Me.aRectCoord)})(kn,_e.width,_e.height,Ne,nl(It,We),Ie,Zt,We,En,he?new Float32Array(he):Hg(_e.width,_e.height,lt,Ze,s),xn,xt*s,Ve)}Ke&&(Ke=Math.min(Ke,Oe.width,Oe.height),K(((_e,Je,kn,En,Zt,Dn,H,Wt)=>{const z=[];if(Dn.every(Qt=>Qt===0))z.push(pt(_e,Je),pt(_e+kn,Je),pt(_e+kn,Je+En),pt(_e,Je+En));else{const[Qt,ce,ye,ue]=Dn,Yt=_e,Gt=_e+kn,hn=Je,Xe=Je+En;z.push(pt(Yt+Qt,hn)),ru(z,Gt-ce,hn+ce,ce,-1),z.push(pt(Gt,hn+ce)),ru(z,Gt-ue,Xe-ue,ue,0),z.push(pt(Gt-ue,Xe)),ru(z,Yt+ye,Xe-ye,ye,1),z.push(pt(Yt,Xe-ye)),ru(z,Yt+Qt,hn+Qt,Qt,2)}return(H||Wt)&&Nl(z,H,Wt,_e+.5*kn,Je+.5*En),Zt&&ls(z,Zt,_e+.5*kn,Je+.5*En),z})(Oe.x,Oe.y,Oe.width,Oe.height,Ut,Ne,qt,Dt),Ke*s,nl(Ae,We),!0))},drawEllipse:(nt,Ut,qt,Dt,ve,It,Ie,lt,Ze,nn,he,Ke,Ae,We,xn)=>{const xt=Ms(Ci(nt.x-Ut,nt.y-qt,2*Ut,2*qt),s);if(Ie||lt){const de=Mn(xt);xn||(de.x-=.5,de.y-=.5,de.width+=1,de.height+=1);const Ve=Wg(de,Dt,ve,It);((Oe,Ne,_e,Je,kn=N,En=Lc,Zt=1,Dn=!1)=>{const{program:H,locations:Wt}=gt;$.useProgram(H),$.enableVertexAttribArray(Wt.aPosition),$.enableVertexAttribArray(Wt.aTexCoord),$.uniformMatrix4fv(Wt.uMatrix,!1,u),$.uniform2fv(Wt.uRadius,[.5*Ne,.5*_e]),$.uniform1i(Wt.uInverted,Dn?1:0),$.uniform4fv(Wt.uColor,Je),$.uniform4f(Wt.uCanvasColor,T,I,P,_),$.uniform2fv(Wt.uRepeat,[1,1]),$.uniform1fv(Wt.uMaskBounds,b),$.uniform1f(Wt.uMaskOpacity,f),$.uniform1i(Wt.uTexture,4),$.uniform1f(Wt.uTextureOpacity,Zt),$.activeTexture($.TEXTURE0+4),$.bindTexture($.TEXTURE_2D,kn),$.bindBuffer($.ARRAY_BUFFER,le),$.bufferData($.ARRAY_BUFFER,En,$.STATIC_DRAW),$.vertexAttribPointer(Wt.aTexCoord,2,$.FLOAT,!1,0,0),$.bindBuffer($.ARRAY_BUFFER,Jt),$.bufferData($.ARRAY_BUFFER,Oe,$.STATIC_DRAW),$.vertexAttribPointer(Wt.aPosition,2,$.FLOAT,!1,0,0),$.drawArrays($.TRIANGLE_STRIP,0,Oe.length/2),$.disableVertexAttribArray(Wt.aPosition),$.disableVertexAttribArray(Wt.aTexCoord)})(Ng(Ve),de.width,de.height,nl(Ie,We),lt,he?new Float32Array(he):Hg(de.width,de.height,Ze,nn,s),We,xn)}Ke&&K(((de,Ve,Oe,Ne,_e,Je,kn)=>{const En=.5*Math.abs(Oe),Zt=.5*Math.abs(Ne),Dn=Math.abs(Oe)+Math.abs(Ne),H=Math.max(20,Math.round(Dn/6));return Au(pt(de+En,Ve+Zt),En,Zt,_e,Je,kn,H)})(xt.x,xt.y,xt.width,xt.height,Dt,ve,It),Ke*s,nl(Ae,We),!0)},drawImage:(nt,Ut,qt,Dt,ve,It,Ie,lt,Ze,nn,he=gw,Ke=1,Ae,We=1,xn=0,xt=v,de=fw,Ve=Hp,Oe=!1,Ne=!1,_e=!0)=>{const Je=Ut.width*s,kn=Ut.height*s,En=-.5*Je,Zt=.5*kn,Dn=.5*Je,H=-.5*kn,Wt=new Float32Array([En,H,0,En,Zt,0,Dn,H,0,Dn,Zt,0]);$.bindBuffer($.ARRAY_BUFFER,q),$.bufferData($.ARRAY_BUFFER,Wt,$.STATIC_DRAW);const z=Ut.height/2/O*(i.height/Ut.height)*-1;ve*=s,It*=s,qt*=s,Dt*=s;const{program:Qt,locations:ce}=at,ye=Np();((xe,Me,Yn,Se,J)=>{const Xt=1/Math.tan(Me/2),jt=1/(Se-J);xe[0]=Xt/Yn,xe[1]=0,xe[2]=0,xe[3]=0,xe[4]=0,xe[5]=Xt,xe[6]=0,xe[7]=0,xe[8]=0,xe[9]=0,xe[10]=(J+Se)*jt,xe[11]=-1,xe[12]=0,xe[13]=0,xe[14]=2*J*Se*jt,xe[15]=0})(ye,G,a,1,2*-z),il(ye,ve,-It,z),il(ye,qt,-Dt,0),zg(ye,-Ze),Fg(ye,nn),il(ye,-qt,Dt,0),Dg(ye,lt),_g(ye,Ie),$.useProgram(Qt),$.enableVertexAttribArray(ce.aPosition),$.enableVertexAttribArray(ce.aTexCoord),$.uniform1i(ce.uTexture,3),$.uniform2f(ce.uTextureSize,Ut.width,Ut.height),$.activeTexture($.TEXTURE0+3),$.bindTexture($.TEXTURE_2D,nt);const ue=Ne?1:0,Yt=C.get(ue);$.uniform1i(ce.uTextureBlend,ue),$.activeTexture($.TEXTURE0+ue),$.bindTexture($.TEXTURE_2D,Yt);const Gt=Oe?2:0,hn=C.get(Gt);$.uniform1i(ce.uTextureOverlay,Gt),$.activeTexture($.TEXTURE0+Gt),$.bindTexture($.TEXTURE_2D,hn),$.bindBuffer($.ARRAY_BUFFER,q),$.vertexAttribPointer(ce.aPosition,3,$.FLOAT,!1,0,0);const Xe=mw&&Be(nt);let on;$.bindBuffer($.ARRAY_BUFFER,Xe?V:ct),$.vertexAttribPointer(ce.aTexCoord,2,$.FLOAT,!1,0,0),$.uniformMatrix4fv(ce.uMatrix,!1,ye),$.uniform4fv(ce.uOverlayColor,Ve),!Ae||Os(Ae,Vg)?(Ae=Vg,on=-1):(on=Ae.reduce((xe,Me)=>xe+Me,0),on=on<=0?1:on),$.uniform1fv(ce.uClarityKernel,Ae),$.uniform1f(ce.uClarityKernelWeight,on),$.uniform1f(ce.uColorGamma,1/We),$.uniform1f(ce.uColorVignette,xn),$.uniform1i(ce.uAntialias,_e?1:0),$.uniform4f(ce.uColorOffset,he[4],he[9],he[14],he[19]),$.uniformMatrix4fv(ce.uColorMatrix,!1,[he[0],he[1],he[2],he[3],he[5],he[6],he[7],he[8],he[10],he[11],he[12],he[13],he[15],he[16],he[17],he[18]]),$.uniform1f(ce.uOpacity,Ke),$.uniform1f(ce.uMaskOpacity,f),$.uniform1fv(ce.uMaskBounds,b),$.uniform1fv(ce.uMaskCornerRadius,de.map(xe=>xe*s)),$.uniform1fv(ce.uMaskFeather,xt.map((xe,Me)=>Me%2==0?xe:xe*s)),$.drawArrays($.TRIANGLE_STRIP,0,4),$.disableVertexAttribArray(ce.aPosition),$.disableVertexAttribArray(ce.aTexCoord)},textureFilterNearest:$.NEAREST,textureFilterLinear:$.LINEAR,textureClamp:$.CLAMP_TO_EDGE,textureRepeat:$.REPEAT,textureCreate:()=>$.createTexture(),textureUpdate:(nt,Ut,qt)=>(rt.set(nt,{src:Ut,options:qt,isRotatedVideo:Ut.nodeName==="VIDEO"&&(Ut.dataset&&Ut.dataset.rotation==90||Ut.dataset.rotation==270)}),cw($,nt,Ut,qt)),textureGetSize:nt=>{const{src:Ut,options:qt}=rt.get(nt),Dt=Wa(Ut);return qt.scalar?cs(Dt,ve=>ve/qt.scalar):Dt},textureDelete:$t,enablePreviewStencil:()=>{$.stencilOp($.KEEP,$.KEEP,$.REPLACE),$.stencilFunc($.ALWAYS,1,255),$.stencilMask(255)},applyPreviewStencil:()=>{$.stencilFunc($.EQUAL,1,255),$.stencilMask(0)},disablePreviewStencil:F,setCanvasColor(nt){T=nt[0],I=nt[1],P=nt[2],_=n?nt[3]:1,$.clear($.COLOR_BUFFER_BIT)},resetCanvasMatrix:()=>{Wp(c,0,i.width,i.height,0,-1,1)},updateCanvasMatrix(nt,Ut,qt,Dt,ve){const It=nt.width,Ie=nt.height,lt=i.width*(.5/s),Ze=i.height*(.5/s),nn={x:lt+(qt.x+Ut.x),y:Ze+(qt.y+Ut.y)},he={x:nn.x-Ut.x,y:nn.y-Ut.y},Ke=.5*It,Ae=.5*Ie;Gr(he,ve.z,nn),_b(he,Dt,nn),il(c,(he.x-Ke)*s,(he.y-Ae)*s,0),il(c,Ke*s,Ae*s,0),zg(c,ve.z);const We=ve.x>Math.PI/2;_g(c,We?Math.PI:0);const xn=ve.y>Math.PI/2;Dg(c,xn?Math.PI:0),Fg(c,Dt),il(c,-Ke*s,-Ae*s,0)},drawToCanvas(){$.bindFramebuffer($.FRAMEBUFFER,null),u=c,$.viewport(0,0,$.drawingBufferWidth,$.drawingBufferHeight),$.colorMask(!0,!0,!0,!0),$.clearColor(T,I,P,_),$.clear($.COLOR_BUFFER_BIT),w=[1,0,1,0,1,i.width,1,i.width]},drawToImageBlendBuffer(nt,Ut){Nt(1,ot,nt,Ut)},drawToImageOverlayBuffer(nt,Ut){Nt(2,M,nt,Ut)},enableMask(nt,Ut){const qt=nt.x*s,Dt=nt.y*s,ve=nt.width*s,It=nt.height*s;m=qt,h=m+ve,p=i.height-Dt,y=i.height-(Dt+It),f=1-Ut,b=[p,h,y,m]},disableMask(){m=0,h=i.width,p=i.height,y=0,f=1,b=[p,h,y,m]},resize:(nt,Ut,qt)=>{s=Math.max(1,qt),l=s===1?.75:1,r.width=nt,r.height=Ut,i.width=nt*s,i.height=Ut*s,a=as(i.width,i.height),t.width=i.width,t.height=i.height,Wp(c,0,i.width,i.height,0,-1,1),v=[1,0,1,0,1,r.width,1,r.width]},release(){Array.from(rt.keys()).forEach(nt=>$t(nt,{forceRelease:!0})),rt.clear(),C.forEach(nt=>{$.deleteTexture(nt)}),C.clear(),at.destroy(),ut.destroy(),vt.destroy(),Z.destroy(),gt.destroy(),t.width=1,t.height=1,t=void 0}}};function yw(t){return Math.sqrt(1- --t*t)}function Ug(t){return Object.prototype.toString.call(t)==="[object Date]"}function Ch(t,e){if(t===e||t!=t)return()=>t;const n=typeof t;if(n!==typeof e||Array.isArray(t)!==Array.isArray(e))throw new Error("Cannot interpolate values of different type");if(Array.isArray(t)){const i=e.map((r,o)=>Ch(t[o],r));return r=>i.map(o=>o(r))}if(n==="object"){if(!t||!e)throw new Error("Object cannot be null");if(Ug(t)&&Ug(e)){t=t.getTime();const o=(e=e.getTime())-t;return a=>new Date(t+a*o)}const i=Object.keys(e),r={};return i.forEach(o=>{r[o]=Ch(t[o],e[o])}),o=>{const a={};return i.forEach(s=>{a[s]=r[s](o)}),a}}if(n==="number"){const i=e-t;return r=>t+r*i}throw new Error(`Cannot interpolate ${n} values`)}function g0(t,e={}){const n=me(t);let i,r=t;function o(a,s){if(t==null)return n.set(t=a),Promise.resolve();r=a;let l=i,c=!1,{delay:d=0,duration:u=400,easing:p=m2,interpolate:h=Ch}=ki(ki({},e),s);if(u===0)return l&&(l.abort(),l=null),n.set(t=r),Promise.resolve();const y=y2()+d;let m;return i=o0(f=>{if(f<y)return!0;c||(m=h(t,a),typeof u=="function"&&(u=u(t,a)),c=!0),l&&(l.abort(),l=null);const b=f-y;return b>u?(n.set(t=a),!1):(n.set(t=m(p(b/u))),!0)}),i.promise}return{set:o,update:(a,s)=>o(a(r,t),s),subscribe:n.subscribe}}function Mh(t,e,n,i){if(typeof n=="number"){const r=i-n,o=(n-e)/(t.dt||1/60),a=(o+(t.opts.stiffness*r-t.opts.damping*o)*t.inv_mass)*t.dt;return Math.abs(a)<t.opts.precision&&Math.abs(r)<t.opts.precision?i:(t.settled=!1,n+a)}if(qi(n))return n.map((r,o)=>Mh(t,e[o],n[o],i[o]));if(typeof n=="object"){const r={};for(const o in n)r[o]=Mh(t,e[o],n[o],i[o]);return r}throw new Error(`Cannot spring ${typeof n} values`)}function fn(t,e={}){const n=me(t),{stiffness:i=.15,damping:r=.8,precision:o=.01}=e;let a,s,l,c=t,d=t,u=1,p=0,h=!1;function y(f,b={}){d=f;const v=l={};if(t==null||b.hard||m.stiffness>=1&&m.damping>=1)return h=!0,a=null,c=f,n.set(t=d),Promise.resolve();if(b.soft&&(p=1/(60*(b.soft===!0?.5:+b.soft)),u=0),!s){a=null,h=!1;const w={inv_mass:void 0,opts:m,settled:!0,dt:void 0};s=o0(T=>{if(a===null&&(a=T),h)return h=!1,s=null,!1;u=Math.min(u+p,1),w.inv_mass=u,w.opts=m,w.settled=!0,w.dt=60*(T-a)/1e3;const I=Mh(w,c,t,d);return a=T,c=t,n.set(t=I),w.settled&&(s=null),!w.settled})}return new Promise(w=>{s.promise.then(()=>{v===l&&w()})})}const m={set:y,update:(f,b)=>y(f(d,t),b),subscribe:n.subscribe,stiffness:i,damping:r,precision:o};return m}var xw=zl(!1,t=>{const e=window.matchMedia("(prefers-reduced-motion:reduce)"),n=()=>t(e.matches);return n(),e.addListener(n),()=>e.removeListener(n)}),Gg=()=>"ResizeObserver"in window;const Up=Cs(),X2=(t,e,n,i,r)=>{t.rect||(t.rect=Cs());const o=t.rect;Ly(Up,e,n,i,r),ea(o,Up)||(Zu(o,Up),t.dispatchEvent(new CustomEvent("measure",{detail:o})))},au=Math.round,bw=t=>{const e=t.getBoundingClientRect();ya&&X2(t,au(e.x),au(e.y),au(e.width),au(e.height))},Gp=t=>{ya&&X2(t,t.offsetLeft,t.offsetTop,t.offsetWidth,t.offsetHeight)},Nc=[];let rl,fa,ya;function kh(){Nc.length?(Nc.forEach(t=>t.measure(t)),ya=requestAnimationFrame(kh)):ya=void 0}let su=new Map([]),kc=0,jp=0;var Cr=(t,e={})=>{const{observePosition:n=!1,observeViewRect:i=!1,once:r=!1,disabled:o=!1,isMeasureRoot:a=!1}=e;if(Gg()&&a&&(fa||(fa=new ResizeObserver(s=>{s.forEach(c=>{su.set(c.target,c.contentRect)});const l=Array.from(su.values()).some(({width:c,height:d})=>c>0&&d>0);l?l&&ya===!1&&kh():(ya&&cancelAnimationFrame(ya),ya=!1)})),fa.observe(t),kc++),!o)return!Gg()||n||i?(t.measure=i?bw:Gp,Nc.push(t),ya===void 0&&(ya=requestAnimationFrame(kh)),t.measure(t),{destroy(){a&&fa&&(su.delete(t),fa.unobserve(t),kc--,kc===0&&(fa.disconnect(),fa=void 0));const s=Nc.indexOf(t);Nc.splice(s,1),delete t.measure}}):(rl||(rl=new ResizeObserver(s=>{s.forEach(l=>{ya&&Gp(l.target)})})),rl.observe(t),Gp(t),r?rl.unobserve(t):jp++,{destroy(){a&&fa&&(su.delete(t),fa.unobserve(t),kc--,kc===0&&(fa.disconnect(),fa=void 0)),r||(rl.unobserve(t),jp--,jp===0&&(rl.disconnect(),rl=void 0))}})},vw=t=>{let e=!1;const n={pointerdown:()=>{e=!1},keydown:()=>{e=!0},keyup:()=>{e=!1},focus:i=>{e&&(i.target.dataset.focusVisible="")},blur:i=>{delete i.target.dataset.focusVisible}};return Object.keys(n).forEach(i=>t.addEventListener(i,n[i],!0)),{destroy(){Object.keys(n).forEach(i=>t.removeEventListener(i,n[i],!0))}}};const ww=async t=>new Promise(e=>{if(t.kind==="file")return e(t.getAsFile());t.getAsString(e)});var q2=(t,e={})=>{const n=r=>{r.preventDefault()},i=async r=>{r.preventDefault(),r.stopPropagation();try{const o=await(a=>new Promise((s,l)=>{const{items:c}=a.dataTransfer;if(!c)return s([]);Promise.all(Array.from(c).map(ww)).then(d=>{s(d.filter(u=>jl(u)&&Xu(u)||/^http/.test(u)))}).catch(l)}))(r);t.dispatchEvent(new CustomEvent("dropfiles",{detail:{event:r,resources:o},...e}))}catch{}};return t.addEventListener("drop",i),t.addEventListener("dragover",n),{destroy(){t.removeEventListener("drop",i),t.removeEventListener("dragover",n)}}};let lu=null;var f0=()=>{if(lu===null)if(ir()){const t=fi("canvas");lu=!Ku(t,{failIfMajorPerformanceCaveat:!0}),dr(t)}else lu=!1;return lu},Zp=t=>t instanceof WebGLTexture,jg=([t,e,n,i])=>[i.x,i.y,t.x,t.y,n.x,n.y,e.x,e.y];function Sw(t){let e,n,i,r;return{c(){e=ft("div"),n=ft("canvas"),S(e,"class","PinturaCanvas")},m(o,a){tt(o,e,a),Et(e,n),t[37](n),i||(r=[St(n,"measure",t[38]),qn(Cr.call(null,n))],i=!0)},p:tn,i:tn,o:tn,d(o){o&&Q(e),t[37](null),i=!1,Zn(r)}}}function Tw(t,e,n){let i,r,o,a,s,l,c;const d=[0,0,0,0],u=hi(),p=ir()&&(H=>{const Wt=.5*H,z=fi("canvas",{"data-retain":!0,width:H,height:H}),Qt=z.getContext("2d");return Qt.fillStyle="#f0f",Qt.fillRect(0,0,Wt,Wt),Qt.fillRect(Wt,Wt,Wt,Wt),z})(128),h=la();let y,{isAnimated:m}=e,{isTransparent:f}=e,{maskRect:b}=e,{maskOpacity:v=1}=e,{maskFrameOpacity:w=.95}=e,{maskMarkupOpacity:T=1}=e,{clipAnnotationsToImage:I=!0}=e,{pixelRatio:P=1}=e,{textPixelRatio:_=P}=e,{backgroundColor:C}=e,{willRender:F=ni}=e,{didRender:G=ni}=e,{willRequest:O}=e,{csp:$}=e,{loadImageData:N=ni}=e,{enableGrid:it=!1}=e,{gridColors:M}=e,{gridSize:W}=e,{gridOpacity:ot=0}=e,{images:at=[]}=e,{interfaceImages:q=[]}=e,{selectionColor:ct}=e,V=null,ut=null,bt=null;const K=(H,Wt)=>H.set(Wt,{hard:!m}),vt={precision:1e-4*.01};let X=0;const Z=g0(void 0,{duration:0});D(t,Z,H=>n(36,c=H));const mt=fn(1,vt);D(t,mt,H=>n(35,s=H));const Bt=fn(1,vt);D(t,Bt,H=>n(51,o=H));const st=me();D(t,st,H=>n(53,l=H));const gt=me();D(t,gt,H=>n(52,a=H));const Jt={},le=(H,Wt)=>{let z=Jt[H.id];const Qt=Math.min(1,2048/Wt.width);let ce=z?z.element:fi("canvas",{width:Wt.width*Qt,height:Wt.height*Qt,"data-retain":!0});if(!z||((ye,ue)=>{if(ye.total!==ue.length)return!0;const Yt=ye.last,Gt=ue[ue.length-1];return Yt.drawMode!==Gt.drawMode||!(!ko(Yt)||ko(Gt)&&ea(Yt,Gt))||!(!er(Yt)||er(Gt)&&Yt.x===Gt.x&&Yt.y===Gt.y&&Yt.rx===Gt.rx&&Yt.ry===Gt.ry)||!(!Ni(Yt)||Ni(Gt)&&Gt.points.length===Yt.points.length)})(z,H.actions)){ce=ce.cloneNode(),((ue,Yt,Gt)=>{const{selectionColor:hn=[1,1,1],scalar:Xe=1}=Gt||{};let on=!1;for(const xe of Yt){const Me=xe.drawMode==="subtract";if(Me&&!on)continue;ue.globalCompositeOperation=Me?"destination-out":"source-over",ue.save(),ue.beginPath();const Yn=c2(xe);Zy(ue,Xe,Xe),qh(ue,xe.rotation,Yn),u2(ue,xe.flipX,xe.flipY,Yn),xe.width?t0(ue,{...xe,backgroundColor:hn}):xe.points?vh(ue,Object.assign({},xe,xe.pathClose?{backgroundColor:hn,strokeColor:[0,0,0,0]}:{strokeColor:hn,strokeJoin:"round",strokeCap:"round"})):xe.rx&&e0(ue,{...xe,backgroundColor:hn,strokeColor:[0,0,0,0],strokeJoin:"round",strokeCap:"round"}),ue.restore(),on=!0}})(ce.getContext("2d"),H.actions,{selectionColor:[1,0,1],scalar:Qt});const ye=H.actions.length;Jt[H.id]={total:ye,last:{...H.actions[ye-1]},element:ce}}return{x:0,y:0,...Wt,fillColor:H.color||[1,1,1],backgroundImage:ce}};let rt;const kt=()=>{cancelAnimationFrame(rt),rt=requestAnimationFrame(()=>{xn=!0,Zt=0,r()})},Nt=new Map([]),$t=new Map([]),Be=(H,Wt)=>({filterParam:H==="pixelated"?V.textureFilterNearest:V.textureFilterLinear,wrapParam:Wt==="repeat"?V.textureRepeat:V.textureClamp}),nt=(H,Wt,z)=>{if(!Nt.has(H)){Nt.set(H,H);const ye=Be(Wt,z);if(!Qe(Qt=H)&&(Gy(Qt)||Vc(Qt)||ed(Qt)||Ou(Qt))){const ue=V.textureCreate();V.textureUpdate(ue,H,ye),Nt.set(H,ue)}else N(H).then(ue=>{if(!V||!ue)return;const Yt=V.textureCreate();V.textureUpdate(Yt,ue,ye),Nt.set(H,Yt),kt()}).catch(ue=>{Nt.set(H,ue)})}var Qt,ce;if(Ou(H)&&((ce=H).currentTime>0&&!ce.paused&&!ce.ended&&ce.readyState>2||H.dataset.redraw==="true")){const ye=Nt.get(H),ue=Be(Wt,z);return V.textureUpdate(ye,H,ue),H.dataset.redraw=!1,ye}return Nt.get(H)},Ut=(H,Wt={})=>{const z=Wt.id||H.id;if(H.width&&H.width<1||H.height&&H.height<1||!H.text.length)return void $t.delete(z);let{text:Qt,textAlign:ce,fontFamily:ye,fontSize:ue=16,fontWeight:Yt,fontVariant:Gt,fontStyle:hn,letterSpacing:Xe,lineHeight:on=ue,width:xe,height:Me}=H,{outline:Yn=0,blur:Se=0,paddingTop:J=0,paddingRight:Xt=0,paddingBottom:jt=0,paddingLeft:se=0}=Wt;xe=dn(xe)?Math.floor(xe):xe,Me=dn(Me)?Math.floor(Me):Me;const{textSize:Fe,signature:ke}=((si="",ge)=>{let{width:an=0,height:we="auto",fontSize:Ge,fontFamily:Le,lineHeight:Ht,fontWeight:Pe,fontStyle:Cn,fontVariant:Un,letterSpacing:bi}=ge;const Pi=bu({text:si,fontFamily:Le,fontWeight:Pe,fontStyle:Cn,fontVariant:Un,fontSize:Ge,lineHeight:Ht,letterSpacing:bi,width:an,height:we});let Hi=Jm.get(Pi);if(Hi)return Hi;let Xn=1;Ge>1e3&&va()&&(Xn=Ge/1e3,Ge=1e3,Ht*=Xn);const Ui=jh(fi("pre",{contenteditable:"true",spellcheck:"false",style:`${Jy}${Yh({fontFamily:Le,fontWeight:Pe,fontStyle:Cn,fontVariant:Un,fontSize:Ge,letterSpacing:bi,lineHeight:Ht})};${Kh(si,ge)}"`,innerHTML:si})),yr=Ui.getBoundingClientRect();return Hi={signature:Ky(Ui).flat().map(gr=>gr.text).join("_;_"),textSize:cs(Wa(yr),gr=>Math.ceil(gr*Xn))},Jm.set(Pi,Hi),Ui.remove(),Hi})(Qt,{...H,width:xe,height:void 0}),be=bu({text:Qt,textAlign:ce,fontFamily:ye,fontSize:ue,fontWeight:Yt,fontVariant:Gt,fontStyle:hn,lineHeight:on,letterSpacing:Xe,outline:Yn,blur:Se,signature:ke});if(!Nt.has(be)){Nt.set(be,Qt);const si=Math.ceil(Fe.width),ge=Math.ceil(Fe.height);if(si===0||ge===0)return;const an=h0(),we=Math.min(1,(an-(se+Xt)*_)/(si*_),(an-(J+jt)*_)/(ge*_));t2(Qt,{fontSize:ue,fontFamily:ye,fontWeight:Yt,fontVariant:Gt,fontStyle:hn,letterSpacing:Xe,textAlign:ce,lineHeight:on,width:xe,height:Me,imageWidth:si,imageHeight:ge,paddingLeft:se,paddingTop:J,paddingRight:Xt,paddingBottom:jt,pixelRatio:_*we,willRequest:O,outline:Yn,blur:Se,styleNonce:$.styleNonce,color:[1,0,1]}).then(Ge=>{if(!V)return;const Le=V.textureCreate();V.textureUpdate(Le,Ge,{filterParam:V.textureFilterLinear,wrapParam:V.textureClamp,scalar:we}),Nt.set(be,Le),$t.set(z,Le),kt()}).catch(console.error)}const mi=Nt.get(be);return Zp(mi)?mi:$t.get(z)},qt=new Map,Dt=H=>{let Wt;return H.backgroundImage?Wt=nt(H.backgroundImage,H.backgroundImageRendering,H.backgroundRepeat==="repeat"?"repeat":void 0):H.bitmap&&H.points&&(Wt=(z=>{const{id:Qt,points:ce,strokeWidth:ye,strokeCap:ue,strokeJoin:Yt,strokeColor:Gt,strokeDash:hn}=z;let Xe=Nt.get(Qt),on=qt.get(Qt);const xe=bu({points:ce.map(ke=>`${ke.x},${ke.y}`).join(","),strokeWidth:ye,strokeCap:ue,strokeJoin:Yt,strokeColor:Gt,strokeDash:(hn||[]).join(",")});if(on){const{hash:ke}=on;if(Nt.has(Qt)){if(xe===ke)return Nt.get(Qt)}else on=void 0}if(!on){const ke=fi("canvas",{width:1,height:1});on={canvas:ke,hash:void 0},qt.set(z.id,on),Xe=V.textureCreate(),V.textureUpdate(Xe,ke,{filterParam:V.textureFilterLinear,wrapParam:V.textureClamp}),Nt.set(Qt,Xe)}const{canvas:Me}=on,Yn=Math.ceil(z.strokeWidth),Se=Vi(ce),J=Math.floor(Se.x)-.5*Yn,Xt=Math.floor(Se.y)-.5*Yn,jt=Math.ceil(Se.width+Yn),se=Math.ceil(Se.height+Yn);Me.width=Math.max(jt,1),Me.height=Math.max(se,1);const Fe=Me.getContext("2d");return Fe.clearRect(0,0,Me.width,Me.height),jt>=1&&se>=1&&(Fe.translate(-J,-Xt),vh(Fe,z),Fe.resetTransform()),V.textureUpdate(Xe,Me,{filterParam:V.textureFilterLinear,wrapParam:V.textureClamp}),qt.set(Qt,{canvas:Me,hash:xe}),Nt.get(Qt)})(H)),Wt},ve=({texture:H,size:Wt,origin:z,translation:Qt,rotation:ce,scale:ye,colorMatrix:ue,opacity:Yt,convolutionMatrix:Gt,gamma:hn,vignette:Xe,maskFeather:on,maskCornerRadius:xe,overlayColor:Me,enableOverlay:Yn,enableManipulation:Se,enableAntialiasing:J})=>{let Xt=0,jt=0;if(P===1){const se=Math.abs(1-ye)<Number.EPSILON;Xt=se&&ut%2!=0?.5:0,jt=se&&bt%2!=0?.5:0}return V.drawImage(H,Wt,z.x,z.y,Qt.x+Xt,Qt.y+jt,ce.x,ce.y,ce.z,ye,ue,oi(Yt,0,1),Gt,hn,Xe,on,xe,Me,Yn,Se,J),H},It=(H,Wt,z)=>{const Qt=wn(Wt),ce=wn(H),ye=Qt.x-ce.x,ue=Qt.y-ce.y,Yt=Gr(Qt,z,ce);return{x:Yt.x-ce.x-ye,y:Yt.y-ce.y-ue}},Ie=(H=[],Wt)=>{H.forEach(z=>{let Qt=Dt(z);const ce=z.status!=="complete"&&(z.status==="loading"||z.backgroundImage&&Qt===z.backgroundImage);ce&&kt();const ye=z.status==="error"||z.backgroundImage&&Qt instanceof Error;let ue=Zp(Qt)?Qt:void 0;const Yt=z._scale||1,Gt=z._translate||u,hn=z.strokeWidth&&z.strokeWidth*Yt,Xe=z.cornerRadius?((Se,J)=>[Se,Se,Se,Se].map(Xt=>Xt*J))(z.cornerRadius,Yt):d,on=!!z.width,xe=Qe(z.text),Me=qi(z.points),Yn=er(z);if(Me){const Se=z.points.map(J=>pt(J.x*Yt+Gt.x,J.y*Yt+Gt.y));if(z.bitmap){Qt&&Wt.push(Qt);const J=Vi(Se),Xt=Math.ceil(z.strokeWidth*Yt);V.drawRect({x:Math.floor(J.x)-.5*Xt,y:Math.floor(J.y)-.5*Xt,width:Math.ceil(J.width+Xt),height:Math.ceil(J.height+Xt)},z.rotation,z.flipX,z.flipY,[0,0,0,0],void 0,ue,void 0,void 0,void 0,void 0,void 0,void 0,z.opacity,void 0,void 0,!1,!1)}else V.drawPath(Se,z.rotation,z.flipX,z.flipY,hn,z.strokeColor,z.pathClose,z.backgroundColor,z.opacity)}else if(Yn){let Se=z.x,J=z.y;Se*=Yt,J*=Yt,Se+=Gt.x,J+=Gt.y;const Xt=pt(Se,J);V.drawEllipse(Xt,z.rx*Yt,z.ry*Yt,z.rotation,z.flipX,z.flipY,z.backgroundColor,ue,void 0,void 0,z.backgroundCorners&&jg(z.backgroundCorners),hn,z.strokeColor,z.opacity,z.inverted),Qt&&Wt.push(Qt),(ce||ye)&&(z.backgroundColor||z.strokeColor&&z.strokeWidth||V.drawEllipse(Xt,z.rx*Yt,z.ry*Yt,z.rotation,z.flipX,z.flipY,ye?[1,0,0,.25*z.opacity]:[0,0,0,.25*z.opacity]),ye&&Ae(Xt),ce&&Ke(Xt))}else if(xe){const{fontSize:Se=16}=z,J=Se>1e3&&va()?Se/1e3:1,Xt=Math.max(16,Math.ceil(Se/J*.25)),jt=Math.abs(z.rotation)>0,se=Do(z.text,z),Fe={x:z.x*Yt+Gt.x,y:z.y*Yt+Gt.y,width:se.width*Yt,height:se.height*Yt},ke=!!z.height;(z.backgroundColor||z.strokeColor)&&V.drawRect(Fe,z.rotation,z.flipX,z.flipY,Xe,z.backgroundColor,void 0,void 0,void 0,!1,void 0,hn,z.strokeColor,z.opacity,void 0,void 0,void 0,z.inverted);const{textShadowX:be,textShadowY:mi,textShadowBlur:si}=z;if(be||mi||si){const an=Math.ceil(.5*si),we=Math.max(Xt,ke?0:an),Ge=Ut(z,{id:z.id+"shadow",blur:si,paddingTop:we,paddingRight:we,paddingBottom:we,paddingLeft:we});if(Ge&&!z._prerender){Wt.push(Ge);const Le=V.textureGetSize(Ge),Ht={x:0,y:0},Pe={width:Le.width/_*Yt,height:Le.height/_*Yt},Cn=Xt*Yt/J;let Un;if(ke)Un={...Fe},Ht.x=be-Cn,Ht.y=mi-Cn;else if(Un={x:z.x*Yt+Gt.x-Cn,y:z.y*Yt+Gt.y-Cn,width:Pe.width,height:Pe.height},jt){const bi=It(Fe,Un,z.rotation);Un.x+=bi.x,Un.y+=bi.y;const Pi=Gr(pt(be,mi),z.rotation);Un.x+=Pi.x,Un.y+=Pi.y}else Un.x+=be,Un.y+=mi;V.drawRect(Un,z.rotation,z.flipX,z.flipY,[0,0,0,0],void 0,Ge,Pe,Ht,!1,void 0,void 0,void 0,z.opacity,void 0,0,z.textShadowColor)}}if(z.textOutlineWidth){const an=Math.ceil(.5*z.textOutlineWidth),we=Xt+an,Ge=Ut(z,{id:z.id+"outline",outline:z.textOutlineWidth,paddingTop:we,paddingRight:we,paddingBottom:we,paddingLeft:we});if(Ge&&!z._prerender){Wt.push(Ge);const Le=V.textureGetSize(Ge),Ht={x:0,y:0},Pe={width:Le.width/_*Yt,height:Le.height/_*Yt},Cn=(Xt+an)*Yt/J,Un={x:z.x*Yt+Gt.x-Cn,y:z.y*Yt+Gt.y-Cn,width:Pe.width,height:z.height?se.height+Cn:Pe.height};if(jt){const bi=It(Fe,Un,z.rotation);Un.x+=bi.x,Un.y+=bi.y}V.drawRect(Un,z.rotation,z.flipX,z.flipY,[0,0,0,0],void 0,Ge,Pe,Ht,!1,void 0,void 0,void 0,z.opacity,void 0,0,z.textOutlineColor)}}const ge=Ut(z,{id:z.id+"text",paddingTop:Xt,paddingRight:Xt,paddingBottom:Xt,paddingLeft:Xt});if(ge&&!z._prerender){Wt.push(ge);const an=V.textureGetSize(ge),we={x:0,y:0},Ge={width:an.width/_*Yt,height:an.height/_*Yt},Le=Xt*Yt/J,Ht={x:z.x*Yt+Gt.x-Le,y:z.y*Yt+Gt.y-Le,width:Ge.width,height:z.height?se.height+Le:Ge.height};if(jt){const Cn=It(Fe,Ht,z.rotation);Ht.x+=Cn.x,Ht.y+=Cn.y}const Pe=z.color||[0,0,0];z._prerender&&(Pe[3]=0),V.drawRect(Ht,z.rotation,z.flipX,z.flipY,d,!1,ge,Ge,we,!1,!1,void 0,void 0,z.opacity,void 0,z.feather,Pe,z.inverted)}}else if(on){Qt&&Wt.push(Qt);const Se=vs(z);let J,Xt;Yt&&Gt&&(Se.x*=Yt,Se.y*=Yt,Se.x+=Gt.x,Se.y+=Gt.y,Se.width*=Yt,Se.height*=Yt);const{backgroundRepeat:jt="no-repeat"}=z,se=ue&&V.textureGetSize(ue);if(se&&z.backgroundImage&&(z.backgroundSize||z.backgroundPosition||z.backgroundRepeat)){const Fe=as(se.width,se.height);if(z.backgroundRepeat==="repeat"&&(J={...se},Xt={x:0,y:0}),z.backgroundSize==="contain"){const ke=Kr(Se,Fe,Se);J=dl(ke),Xt=z.backgroundPosition?z.backgroundPosition:pt(.5*(Se.width-J.width),.5*(Se.height-J.height))}else if(z.backgroundSize==="cover"){const ke=Ls(Se,Fe,Se);J=dl(ke),z.backgroundPosition?Xt=z.backgroundPosition:(Xt=pt(ke.x,ke.y),Xt=pt(.5*(Se.width-J.width),.5*(Se.height-J.height)))}else z.backgroundSize?(J=z.backgroundSize,Xt=z.backgroundPosition||{x:0,y:0}):z.backgroundPosition&&(J={...se},Xt=z.backgroundPosition)}if(V.drawRect(Se,z.rotation,z.flipX,z.flipY,Xe,z.backgroundColor,ue,J,Xt,jt==="repeat",z.backgroundCorners&&jg(z.backgroundCorners),hn,z.strokeColor,z.opacity,void 0,z.feather,z.fillColor,z.inverted),ce||ye){z.backgroundColor&&z.backgroundColor[3]!==0||z.strokeColor&&z.strokeWidth||V.drawRect(Se,z.rotation,z.flipX,z.flipY,Xe,ye?[1,.2549,.2118,.25*z.opacity]:[0,0,0,.25*z.opacity]);const Fe=wn(Se);ye&&Ae(Fe),ce&&Ke(Fe)}}else Qt&&Wt.push(Qt)})};let lt=0;const Ze=[{x:-5,y:-5},{x:5,y:5}],nn=[{x:5,y:-5},{x:-5,y:5}],he=Au({x:0,y:0},10,10,0,!1,!1,16);he.length=9;const Ke=H=>{lt=Date.now()/50,V.drawEllipse(H,15,15,0,!1,!1,[0,0,0,.5]);const Wt=ls(he.map(z=>({x:z.x+H.x,y:z.y+H.y})),lt,H.x,H.y);V.drawPath(Wt,0,!1,!1,2,[1,1,1])},Ae=H=>{V.drawEllipse(H,13,13,0,!1,!1,[1,.2549,.2118,.75]);const Wt=Ze.map(Qt=>({x:Qt.x+H.x,y:Qt.y+H.y})),z=nn.map(Qt=>({x:Qt.x+H.x,y:Qt.y+H.y}));V.drawPath(Wt,0,!1,!1,3,[1,1,1]),V.drawPath(z,0,!1,!1,3,[1,1,1])},We=(H,Wt,z,Qt,ce,ye)=>V.drawRect(Wt,0,!1,!1,d,d,H,Qt,z,!0,void 0,0,void 0,ye,void 0,void 0,ce);let xn=!1,xt=!0,de=!1;const Ve=[],Oe=[],Ne=[],_e=H=>!H.aboveFrame,Je=H=>H.aboveFrame,kn=()=>{Ne.length=0;const H=at[0],{manipulationShapes:Wt,manipulationShapesDirty:z,annotationShapes:Qt,annotationShapesDirty:ce,interfaceShapes:ye,decorationShapes:ue,frameShapes:Yt,selectionShapes:Gt}=F({opacity:H.opacity,rotation:H.rotation,scale:H.scale,images:at,size:sr(ut,bt),backgroundColor:[...c],selectionRect:l}),hn=[...c],Xe=l,on=oi(s,0,1),xe=a,Me=Math.abs(H.rotation.x/Math.PI*2-1),Yn=Math.abs(H.rotation.y/Math.PI*2-1),Se=Me<.99||Yn<.99,J={...H.size},Xt=H.backgroundColor,jt=H.backgroundImage,se=Wt.length>0,Fe=Qt.length>0,ke=Qt.filter(Je).length>0,be=ue.filter(Je).length>0,mi=Xt[3]>0,si=!!I&&T>=1;if(on<1&&mi){const ge=hn[0],an=hn[1],we=hn[2],Ge=1-on,Le=Xt[0]*Ge,Ht=Xt[1]*Ge,Pe=Xt[2]*Ge,Cn=1-Ge;hn[0]=Le+ge*Cn,hn[1]=Ht+an*Cn,hn[2]=Pe+we*Cn,hn[3]=1}if(V.setCanvasColor(f?d:hn),se&&(z||xn)?(V.disableMask(),V.drawToImageBlendBuffer(J),Ve.length=0,Ie(Wt,Ve)):se||(Ve.length=0),Ne.push(...Ve),xt&&(V.drawToImageOverlayBuffer(J,_),xt=!1),Se){if(Fe&&(ce||xn)||!de){V.disableMask(),V.drawToImageOverlayBuffer(J,_),Oe.length=0;const ge=ke?Qt.filter(_e):Qt;Ie(ge,Oe)}else Fe||(Oe.length=0);de=!0}else de=!1;if(V.drawToCanvas(),V.enableMask(Xe,on),it&&W>=1&&M.length===2&&ot&&((ge,an,we,Ge,Le)=>{const Ht=sr(an,an),Pe=nt(p,"pixelated","repeat"),Cn=pt(-ge.x%an,-ge.y%an),Un=pt(Cn.x+.5*Ht.width,Cn.y);We(Pe,ge,Cn,Ht,we,Le),We(Pe,ge,Un,Ht,Ge,Le)})(Xe,W,M[0],M[1],ot),mi&&V.drawRect(Xe,0,!1,!1,d,Xt),jt){V.enableMask(Xe,1);const ge=Math.max(b.width/jt.width,b.height/jt.height),an=jt.width*ge,we=jt.height*ge,Ge={x:b.x+.5*b.width-.5*an,y:b.y+.5*b.height-.5*we,width:an,height:we};V.drawRect(Ge,0,!1,!1,d,d,nt(jt,"linear")),V.enableMask(Xe,on)}if(si&&V.enablePreviewStencil(),Ne.push(...[...at].reverse().map(ge=>ve({...ge,texture:nt(ge.data),enableOverlay:Se&&Fe,enableManipulation:se,enableAntialiasing:!0,mask:Xe,maskOpacity:on,overlayColor:xe}))),V.enableMask(Xe,T),!Se){si&&V.applyPreviewStencil(),V.resetCanvasMatrix(),V.updateCanvasMatrix(J,H.origin,H.translation,H.scale,H.rotation),Oe.length=0;const ge=ke?Qt.filter(_e):Qt;Ie(ge,Oe),si&&V.disablePreviewStencil()}if(Ne.push(...Oe),V.resetCanvasMatrix(),V.enableMask(Xe,T),Ie(be?ue.filter(_e):ue,Ne),Yt.length){V.enableMask(Xe,1);const ge=Yt.filter(we=>!we.expandsCanvas),an=Yt.filter(we=>we.expandsCanvas);ge.length&&Ie(ge,Ne),an.length&&(V.enableMask({x:Xe.x+.5,y:Xe.y+.5,width:Xe.width-1,height:Xe.height-1},o),Ie(an,Ne))}if(ke&&(V.resetCanvasMatrix(),V.updateCanvasMatrix(J,H.origin,H.translation,H.scale,H.rotation),Ie(Qt.filter(Je),Ne),V.resetCanvasMatrix()),be&&(V.resetCanvasMatrix(),Ie(ue.filter(Je),Ne),V.resetCanvasMatrix()),ct&&Gt.length&&!Se){V.resetCanvasMatrix(),V.updateCanvasMatrix(J,H.origin,H.translation,H.scale,H.rotation);const ge=[...ct];ge[3]=.5;const an=[{id:"selection",color:ge,actions:[...Gt]}].map(we=>le(we,J));Ie(an,Ne),V.resetCanvasMatrix()}V.disableMask(),Ie(ye,Ne),q.forEach(ge=>{if(V.enableMask(ge.mask,ge.maskOpacity),ge.backgroundColor){const we=jt&&Ls({...ge.mask},jt.width/jt.height),Ge=jt&&nt(jt,"linear");V.drawRect(ge.mask,0,!1,!1,ge.maskCornerRadius,ge.backgroundColor,Ge,we,we,void 0,void 0,void 0,void 0,ge.opacity,ge.maskFeather),Ge&&Ne.push(Ge)}const an=ve({...ge,texture:nt(ge.data),enableAntialiasing:!1,translation:{x:ge.translation.x+ge.offset.x-.5*ut,y:ge.translation.y+ge.offset.y-.5*bt}});Ne.push(an)}),V.disableMask(),(ge=>{Nt.forEach((an,we)=>{!ge.find(Ge=>Ge===an)&&Zp(an)&&(Array.from($t.values()).includes(an)||(Nt.delete(we),V.textureDelete(an)))})})(Ne),G(),xn=!1};let En,Zt=0;const Dn=()=>{clearTimeout(En);const H=Date.now();H-Zt<48?En=setTimeout(Dn,48):(Zt=H,kn())};return S2(()=>r()),ds(()=>n(31,V=$w(y,{alpha:f}))),Ho(()=>{V&&(qt.forEach(({canvas:H})=>dr(H)),qt.clear(),V.release(),n(31,V=void 0),n(0,y=void 0))}),t.$$set=H=>{"isAnimated"in H&&n(9,m=H.isAnimated),"isTransparent"in H&&n(10,f=H.isTransparent),"maskRect"in H&&n(11,b=H.maskRect),"maskOpacity"in H&&n(12,v=H.maskOpacity),"maskFrameOpacity"in H&&n(13,w=H.maskFrameOpacity),"maskMarkupOpacity"in H&&n(14,T=H.maskMarkupOpacity),"clipAnnotationsToImage"in H&&n(15,I=H.clipAnnotationsToImage),"pixelRatio"in H&&n(16,P=H.pixelRatio),"textPixelRatio"in H&&n(17,_=H.textPixelRatio),"backgroundColor"in H&&n(18,C=H.backgroundColor),"willRender"in H&&n(19,F=H.willRender),"didRender"in H&&n(20,G=H.didRender),"willRequest"in H&&n(21,O=H.willRequest),"csp"in H&&n(22,$=H.csp),"loadImageData"in H&&n(23,N=H.loadImageData),"enableGrid"in H&&n(24,it=H.enableGrid),"gridColors"in H&&n(25,M=H.gridColors),"gridSize"in H&&n(26,W=H.gridSize),"gridOpacity"in H&&n(27,ot=H.gridOpacity),"images"in H&&n(28,at=H.images),"interfaceImages"in H&&n(29,q=H.interfaceImages),"selectionColor"in H&&n(30,ct=H.selectionColor)},t.$$.update=()=>{if(1&t.$$.dirty[0]&&y){const H=getComputedStyle(y).getPropertyValue("--color-transition-duration");n(32,X=(Wt=>{let z=parseFloat(Wt);return/^[0-9]+s$/.test(Wt)?1e3*z:z})(H))}262656&t.$$.dirty[0]|2&t.$$.dirty[1]&&C&&Z.set(C,{duration:m?X:0}),4096&t.$$.dirty[0]&&K(mt,dn(v)?v:1),8192&t.$$.dirty[0]&&K(Bt,dn(w)?w:1),2048&t.$$.dirty[0]&&b&&st.set(b),48&t.$$.dirty[1]&&c&&gt.set([c[0],c[1],c[2],oi(s,0,1)]),268435462&t.$$.dirty[0]|1&t.$$.dirty[1]&&n(34,i=!!(V&&ut&&bt&&at.length)),65542&t.$$.dirty[0]|1&t.$$.dirty[1]&&ut&&bt&&V&&(Zt=0,V.resize(ut,bt,P)),8&t.$$.dirty[1]&&n(33,r=i?f0()?Dn:kn:ae),12&t.$$.dirty[1]&&i&&r&&r()},[y,ut,bt,h,Z,mt,Bt,st,gt,m,f,b,v,w,T,I,P,_,C,F,G,O,$,N,it,M,W,ot,at,q,ct,V,X,r,i,s,c,function(H){Nn[H?"unshift":"push"](()=>{y=H,n(0,y)})},H=>{n(1,ut=H.detail.width),n(2,bt=H.detail.height),h("measure",{width:ut,height:bt})}]}class Cw extends Tn{constructor(e){super(),Sn(this,e,Tw,Sw,yn,{isAnimated:9,isTransparent:10,maskRect:11,maskOpacity:12,maskFrameOpacity:13,maskMarkupOpacity:14,clipAnnotationsToImage:15,pixelRatio:16,textPixelRatio:17,backgroundColor:18,willRender:19,didRender:20,willRequest:21,csp:22,loadImageData:23,enableGrid:24,gridColors:25,gridSize:26,gridOpacity:27,images:28,interfaceImages:29,selectionColor:30},null,[-1,-1,-1])}}var rn=(t,e=Boolean,n=" ")=>t.filter(e).join(n);function Zg(t,e,n){const i=t.slice();return i[17]=e[n],i}const Mw=t=>({tab:4&t}),Xg=t=>({tab:t[17]});function qg(t){let e,n,i,r=[],o=new Map,a=t[2];const s=l=>l[17].id;for(let l=0;l<a.length;l+=1){let c=Zg(t,a,l),d=s(c);o.set(d,r[l]=Yg(d,c))}return{c(){e=ft("ul");for(let l=0;l<r.length;l+=1)r[l].c();S(e,"class",n=rn(["PinturaTabList",t[0]])),S(e,"role","tablist"),S(e,"data-layout",t[1])},m(l,c){tt(l,e,c);for(let d=0;d<r.length;d+=1)r[d].m(e,null);t[14](e),i=!0},p(l,c){1124&c&&(a=l[2],Te(),r=Va(r,c,s,1,l,a,o,e,_s,Yg,null,Zg),Ce()),(!i||1&c&&n!==(n=rn(["PinturaTabList",l[0]])))&&S(e,"class",n),(!i||2&c)&&S(e,"data-layout",l[1])},i(l){if(!i){for(let c=0;c<a.length;c+=1)k(r[c]);i=!0}},o(l){for(let c=0;c<r.length;c+=1)A(r[c]);i=!1},d(l){l&&Q(e);for(let c=0;c<r.length;c+=1)r[c].d();t[14](null)}}}function Yg(t,e){let n,i,r,o,a,s,l,c,d,u;const p=e[11].default,h=ur(p,e,e[10],Xg);function y(...f){return e[12](e[17],...f)}function m(...f){return e[13](e[17],...f)}return{key:t,first:null,c(){n=ft("li"),i=ft("button"),h&&h.c(),o=pe(),S(i,"type","button"),i.disabled=r=e[17].disabled,S(n,"role","tab"),S(n,"aria-controls",a=e[17].href.substring(1)),S(n,"id",s=e[17].tabId),S(n,"aria-selected",l=e[17].selected),this.first=n},m(f,b){tt(f,n,b),Et(n,i),h&&h.m(i,null),Et(n,o),c=!0,d||(u=[St(i,"keydown",y),St(i,"click",m)],d=!0)},p(f,b){e=f,h&&h.p&&(!c||1028&b)&&hr(h,p,e,e[10],c?pr(p,e[10],b,Mw):mr(e[10]),Xg),(!c||4&b&&r!==(r=e[17].disabled))&&(i.disabled=r),(!c||4&b&&a!==(a=e[17].href.substring(1)))&&S(n,"aria-controls",a),(!c||4&b&&s!==(s=e[17].tabId))&&S(n,"id",s),(!c||4&b&&l!==(l=e[17].selected))&&S(n,"aria-selected",l)},i(f){c||(k(h,f),c=!0)},o(f){A(h,f),c=!1},d(f){f&&Q(n),h&&h.d(f),d=!1,Zn(u)}}}function kw(t){let e,n,i=t[4]&&qg(t);return{c(){i&&i.c(),e=Ei()},m(r,o){i&&i.m(r,o),tt(r,e,o),n=!0},p(r,[o]){r[4]?i?(i.p(r,o),16&o&&k(i,1)):(i=qg(r),i.c(),k(i,1),i.m(e.parentNode,e)):i&&(Te(),A(i,1,1,()=>{i=null}),Ce())},i(r){n||(k(i),n=!0)},o(r){A(i),n=!1},d(r){i&&i.d(r),r&&Q(e)}}}function Ew(t,e,n){let i,r,o,{$$slots:a={},$$scope:s}=e,{class:l}=e,{name:c}=e,{selected:d}=e,{tabs:u=[]}=e,{layout:p}=e;const h=la(),y=b=>{const v=o.querySelectorAll('[role="tab"] button')[b];v&&v.focus()},m=(b,v)=>{b.preventDefault(),b.stopPropagation(),h("select",v)},f=({key:b},v)=>{if(!/arrow/i.test(b))return;const w=u.findIndex(T=>T.id===v);return/right|down/i.test(b)?y(w<u.length-1?w+1:0):/left|up/i.test(b)?y(w>0?w-1:u.length-1):void 0};return t.$$set=b=>{"class"in b&&n(0,l=b.class),"name"in b&&n(7,c=b.name),"selected"in b&&n(8,d=b.selected),"tabs"in b&&n(9,u=b.tabs),"layout"in b&&n(1,p=b.layout),"$$scope"in b&&n(10,s=b.$$scope)},t.$$.update=()=>{896&t.$$.dirty&&n(2,i=u.map(b=>{const v=b.id===d;return{...b,tabId:`tab-${c}-${b.id}`,href:`#panel-${c}-${b.id}`,selected:v}})),4&t.$$.dirty&&n(4,r=i.length>1)},[l,p,i,o,r,m,f,c,d,u,s,a,(b,v)=>f(v,b.id),(b,v)=>m(v,b.id),function(b){Nn[b?"unshift":"push"](()=>{o=b,n(3,o)})}]}class Ju extends Tn{constructor(e){super(),Sn(this,e,Ew,kw,yn,{class:0,name:7,selected:8,tabs:9,layout:1})}}const Pw=t=>({panel:16&t}),Kg=t=>({panel:t[4][0].id,panelIsActive:!0});function Jg(t,e,n){const i=t.slice();return i[14]=e[n].id,i[15]=e[n].shouldDraw,i[16]=e[n].panelId,i[17]=e[n].tabindex,i[18]=e[n].labelledBy,i[19]=e[n].isActive,i[20]=e[n].hidden,i[3]=e[n].visible,i}const Iw=t=>({panel:16&t,panelIsActive:16&t}),Qg=t=>({panel:t[14],panelIsActive:t[19]});function Rw(t){let e,n,i,r,o,a;const s=t[11].default,l=ur(s,t,t[10],Kg);return{c(){e=ft("div"),n=ft("div"),l&&l.c(),S(n,"class",i=rn([t[1]])),S(e,"class",t[0]),S(e,"style",t[2])},m(c,d){tt(c,e,d),Et(e,n),l&&l.m(n,null),r=!0,o||(a=[St(e,"measure",t[13]),qn(Cr.call(null,e))],o=!0)},p(c,d){l&&l.p&&(!r||1040&d)&&hr(l,s,c,c[10],r?pr(s,c[10],d,Pw):mr(c[10]),Kg),(!r||2&d&&i!==(i=rn([c[1]])))&&S(n,"class",i),(!r||1&d)&&S(e,"class",c[0]),(!r||4&d)&&S(e,"style",c[2])},i(c){r||(k(l,c),r=!0)},o(c){A(l,c),r=!1},d(c){c&&Q(e),l&&l.d(c),o=!1,Zn(a)}}}function Aw(t){let e,n,i,r,o,a=[],s=new Map,l=t[4];const c=d=>d[14];for(let d=0;d<l.length;d+=1){let u=Jg(t,l,d),p=c(u);s.set(p,a[d]=ef(p,u))}return{c(){e=ft("div");for(let d=0;d<a.length;d+=1)a[d].c();S(e,"class",n=rn(["PinturaTabPanels",t[0]])),S(e,"style",t[2])},m(d,u){tt(d,e,u);for(let p=0;p<a.length;p+=1)a[p].m(e,null);i=!0,r||(o=[St(e,"measure",t[12]),qn(Cr.call(null,e,{observePosition:!0}))],r=!0)},p(d,u){1042&u&&(l=d[4],Te(),a=Va(a,u,c,1,d,l,s,e,_s,ef,null,Jg),Ce()),(!i||1&u&&n!==(n=rn(["PinturaTabPanels",d[0]])))&&S(e,"class",n),(!i||4&u)&&S(e,"style",d[2])},i(d){if(!i){for(let u=0;u<l.length;u+=1)k(a[u]);i=!0}},o(d){for(let u=0;u<a.length;u+=1)A(a[u]);i=!1},d(d){d&&Q(e);for(let u=0;u<a.length;u+=1)a[u].d();r=!1,Zn(o)}}}function tf(t){let e;const n=t[11].default,i=ur(n,t,t[10],Qg);return{c(){i&&i.c()},m(r,o){i&&i.m(r,o),e=!0},p(r,o){i&&i.p&&(!e||1040&o)&&hr(i,n,r,r[10],e?pr(n,r[10],o,Iw):mr(r[10]),Qg)},i(r){e||(k(i,r),e=!0)},o(r){A(i,r),e=!1},d(r){i&&i.d(r)}}}function ef(t,e){let n,i,r,o,a,s,l,c,d,u=e[15]&&tf(e);return{key:t,first:null,c(){n=ft("div"),u&&u.c(),i=pe(),S(n,"class",r=rn(["PinturaTabPanel",e[1]])),n.hidden=o=e[20],S(n,"id",a=e[16]),S(n,"tabindex",s=e[17]),S(n,"aria-labelledby",l=e[18]),S(n,"data-inert",c=!e[3]),this.first=n},m(p,h){tt(p,n,h),u&&u.m(n,null),Et(n,i),d=!0},p(p,h){(e=p)[15]?u?(u.p(e,h),16&h&&k(u,1)):(u=tf(e),u.c(),k(u,1),u.m(n,i)):u&&(Te(),A(u,1,1,()=>{u=null}),Ce()),(!d||2&h&&r!==(r=rn(["PinturaTabPanel",e[1]])))&&S(n,"class",r),(!d||16&h&&o!==(o=e[20]))&&(n.hidden=o),(!d||16&h&&a!==(a=e[16]))&&S(n,"id",a),(!d||16&h&&s!==(s=e[17]))&&S(n,"tabindex",s),(!d||16&h&&l!==(l=e[18]))&&S(n,"aria-labelledby",l),(!d||16&h&&c!==(c=!e[3]))&&S(n,"data-inert",c)},i(p){d||(k(u),d=!0)},o(p){A(u),d=!1},d(p){p&&Q(n),u&&u.d()}}}function Lw(t){let e,n,i,r;const o=[Aw,Rw],a=[];function s(l,c){return l[5]?0:1}return e=s(t),n=a[e]=o[e](t),{c(){n.c(),i=Ei()},m(l,c){a[e].m(l,c),tt(l,i,c),r=!0},p(l,[c]){let d=e;e=s(l),e===d?a[e].p(l,c):(Te(),A(a[d],1,1,()=>{a[d]=null}),Ce(),n=a[e],n?n.p(l,c):(n=a[e]=o[e](l),n.c()),k(n,1),n.m(i.parentNode,i))},i(l){r||(k(n),r=!0)},o(l){A(n),r=!1},d(l){a[e].d(l),l&&Q(i)}}}function Ow(t,e,n){let i,r,{$$slots:o={},$$scope:a}=e,{class:s}=e,{name:l}=e,{selected:c}=e,{panelClass:d}=e,{panels:u=[]}=e,{visible:p}=e,{style:h}=e;const y={};return t.$$set=m=>{"class"in m&&n(0,s=m.class),"name"in m&&n(6,l=m.name),"selected"in m&&n(7,c=m.selected),"panelClass"in m&&n(1,d=m.panelClass),"panels"in m&&n(8,u=m.panels),"visible"in m&&n(3,p=m.visible),"style"in m&&n(2,h=m.style),"$$scope"in m&&n(10,a=m.$$scope)},t.$$.update=()=>{968&t.$$.dirty&&n(4,i=u.map(m=>{const f=m===c;f&&n(9,y[m]=!0,y);const b=p?p.indexOf(m)!==-1:f;return{id:m,panelId:`panel-${l}-${m}`,labelledBy:`tab-${l}-${m}`,isActive:f,hidden:!f,visible:b,tabindex:f?0:-1,shouldDraw:f||y[m]}})),16&t.$$.dirty&&n(5,r=i.length>1)},[s,d,h,p,i,r,l,c,u,y,a,o,function(m){aa.call(this,t,m)},function(m){aa.call(this,t,m)}]}class Qu extends Tn{constructor(e){super(),Sn(this,e,Ow,Lw,yn,{class:0,name:6,selected:7,panelClass:1,panels:8,visible:3,style:2})}}var $0=t=>{const e=Object.getOwnPropertyDescriptors(t.prototype);return Object.keys(e).filter(n=>!!e[n].get)};function nf(t){let e,n,i,r;const o=[t[5],{locale:t[1]}];function a(c){t[22](c)}var s=t[10];function l(c){let d={};for(let u=0;u<o.length;u+=1)d=ki(d,o[u]);return c[3]!==void 0&&(d.name=c[3]),{props:d}}return s&&(e=zu(s,l(t)),Nn.push(()=>Ro(e,"name",a)),t[23](e),e.$on("measure",t[11])),{c(){e&&zt(e.$$.fragment),i=Ei()},m(c,d){e&&Ft(e,c,d),tt(c,i,d),r=!0},p(c,d){const u=34&d[0]?Tr(o,[32&d[0]&&_r(c[5]),2&d[0]&&{locale:c[1]}]):{};if(!n&&8&d[0]&&(n=!0,u.name=c[3],Wo(()=>n=!1)),s!==(s=c[10])){if(e){Te();const p=e;A(p.$$.fragment,1,0,()=>{_t(p,1)}),Ce()}s?(e=zu(s,l(c)),Nn.push(()=>Ro(e,"name",a)),c[23](e),e.$on("measure",c[11]),zt(e.$$.fragment),k(e.$$.fragment,1),Ft(e,i.parentNode,i)):e=null}else s&&e.$set(u)},i(c){r||(e&&k(e.$$.fragment,c),r=!0)},o(c){e&&A(e.$$.fragment,c),r=!1},d(c){t[23](null),c&&Q(i),e&&_t(e,c)}}}function Fw(t){let e,n,i,r=t[6]&&nf(t);return{c(){e=ft("div"),r&&r.c(),S(e,"data-util",t[3]),S(e,"class",n=rn(["PinturaUtilPanel",t[2]])),S(e,"style",t[7])},m(o,a){tt(o,e,a),r&&r.m(e,null),t[24](e),i=!0},p(o,a){o[6]?r?(r.p(o,a),64&a[0]&&k(r,1)):(r=nf(o),r.c(),k(r,1),r.m(e,null)):r&&(Te(),A(r,1,1,()=>{r=null}),Ce()),(!i||8&a[0])&&S(e,"data-util",o[3]),(!i||4&a[0]&&n!==(n=rn(["PinturaUtilPanel",o[2]])))&&S(e,"class",n),(!i||128&a[0])&&S(e,"style",o[7])},i(o){i||(k(r),i=!0)},o(o){A(r),i=!1},d(o){o&&Q(e),r&&r.d(),t[24](null)}}}function _w(t,e,n){let i,r,o,a,s;const l=la();let{isActive:c=!0}=e,{stores:d}=e,{view:u}=e,{props:p}=e,{component:h}=e,{locale:y}=e,{class:m}=e;const f=yi("isAnimated");let b;D(t,f,W=>n(21,s=W));const v=fn(0),w=Vn(v,W=>oi(W,0,1));D(t,w,W=>n(20,a=W));let T=!c;const I=me(c),P={isActive:Vn(I,async(W,ot)=>{if(!W)return ot(W);await M2(),ot(W)},!1),isActiveFraction:Vn(w,W=>W),isVisible:Vn(w,W=>W>0)},_=u,C=$0(_),F=Object.keys(p||{}).reduce((W,ot)=>(C.includes(ot)&&(W[ot]=p[ot]),W),{}),G=Object.keys(P).reduce((W,ot)=>(C.includes(ot)&&(W[ot]=P[ot]),W),{});let O,$;const N=W=>{n(17,b={...W.detail}),M&&c&&l("measure",{...b})};$o("measurable",Cr);const it=gl().$$.context;let M=!1;return ds(()=>{if(n(19,M=!0),o)return;n(0,h=new _({target:$,props:{...r,locale:y},context:it})),n(3,O=h.name);const W=h.$on("measure",N);return()=>{W(),h.$destroy()}}),t.$$set=W=>{"isActive"in W&&n(12,c=W.isActive),"stores"in W&&n(13,d=W.stores),"view"in W&&n(14,u=W.view),"props"in W&&n(15,p=W.props),"component"in W&&n(0,h=W.component),"locale"in W&&n(1,y=W.locale),"class"in W&&n(2,m=W.class)},t.$$.update=()=>{135169&t.$$.dirty[0]&&b&&c&&h&&l("measure",b),2101248&t.$$.dirty[0]&&v.set(c?1:0,{hard:s===!1}),1310720&t.$$.dirty[0]&&(a<=0&&!T?n(18,T=!0):a>0&&T&&n(18,T=!1)),786432&t.$$.dirty[0]&&M&&l(T?"hide":"show"),1048576&t.$$.dirty[0]&&l("fade",a),1048576&t.$$.dirty[0]&&n(7,i=a<1?"opacity: "+a:void 0),4096&t.$$.dirty[0]&&I.set(c),8192&t.$$.dirty[0]&&n(5,r={...F,...G,stores:d})},n(6,o=!C.includes("external")),[h,y,m,O,$,r,o,i,f,w,_,N,c,d,u,p,v,b,T,M,a,s,function(W){O=W,n(3,O)},function(W){Nn[W?"unshift":"push"](()=>{h=W,n(0,h)})},function(W){Nn[W?"unshift":"push"](()=>{$=W,n(4,$)})}]}class Y2 extends Tn{constructor(e){super(),Sn(this,e,_w,Fw,yn,{isActive:12,stores:13,view:14,props:15,component:0,locale:1,class:2,opacity:16},null,[-1,-1])}get opacity(){return this.$$.ctx[16]}}function Dw(t){let e,n,i;const r=t[5].default,o=ur(r,t,t[4],null);return{c(){e=Or("svg"),o&&o.c(),S(e,"class",t[3]),S(e,"style",t[2]),S(e,"width",t[0]),S(e,"height",t[1]),S(e,"viewBox",n="0 0 "+t[0]+`
    `+t[1]),S(e,"xmlns","http://www.w3.org/2000/svg"),S(e,"aria-hidden","true"),S(e,"focusable","false"),S(e,"stroke-linecap","round"),S(e,"stroke-linejoin","round")},m(a,s){tt(a,e,s),o&&o.m(e,null),i=!0},p(a,[s]){o&&o.p&&(!i||16&s)&&hr(o,r,a,a[4],i?pr(r,a[4],s,null):mr(a[4]),null),(!i||8&s)&&S(e,"class",a[3]),(!i||4&s)&&S(e,"style",a[2]),(!i||1&s)&&S(e,"width",a[0]),(!i||2&s)&&S(e,"height",a[1]),(!i||3&s&&n!==(n="0 0 "+a[0]+`
    `+a[1]))&&S(e,"viewBox",n)},i(a){i||(k(o,a),i=!0)},o(a){A(o,a),i=!1},d(a){a&&Q(e),o&&o.d(a)}}}function zw(t,e,n){let{$$slots:i={},$$scope:r}=e,{width:o=24}=e,{height:a=24}=e,{style:s}=e,{class:l}=e;return t.$$set=c=>{"width"in c&&n(0,o=c.width),"height"in c&&n(1,a=c.height),"style"in c&&n(2,s=c.style),"class"in c&&n(3,l=c.class),"$$scope"in c&&n(4,r=c.$$scope)},[o,a,s,l,r,i]}class Vo extends Tn{constructor(e){super(),Sn(this,e,zw,Dw,yn,{width:0,height:1,style:2,class:3})}}var K2=(t,e)=>e===t.target||e.contains(t.target),rf=(t,e,n)=>{const i=Qe(e)?e:t;return n?`${i} (${r=n,r.map(o=>o==="CMD"?qu()?"⌘":"Ctrl":o).join("+")})`:i;var r};function of(t){let e,n;return e=new Vo({props:{class:"PinturaButtonIcon",$$slots:{default:[Bw]},$$scope:{ctx:t}}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};536870920&r&&(o.$$scope={dirty:r,ctx:i}),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function Bw(t){let e;return{c(){e=Or("g")},m(n,i){tt(n,e,i),e.innerHTML=t[3]},p(n,i){8&i&&(e.innerHTML=n[3])},d(n){n&&Q(e)}}}function af(t){let e;return{c(){e=ft("span"),S(e,"class",t[11])},m(n,i){tt(n,e,i),e.innerHTML=t[0]},p(n,i){1&i&&(e.innerHTML=n[0]),2048&i&&S(e,"class",n[11])},d(n){n&&Q(e)}}}function Nw(t){let e,n,i,r,o;const a=t[27].default,s=ur(a,t,t[29],null),l=s||function(c){let d,u,p,h=c[3]&&of(c),y=c[0]&&af(c);return{c(){d=ft("span"),h&&h.c(),u=pe(),y&&y.c(),S(d,"class",c[13])},m(m,f){tt(m,d,f),h&&h.m(d,null),Et(d,u),y&&y.m(d,null),p=!0},p(m,f){m[3]?h?(h.p(m,f),8&f&&k(h,1)):(h=of(m),h.c(),k(h,1),h.m(d,u)):h&&(Te(),A(h,1,1,()=>{h=null}),Ce()),m[0]?y?y.p(m,f):(y=af(m),y.c(),y.m(d,null)):y&&(y.d(1),y=null),(!p||8192&f)&&S(d,"class",m[13])},i(m){p||(k(h),p=!0)},o(m){A(h),p=!1},d(m){m&&Q(d),h&&h.d(),y&&y.d()}}}(t);return{c(){e=ft("button"),l&&l.c(),S(e,"type",t[6]),S(e,"style",t[4]),e.disabled=t[5],S(e,"class",t[12]),S(e,"title",n=rf(t[0],t[1],t[2]))},m(c,d){tt(c,e,d),l&&l.m(e,null),t[28](e),i=!0,r||(o=[St(e,"keydown",function(){Hn(t[8])&&t[8].apply(this,arguments)}),St(e,"click",function(){Hn(t[7])&&t[7].apply(this,arguments)}),St(e,"pointerdown",function(){Hn(t[14])&&t[14].apply(this,arguments)}),qn(t[9].call(null,e))],r=!0)},p(c,[d]){t=c,s?s.p&&(!i||536870912&d)&&hr(s,a,t,t[29],i?pr(a,t[29],d,null):mr(t[29]),null):l&&l.p&&(!i||10249&d)&&l.p(t,i?d:-1),(!i||64&d)&&S(e,"type",t[6]),(!i||16&d)&&S(e,"style",t[4]),(!i||32&d)&&(e.disabled=t[5]),(!i||4096&d)&&S(e,"class",t[12]),(!i||7&d&&n!==(n=rf(t[0],t[1],t[2])))&&S(e,"title",n)},i(c){i||(k(l,c),i=!0)},o(c){A(l,c),i=!1},d(c){c&&Q(e),l&&l.d(c),t[28](null),r=!1,Zn(o)}}}function Ww(t,e,n){let i,r,o,a,s,l,{$$slots:c={},$$scope:d}=e,{class:u}=e,{label:p}=e,{title:h}=e,{shortcut:y}=e,{labelClass:m}=e,{innerClass:f}=e,{hideLabel:b=!1}=e,{icon:v}=e,{style:w}=e,{disabled:T}=e,{type:I="button"}=e,{onclick:P}=e,{onkeydown:_}=e,{onhold:C}=e,{action:F=()=>{}}=e,{holdThreshold:G=500}=e,{holdSpeedUpFactor:O=.5}=e,{holdSpeedMin:$=20}=e;const N=M=>{n(25,l=setTimeout(()=>{C(),N(Math.max(M*O,$))},M))};let it;return t.$$set=M=>{"class"in M&&n(15,u=M.class),"label"in M&&n(0,p=M.label),"title"in M&&n(1,h=M.title),"shortcut"in M&&n(2,y=M.shortcut),"labelClass"in M&&n(16,m=M.labelClass),"innerClass"in M&&n(17,f=M.innerClass),"hideLabel"in M&&n(18,b=M.hideLabel),"icon"in M&&n(3,v=M.icon),"style"in M&&n(4,w=M.style),"disabled"in M&&n(5,T=M.disabled),"type"in M&&n(6,I=M.type),"onclick"in M&&n(7,P=M.onclick),"onkeydown"in M&&n(8,_=M.onkeydown),"onhold"in M&&n(19,C=M.onhold),"action"in M&&n(9,F=M.action),"holdThreshold"in M&&n(20,G=M.holdThreshold),"holdSpeedUpFactor"in M&&n(21,O=M.holdSpeedUpFactor),"holdSpeedMin"in M&&n(22,$=M.holdSpeedMin),"$$scope"in M&&n(29,d=M.$$scope)},t.$$.update=()=>{101187584&t.$$.dirty&&n(26,r=C?()=>{l&&(clearTimeout(l),n(25,l=void 0),document.documentElement.removeEventListener("pointerup",r))}:ae),68681728&t.$$.dirty&&n(14,i=C?()=>{document.documentElement.addEventListener("pointerup",r),N(G)}:ae),131072&t.$$.dirty&&n(13,o=rn(["PinturaButtonInner",f])),294912&t.$$.dirty&&n(12,a=rn(["PinturaButton",b&&"PinturaButtonIconOnly",u])),327680&t.$$.dirty&&n(11,s=rn([b?"implicit":"PinturaButtonLabel",m]))},[p,h,y,v,w,T,I,P,_,F,it,s,a,o,i,u,m,f,b,C,G,O,$,M=>K2(M,it),()=>it,l,r,c,function(M){Nn[M?"unshift":"push"](()=>{it=M,n(10,it)})},d]}class Ds extends Tn{constructor(e){super(),Sn(this,e,Ww,Nw,yn,{class:15,label:0,title:1,shortcut:2,labelClass:16,innerClass:17,hideLabel:18,icon:3,style:4,disabled:5,type:6,onclick:7,onkeydown:8,onhold:19,action:9,holdThreshold:20,holdSpeedUpFactor:21,holdSpeedMin:22,isEventTarget:23,getElement:24})}get isEventTarget(){return this.$$.ctx[23]}get getElement(){return this.$$.ctx[24]}}var Vw=(t,e)=>{const n=t.findIndex(e);if(n>=0)return t.splice(n,1)};const Hw=80;var zs=(t,e={})=>{const{inertia:n=!1,inertiaDurationMultiplier:i=Hw,shouldStartInteraction:r=()=>!0,pinch:o=!1,multiTouch:a,getEventPosition:s=K=>pt(K.clientX,K.clientY),observeKeys:l=!1}=e;function c(K,vt){t.dispatchEvent(new CustomEvent(K,{detail:vt}))}function d(){P&&P(),P=void 0}const u=[],p=K=>K.timeStamp===0?Date.now():K.timeStamp,h=()=>{const K=Ue(u[0].position);if(u[1]){const vt=.5*(u[1].position.x-K.x),X=.5*(u[1].position.y-K.y);K.x+=vt,K.y+=X}return K},y=K=>{K.origin.x=K.position.x,K.origin.y=K.position.y,K.translation.x=0,K.translation.y=0},m=K=>{const vt=(X=>u.findIndex(Z=>Z.event.pointerId===X.pointerId))(K);if(!(vt<0))return u[vt]},f=()=>u.length===1,b=()=>u.length===2,v=K=>{const vt=zo(K.map(X=>X.position));return{center:vt,distance:((X,Z)=>X.reduce((mt,Bt)=>mt+Yr(Z,Bt.position),0)/X.length)(K,vt),velocity:zo(K.map(X=>X.velocity)),translation:zo(K.map(X=>X.translation))}};let w,T,I,P,_,C,F,G,O=0,$;t.addEventListener("pointerdown",ot);const N=["Meta","Control","Alt","Shift"];function it(K){if(!N.includes(K.key))return;const{metaKey:vt,ctrlKey:X,altKey:Z,shiftKey:mt}=K;W({metaKey:vt,ctrlKey:X,altKey:Z,shiftKey:mt})}let M=Date.now();const W=K=>{const vt=Ue(u[0].translation);let X=F;o&&b()&&(X*=Yr(u[0].position,u[1].position)/_,nr(vt,u[1].translation)),nr(vt,C);const Z=Date.now();Z-M<16||(M=Z,c("interactionupdate",{position:h(),translation:vt,scalar:o?X:void 0,isMultiTouching:b(),...K}))};function ot(K){if(!b()&&!(vt=>dn(vt.button)&&vt.button!==0)(K)&&r(K,t)){if(d(),(vt=>{const X=p(vt),Z={timeStamp:X,timeStampInitial:X,position:s(vt),origin:s(vt),velocity:hi(),velocityHistory:[],velocityAverage:hi(),translation:hi(),interactionState:void 0,event:vt};u.push(Z),Z.interactionState=v(u)})(K),l&&(window.addEventListener("keydown",it),window.addEventListener("keyup",it)),f())document.documentElement.addEventListener("pointermove",at),document.documentElement.addEventListener("pointerup",q),document.documentElement.addEventListener("pointercancel",q),document.addEventListener("visibilitychange",V),G=!1,F=1,C=hi(),_=void 0,c("interactionstart",{origin:Ue(m(K).origin)});else if(o)G=!0,_=Yr(u[0].position,u[1].position),C.x+=u[0].translation.x,C.y+=u[0].translation.y,y(u[0]);else if(a===!1)return u.length=0,bt(),c("interactioncancel")}}function at(K){K.preventDefault(),(Bt=>{const st=m(Bt);if(!st)return;const gt=p(Bt),Jt=s(Bt),le=Math.max(1,gt-st.timeStamp);st.velocity.x=(Jt.x-st.position.x)/le,st.velocity.y=(Jt.y-st.position.y)/le,st.velocityHistory.push(Ue(st.velocity)),st.velocityHistory=st.velocityHistory.slice(-3),st.velocityAverage=st.velocityHistory.reduce((rt,kt,Nt,$t)=>(rt.x+=kt.x/$t.length,rt.y+=kt.y/$t.length,rt),hi()),st.translation.x=Jt.x-st.origin.x,st.translation.y=Jt.y-st.origin.y,st.timeStamp=gt,st.position.x=Jt.x,st.position.y=Jt.y,st.event=Bt})(K);const{metaKey:vt=!1,ctrlKey:X=!1,altKey:Z=!1,shiftKey:mt=!1}=l?K:{};W({metaKey:vt,ctrlKey:X,altKey:Z,shiftKey:mt})}function q(K){if(!m(K))return;const vt=h(),X=(le=>{const rt=Vw(u,kt=>kt.event.pointerId===le.pointerId);if(rt)return rt[0]})(K);if(o&&f()){const le=Yr(u[0].position,X.position);F*=le/_,C.x+=u[0].translation.x+X.translation.x,C.y+=u[0].translation.y+X.translation.y,y(u[0])}let Z=!1,mt=!1;if(!G&&X){const le=performance.now(),rt=le-X.timeStampInitial;Z=yo(X.translation)<64&&rt<300,mt=!!($&&Z&&le-O<700&&yo($,X.position)<128),Z&&($=Ue(X.position),O=le)}if(u.length>0)return;bt();const Bt=Ue(X.translation),st=Ue(X.velocityAverage);let gt=!1;c("interactionrelease",{isTap:Z,isDoubleTap:mt,position:vt,translation:Bt,scalar:F,preventInertia:()=>gt=!0});const Jt=Yr(st);if(gt||!n||Jt<.25)return ut(Bt,{isTap:Z,isDoubleTap:mt});T=Ue(vt),I=Ue(Bt),w=g0(Ue(Bt),{easing:yw,duration:Jt*i}),w.set({x:Bt.x+50*st.x,y:Bt.y+50*st.y}).then(()=>{P&&ut(xa(w),{isTap:Z,isDoubleTap:mt})}),P=w.subscribe(ct)}function ct(K){K&&c("interactionupdate",{position:pt(T.x+(K.x-I.x),T.y+(K.y-I.y)),translation:K,scalar:o?F:void 0})}function V(K){if(document.visibilityState==="visible"||!u.length)return;const vt=v(u);d(),c("interactionend",{...vt}),u.length=0,bt()}function ut(K,vt){d(),c("interactionend",{...vt,translation:K,scalar:o?F:void 0})}function bt(){l&&window.removeEventListener("keydown",it),l&&window.removeEventListener("keyup",it),document.documentElement.removeEventListener("pointermove",at),document.documentElement.removeEventListener("pointerup",q),document.documentElement.removeEventListener("pointercancel",q),document.addEventListener("visibilitychange",V)}return{destroy(){d(),t.removeEventListener("pointerdown",ot)}}},Bs=(t,e={})=>{const{direction:n,shiftMultiplier:i=10,bubbles:r=!1,preventDefault:o=!1,stopKeydownPropagation:a=!0}=e,s=n==="horizontal",l=n==="vertical",c=d=>{const{key:u}=d,p=d.shiftKey,h=/up|down/i.test(u),y=/left|right/i.test(u);if(!y&&!h||s&&h||l&&y)return;const m=p?i:1;a&&d.stopPropagation(),o&&d.preventDefault(),t.dispatchEvent(new CustomEvent("nudge",{bubbles:r,detail:pt((/left/i.test(u)?-1:/right/i.test(u)?1:0)*m,(/up/i.test(u)?-1:/down/i.test(u)?1:0)*m)}))};return t.addEventListener("keydown",c),{destroy(){t.removeEventListener("keydown",c)}}};function Ss(t,e){return e?e*Math.sign(t)*Math.log10(1+Math.abs(t)/e):t}const sf=(t,e,n)=>{if(!e||!n)return{...t};const i=t.x+Ss(e.x-t.x,n),r=t.x+t.width+Ss(e.x+e.width-(t.x+t.width),n),o=t.y+Ss(e.y-t.y,n);return{x:i,y:o,width:r-i,height:t.y+t.height+Ss(e.y+e.height-(t.y+t.height),n)-o}},Uw=(t,e,n)=>e&&n?pt(t.x+Ss(e.x-t.x,n),t.y+Ss(e.y-t.y,n)):{...t};var J2=(t,e)=>{if(t)return/em/.test(t)?16*parseInt(t,10):/px/.test(t)?parseInt(t,10):void 0},t1=(t,e)=>{let n=t.detail||0;const{deltaX:i,deltaY:r,wheelDelta:o,wheelDeltaX:a,wheelDeltaY:s}=t,{fixScrollDirection:l=!1}=e||{};return dn(a)&&Math.abs(a)>Math.abs(s)?n=a/-120:dn(i)&&Math.abs(i)>Math.abs(r)?n=i/20:(o||s)&&(n=(o||s)/-120),n||(n=r/20),(va()||Ba())&&(n*=2),l&&qu()&&(n*=-1),n};function Gw(t){let e,n,i,r,o,a,s;const l=t[37].default,c=ur(l,t,t[36],null);return{c(){e=ft("div"),n=ft("div"),c&&c.c(),S(n,"style",t[5]),S(e,"class",i=rn(["PinturaScrollable",t[0]])),S(e,"style",t[4]),S(e,"data-direction",t[1]),S(e,"data-state",t[6])},m(d,u){tt(d,e,u),Et(e,n),c&&c.m(n,null),t[39](e),o=!0,a||(s=[St(n,"interactionstart",t[9]),St(n,"interactionupdate",t[11]),St(n,"interactionend",t[12]),St(n,"interactionrelease",t[10]),qn(zs.call(null,n,{inertia:!0})),St(n,"measure",t[38]),qn(Cr.call(null,n)),St(e,"wheel",t[14],{passive:!1}),St(e,"scroll",t[16]),St(e,"focusin",t[15]),St(e,"nudge",t[17]),St(e,"measure",t[13]),qn(Cr.call(null,e,{observePosition:!0})),qn(r=Bs.call(null,e,{direction:t[1]==="x"?"horizontal":"vertical",stopKeydownPropagation:!1}))],a=!0)},p(d,u){c&&c.p&&(!o||32&u[1])&&hr(c,l,d,d[36],o?pr(l,d[36],u,null):mr(d[36]),null),(!o||32&u[0])&&S(n,"style",d[5]),(!o||1&u[0]&&i!==(i=rn(["PinturaScrollable",d[0]])))&&S(e,"class",i),(!o||16&u[0])&&S(e,"style",d[4]),(!o||2&u[0])&&S(e,"data-direction",d[1]),(!o||64&u[0])&&S(e,"data-state",d[6]),r&&Hn(r.update)&&2&u[0]&&r.update.call(null,{direction:d[1]==="x"?"horizontal":"vertical",stopKeydownPropagation:!1})},i(d){o||(k(c,d),o=!0)},o(d){A(c,d),o=!1},d(d){d&&Q(e),c&&c.d(d),t[39](null),a=!1,Zn(s)}}}function jw(t,e,n){let i,r,o,a,s,l,c,d,u,{$$slots:p={},$$scope:h}=e;const y=la();let m,f,b,v,w="idle",T=fn(0);D(t,T,Z=>n(35,d=Z));let{class:I}=e,{scrollBlockInteractionDist:P=5}=e,{scrollStep:_=10}=e,{scrollFocusMargin:C=64}=e,{scrollDirection:F="x"}=e,{scrollAutoCancel:G=!1}=e,{elasticity:O=0}=e,{onscroll:$=ae}=e,{maskFeatherSize:N}=e,{maskFeatherStartOpacity:it}=e,{maskFeatherEndOpacity:M}=e,{scroll:W}=e;const ot=yi("fixScrollDirection");let at;D(t,ot,Z=>n(46,u=Z));let q="",ct=!0;const V=T.subscribe(Z=>{const mt=hi();mt[F]=Z,$(mt)}),ut=Z=>Math.max(Math.min(0,Z),b[i]-f[i]);let bt,K,vt;const X=(Z,mt={})=>{const{elastic:Bt=!1,animate:st=!1,preventScrollState:gt=!1}=mt;Math.abs(Z-m)>P&&w==="idle"&&!v&&!gt&&n(28,w="scrolling");const Jt=ut(Z),le=Bt&&O&&!v?Jt+Ss(Z-Jt,O):Jt;let rt=!0;st?rt=!1:ct||(rt=!v),ct=!1,T.set(le,{hard:rt}).then(kt=>{v&&(ct=!0)})};return Ho(()=>{V()}),t.$$set=Z=>{"class"in Z&&n(0,I=Z.class),"scrollBlockInteractionDist"in Z&&n(21,P=Z.scrollBlockInteractionDist),"scrollStep"in Z&&n(22,_=Z.scrollStep),"scrollFocusMargin"in Z&&n(23,C=Z.scrollFocusMargin),"scrollDirection"in Z&&n(1,F=Z.scrollDirection),"scrollAutoCancel"in Z&&n(24,G=Z.scrollAutoCancel),"elasticity"in Z&&n(25,O=Z.elasticity),"onscroll"in Z&&n(26,$=Z.onscroll),"maskFeatherSize"in Z&&n(20,N=Z.maskFeatherSize),"maskFeatherStartOpacity"in Z&&n(18,it=Z.maskFeatherStartOpacity),"maskFeatherEndOpacity"in Z&&n(19,M=Z.maskFeatherEndOpacity),"scroll"in Z&&n(27,W=Z.scroll),"$$scope"in Z&&n(36,h=Z.$$scope)},t.$$.update=()=>{if(2&t.$$.dirty[0]&&n(32,i=F==="x"?"width":"height"),2&t.$$.dirty[0]&&n(30,r=F.toUpperCase()),8&t.$$.dirty[0]&&n(34,o=at&&getComputedStyle(at)),8&t.$$.dirty[0]|8&t.$$.dirty[1]&&n(33,a=o&&J2(o.getPropertyValue("--scrollable-feather-size"))),537657348&t.$$.dirty[0]|22&t.$$.dirty[1]&&d!=null&&b&&a!=null&&f){const Z=-1*d/a,mt=-(b[i]-f[i]-d)/a;n(18,it=oi(1-Z,0,1)),n(19,M=oi(1-mt,0,1)),n(20,N=a),n(4,q=`--scrollable-feather-start-opacity: ${it};--scrollable-feather-end-opacity: ${M}`)}134217736&t.$$.dirty[0]&&at&&W!==void 0&&(dn(W)?X(W):X(W.scrollOffset,W)),536870916&t.$$.dirty[0]|2&t.$$.dirty[1]&&n(31,s=b&&f?f[i]>b[i]:void 0),268435456&t.$$.dirty[0]|1&t.$$.dirty[1]&&n(6,l=rn([w,s?"overflows":void 0])),1073741824&t.$$.dirty[0]|17&t.$$.dirty[1]&&n(5,c=s?`transform: translate${r}(${d}px)`:void 0)},[I,F,f,at,q,c,l,T,ot,()=>{s&&(K=!1,bt=!0,vt=pt(0,0),v=!1,n(28,w="idle"),m=xa(T))},({detail:Z})=>{s&&(v=!0,n(28,w="idle"))},({detail:Z})=>{s&&(K||bt&&(bt=!1,yo(Z.translation)<.1)||(!G||F!=="x"||(mt=>{const Bt=Eo(pt(mt.x-vt.x,mt.y-vt.y),Math.abs);vt=Ue(mt);const st=yo(Bt),gt=Bt.x-Bt.y;return!(st>1&&gt<-.5)})(Z.translation)?X(m+Z.translation[F],{elastic:!0}):K=!0))},({detail:Z})=>{if(!s||K)return;const mt=m+Z.translation[F],Bt=ut(mt);ct=!1,T.set(Bt).then(st=>{v&&(ct=!0)})},({detail:Z})=>{n(29,b=Z),y("measure",{x:Z.x,y:Z.y,width:Z.width,height:Z.height})},Z=>{if(!s)return;Z.preventDefault(),Z.stopPropagation();const mt=Z.shiftKey,Bt=t1(Z,{fixScrollDirection:u})*(mt?-1:1),st=xa(T);X(st+Bt*_,{animate:!0})},Z=>{if(!s||!v)return;let mt=Z.target;Z.target.classList.contains("implicit")&&(mt=mt.parentNode);const Bt=mt[F==="x"?"offsetLeft":"offsetTop"],st=Bt+mt[F==="x"?"offsetWidth":"offsetHeight"],gt=xa(T),Jt=C+N;gt+Bt<Jt?X(-Bt+Jt):gt+st>b[i]-Jt&&X(b[i]-st-Jt,{animate:!0})},()=>{n(3,at[F==="x"?"scrollLeft":"scrollTop"]=0,at)},({detail:Z})=>{if(at.querySelector("[data-focus-visible]"))return;const mt=-2*Z[F],Bt=xa(T);X(Bt+mt*_,{animate:!0,preventScrollState:!0})},it,M,N,P,_,C,G,O,$,W,w,b,r,s,i,a,o,d,h,p,Z=>n(2,f=Z.detail),function(Z){Nn[Z?"unshift":"push"](()=>{at=Z,n(3,at)})}]}class us extends Tn{constructor(e){super(),Sn(this,e,jw,Gw,yn,{class:0,scrollBlockInteractionDist:21,scrollStep:22,scrollFocusMargin:23,scrollDirection:1,scrollAutoCancel:24,elasticity:25,onscroll:26,maskFeatherSize:20,maskFeatherStartOpacity:18,maskFeatherEndOpacity:19,scroll:27},null,[-1,-1])}}function Zw(t){let e,n,i,r,o;return{c(){e=ft("span"),S(e,"class","PinturaStatusMessage")},m(a,s){tt(a,e,s),e.innerHTML=t[0],i=!0,r||(o=[St(e,"measure",function(){Hn(t[1])&&t[1].apply(this,arguments)}),qn(Cr.call(null,e))],r=!0)},p(a,[s]){t=a,(!i||1&s)&&(e.innerHTML=t[0])},i(a){i||(hl(()=>{n||(n=Sg(e,t[4],{duration:t[2]},!0)),n.run(1)}),i=!0)},o(a){n||(n=Sg(e,t[4],{duration:t[2]},!1)),n.run(0),i=!1},d(a){a&&Q(e),a&&n&&n.end(),r=!1,Zn(o)}}}function Xw(t,e,n){let i,r,{text:o}=e,{onmeasure:a=ae}=e;const s=yi("isAnimated");return D(t,s,l=>n(5,r=l)),t.$$set=l=>{"text"in l&&n(0,o=l.text),"onmeasure"in l&&n(1,a=l.onmeasure)},t.$$.update=()=>{32&t.$$.dirty&&n(2,i=r?500:0)},[o,a,i,s,function(l,{duration:c}){return{duration:c,tick:d=>{l.style.opacity=d}}},r]}class Q2 extends Tn{constructor(e){super(),Sn(this,e,Xw,Zw,yn,{text:0,onmeasure:1})}}function qw(t){let e,n,i,r,o,a,s,l,c;return{c(){e=ft("span"),n=Or("svg"),i=Or("g"),r=Or("circle"),o=Or("circle"),a=pe(),s=ft("span"),l=Mi(t[3]),S(r,"class","PinturaProgressIndicatorBar"),S(r,"r","8.5"),S(r,"cx","10"),S(r,"cy","10"),S(r,"stroke-linecap","round"),S(r,"opacity",".25"),S(o,"class","PinturaProgressIndicatorFill"),S(o,"r","8.5"),S(o,"stroke-dasharray",t[2]),S(o,"cx","10"),S(o,"cy","10"),S(o,"transform","rotate(-90) translate(-20)"),S(i,"fill","none"),S(i,"stroke","currentColor"),S(i,"stroke-width","2.5"),S(i,"stroke-linecap","round"),S(i,"opacity",t[1]),S(n,"width","20"),S(n,"height","20"),S(n,"viewBox","0 0 20 20"),S(n,"xmlns","http://www.w3.org/2000/svg"),S(n,"aria-hidden","true"),S(n,"focusable","false"),S(s,"class","implicit"),S(e,"class","PinturaProgressIndicator"),S(e,"data-status",t[0]),S(e,"style",c="opacity:"+t[4])},m(d,u){tt(d,e,u),Et(e,n),Et(n,i),Et(i,r),Et(i,o),Et(e,a),Et(e,s),Et(s,l)},p(d,[u]){4&u&&S(o,"stroke-dasharray",d[2]),2&u&&S(i,"opacity",d[1]),8&u&&Yi(l,d[3]),1&u&&S(e,"data-status",d[0]),16&u&&c!==(c="opacity:"+d[4])&&S(e,"style",c)},i:tn,o:tn,d(d){d&&Q(e)}}}function Yw(t,e,n){let i,r,o,a,s,l,c,d;const u=la();let{progress:p}=e,{min:h=0}=e,{max:y=100}=e,{labelBusy:m="Busy"}=e,{opacity:f}=e;const b=yi("isAnimated");D(t,b,_=>n(14,s=_));const v=fn(f,{precision:.01});D(t,v,_=>n(4,d=_));const w=fn(0,{precision:.01}),T=fn(0,{precision:.01});D(t,T,_=>n(15,l=_));const I=Vn([w],_=>oi(_,h,y));D(t,I,_=>n(16,c=_));const P=I.subscribe(_=>{p===1&&Math.round(_)>=100&&u("complete")});return ds(()=>{T.set(1,{hard:!s})}),Ho(()=>{P()}),t.$$set=_=>{"progress"in _&&n(9,p=_.progress),"min"in _&&n(10,h=_.min),"max"in _&&n(11,y=_.max),"labelBusy"in _&&n(12,m=_.labelBusy),"opacity"in _&&n(13,f=_.opacity)},t.$$.update=()=>{24576&t.$$.dirty&&dn(f)&&v.set(f,{hard:!s}),16896&t.$$.dirty&&p&&p!==1/0&&w.set(100*p,{hard:!s}),70144&t.$$.dirty&&n(3,i=p===1/0?m:Math.round(c)+"%"),66048&t.$$.dirty&&n(2,r=p===1/0?"26.5 53":c/100*53+" 53"),32768&t.$$.dirty&&n(1,o=l),512&t.$$.dirty&&n(0,a=p===1/0?"busy":"loading")},[a,o,r,i,d,b,v,T,I,p,h,y,m,f,s,l,c]}class tx extends Tn{constructor(e){super(),Sn(this,e,Yw,qw,yn,{progress:9,min:10,max:11,labelBusy:12,opacity:13})}}function Kw(t){let e,n,i;const r=t[5].default,o=ur(r,t,t[4],null);return{c(){e=ft("span"),o&&o.c(),S(e,"class",n="PinturaStatusAside "+t[0]),S(e,"style",t[1])},m(a,s){tt(a,e,s),o&&o.m(e,null),i=!0},p(a,[s]){o&&o.p&&(!i||16&s)&&hr(o,r,a,a[4],i?pr(r,a[4],s,null):mr(a[4]),null),(!i||1&s&&n!==(n="PinturaStatusAside "+a[0]))&&S(e,"class",n),(!i||2&s)&&S(e,"style",a[1])},i(a){i||(k(o,a),i=!0)},o(a){A(o,a),i=!1},d(a){a&&Q(e),o&&o.d(a)}}}function Jw(t,e,n){let i,{$$slots:r={},$$scope:o}=e,{offset:a=0}=e,{opacity:s=0}=e,{class:l}=e;return t.$$set=c=>{"offset"in c&&n(2,a=c.offset),"opacity"in c&&n(3,s=c.opacity),"class"in c&&n(0,l=c.class),"$$scope"in c&&n(4,o=c.$$scope)},t.$$.update=()=>{12&t.$$.dirty&&n(1,i=`transform:translateX(${a}px);opacity:${s}`)},[l,i,a,s,o,r]}class ex extends Tn{constructor(e){super(),Sn(this,e,Jw,Kw,yn,{offset:2,opacity:3,class:0})}}const{document:lf}=a0;function Qw(t){let e,n,i,r;return{c(){e=pe(),n=ft("button"),S(n,"class","PinturaImageButton"),S(n,"type","button"),S(n,"title",t[1]),n.disabled=t[2]},m(o,a){tt(o,e,a),tt(o,n,a),n.innerHTML=t[0],t[11](n),i||(r=[St(lf.body,"load",t[5],!0),St(lf.body,"error",t[6],!0),St(n,"pointerdown",t[4])],i=!0)},p(o,[a]){1&a&&(n.innerHTML=o[0]),2&a&&S(n,"title",o[1]),4&a&&(n.disabled=o[2])},i:tn,o:tn,d(o){o&&Q(e),o&&Q(n),t[11](null),i=!1,Zn(r)}}}function t4(t,e,n){let i,{html:r}=e,{title:o}=e,{onclick:a}=e,{disabled:s=!1}=e,{ongrab:l=ae}=e,{ondrag:c=ae}=e,{ondrop:d=ae}=e;const u=f=>yo(p,pt(f.pageX,f.pageY))<256;let p;const h=f=>{document.documentElement.removeEventListener("pointermove",y),document.documentElement.removeEventListener("pointerup",h);const b=pt(f.pageX,f.pageY);if(yo(p,b)<32)return a(f);u(f)||d(f)},y=f=>{u(f)||c(f)},m=f=>i&&i.contains(f)&&f.nodeName==="IMG";return t.$$set=f=>{"html"in f&&n(0,r=f.html),"title"in f&&n(1,o=f.title),"onclick"in f&&n(7,a=f.onclick),"disabled"in f&&n(2,s=f.disabled),"ongrab"in f&&n(8,l=f.ongrab),"ondrag"in f&&n(9,c=f.ondrag),"ondrop"in f&&n(10,d=f.ondrop)},t.$$.update=()=>{8&t.$$.dirty&&i&&i.querySelector("img")&&n(3,i.dataset.loader=!0,i)},[r,o,s,i,f=>{p=pt(f.pageX,f.pageY),l(f),document.documentElement.addEventListener("pointermove",y),document.documentElement.addEventListener("pointerup",h)},({target:f})=>{m(f)&&n(3,i.dataset.load=!0,i)},({target:f})=>{m(f)&&n(3,i.dataset.error=!0,i)},a,l,c,d,function(f){Nn[f?"unshift":"push"](()=>{i=f,n(3,i)})}]}class nx extends Tn{constructor(e){super(),Sn(this,e,t4,Qw,yn,{html:0,title:1,onclick:7,disabled:2,ongrab:8,ondrag:9,ondrop:10})}}function cf(t,e,n){const i=t.slice();return i[14]=e[n],i}function df(t,e){let n,i,r,o,a,s,l;function c(){return e[10](e[14])}function d(...h){return e[11](e[14],...h)}function u(...h){return e[12](e[14],...h)}function p(...h){return e[13](e[14],...h)}return i=new nx({props:{onclick:c,ongrab:d,ondrag:u,ondrop:p,disabled:e[1]||e[14].disabled,title:e[14].title,html:e[14].thumb}}),{key:t,first:null,c(){n=ft("li"),zt(i.$$.fragment),r=pe(),S(n,"style",e[6]),this.first=n},m(h,y){tt(h,n,y),Ft(i,n,null),Et(n,r),a=!0,s||(l=qn(o=e[8].call(null,n,e[14])),s=!0)},p(h,y){e=h;const m={};5&y&&(m.onclick=c),9&y&&(m.ongrab=d),17&y&&(m.ondrag=u),33&y&&(m.ondrop=p),3&y&&(m.disabled=e[1]||e[14].disabled),1&y&&(m.title=e[14].title),1&y&&(m.html=e[14].thumb),i.$set(m),(!a||64&y)&&S(n,"style",e[6]),o&&Hn(o.update)&&1&y&&o.update.call(null,e[14])},i(h){a||(k(i.$$.fragment,h),a=!0)},o(h){A(i.$$.fragment,h),a=!1},d(h){h&&Q(n),_t(i),s=!1,l()}}}function e4(t){let e,n,i=[],r=new Map,o=t[0];const a=s=>s[14].id;for(let s=0;s<o.length;s+=1){let l=cf(t,o,s),c=a(l);r.set(c,i[s]=df(c,l))}return{c(){e=ft("ul");for(let s=0;s<i.length;s+=1)i[s].c();S(e,"class","PinturaImageButtonList")},m(s,l){tt(s,e,l);for(let c=0;c<i.length;c+=1)i[c].m(e,null);n=!0},p(s,[l]){127&l&&(o=s[0],Te(),i=Va(i,l,a,1,s,o,r,e,_s,df,null,cf),Ce())},i(s){if(!n){for(let l=0;l<o.length;l+=1)k(i[l]);n=!0}},o(s){for(let l=0;l<i.length;l+=1)A(i[l]);n=!1},d(s){s&&Q(e);for(let l=0;l<i.length;l+=1)i[l].d()}}}function n4(t,e,n){let i,r,{items:o}=e,{disabled:a}=e,{onclickitem:s}=e,{ongrabitem:l}=e,{ondragitem:c}=e,{ondropitem:d}=e;const u=fn(0,{stiffness:.25,damping:.9});return D(t,u,p=>n(9,r=p)),ds(()=>u.set(1)),t.$$set=p=>{"items"in p&&n(0,o=p.items),"disabled"in p&&n(1,a=p.disabled),"onclickitem"in p&&n(2,s=p.onclickitem),"ongrabitem"in p&&n(3,l=p.ongrabitem),"ondragitem"in p&&n(4,c=p.ondragitem),"ondropitem"in p&&n(5,d=p.ondropitem)},t.$$.update=()=>{512&t.$$.dirty&&n(6,i="opacity:"+r)},[o,a,s,l,c,d,i,u,(p,h)=>h.mount&&h.mount(p.firstChild,h),r,p=>s(p.id),(p,h)=>l&&l(p.id,h),(p,h)=>c&&c(p.id,h),(p,h)=>d&&d(p.id,h)]}class y0 extends Tn{constructor(e){super(),Sn(this,e,n4,e4,yn,{items:0,disabled:1,onclickitem:2,ongrabitem:3,ondragitem:4,ondropitem:5})}}var Oc=()=>ir()&&window.devicePixelRatio||1;let Xp=null;var Kc=t=>(Xp===null&&(Xp=Oc()===1?Math.round:e=>e),Xp(t)),Eh=(t,e={})=>{if(t){if(e.preventScroll&&Ba()){const n=document.body.scrollTop;return t.focus(),void(document.body.scrollTop=n)}t.focus(e)}},ix=t=>/date|email|number|search|text|url/.test(t.type),ml=t=>(e=>/textarea/i.test(e.nodeName))(t)||ix(t)||t.isContentEditable;const i4=t=>({}),uf=t=>({}),r4=t=>({}),pf=t=>({});function o4(t){let e,n;const i=[t[7]];let r={$$slots:{default:[s4]},$$scope:{ctx:t}};for(let o=0;o<i.length;o+=1)r=ki(r,i[o]);return e=new Ds({props:r}),t[46](e),{c(){zt(e.$$.fragment)},m(o,a){Ft(e,o,a),n=!0},p(o,a){const s=128&a[0]?Tr(i,[_r(o[7])]):{};524288&a[1]&&(s.$$scope={dirty:a,ctx:o}),e.$set(s)},i(o){n||(k(e.$$.fragment,o),n=!0)},o(o){A(e.$$.fragment,o),n=!1},d(o){t[46](null),_t(e,o)}}}function a4(t){let e,n;const i=[t[7]];let r={};for(let o=0;o<i.length;o+=1)r=ki(r,i[o]);return e=new Ds({props:r}),t[45](e),{c(){zt(e.$$.fragment)},m(o,a){Ft(e,o,a),n=!0},p(o,a){const s=128&a[0]?Tr(i,[_r(o[7])]):{};e.$set(s)},i(o){n||(k(e.$$.fragment,o),n=!0)},o(o){A(e.$$.fragment,o),n=!1},d(o){t[45](null),_t(e,o)}}}function s4(t){let e;const n=t[44].label,i=ur(n,t,t[50],pf);return{c(){i&&i.c()},m(r,o){i&&i.m(r,o),e=!0},p(r,o){i&&i.p&&(!e||524288&o[1])&&hr(i,n,r,r[50],e?pr(n,r[50],o,r4):mr(r[50]),pf)},i(r){e||(k(i,r),e=!0)},o(r){A(i,r),e=!1},d(r){i&&i.d(r)}}}function hf(t){let e,n,i,r,o,a,s;const l=t[44].details,c=ur(l,t,t[50],uf);return{c(){e=ft("div"),c&&c.c(),n=pe(),i=ft("span"),S(i,"class","PinturaPanelTip"),S(i,"style",t[10]),S(e,"class",r=rn(["PinturaPanel","pintura-editor-panel",t[2]])),S(e,"tabindex","-1"),S(e,"style",t[11])},m(d,u){tt(d,e,u),c&&c.m(e,null),Et(e,n),Et(e,i),t[47](e),o=!0,a||(s=[St(e,"close",t[48]),St(e,"keydown",t[18]),St(e,"measure",t[49]),qn(Cr.call(null,e))],a=!0)},p(d,u){c&&c.p&&(!o||524288&u[1])&&hr(c,l,d,d[50],o?pr(l,d[50],u,i4):mr(d[50]),uf),(!o||1024&u[0])&&S(i,"style",d[10]),(!o||4&u[0]&&r!==(r=rn(["PinturaPanel","pintura-editor-panel",d[2]])))&&S(e,"class",r),(!o||2048&u[0])&&S(e,"style",d[11])},i(d){o||(k(c,d),o=!0)},o(d){A(c,d),o=!1},d(d){d&&Q(e),c&&c.d(d),t[47](null),a=!1,Zn(s)}}}function l4(t){let e,n,i,r,o,a,s,l,c;const d=[a4,o4],u=[];function p(y,m){return y[1]?0:1}n=p(t),i=u[n]=d[n](t);let h=t[6]&&hf(t);return{c(){e=pe(),i.c(),r=pe(),h&&h.c(),o=pe(),a=Ei()},m(y,m){tt(y,e,m),u[n].m(y,m),tt(y,r,m),h&&h.m(y,m),tt(y,o,m),tt(y,a,m),s=!0,l||(c=[St(document.body,"pointerdown",function(){Hn(t[9])&&t[9].apply(this,arguments)}),St(document.body,"pointerup",function(){Hn(t[8])&&t[8].apply(this,arguments)})],l=!0)},p(y,m){let f=n;n=p(t=y),n===f?u[n].p(t,m):(Te(),A(u[f],1,1,()=>{u[f]=null}),Ce(),i=u[n],i?i.p(t,m):(i=u[n]=d[n](t),i.c()),k(i,1),i.m(r.parentNode,r)),t[6]?h?(h.p(t,m),64&m[0]&&k(h,1)):(h=hf(t),h.c(),k(h,1),h.m(o.parentNode,o)):h&&(Te(),A(h,1,1,()=>{h=null}),Ce())},i(y){s||(k(i),k(h),k(!1),s=!0)},o(y){A(i),A(h),A(!1),s=!1},d(y){y&&Q(e),u[n].d(y),y&&Q(r),h&&h.d(y),y&&Q(o),y&&Q(a),l=!1,Zn(c)}}}function c4(t,e,n){let i,r,o,a,s,l,c,d,u,p,h,y,m,f,b,v,w,T,I,{$$slots:P={},$$scope:_}=e,{buttonClass:C}=e,{buttonLabel:F}=e,{buttonLabelClass:G}=e,{buttonHideLabel:O}=e,{buttonIcon:$}=e,{buttonTitle:N}=e,{panelClass:it}=e,{isActive:M=!1}=e,{onshow:W=({panel:$t})=>Eh($t,{preventScroll:!0})}=e,{onhide:ot=ae}=e;const at=yi("isAnimated");D(t,at,$t=>n(43,I=$t));const q=yi("rootPortal");D(t,q,$t=>n(38,f=$t));const ct=yi("rootRect");let V,ut,bt;D(t,ct,$t=>n(41,w=$t));const K=()=>n(26,bt=i&&i.getBoundingClientRect());let vt=hi(),X=fn(0);D(t,X,$t=>n(40,v=$t));let Z=hi();const mt=me({x:0,y:0});D(t,mt,$t=>n(39,b=$t));const Bt=fn(-5,{stiffness:.1,damping:.35,precision:.001});D(t,Bt,$t=>n(42,T=$t));let st=!0;const gt=$t=>K2($t,f)||ut.isEventTarget($t);let Jt,le,rt=!1;const kt=$t=>{ml($t.target)||(M||K(),n(31,le=$t),n(0,M=!M))},Nt=$t=>{/down/i.test($t.key)&&(n(0,M=!0),n(31,le=$t))};return Ho(()=>{if(!f||!Jt)return;const $t=Jt;M2().then(()=>{$t.parentNode&&$t.remove()})}),t.$$set=$t=>{"buttonClass"in $t&&n(19,C=$t.buttonClass),"buttonLabel"in $t&&n(1,F=$t.buttonLabel),"buttonLabelClass"in $t&&n(20,G=$t.buttonLabelClass),"buttonHideLabel"in $t&&n(21,O=$t.buttonHideLabel),"buttonIcon"in $t&&n(22,$=$t.buttonIcon),"buttonTitle"in $t&&n(23,N=$t.buttonTitle),"panelClass"in $t&&n(2,it=$t.panelClass),"isActive"in $t&&n(0,M=$t.isActive),"onshow"in $t&&n(24,W=$t.onshow),"onhide"in $t&&n(25,ot=$t.onhide),"$$scope"in $t&&n(50,_=$t.$$scope)},t.$$.update=()=>{if(16&t.$$.dirty[0]&&(i=ut&&ut.getElement()),1073741825&t.$$.dirty[0]&&n(8,y=M?$t=>{rt&&(n(30,rt=!1),gt($t)||n(0,M=!1))}:void 0),1&t.$$.dirty[0]|4096&t.$$.dirty[1]&&X.set(M?1:0,{hard:I===!1}),1&t.$$.dirty[0]|4096&t.$$.dirty[1]&&Bt.set(M?0:-5,{hard:I===!1}),2048&t.$$.dirty[1]&&n(34,r=1-T/-5),1&t.$$.dirty[0]|1024&t.$$.dirty[1]&&w&&M&&K(),67108873&t.$$.dirty[0]|1024&t.$$.dirty[1]&&w&&V&&bt&&M){n(29,st=!0);let $t=bt.x-w.x+.5*bt.width-.5*V.width,Be=bt.y-w.y+bt.height;const nt=12,Ut=12,qt=w.width-12,Dt=w.height-12,ve=$t,It=Be,Ie=ve+V.width,lt=It+V.height;ve<nt&&(n(28,Z.x=ve-nt,Z),$t=nt),Ie>qt&&(n(28,Z.x=Ie-qt,Z),$t=qt-V.width),lt>Dt?(n(27,vt.y=-1,vt),Ut<Be-V.height-bt.height?(n(28,Z.y=0,Z),Be-=V.height+bt.height):(n(28,Z.y=Be-(lt-Dt),Z),Be-=lt-Dt-12,n(29,st=!1))):n(27,vt.y=1,vt),At(mt,b=Eo(pt($t,Be),Kc),b)}512&t.$$.dirty[1]&&n(6,o=v>0),512&t.$$.dirty[1]&&n(37,a=v<1),134217728&t.$$.dirty[0]|2304&t.$$.dirty[1]&&n(36,s=`translateX(${Math.round(b.x)+12*vt.x}px) translateY(${Math.round(b.y)+12*vt.y+vt.y*T}px)`),1024&t.$$.dirty[1]&&n(35,l=`--panel-max-height:${w.height-24}px`),624&t.$$.dirty[1]&&n(11,c=a?`opacity: ${v}; pointer-events: ${v<1?"none":"all"}; transform: ${s};${l}`:`transform: ${s};${l}`),8&t.$$.dirty[1]&&n(32,d=.5+.5*r),8&t.$$.dirty[1]&&n(33,u=r),939524104&t.$$.dirty[0]|262&t.$$.dirty[1]&&n(10,p=b&&V&&`opacity:${st?u:0};transform:scaleX(${d})rotate(45deg);top:${vt.y<0?Z.y+V.height:0}px;left:${Z.x+.5*V.width}px`),1&t.$$.dirty[0]&&n(9,h=M?$t=>{gt($t)||n(30,rt=!0)}:void 0),96&t.$$.dirty[0]|128&t.$$.dirty[1]&&o&&f&&Jt&&Jt.parentNode!==f&&f.append(Jt),1&t.$$.dirty[0]&&(M||n(31,le=void 0)),16777313&t.$$.dirty[0]|1&t.$$.dirty[1]&&M&&o&&Jt&&W({e:le,panel:Jt}),33554497&t.$$.dirty[0]&&o&&!M&&ot(),16252930&t.$$.dirty[0]&&n(7,m={label:F,icon:$,class:rn(["PinturaPanelButton",C]),onkeydown:Nt,onclick:kt,hideLabel:O,labelClass:G,title:N})},[M,F,it,V,ut,Jt,o,m,y,h,p,c,at,q,ct,X,mt,Bt,$t=>{/esc/i.test($t.key)&&(n(0,M=!1),i.focus())},C,G,O,$,N,W,ot,bt,vt,Z,st,rt,le,d,u,r,l,s,a,f,b,v,w,T,I,P,function($t){Nn[$t?"unshift":"push"](()=>{ut=$t,n(4,ut)})},function($t){Nn[$t?"unshift":"push"](()=>{ut=$t,n(4,ut)})},function($t){Nn[$t?"unshift":"push"](()=>{Jt=$t,n(5,Jt)})},$t=>{$t.stopPropagation(),n(0,M=!1)},$t=>n(3,V=Wa($t.detail)),_]}class e1 extends Tn{constructor(e){super(),Sn(this,e,c4,l4,yn,{buttonClass:19,buttonLabel:1,buttonLabelClass:20,buttonHideLabel:21,buttonIcon:22,buttonTitle:23,panelClass:2,isActive:0,onshow:24,onhide:25},null,[-1,-1])}}var d4={Up:38,Down:40,Left:37,Right:39};function u4(t){let e,n,i,r,o,a,s,l;const c=t[15].default,d=ur(c,t,t[14],null);return{c(){e=ft("li"),n=ft("input"),i=pe(),r=ft("label"),d&&d.c(),S(n,"type","radio"),S(n,"class","implicit"),S(n,"id",t[7]),S(n,"name",t[0]),n.value=t[3],n.disabled=t[6],n.hidden=t[5],n.checked=t[4],S(r,"for",t[7]),S(r,"title",t[2]),S(e,"class",o=rn(["PinturaRadioGroupOption",t[1]])),S(e,"data-hidden",t[5]),S(e,"data-disabled",t[6]),S(e,"data-selected",t[4])},m(u,p){tt(u,e,p),Et(e,n),Et(e,i),Et(e,r),d&&d.m(r,null),a=!0,s||(l=[St(n,"change",Mv(t[16])),St(n,"keydown",t[9]),St(n,"click",t[10])],s=!0)},p(u,[p]){(!a||128&p)&&S(n,"id",u[7]),(!a||1&p)&&S(n,"name",u[0]),(!a||8&p)&&(n.value=u[3]),(!a||64&p)&&(n.disabled=u[6]),(!a||32&p)&&(n.hidden=u[5]),(!a||16&p)&&(n.checked=u[4]),d&&d.p&&(!a||16384&p)&&hr(d,c,u,u[14],a?pr(c,u[14],p,null):mr(u[14]),null),(!a||128&p)&&S(r,"for",u[7]),(!a||4&p)&&S(r,"title",u[2]),(!a||2&p&&o!==(o=rn(["PinturaRadioGroupOption",u[1]])))&&S(e,"class",o),(!a||32&p)&&S(e,"data-hidden",u[5]),(!a||64&p)&&S(e,"data-disabled",u[6]),(!a||16&p)&&S(e,"data-selected",u[4])},i(u){a||(k(d,u),a=!0)},o(u){A(d,u),a=!1},d(u){u&&Q(e),d&&d.d(u),s=!1,Zn(l)}}}function p4(t,e,n){let i,r,{$$slots:o={},$$scope:a}=e,{name:s}=e,{class:l}=e,{label:c}=e,{id:d}=e,{value:u}=e,{checked:p}=e,{onkeydown:h}=e,{onclick:y}=e,{hidden:m=!1}=e,{disabled:f=!1}=e;const b=Object.values(d4),v=yi("keysPressed");return D(t,v,w=>n(17,r=w)),t.$$set=w=>{"name"in w&&n(0,s=w.name),"class"in w&&n(1,l=w.class),"label"in w&&n(2,c=w.label),"id"in w&&n(11,d=w.id),"value"in w&&n(3,u=w.value),"checked"in w&&n(4,p=w.checked),"onkeydown"in w&&n(12,h=w.onkeydown),"onclick"in w&&n(13,y=w.onclick),"hidden"in w&&n(5,m=w.hidden),"disabled"in w&&n(6,f=w.disabled),"$$scope"in w&&n(14,a=w.$$scope)},t.$$.update=()=>{2049&t.$$.dirty&&n(7,i=`${s}-${d}`)},[s,l,c,u,p,m,f,i,v,w=>{h(w)},w=>{r.some(T=>b.includes(T))||y(w)},d,h,y,a,o,function(w){aa.call(this,t,w)}]}class rx extends Tn{constructor(e){super(),Sn(this,e,p4,u4,yn,{name:0,class:1,label:2,id:11,value:3,checked:4,onkeydown:12,onclick:13,hidden:5,disabled:6})}}var Wc=(t=[])=>t.reduce((e,n)=>(qi(n)?qi(n[1]):n.options)?e.concat(qi(n)?n[1]:n.options):(e.push(n),e),[]);const cu=(t,e,n)=>{let i;return qi(t)?i={id:e,value:t[0],label:t[1],...t[2]||{}}:(i=t,i.id=i.id!=null?i.id:e),n?n(i):i};var cr=(t,e,n)=>Si(t)?t(e,n):t;const ox=(t,e)=>t.map(([n,i,r])=>{if(qi(i))return[cr(n,e),ox(i,e)];{const o=[n,cr(i,e)];if(r){let a={...r};r.icon&&(a.icon=cr(r.icon,e)),o.push(a)}return o}});var ax=(t,e)=>ox(t,e),sx=(t,e)=>Array.isArray(t)&&Array.isArray(e)?Os(t,e):t===e;function mf(t,e,n){const i=t.slice();return i[27]=e[n],i}const h4=t=>({option:1024&t[0]}),gf=t=>({option:t[27]});function ff(t,e,n){const i=t.slice();return i[27]=e[n],i}const m4=t=>({option:1024&t[0]}),$f=t=>({option:t[27]}),g4=t=>({option:1024&t[0]}),yf=t=>({option:t[27]});function xf(t){let e,n,i,r,o,a=[],s=new Map,l=t[1]&&bf(t),c=t[10];const d=u=>u[27].id;for(let u=0;u<c.length;u+=1){let p=mf(t,c,u),h=d(p);s.set(h,a[u]=Mf(h,p))}return{c(){e=ft("fieldset"),l&&l.c(),n=pe(),i=ft("ul");for(let u=0;u<a.length;u+=1)a[u].c();S(i,"class","PinturaRadioGroupOptions"),S(e,"class",r=rn(["PinturaRadioGroup",t[3]])),S(e,"data-layout",t[5]),S(e,"title",t[7])},m(u,p){tt(u,e,p),l&&l.m(e,null),Et(e,n),Et(e,i);for(let h=0;h<a.length;h+=1)a[h].m(i,null);o=!0},p(u,p){u[1]?l?l.p(u,p):(l=bf(u),l.c(),l.m(e,n)):l&&(l.d(1),l=null),8419153&p[0]&&(c=u[10],Te(),a=Va(a,p,d,1,u,c,s,i,_s,Mf,null,mf),Ce()),(!o||8&p[0]&&r!==(r=rn(["PinturaRadioGroup",u[3]])))&&S(e,"class",r),(!o||32&p[0])&&S(e,"data-layout",u[5]),(!o||128&p[0])&&S(e,"title",u[7])},i(u){if(!o){for(let p=0;p<c.length;p+=1)k(a[p]);o=!0}},o(u){for(let p=0;p<a.length;p+=1)A(a[p]);o=!1},d(u){u&&Q(e),l&&l.d();for(let p=0;p<a.length;p+=1)a[p].d()}}}function bf(t){let e,n,i;return{c(){e=ft("legend"),n=Mi(t[1]),S(e,"class",i=t[2]&&"implicit")},m(r,o){tt(r,e,o),Et(e,n)},p(r,o){2&o[0]&&Yi(n,r[1]),4&o[0]&&i!==(i=r[2]&&"implicit")&&S(e,"class",i)},d(r){r&&Q(e)}}}function f4(t){let e,n;return e=new rx({props:{name:t[4],label:t[27].label,id:t[27].id,value:t[27].value,disabled:t[27].disabled,hidden:t[27].hidden,class:t[8],checked:t[12](t[27])===t[0],onkeydown:t[13](t[27]),onclick:t[14](t[27]),$$slots:{default:[x4]},$$scope:{ctx:t}}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};16&r[0]&&(o.name=i[4]),1024&r[0]&&(o.label=i[27].label),1024&r[0]&&(o.id=i[27].id),1024&r[0]&&(o.value=i[27].value),1024&r[0]&&(o.disabled=i[27].disabled),1024&r[0]&&(o.hidden=i[27].hidden),256&r[0]&&(o.class=i[8]),1025&r[0]&&(o.checked=i[12](i[27])===i[0]),1024&r[0]&&(o.onkeydown=i[13](i[27])),1024&r[0]&&(o.onclick=i[14](i[27])),8389696&r[0]&&(o.$$scope={dirty:r,ctx:i}),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function $4(t){let e,n,i,r,o,a,s=[],l=new Map;const c=t[22].group,d=ur(c,t,t[23],yf),u=d||function(y){let m,f,b=y[27].label+"";return{c(){m=ft("span"),f=Mi(b),S(m,"class","PinturaRadioGroupOptionGroupLabel")},m(v,w){tt(v,m,w),Et(m,f)},p(v,w){1024&w[0]&&b!==(b=v[27].label+"")&&Yi(f,b)},d(v){v&&Q(m)}}}(t);let p=t[27].options;const h=y=>y[27].id;for(let y=0;y<p.length;y+=1){let m=ff(t,p,y),f=h(m);l.set(f,s[y]=Cf(f,m))}return{c(){e=ft("li"),u&&u.c(),n=pe(),i=ft("ul");for(let y=0;y<s.length;y+=1)s[y].c();r=pe(),S(i,"class","PinturaRadioGroupOptions"),S(e,"class",o=rn(["PinturaRadioGroupOptionGroup",t[9]]))},m(y,m){tt(y,e,m),u&&u.m(e,null),Et(e,n),Et(e,i);for(let f=0;f<s.length;f+=1)s[f].m(i,null);Et(e,r),a=!0},p(y,m){d?d.p&&(!a||8389632&m[0])&&hr(d,c,y,y[23],a?pr(c,y[23],m,g4):mr(y[23]),yf):u&&u.p&&(!a||1024&m[0])&&u.p(y,a?m:[-1,-1]),8418641&m[0]&&(p=y[27].options,Te(),s=Va(s,m,h,1,y,p,l,i,_s,Cf,null,ff),Ce()),(!a||512&m[0]&&o!==(o=rn(["PinturaRadioGroupOptionGroup",y[9]])))&&S(e,"class",o)},i(y){if(!a){k(u,y);for(let m=0;m<p.length;m+=1)k(s[m]);a=!0}},o(y){A(u,y);for(let m=0;m<s.length;m+=1)A(s[m]);a=!1},d(y){y&&Q(e),u&&u.d(y);for(let m=0;m<s.length;m+=1)s[m].d()}}}function vf(t){let e,n;return e=new Vo({props:{$$slots:{default:[y4]},$$scope:{ctx:t}}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};8389632&r[0]&&(o.$$scope={dirty:r,ctx:i}),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function y4(t){let e,n=t[27].icon+"";return{c(){e=Or("g")},m(i,r){tt(i,e,r),e.innerHTML=n},p(i,r){1024&r[0]&&n!==(n=i[27].icon+"")&&(e.innerHTML=n)},d(i){i&&Q(e)}}}function wf(t){let e,n,i=t[27].label+"";return{c(){e=ft("span"),n=Mi(i),S(e,"class",t[6])},m(r,o){tt(r,e,o),Et(e,n)},p(r,o){1024&o[0]&&i!==(i=r[27].label+"")&&Yi(n,i),64&o[0]&&S(e,"class",r[6])},d(r){r&&Q(e)}}}function x4(t){let e;const n=t[22].option,i=ur(n,t,t[23],gf),r=i||function(o){let a,s,l,c=o[27].icon&&vf(o),d=!o[27].hideLabel&&wf(o);return{c(){c&&c.c(),a=pe(),d&&d.c(),s=pe()},m(u,p){c&&c.m(u,p),tt(u,a,p),d&&d.m(u,p),tt(u,s,p),l=!0},p(u,p){u[27].icon?c?(c.p(u,p),1024&p[0]&&k(c,1)):(c=vf(u),c.c(),k(c,1),c.m(a.parentNode,a)):c&&(Te(),A(c,1,1,()=>{c=null}),Ce()),u[27].hideLabel?d&&(d.d(1),d=null):d?d.p(u,p):(d=wf(u),d.c(),d.m(s.parentNode,s))},i(u){l||(k(c),l=!0)},o(u){A(c),l=!1},d(u){c&&c.d(u),u&&Q(a),d&&d.d(u),u&&Q(s)}}}(t);return{c(){r&&r.c()},m(o,a){r&&r.m(o,a),e=!0},p(o,a){i?i.p&&(!e||8389632&a[0])&&hr(i,n,o,o[23],e?pr(n,o[23],a,h4):mr(o[23]),gf):r&&r.p&&(!e||1088&a[0])&&r.p(o,e?a:[-1,-1])},i(o){e||(k(r,o),e=!0)},o(o){A(r,o),e=!1},d(o){r&&r.d(o)}}}function Sf(t){let e,n;return e=new Vo({props:{$$slots:{default:[b4]},$$scope:{ctx:t}}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};8389632&r[0]&&(o.$$scope={dirty:r,ctx:i}),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function b4(t){let e,n=t[27].icon+"";return{c(){e=Or("g")},m(i,r){tt(i,e,r),e.innerHTML=n},p(i,r){1024&r[0]&&n!==(n=i[27].icon+"")&&(e.innerHTML=n)},d(i){i&&Q(e)}}}function Tf(t){let e,n,i=t[27].label+"";return{c(){e=ft("span"),n=Mi(i),S(e,"class",t[6])},m(r,o){tt(r,e,o),Et(e,n)},p(r,o){1024&o[0]&&i!==(i=r[27].label+"")&&Yi(n,i),64&o[0]&&S(e,"class",r[6])},d(r){r&&Q(e)}}}function v4(t){let e;const n=t[22].option,i=ur(n,t,t[23],$f),r=i||function(o){let a,s,l,c=o[27].icon&&Sf(o),d=!o[27].hideLabel&&Tf(o);return{c(){c&&c.c(),a=pe(),d&&d.c(),s=pe()},m(u,p){c&&c.m(u,p),tt(u,a,p),d&&d.m(u,p),tt(u,s,p),l=!0},p(u,p){u[27].icon?c?(c.p(u,p),1024&p[0]&&k(c,1)):(c=Sf(u),c.c(),k(c,1),c.m(a.parentNode,a)):c&&(Te(),A(c,1,1,()=>{c=null}),Ce()),u[27].hideLabel?d&&(d.d(1),d=null):d?d.p(u,p):(d=Tf(u),d.c(),d.m(s.parentNode,s))},i(u){l||(k(c),l=!0)},o(u){A(c),l=!1},d(u){c&&c.d(u),u&&Q(a),d&&d.d(u),u&&Q(s)}}}(t);return{c(){r&&r.c()},m(o,a){r&&r.m(o,a),e=!0},p(o,a){i?i.p&&(!e||8389632&a[0])&&hr(i,n,o,o[23],e?pr(n,o[23],a,m4):mr(o[23]),$f):r&&r.p&&(!e||1088&a[0])&&r.p(o,e?a:[-1,-1])},i(o){e||(k(r,o),e=!0)},o(o){A(r,o),e=!1},d(o){r&&r.d(o)}}}function Cf(t,e){let n,i,r;return i=new rx({props:{name:e[4],label:e[27].label,id:e[27].id,value:e[27].value,disabled:e[27].disabled,hidden:e[27].hidden,class:e[8],checked:e[12](e[27])===e[0],onkeydown:e[13](e[27]),onclick:e[14](e[27]),$$slots:{default:[v4]},$$scope:{ctx:e}}}),{key:t,first:null,c(){n=Ei(),zt(i.$$.fragment),this.first=n},m(o,a){tt(o,n,a),Ft(i,o,a),r=!0},p(o,a){e=o;const s={};16&a[0]&&(s.name=e[4]),1024&a[0]&&(s.label=e[27].label),1024&a[0]&&(s.id=e[27].id),1024&a[0]&&(s.value=e[27].value),1024&a[0]&&(s.disabled=e[27].disabled),1024&a[0]&&(s.hidden=e[27].hidden),256&a[0]&&(s.class=e[8]),1025&a[0]&&(s.checked=e[12](e[27])===e[0]),1024&a[0]&&(s.onkeydown=e[13](e[27])),1024&a[0]&&(s.onclick=e[14](e[27])),8389696&a[0]&&(s.$$scope={dirty:a,ctx:e}),i.$set(s)},i(o){r||(k(i.$$.fragment,o),r=!0)},o(o){A(i.$$.fragment,o),r=!1},d(o){o&&Q(n),_t(i,o)}}}function Mf(t,e){let n,i,r,o,a;const s=[$4,f4],l=[];function c(d,u){return d[27].options?0:1}return i=c(e),r=l[i]=s[i](e),{key:t,first:null,c(){n=Ei(),r.c(),o=Ei(),this.first=n},m(d,u){tt(d,n,u),l[i].m(d,u),tt(d,o,u),a=!0},p(d,u){let p=i;i=c(e=d),i===p?l[i].p(e,u):(Te(),A(l[p],1,1,()=>{l[p]=null}),Ce(),r=l[i],r?r.p(e,u):(r=l[i]=s[i](e),r.c()),k(r,1),r.m(o.parentNode,o))},i(d){a||(k(r),a=!0)},o(d){A(r),a=!1},d(d){d&&Q(n),l[i].d(d),d&&Q(o)}}}function w4(t){let e,n,i,r=t[11].length&&xf(t);return{c(){r&&r.c(),e=pe(),n=Ei()},m(o,a){r&&r.m(o,a),tt(o,e,a),tt(o,n,a),i=!0},p(o,a){o[11].length?r?(r.p(o,a),2048&a[0]&&k(r,1)):(r=xf(o),r.c(),k(r,1),r.m(e.parentNode,e)):r&&(Te(),A(r,1,1,()=>{r=null}),Ce())},i(o){i||(k(r),k(!1),i=!0)},o(o){A(r),A(!1),i=!1},d(o){r&&r.d(o),o&&Q(e),o&&Q(n)}}}function S4(t,e,n){let i,r,o,{$$slots:a={},$$scope:s}=e;const l=la();let{label:c}=e,{hideLabel:d=!0}=e,{class:u}=e,{name:p="radio-group-"+ba()}=e,{selectedIndex:h=-1}=e,{options:y=[]}=e,{onchange:m}=e,{layout:f}=e,{optionMapper:b}=e,{optionFilter:v}=e,{value:w}=e,{optionLabelClass:T}=e,{title:I}=e,{locale:P}=e,{optionClass:_}=e,{optionGroupClass:C}=e;const F=O=>o.findIndex($=>$.id===O.id),G=(O,$)=>{n(0,h=F(O));const N={index:h,...O};((it,...M)=>{it&&it(...M)})(m,N,$),l("change",N)};return t.$$set=O=>{"label"in O&&n(1,c=O.label),"hideLabel"in O&&n(2,d=O.hideLabel),"class"in O&&n(3,u=O.class),"name"in O&&n(4,p=O.name),"selectedIndex"in O&&n(0,h=O.selectedIndex),"options"in O&&n(15,y=O.options),"onchange"in O&&n(16,m=O.onchange),"layout"in O&&n(5,f=O.layout),"optionMapper"in O&&n(17,b=O.optionMapper),"optionFilter"in O&&n(18,v=O.optionFilter),"value"in O&&n(19,w=O.value),"optionLabelClass"in O&&n(6,T=O.optionLabelClass),"title"in O&&n(7,I=O.title),"locale"in O&&n(20,P=O.locale),"optionClass"in O&&n(8,_=O.optionClass),"optionGroupClass"in O&&n(9,C=O.optionGroupClass),"$$scope"in O&&n(23,s=O.$$scope)},t.$$.update=()=>{1343488&t.$$.dirty[0]&&n(11,i=ax(v?y.filter(v):y,P)),133120&t.$$.dirty[0]&&n(10,r=((O=[],$)=>{let N=0;return O.map(it=>(N++,qi(it)?qi(it[1])?{id:N,label:it[0],options:it[1].map(M=>cu(M,++N,$))}:cu(it,N,$):it.options?{id:it.id||N,label:it.label,options:it.options.map(M=>cu(M,++N,$))}:cu(it,N,$)))})(i,b)),1024&t.$$.dirty[0]&&n(21,o=Wc(r)),2654209&t.$$.dirty[0]&&h<0&&(n(0,h=o.findIndex(O=>sx(O.value,w))),h<0&&n(0,h=(O=>O.findIndex($=>$[0]===void 0))(y)))},[h,c,d,u,p,f,T,I,_,C,r,i,F,O=>$=>{var N;N=$.key,/enter| /i.test(N)&&G(O,$)},O=>$=>{G(O,$)},y,m,b,v,w,P,o,a,s]}class fl extends Tn{constructor(e){super(),Sn(this,e,S4,w4,yn,{label:1,hideLabel:2,class:3,name:4,selectedIndex:0,options:15,onchange:16,layout:5,optionMapper:17,optionFilter:18,value:19,optionLabelClass:6,title:7,locale:20,optionClass:8,optionGroupClass:9},null,[-1,-1])}}function kf(t){let e,n,i,r,o,a,s,l,c,d;return{c(){e=ft("div"),n=ft("button"),i=Mi("▲"),o=pe(),a=ft("button"),s=Mi("▼"),S(n,"type","button"),S(n,"tabindex","-1"),S(n,"aria-label",r="increase "+t[7]),S(a,"type","button"),S(a,"tabindex","-1"),S(a,"aria-label",l="decrease "+t[7]),S(e,"class","PinturaInputSpinners")},m(u,p){tt(u,e,p),Et(e,n),Et(n,i),Et(e,o),Et(e,a),Et(a,s),c||(d=[St(n,"click",t[17]),St(a,"click",t[18])],c=!0)},p(u,p){128&p&&r!==(r="increase "+u[7])&&S(n,"aria-label",r),128&p&&l!==(l="decrease "+u[7])&&S(a,"aria-label",l)},d(u){u&&Q(e),c=!1,Zn(d)}}}function T4(t){let e,n,i,r,o,a,s=t[1]==="number"&&t[9]&&kf(t);return{c(){e=ft("div"),n=ft("input"),r=pe(),s&&s.c(),S(n,"class","PinturaInputField"),S(n,"title",t[7]),S(n,"type",t[1]),S(n,"min",t[4]),S(n,"max",t[5]),S(n,"step",t[6]),S(n,"inputmode",t[3]),n.value=i=t[14]?t[13]:t[0],S(n,"style",t[11]),S(n,"placeholder",t[8]),S(n,"maxlength",t[12]),n.disabled=t[2],S(n,"spellcheck","false"),S(n,"autocorrect","off"),S(n,"autocapitalize","off"),S(e,"class","PinturaInput")},m(l,c){tt(l,e,c),Et(e,n),t[27](n),Et(e,r),s&&s.m(e,null),o||(a=[St(n,"input",t[16]),St(n,"blur",function(){Hn(t[14]&&t[15])&&(t[14]&&t[15]).apply(this,arguments)}),St(n,"keydown",t[19]),St(n,"keyup",t[20])],o=!0)},p(l,[c]){t=l,128&c&&S(n,"title",t[7]),2&c&&S(n,"type",t[1]),16&c&&S(n,"min",t[4]),32&c&&S(n,"max",t[5]),64&c&&S(n,"step",t[6]),8&c&&S(n,"inputmode",t[3]),24577&c&&i!==(i=t[14]?t[13]:t[0])&&n.value!==i&&(n.value=i),2048&c&&S(n,"style",t[11]),256&c&&S(n,"placeholder",t[8]),4096&c&&S(n,"maxlength",t[12]),4&c&&(n.disabled=t[2]),t[1]==="number"&&t[9]?s?s.p(t,c):(s=kf(t),s.c(),s.m(e,null)):s&&(s.d(1),s=null)},i:tn,o:tn,d(l){l&&Q(e),t[27](null),s&&s.d(),o=!1,Zn(a)}}}function C4(t,e,n){let i,r,o,a,s,l,c,{value:d}=e,{type:u="text"}=e,{disabled:p=!1}=e,{inputmode:h}=e,{min:y}=e,{max:m}=e,{step:f}=e,{onchange:b=ae}=e,{onkeydown:v=ae}=e,{title:w}=e,{stepMultiplier:T=10}=e,{placeholder:I}=e,{enableSpinButtons:P=!0}=e,{enableStopPropagation:_=!1}=e;const C=()=>{let $=l.value;return u==="number"&&($=h==="numeric"?parseInt($,10):parseFloat($),!dn($)||Number.isNaN($)?$=y||0:i&&($=oi($,y,m))),$};let F=d;const G=()=>{const $=oi(C()+(c?f*T:f),y,m);$!==d&&(n(25,F=$),n(0,d=$),b(d))},O=()=>{const $=oi(C()-(c?f*T:f),y,m);$!==d&&(n(25,F=$),n(0,d=$),b(d))};return t.$$set=$=>{"value"in $&&n(0,d=$.value),"type"in $&&n(1,u=$.type),"disabled"in $&&n(2,p=$.disabled),"inputmode"in $&&n(3,h=$.inputmode),"min"in $&&n(4,y=$.min),"max"in $&&n(5,m=$.max),"step"in $&&n(6,f=$.step),"onchange"in $&&n(21,b=$.onchange),"onkeydown"in $&&n(22,v=$.onkeydown),"title"in $&&n(7,w=$.title),"stepMultiplier"in $&&n(23,T=$.stepMultiplier),"placeholder"in $&&n(8,I=$.placeholder),"enableSpinButtons"in $&&n(9,P=$.enableSpinButtons),"enableStopPropagation"in $&&n(24,_=$.enableStopPropagation)},t.$$.update=()=>{48&t.$$.dirty&&n(14,i=dn(y)&&dn(m)),33555457&t.$$.dirty&&n(13,r=l===document.activeElement?F:d),32&t.$$.dirty&&n(26,o=m?(m+"").length:void 0),67108872&t.$$.dirty&&n(12,a=h==="numeric"&&o?o:void 0),67108864&t.$$.dirty&&n(11,s=o?`min-width:${o}em`:void 0)},[d,u,p,h,y,m,f,w,I,P,l,s,a,r,i,()=>{n(25,F=C()),b(d)},()=>{n(25,F=l.value),b(C())},G,O,$=>{c=$.shiftKey,v($);const{key:N}=$;_&&$.stopPropagation(),/up|down/i.test(N)&&(/up/i.test(N)&&G(),/down/i.test(N)&&O(),$.preventDefault(),$.stopPropagation())},$=>{const{key:N}=$;/up|down/i.test(N)&&($.preventDefault(),$.stopPropagation())},b,v,T,_,F,o,function($){Nn[$?"unshift":"push"](()=>{l=$,n(10,l)})}]}class lx extends Tn{constructor(e){super(),Sn(this,e,C4,T4,yn,{value:0,type:1,disabled:2,inputmode:3,min:4,max:5,step:6,onchange:21,onkeydown:22,title:7,stepMultiplier:23,placeholder:8,enableSpinButtons:9,enableStopPropagation:24})}}const M4=t=>({}),Ef=t=>({});function k4(t){let e,n,i,r,o=(t[2]||t[21])+"",a=t[6]&&Pf(t);return{c(){a&&a.c(),e=pe(),n=ft("span"),S(n,"class",i=rn(["PinturaButtonLabel",t[3],t[5]&&"implicit"]))},m(s,l){a&&a.m(s,l),tt(s,e,l),tt(s,n,l),n.innerHTML=o,r=!0},p(s,l){s[6]?a?(a.p(s,l),64&l[0]&&k(a,1)):(a=Pf(s),a.c(),k(a,1),a.m(e.parentNode,e)):a&&(Te(),A(a,1,1,()=>{a=null}),Ce()),(!r||2097156&l[0])&&o!==(o=(s[2]||s[21])+"")&&(n.innerHTML=o),(!r||40&l[0]&&i!==(i=rn(["PinturaButtonLabel",s[3],s[5]&&"implicit"])))&&S(n,"class",i)},i(s){r||(k(a),r=!0)},o(s){A(a),r=!1},d(s){a&&a.d(s),s&&Q(e),s&&Q(n)}}}function E4(t){let e,n;return e=new lx({props:{value:t[10],onchange:t[17],enableStopPropagation:!0,type:"number",inputmode:"numeric",min:t[8].reduce(Lf,1/0),max:t[8].reduce(Of,-1/0),enableSpinButtons:!1}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};1024&r[0]&&(o.value=i[10]),131072&r[0]&&(o.onchange=i[17]),256&r[0]&&(o.min=i[8].reduce(Lf,1/0)),256&r[0]&&(o.max=i[8].reduce(Of,-1/0)),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function Pf(t){let e,n;return e=new Vo({props:{class:"PinturaButtonIcon",$$slots:{default:[P4]},$$scope:{ctx:t}}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};536870976&r[0]&&(o.$$scope={dirty:r,ctx:i}),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function P4(t){let e;return{c(){e=Or("g")},m(n,i){tt(n,e,i),e.innerHTML=t[6]},p(n,i){64&i[0]&&(e.innerHTML=n[6])},d(n){n&&Q(e)}}}function I4(t){let e,n,i,r,o,a;const s=[E4,k4],l=[];function c(d,u){return d[18]?0:1}return n=c(t),i=l[n]=s[n](t),{c(){e=ft("span"),i.c(),S(e,"slot","label"),S(e,"title",r=cr(t[1],t[16])),S(e,"class",o=rn(["PinturaButtonInner",t[18]&&"PinturaComboBox",t[4]]))},m(d,u){tt(d,e,u),l[n].m(e,null),a=!0},p(d,u){let p=n;n=c(d),n===p?l[n].p(d,u):(Te(),A(l[p],1,1,()=>{l[p]=null}),Ce(),i=l[n],i?i.p(d,u):(i=l[n]=s[n](d),i.c()),k(i,1),i.m(e,null)),(!a||65538&u[0]&&r!==(r=cr(d[1],d[16])))&&S(e,"title",r),(!a||262160&u[0]&&o!==(o=rn(["PinturaButtonInner",d[18]&&"PinturaComboBox",d[4]])))&&S(e,"class",o)},i(d){a||(k(i),a=!0)},o(d){A(i),a=!1},d(d){d&&Q(e),l[n].d()}}}function R4(t){let e,n,i=t[31].label+"";return{c(){e=ft("span"),n=Mi(i),S(e,"slot","group")},m(r,o){tt(r,e,o),Et(e,n)},p(r,o){1&o[1]&&i!==(i=r[31].label+"")&&Yi(n,i)},d(r){r&&Q(e)}}}function If(t){let e,n;return e=new Vo({props:{style:Si(t[14])?t[14](t[31].value):t[14],$$slots:{default:[A4]},$$scope:{ctx:t}}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};16384&r[0]|1&r[1]&&(o.style=Si(i[14])?i[14](i[31].value):i[14]),536870912&r[0]|1&r[1]&&(o.$$scope={dirty:r,ctx:i}),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function A4(t){let e,n=t[31].icon+"";return{c(){e=Or("g")},m(i,r){tt(i,e,r),e.innerHTML=n},p(i,r){1&r[1]&&n!==(n=i[31].icon+"")&&(e.innerHTML=n)},d(i){i&&Q(e)}}}function Rf(t){let e,n,i,r,o,a=t[31].label+"",s=t[31].sublabel&&Af(t);return{c(){e=ft("span"),n=new w2(!1),i=pe(),s&&s.c(),n.a=i,S(e,"style",r=Si(t[15])?t[15](t[31].value):t[15]),S(e,"class",o=rn(["PinturaDropdownOptionLabel",t[11]]))},m(l,c){tt(l,e,c),n.m(a,e),Et(e,i),s&&s.m(e,null)},p(l,c){1&c[1]&&a!==(a=l[31].label+"")&&n.p(a),l[31].sublabel?s?s.p(l,c):(s=Af(l),s.c(),s.m(e,null)):s&&(s.d(1),s=null),32768&c[0]|1&c[1]&&r!==(r=Si(l[15])?l[15](l[31].value):l[15])&&S(e,"style",r),2048&c[0]&&o!==(o=rn(["PinturaDropdownOptionLabel",l[11]]))&&S(e,"class",o)},d(l){l&&Q(e),s&&s.d()}}}function Af(t){let e,n=t[31].sublabel+"";return{c(){e=ft("span"),S(e,"class","PinturaDropdownOptionSublabel")},m(i,r){tt(i,e,r),e.innerHTML=n},p(i,r){1&r[1]&&n!==(n=i[31].sublabel+"")&&(e.innerHTML=n)},d(i){i&&Q(e)}}}function L4(t){let e,n,i,r=t[31].icon&&If(t),o=!t[31].hideLabel&&Rf(t);return{c(){e=ft("span"),r&&r.c(),n=pe(),o&&o.c(),S(e,"slot","option")},m(a,s){tt(a,e,s),r&&r.m(e,null),Et(e,n),o&&o.m(e,null),i=!0},p(a,s){a[31].icon?r?(r.p(a,s),1&s[1]&&k(r,1)):(r=If(a),r.c(),k(r,1),r.m(e,n)):r&&(Te(),A(r,1,1,()=>{r=null}),Ce()),a[31].hideLabel?o&&(o.d(1),o=null):o?o.p(a,s):(o=Rf(a),o.c(),o.m(e,null))},i(a){i||(k(r),i=!0)},o(a){A(r),i=!1},d(a){a&&Q(e),r&&r.d(),o&&o.d()}}}function O4(t){let e,n,i,r,o,a;const s=t[27].controls,l=ur(s,t,t[29],Ef);return i=new fl({props:{class:"PinturaOptionsList PinturaScrollableContent",name:t[7],value:t[10],selectedIndex:t[9],optionFilter:t[12],optionMapper:t[13],optionLabelClass:rn(["PinturaDropdownOptionLabel",t[11]]),optionGroupClass:"PinturaListOptionGroup",optionClass:"PinturaListOption",options:t[19],onchange:t[22],$$slots:{option:[L4,({option:c})=>({31:c}),({option:c})=>[0,c?1:0]],group:[R4,({option:c})=>({31:c}),({option:c})=>[0,c?1:0]]},$$scope:{ctx:t}}}),{c(){e=ft("div"),l&&l.c(),n=pe(),zt(i.$$.fragment),S(e,"slot","details"),S(e,"class","PinturaOptionsListWrapper")},m(c,d){tt(c,e,d),l&&l.m(e,null),Et(e,n),Ft(i,e,null),r=!0,o||(a=St(e,"keydown",t[24]),o=!0)},p(c,d){l&&l.p&&(!r||536870912&d[0])&&hr(l,s,c,c[29],r?pr(s,c[29],d,M4):mr(c[29]),Ef);const u={};128&d[0]&&(u.name=c[7]),1024&d[0]&&(u.value=c[10]),512&d[0]&&(u.selectedIndex=c[9]),4096&d[0]&&(u.optionFilter=c[12]),8192&d[0]&&(u.optionMapper=c[13]),2048&d[0]&&(u.optionLabelClass=rn(["PinturaDropdownOptionLabel",c[11]])),524288&d[0]&&(u.options=c[19]),536922112&d[0]|1&d[1]&&(u.$$scope={dirty:d,ctx:c}),i.$set(u)},i(c){r||(k(l,c),k(i.$$.fragment,c),r=!0)},o(c){A(l,c),A(i.$$.fragment,c),r=!1},d(c){c&&Q(e),l&&l.d(c),_t(i),o=!1,a()}}}function F4(t){let e,n,i;function r(a){t[28](a)}let o={onshow:t[23],buttonClass:rn(["PinturaDropdownButton",t[0],t[5]&&"PinturaDropdownIconOnly"]),$$slots:{details:[O4],label:[I4]},$$scope:{ctx:t}};return t[20]!==void 0&&(o.isActive=t[20]),e=new e1({props:o}),Nn.push(()=>Ro(e,"isActive",r)),{c(){zt(e.$$.fragment)},m(a,s){Ft(e,a,s),i=!0},p(a,s){const l={};33&s[0]&&(l.buttonClass=rn(["PinturaDropdownButton",a[0],a[5]&&"PinturaDropdownIconOnly"])),540016638&s[0]&&(l.$$scope={dirty:s,ctx:a}),!n&&1048576&s[0]&&(n=!0,l.isActive=a[20],Wo(()=>n=!1)),e.$set(l)},i(a){i||(k(e.$$.fragment,a),i=!0)},o(a){A(e.$$.fragment,a),i=!1},d(a){_t(e,a)}}}const Lf=(t,[e])=>e<t?e:t,Of=(t,[e])=>e>t?e:t;function _4(t,e,n){let i,r,{$$slots:o={},$$scope:a}=e,{class:s}=e,{title:l}=e,{label:c}=e,{labelClass:d}=e,{innerClass:u}=e,{hideLabel:p=!1}=e,{icon:h}=e,{name:y}=e,{options:m=[]}=e,{selectedIndex:f=-1}=e,{value:b}=e,{optionLabelClass:v}=e,{optionFilter:w}=e,{optionMapper:T}=e,{optionIconStyle:I}=e,{optionLabelStyle:P}=e,{locale:_}=e,{onchange:C=ae}=e,{onload:F=ae}=e,{ondestroy:G=ae}=e,{enableInput:O=!1}=e,$;return ds(()=>F({options:m})),Ho(()=>G({options:m})),t.$$set=N=>{"class"in N&&n(0,s=N.class),"title"in N&&n(1,l=N.title),"label"in N&&n(2,c=N.label),"labelClass"in N&&n(3,d=N.labelClass),"innerClass"in N&&n(4,u=N.innerClass),"hideLabel"in N&&n(5,p=N.hideLabel),"icon"in N&&n(6,h=N.icon),"name"in N&&n(7,y=N.name),"options"in N&&n(8,m=N.options),"selectedIndex"in N&&n(9,f=N.selectedIndex),"value"in N&&n(10,b=N.value),"optionLabelClass"in N&&n(11,v=N.optionLabelClass),"optionFilter"in N&&n(12,w=N.optionFilter),"optionMapper"in N&&n(13,T=N.optionMapper),"optionIconStyle"in N&&n(14,I=N.optionIconStyle),"optionLabelStyle"in N&&n(15,P=N.optionLabelStyle),"locale"in N&&n(16,_=N.locale),"onchange"in N&&n(17,C=N.onchange),"onload"in N&&n(25,F=N.onload),"ondestroy"in N&&n(26,G=N.ondestroy),"enableInput"in N&&n(18,O=N.enableInput),"$$scope"in N&&n(29,a=N.$$scope)},t.$$.update=()=>{65792&t.$$.dirty[0]&&n(19,i=_?ax(m,_):m),525312&t.$$.dirty[0]&&n(21,r=i.reduce((N,it)=>{if(N)return N;const M=Array.isArray(it)?it:[it,it],[W,ot]=M;return sx(W,b)?ot:void 0},void 0)||(N=>{const it=N.find(M=>M[0]===void 0);if(it)return it[1]})(i)||b)},[s,l,c,d,u,p,h,y,m,f,b,v,w,T,I,P,_,C,O,i,$,r,N=>{n(21,r=N.value),C(N),n(20,$=!1)},({e:N,panel:it})=>{if(N&&N.key&&/up|down/i.test(N.key))return Eh(it.querySelector("input:not([disabled])"));Eh(it.querySelector("fieldset"))},N=>{/tab/i.test(N.key)&&N.preventDefault()},F,G,o,function(N){$=N,n(20,$)},a]}class x0 extends Tn{constructor(e){super(),Sn(this,e,_4,F4,yn,{class:0,title:1,label:2,labelClass:3,innerClass:4,hideLabel:5,icon:6,name:7,options:8,selectedIndex:9,value:10,optionLabelClass:11,optionFilter:12,optionMapper:13,optionIconStyle:14,optionLabelStyle:15,locale:16,onchange:17,onload:25,ondestroy:26,enableInput:18},null,[-1,-1])}}function D4(t){let e;return{c(){e=ft("div"),S(e,"slot","details")},m(n,i){tt(n,e,i),t[14](e)},p:tn,d(n){n&&Q(e),t[14](null)}}}function z4(t){let e,n,i;function r(a){t[15](a)}let o={buttonLabel:t[0],buttonClass:t[1],buttonIcon:t[2],buttonHideLabel:t[3],buttonTitle:t[4],buttonLabelClass:t[5],onshow:t[6],onhide:t[7],$$slots:{details:[D4]},$$scope:{ctx:t}};return t[9]!==void 0&&(o.isActive=t[9]),e=new e1({props:o}),Nn.push(()=>Ro(e,"isActive",r)),{c(){zt(e.$$.fragment)},m(a,s){Ft(e,a,s),i=!0},p(a,[s]){const l={};1&s&&(l.buttonLabel=a[0]),2&s&&(l.buttonClass=a[1]),4&s&&(l.buttonIcon=a[2]),8&s&&(l.buttonHideLabel=a[3]),16&s&&(l.buttonTitle=a[4]),32&s&&(l.buttonLabelClass=a[5]),64&s&&(l.onshow=a[6]),128&s&&(l.onhide=a[7]),65792&s&&(l.$$scope={dirty:s,ctx:a}),!n&&512&s&&(n=!0,l.isActive=a[9],Wo(()=>n=!1)),e.$set(l)},i(a){i||(k(e.$$.fragment,a),i=!0)},o(a){A(e.$$.fragment,a),i=!1},d(a){_t(e,a)}}}function B4(t,e,n){let{buttonLabel:i}=e,{buttonClass:r}=e,{buttonIcon:o}=e,{buttonHideLabel:a}=e,{buttonTitle:s}=e,{buttonLabelClass:l}=e,{root:c}=e,{ondestroy:d=ae}=e,{onshow:u=ae}=e,{onhide:p=ae}=e,h,y=!1;return Ho(d),t.$$set=m=>{"buttonLabel"in m&&n(0,i=m.buttonLabel),"buttonClass"in m&&n(1,r=m.buttonClass),"buttonIcon"in m&&n(2,o=m.buttonIcon),"buttonHideLabel"in m&&n(3,a=m.buttonHideLabel),"buttonTitle"in m&&n(4,s=m.buttonTitle),"buttonLabelClass"in m&&n(5,l=m.buttonLabelClass),"root"in m&&n(10,c=m.root),"ondestroy"in m&&n(11,d=m.ondestroy),"onshow"in m&&n(6,u=m.onshow),"onhide"in m&&n(7,p=m.onhide)},t.$$.update=()=>{1280&t.$$.dirty&&h&&c&&h.firstChild!==c&&(h.hasChildNodes()?h.replaceChild(c,h.firstChild):h.append(c))},[i,r,o,a,s,l,u,p,h,y,c,d,()=>n(9,y=!1),()=>n(9,y=!0),function(m){Nn[m?"unshift":"push"](()=>{h=m,n(8,h)})},function(m){y=m,n(9,y)}]}class N4 extends Tn{constructor(e){super(),Sn(this,e,B4,z4,yn,{buttonLabel:0,buttonClass:1,buttonIcon:2,buttonHideLabel:3,buttonTitle:4,buttonLabelClass:5,root:10,ondestroy:11,onshow:6,onhide:7,hide:12,show:13})}get hide(){return this.$$.ctx[12]}get show(){return this.$$.ctx[13]}}var Fc=(t,e,n)=>(t-e)/(n-e);const W4=t=>({}),Ff=t=>({});function _f(t){let e,n,i,r,o,a,s,l;return n=new Vo({props:{$$slots:{default:[V4]},$$scope:{ctx:t}}}),o=new Vo({props:{$$slots:{default:[H4]},$$scope:{ctx:t}}}),{c(){e=ft("button"),zt(n.$$.fragment),i=pe(),r=ft("button"),zt(o.$$.fragment),S(e,"type","button"),S(e,"aria-label","Increase"),S(r,"type","button"),S(r,"aria-label","Decrease")},m(c,d){tt(c,e,d),Ft(n,e,null),tt(c,i,d),tt(c,r,d),Ft(o,r,null),a=!0,s||(l=[St(e,"pointerdown",t[20](1)),St(r,"pointerdown",t[20](-1))],s=!0)},p(c,d){const u={};128&d[1]&&(u.$$scope={dirty:d,ctx:c}),n.$set(u);const p={};128&d[1]&&(p.$$scope={dirty:d,ctx:c}),o.$set(p)},i(c){a||(k(n.$$.fragment,c),k(o.$$.fragment,c),a=!0)},o(c){A(n.$$.fragment,c),A(o.$$.fragment,c),a=!1},d(c){c&&Q(e),_t(n),c&&Q(i),c&&Q(r),_t(o),s=!1,Zn(l)}}}function V4(t){let e;return{c(){e=Or("path"),S(e,"d","M8 12 h8 M12 8 v8")},m(n,i){tt(n,e,i)},p:tn,d(n){n&&Q(e)}}}function H4(t){let e;return{c(){e=Or("path"),S(e,"d","M9 12 h6")},m(n,i){tt(n,e,i)},p:tn,d(n){n&&Q(e)}}}function U4(t){let e,n,i,r,o,a,s,l,c,d,u,p,h,y,m,f,b;const v=t[36].default,w=ur(v,t,t[38],null),T=t[36].knob,I=ur(T,t,t[38],Ff);let P=t[9]&&_f(t);return{c(){e=ft("div"),n=ft("div"),i=ft("input"),o=pe(),a=ft("div"),w&&w.c(),l=pe(),c=ft("div"),d=ft("div"),I&&I.c(),h=pe(),P&&P.c(),S(i,"type","range"),S(i,"id",t[3]),S(i,"min",t[0]),S(i,"max",t[1]),S(i,"step",t[2]),i.value=t[14],S(i,"style",r=t[10]?"pointer-events:none":""),S(a,"class",s=rn(["PinturaSliderTrack",t[5]])),S(a,"style",t[4]),S(d,"class",u=rn(["PinturaSliderKnob",t[7]])),S(d,"style",t[6]),S(c,"class","PinturaSliderKnobController"),S(c,"style",t[17]),S(n,"class","PinturaSliderControl"),S(n,"style",p="--slider-position:"+Math.round(t[15])),S(e,"class",y=rn(["PinturaSlider",t[12]])),S(e,"data-direction",t[8])},m(_,C){tt(_,e,C),Et(e,n),Et(n,i),t[37](i),Et(n,o),Et(n,a),w&&w.m(a,null),Et(n,l),Et(n,c),Et(c,d),I&&I.m(d,null),Et(e,h),P&&P.m(e,null),m=!0,f||(b=[St(i,"input",t[18]),St(i,"nudge",t[19]),qn(Bs.call(null,i)),St(n,"pointerdown",function(){Hn(t[11]&&t[13])&&(t[11]&&t[13]).apply(this,arguments)})],f=!0)},p(_,C){t=_,(!m||8&C[0])&&S(i,"id",t[3]),(!m||1&C[0])&&S(i,"min",t[0]),(!m||2&C[0])&&S(i,"max",t[1]),(!m||4&C[0])&&S(i,"step",t[2]),(!m||16384&C[0])&&(i.value=t[14]),(!m||1024&C[0]&&r!==(r=t[10]?"pointer-events:none":""))&&S(i,"style",r),w&&w.p&&(!m||128&C[1])&&hr(w,v,t,t[38],m?pr(v,t[38],C,null):mr(t[38]),null),(!m||32&C[0]&&s!==(s=rn(["PinturaSliderTrack",t[5]])))&&S(a,"class",s),(!m||16&C[0])&&S(a,"style",t[4]),I&&I.p&&(!m||128&C[1])&&hr(I,T,t,t[38],m?pr(T,t[38],C,W4):mr(t[38]),Ff),(!m||128&C[0]&&u!==(u=rn(["PinturaSliderKnob",t[7]])))&&S(d,"class",u),(!m||64&C[0])&&S(d,"style",t[6]),(!m||131072&C[0])&&S(c,"style",t[17]),(!m||32768&C[0]&&p!==(p="--slider-position:"+Math.round(t[15])))&&S(n,"style",p),t[9]?P?(P.p(t,C),512&C[0]&&k(P,1)):(P=_f(t),P.c(),k(P,1),P.m(e,null)):P&&(Te(),A(P,1,1,()=>{P=null}),Ce()),(!m||4096&C[0]&&y!==(y=rn(["PinturaSlider",t[12]])))&&S(e,"class",y),(!m||256&C[0])&&S(e,"data-direction",t[8])},i(_){m||(k(w,_),k(I,_),k(P),m=!0)},o(_){A(w,_),A(I,_),A(P),m=!1},d(_){_&&Q(e),t[37](null),w&&w.d(_),I&&I.d(_),P&&P.d(),f=!1,Zn(b)}}}function G4(t,e,n){let i,r,o,a,s,l,c,d,u,p,h,y,m,f,b,{$$slots:v={},$$scope:w}=e,{min:T=0}=e,{max:I=100}=e,{step:P=1}=e,{id:_}=e,{value:C=0}=e,{valueMin:F}=e,{valueMax:G}=e,{trackStyle:O}=e,{trackClass:$}=e,{knobStyle:N}=e,{knobClass:it}=e,{ongrab:M=ae}=e,{onchange:W=ae}=e,{onrelease:ot=ae}=e,{onexceed:at=ae}=e,{direction:q="x"}=e,{getValue:ct=ni}=e,{setValue:V=ni}=e,{enableSpinButtons:ut=!0}=e,{enableForceUseKnob:bt=!1}=e,{enableStopPropagation:K=!0}=e,{enablePointerdownListener:vt=!0}=e,{maxInteractionDistance:X=6}=e,{class:Z}=e;const mt=nt=>V(((Ut,qt)=>(qt=1/qt,Math.round(Ut*qt)/qt))(oi(nt,T,I),P),C),Bt=(nt,Ut,qt={})=>{const{grabbed:Dt=!1,released:ve=!1}=qt,It=mt(T+nt/Ut*r),Ie=F||T,lt=G||I;n(21,C=Qe(It)?It:oi(It,Ie,lt)),b!==It&&(b=It,!Qe(It)&&(It<Ie||It>lt)&&at(C,It),C!==f&&(f=C,Dt&&M(C),W(C),ve&&ot(C)))};let st,gt;const Jt=nt=>{const Ut=nt[d]-m;Bt(y+Ut,h)},le=nt=>{gt=setTimeout(()=>{h=void 0},50),document.documentElement.removeEventListener("pointermove",Jt),document.documentElement.removeEventListener("pointerup",le),W(C),ot(C)},rt=()=>{n(21,C=mt(i+Nt*P)),W(C)};let kt,Nt=1,$t=!1;const Be=nt=>{clearTimeout(kt),$t||rt(),ot(C),document.removeEventListener("pointerup",Be)};return t.$$set=nt=>{"min"in nt&&n(0,T=nt.min),"max"in nt&&n(1,I=nt.max),"step"in nt&&n(2,P=nt.step),"id"in nt&&n(3,_=nt.id),"value"in nt&&n(21,C=nt.value),"valueMin"in nt&&n(22,F=nt.valueMin),"valueMax"in nt&&n(23,G=nt.valueMax),"trackStyle"in nt&&n(4,O=nt.trackStyle),"trackClass"in nt&&n(5,$=nt.trackClass),"knobStyle"in nt&&n(6,N=nt.knobStyle),"knobClass"in nt&&n(7,it=nt.knobClass),"ongrab"in nt&&n(24,M=nt.ongrab),"onchange"in nt&&n(25,W=nt.onchange),"onrelease"in nt&&n(26,ot=nt.onrelease),"onexceed"in nt&&n(27,at=nt.onexceed),"direction"in nt&&n(8,q=nt.direction),"getValue"in nt&&n(28,ct=nt.getValue),"setValue"in nt&&n(29,V=nt.setValue),"enableSpinButtons"in nt&&n(9,ut=nt.enableSpinButtons),"enableForceUseKnob"in nt&&n(10,bt=nt.enableForceUseKnob),"enableStopPropagation"in nt&&n(30,K=nt.enableStopPropagation),"enablePointerdownListener"in nt&&n(11,vt=nt.enablePointerdownListener),"maxInteractionDistance"in nt&&n(31,X=nt.maxInteractionDistance),"class"in nt&&n(12,Z=nt.class),"$$scope"in nt&&n(38,w=nt.$$scope)},t.$$.update=()=>{270532608&t.$$.dirty[0]&&n(14,i=C!==void 0?ct(C):0),3&t.$$.dirty[0]&&(r=I-T),16387&t.$$.dirty[0]&&n(33,o=Fc(i,T,I)),4&t.$$.dirty[1]&&n(15,a=100*o),256&t.$$.dirty[0]&&n(34,s=q.toUpperCase()),256&t.$$.dirty[0]&&n(35,l=q==="x"?"Width":"Height"),16&t.$$.dirty[1]&&(c="offset"+l),t.$$.dirty[1],8&t.$$.dirty[1]&&(d="page"+s),32768&t.$$.dirty[0]|8&t.$$.dirty[1]&&n(17,u=`transform: translate${s}(${a}%)`)},[T,I,P,_,O,$,N,it,q,ut,bt,vt,Z,nt=>{clearTimeout(gt);let Ut=!1;K&&nt.stopPropagation(),clearTimeout(st);const qt=p.getBoundingClientRect();if(h=p[c],m=nt[d],y=m-qt[q],bt){if(Math.abs(y-o*h)>X)return;Ut=!0,nt.stopPropagation()}return document.activeElement!==p&&p.focus(),Bt(y,h,{grabbed:!0}),document.documentElement.addEventListener("pointermove",Jt),document.documentElement.addEventListener("pointerup",le),Ut},i,a,p,u,nt=>{h||(n(21,C=V(parseFloat(nt.target.value))),C!==f&&(f=C,W(C)))},nt=>{const Ut=p[c];Bt(i/r*Ut+nt.detail[q],Ut),clearTimeout(st),st=setTimeout(()=>{ot(C)},250)},nt=>Ut=>{clearTimeout(st),Nt=nt,$t=!1,kt=setInterval(()=>{$t=!0,rt()},100),document.addEventListener("pointercancel",Be),document.addEventListener("pointerup",Be)},C,F,G,M,W,ot,at,ct,V,K,X,nt=>{const Ut=p.getBoundingClientRect(),qt=nt[d]-Ut[q],Dt=p[c];return Math.abs(qt-o*Dt)},o,s,l,v,function(nt){Nn[nt?"unshift":"push"](()=>{p=nt,n(16,p)})},w]}class b0 extends Tn{constructor(e){super(),Sn(this,e,G4,U4,yn,{min:0,max:1,step:2,id:3,value:21,valueMin:22,valueMax:23,trackStyle:4,trackClass:5,knobStyle:6,knobClass:7,ongrab:24,onchange:25,onrelease:26,onexceed:27,direction:8,getValue:28,setValue:29,enableSpinButtons:9,enableForceUseKnob:10,enableStopPropagation:30,enablePointerdownListener:11,maxInteractionDistance:31,class:12,eventDistanceToKnob:32,handlePointerDown:13},null,[-1,-1])}get eventDistanceToKnob(){return this.$$.ctx[32]}get handlePointerDown(){return this.$$.ctx[13]}}function Df(t){let e,n;return e=new Vo({props:{class:"PinturaButtonIcon",$$slots:{default:[j4]},$$scope:{ctx:t}}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};1048580&r&&(o.$$scope={dirty:r,ctx:i}),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function j4(t){let e;return{c(){e=Or("g")},m(n,i){tt(n,e,i),e.innerHTML=t[2]},p(n,i){4&i&&(e.innerHTML=n[2])},d(n){n&&Q(e)}}}function zf(t){let e,n,i=cr(t[8],t[6])+"";return{c(){e=ft("span"),n=Mi(i),S(e,"class","PinturaButtonLabelPrefix")},m(r,o){tt(r,e,o),Et(e,n)},p(r,o){320&o&&i!==(i=cr(r[8],r[6])+"")&&Yi(n,i)},d(r){r&&Q(e)}}}function Z4(t){let e,n,i,r,o,a,s,l,c,d=t[2]&&Df(t),u=t[8]&&zf(t);return{c(){e=ft("span"),d&&d.c(),n=pe(),u&&u.c(),i=pe(),r=ft("span"),o=Mi(t[9]),S(r,"class",a=rn(["PinturaButtonLabel",t[3],t[5]&&"implicit"])),S(e,"slot","label"),S(e,"title",s=cr(t[1],t[6])),S(e,"class",l=rn(["PinturaButtonInner",t[4]]))},m(p,h){tt(p,e,h),d&&d.m(e,null),Et(e,n),u&&u.m(e,null),Et(e,i),Et(e,r),Et(r,o),c=!0},p(p,h){p[2]?d?(d.p(p,h),4&h&&k(d,1)):(d=Df(p),d.c(),k(d,1),d.m(e,n)):d&&(Te(),A(d,1,1,()=>{d=null}),Ce()),p[8]?u?u.p(p,h):(u=zf(p),u.c(),u.m(e,i)):u&&(u.d(1),u=null),(!c||512&h)&&Yi(o,p[9]),(!c||40&h&&a!==(a=rn(["PinturaButtonLabel",p[3],p[5]&&"implicit"])))&&S(r,"class",a),(!c||66&h&&s!==(s=cr(p[1],p[6])))&&S(e,"title",s),(!c||16&h&&l!==(l=rn(["PinturaButtonInner",p[4]])))&&S(e,"class",l)},i(p){c||(k(d),c=!0)},o(p){A(d),c=!1},d(p){p&&Q(e),d&&d.d(),u&&u.d()}}}function X4(t){let e,n,i,r,o;const a=[t[12],{value:t[7]},{onchange:t[11]}];let s={};for(let l=0;l<a.length;l+=1)s=ki(s,a[l]);return n=new b0({props:s}),{c(){e=ft("div"),zt(n.$$.fragment),S(e,"slot","details")},m(l,c){tt(l,e,c),Ft(n,e,null),i=!0,r||(o=St(e,"keydown",t[10]),r=!0)},p(l,c){const d=6272&c?Tr(a,[4096&c&&_r(l[12]),128&c&&{value:l[7]},2048&c&&{onchange:l[11]}]):{};n.$set(d)},i(l){i||(k(n.$$.fragment,l),i=!0)},o(l){A(n.$$.fragment,l),i=!1},d(l){l&&Q(e),_t(n),r=!1,o()}}}function q4(t){let e,n;return e=new e1({props:{panelClass:"PinturaSliderPanel",buttonClass:rn(["PinturaSliderButton",t[0],t[5]&&"PinturaSliderIconOnly"]),$$slots:{details:[X4],label:[Z4]},$$scope:{ctx:t}}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,[r]){const o={};33&r&&(o.buttonClass=rn(["PinturaSliderButton",i[0],i[5]&&"PinturaSliderIconOnly"])),1053694&r&&(o.$$scope={dirty:r,ctx:i}),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function Y4(t,e,n){const i=["class","title","label","icon","labelClass","innerClass","hideLabel","locale","value","onchange","labelPrefix"];let r=yg(e,i),{class:o}=e,{title:a}=e,{label:s=Math.round}=e,{icon:l}=e,{labelClass:c}=e,{innerClass:d}=e,{hideLabel:u=!1}=e,{locale:p}=e,{value:h}=e,{onchange:y=ae}=e,{labelPrefix:m}=e;const{min:f,max:b,getValue:v=ni}=r;let w;const T=I=>n(9,w=(P=>Si(s)?s(v(P),f,b,P):s)(I));return t.$$set=I=>{e=ki(ki({},e),Xc(I)),n(12,r=yg(e,i)),"class"in I&&n(0,o=I.class),"title"in I&&n(1,a=I.title),"label"in I&&n(13,s=I.label),"icon"in I&&n(2,l=I.icon),"labelClass"in I&&n(3,c=I.labelClass),"innerClass"in I&&n(4,d=I.innerClass),"hideLabel"in I&&n(5,u=I.hideLabel),"locale"in I&&n(6,p=I.locale),"value"in I&&n(7,h=I.value),"onchange"in I&&n(14,y=I.onchange),"labelPrefix"in I&&n(8,m=I.labelPrefix)},t.$$.update=()=>{8320&t.$$.dirty&&T(h)},[o,a,l,c,d,u,p,h,m,w,I=>{/tab/i.test(I.key)&&I.preventDefault()},I=>{T(I),y(I)},r,s,y]}class K4 extends Tn{constructor(e){super(),Sn(this,e,Y4,q4,yn,{class:0,title:1,label:13,icon:2,labelClass:3,innerClass:4,hideLabel:5,locale:6,value:7,onchange:14,labelPrefix:8})}}function Bf(t){let e,n,i=cr(t[0],t[1])+"";return{c(){e=ft("span"),n=Mi(i),S(e,"class",t[3])},m(r,o){tt(r,e,o),Et(e,n)},p(r,o){3&o&&i!==(i=cr(r[0],r[1])+"")&&Yi(n,i),8&o&&S(e,"class",r[3])},d(r){r&&Q(e)}}}function J4(t){let e,n,i,r,o=t[0]&&Bf(t);return i=new vo({props:{items:t[2]}}),{c(){e=ft("li"),o&&o.c(),n=pe(),zt(i.$$.fragment),S(e,"class","PinturaShapeStyle")},m(a,s){tt(a,e,s),o&&o.m(e,null),Et(e,n),Ft(i,e,null),r=!0},p(a,[s]){a[0]?o?o.p(a,s):(o=Bf(a),o.c(),o.m(e,n)):o&&(o.d(1),o=null);const l={};4&s&&(l.items=a[2]),i.$set(l)},i(a){r||(k(i.$$.fragment,a),r=!0)},o(a){A(i.$$.fragment,a),r=!1},d(a){a&&Q(e),o&&o.d(),_t(i)}}}function Q4(t,e,n){let i,{title:r}=e,{locale:o}=e,{items:a}=e,{hideTitle:s=!1}=e;return t.$$set=l=>{"title"in l&&n(0,r=l.title),"locale"in l&&n(1,o=l.locale),"items"in l&&n(2,a=l.items),"hideTitle"in l&&n(4,s=l.hideTitle)},t.$$.update=()=>{16&t.$$.dirty&&n(3,i="PinturaShapeStyleLabel"+(s?" implicit":""))},[r,o,a,i,s]}class t5 extends Tn{constructor(e){super(),Sn(this,e,Q4,J4,yn,{title:0,locale:1,items:2,hideTitle:4})}}var Nf=(t,e,n)=>{let i,r,o;const a=Math.floor(6*t),s=6*t-a,l=n*(1-e),c=n*(1-s*e),d=n*(1-(1-s)*e);switch(a%6){case 0:i=n,r=d,o=l;break;case 1:i=c,r=n,o=l;break;case 2:i=l,r=n,o=d;break;case 3:i=l,r=c,o=n;break;case 4:i=d,r=l,o=n;break;case 5:i=n,r=l,o=c}return[i,r,o]};function e5(t){let e,n,i;return{c(){e=ft("div"),n=ft("span"),S(e,"class","PinturaColorPreview"),S(e,"title",t[0]),S(e,"style",i="--color:"+t[1])},m(r,o){tt(r,e,o),Et(e,n)},p(r,[o]){1&o&&S(e,"title",r[0]),2&o&&i!==(i="--color:"+r[1])&&S(e,"style",i)},i:tn,o:tn,d(r){r&&Q(e)}}}function n5(t,e,n){let i,{color:r}=e,{title:o}=e;return t.$$set=a=>{"color"in a&&n(2,r=a.color),"title"in a&&n(0,o=a.title)},t.$$.update=()=>{4&t.$$.dirty&&n(1,i=r?Lr(r):"transparent")},[o,i,r]}class v0 extends Tn{constructor(e){super(),Sn(this,e,n5,e5,yn,{color:2,title:0})}}var Nu=t=>(t=t.trim(),/^rgba/.test(t)?t.substring(5).split(",").map(parseFloat).map((e,n)=>e/(n===3?1:255)):/^rgb/.test(t)?t.substring(4).split(",").map(parseFloat).map(e=>e/255):/^#/.test(t)?(e=>{const[,n,i,r,o]=e.split("");e=e.length>=4&&e.length<=5?`#${n}${n}${i}${i}${r}${r}${o?`${o}${o}`:""}`:e;const[a,s,l,c,d]=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})?$/i.exec(e)||[];if(a)return[s,l,c,d].filter(u=>u!==void 0).map(u=>parseInt(u,16)/255)})(t):/[0-9]{1,3}\s?,\s?[0-9]{1,3}\s?,\s?[0-9]{1,3}/.test(t)?t.split(",").map(e=>parseInt(e,10)).map(e=>e/255):void 0);let qp=null;function Wf(t){let e,n;return{c(){e=ft("span"),n=Mi(t[0])},m(i,r){tt(i,e,r),Et(e,n)},p(i,r){1&r[0]&&Yi(n,i[0])},d(i){i&&Q(e)}}}function i5(t){let e,n,i,r;n=new v0({props:{color:t[4],title:cr(t[8],t[10])}});let o=!t[9]&&Wf(t);return{c(){e=ft("span"),zt(n.$$.fragment),i=pe(),o&&o.c(),S(e,"slot","label"),S(e,"class","PinturaButtonLabel")},m(a,s){tt(a,e,s),Ft(n,e,null),Et(e,i),o&&o.m(e,null),r=!0},p(a,s){const l={};16&s[0]&&(l.color=a[4]),1280&s[0]&&(l.title=cr(a[8],a[10])),n.$set(l),a[9]?o&&(o.d(1),o=null):o?o.p(a,s):(o=Wf(a),o.c(),o.m(e,null))},i(a){r||(k(n.$$.fragment,a),r=!0)},o(a){A(n.$$.fragment,a),r=!1},d(a){a&&Q(e),_t(n),o&&o.d()}}}function Vf(t){let e,n,i,r,o,a,s,l,c,d,u,p,h,y;c=new b0({props:{class:"PinturaHuePicker",knobStyle:"background-color:"+t[21],onchange:t[27],value:t[16],min:0,max:1,step:.01}});let m=t[11]&&Hf(t),f=(t[14]||t[15])&&Uf(t);return{c(){e=ft("div"),n=ft("div"),i=ft("div"),r=ft("div"),l=pe(),zt(c.$$.fragment),d=pe(),m&&m.c(),u=pe(),f&&f.c(),S(r,"role","button"),S(r,"aria-label","Saturation slider"),S(r,"class","PinturaPickerKnob"),S(r,"tabindex","0"),S(r,"style",o=`background-color:${t[20]};`),S(i,"class","PinturaPickerKnobController"),S(i,"style",a=`transform:translate(${t[25]}%,${t[24]}%)`),S(n,"class","PinturaSaturationPicker"),S(n,"style",s="background-color: "+t[21]),S(e,"class","PinturaPicker")},m(b,v){tt(b,e,v),Et(e,n),Et(n,i),Et(i,r),t[41](n),Et(e,l),Ft(c,e,null),Et(e,d),m&&m.m(e,null),Et(e,u),f&&f.m(e,null),p=!0,h||(y=[St(r,"nudge",t[30]),qn(Bs.call(null,r,{preventDefault:!0})),St(n,"pointerdown",t[29])],h=!0)},p(b,v){(!p||1048576&v[0]&&o!==(o=`background-color:${b[20]};`))&&S(r,"style",o),(!p||50331648&v[0]&&a!==(a=`transform:translate(${b[25]}%,${b[24]}%)`))&&S(i,"style",a),(!p||2097152&v[0]&&s!==(s="background-color: "+b[21]))&&S(n,"style",s);const w={};2097152&v[0]&&(w.knobStyle="background-color:"+b[21]),65536&v[0]&&(w.value=b[16]),c.$set(w),b[11]?m?(m.p(b,v),2048&v[0]&&k(m,1)):(m=Hf(b),m.c(),k(m,1),m.m(e,u)):m&&(Te(),A(m,1,1,()=>{m=null}),Ce()),b[14]||b[15]?f?(f.p(b,v),49152&v[0]&&k(f,1)):(f=Uf(b),f.c(),k(f,1),f.m(e,null)):f&&(Te(),A(f,1,1,()=>{f=null}),Ce())},i(b){p||(k(c.$$.fragment,b),k(m),k(f),p=!0)},o(b){A(c.$$.fragment,b),A(m),A(f),p=!1},d(b){b&&Q(e),t[41](null),_t(c),m&&m.d(),f&&f.d(),h=!1,Zn(y)}}}function Hf(t){let e,n;return e=new b0({props:{class:"PinturaOpacityPicker",knobStyle:"background-color:"+t[18],trackStyle:`background-image:linear-gradient(to right,${t[19]},${t[20]})`,onchange:t[28],value:t[17],min:0,max:1,step:.01}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};262144&r[0]&&(o.knobStyle="background-color:"+i[18]),1572864&r[0]&&(o.trackStyle=`background-image:linear-gradient(to right,${i[19]},${i[20]})`),131072&r[0]&&(o.value=i[17]),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function Uf(t){let e,n,i,r,o,a,s,l=t[15]&&Gf(t);return{c(){e=ft("div"),n=ft("input"),r=pe(),l&&l.c(),S(n,"class","PinturaColorPickerInput"),S(n,"type","text"),n.disabled=i=!t[14],n.value=t[23],S(e,"class","PinturColorPickerInputGroup")},m(c,d){tt(c,e,d),Et(e,n),Et(e,r),l&&l.m(e,null),o=!0,a||(s=[St(n,"keydown",t[32]),St(n,"input",t[31])],a=!0)},p(c,d){(!o||16384&d[0]&&i!==(i=!c[14]))&&(n.disabled=i),(!o||8388608&d[0]&&n.value!==c[23])&&(n.value=c[23]),c[15]?l?(l.p(c,d),32768&d[0]&&k(l,1)):(l=Gf(c),l.c(),k(l,1),l.m(e,null)):l&&(Te(),A(l,1,1,()=>{l=null}),Ce())},i(c){o||(k(l),o=!0)},o(c){A(l),o=!1},d(c){c&&Q(e),l&&l.d(),a=!1,Zn(s)}}}function Gf(t){let e,n;return e=new Ds({props:{icon:'<path stroke="currentColor" stroke-linecap="square" d="m13 14-7 7a2.704 2.704 0 0 1-3 0 2.704 2.704 0 0 1 0-3l7-7"/><path fill="currentColor" d="M9.475 9.475 14.5 14.5c.263.263.69.265.955.005l.783-.767a4.209 4.209 0 0 0 1.262-3.006V10l4-4c.5-.5.375-2.125-.5-3s-2.5-1-3-.5l-4 4h-.732a4.329 4.329 0 0 0-3.03 1.238l-.758.742a.7.7 0 0 0-.005.995Z"/>',hideLabel:!0,label:"Pick a color",class:"PinturaEyeDropper",onclick:t[33]}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p:tn,i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function jf(t){let e,n;return e=new fl({props:{label:cr(t[10].labelColorPalette,t[10]),class:rn(["PinturaColorPresets",t[9]?"PinturaColorPresetsGrid":"PinturaColorPresetsList"]),hideLabel:!1,name:t[1],value:t[4],optionGroupClass:"PinturaListOptionGroup",optionClass:"PinturaListOption",options:t[2].map(t[42]),selectedIndex:t[3],optionMapper:t[7],optionLabelClass:t[6],onchange:t[43],$$slots:{option:[o5,({option:i})=>({59:i}),({option:i})=>[0,i?268435456:0]],group:[r5,({option:i})=>({59:i}),({option:i})=>[0,i?268435456:0]]},$$scope:{ctx:t}}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};1024&r[0]&&(o.label=cr(i[10].labelColorPalette,i[10])),512&r[0]&&(o.class=rn(["PinturaColorPresets",i[9]?"PinturaColorPresetsGrid":"PinturaColorPresetsList"])),2&r[0]&&(o.name=i[1]),16&r[0]&&(o.value=i[4]),1028&r[0]&&(o.options=i[2].map(i[42])),8&r[0]&&(o.selectedIndex=i[3]),128&r[0]&&(o.optionMapper=i[7]),64&r[0]&&(o.optionLabelClass=i[6]),512&r[0]|805306368&r[1]&&(o.$$scope={dirty:r,ctx:i}),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function r5(t){let e,n,i=t[59].label+"";return{c(){e=ft("span"),n=Mi(i),S(e,"slot","group")},m(r,o){tt(r,e,o),Et(e,n)},p(r,o){268435456&o[1]&&i!==(i=r[59].label+"")&&Yi(n,i)},d(r){r&&Q(e)}}}function Zf(t){let e,n,i=t[59].label+"";return{c(){e=ft("span"),n=Mi(i),S(e,"class","PinturaButtonLabel")},m(r,o){tt(r,e,o),Et(e,n)},p(r,o){268435456&o[1]&&i!==(i=r[59].label+"")&&Yi(n,i)},d(r){r&&Q(e)}}}function o5(t){let e,n,i,r;n=new v0({props:{title:t[59].label,color:t[59].value}});let o=!t[9]&&Zf(t);return{c(){e=ft("span"),zt(n.$$.fragment),i=pe(),o&&o.c(),S(e,"slot","option")},m(a,s){tt(a,e,s),Ft(n,e,null),Et(e,i),o&&o.m(e,null),r=!0},p(a,s){const l={};268435456&s[1]&&(l.title=a[59].label),268435456&s[1]&&(l.color=a[59].value),n.$set(l),a[9]?o&&(o.d(1),o=null):o?o.p(a,s):(o=Zf(a),o.c(),o.m(e,null))},i(a){r||(k(n.$$.fragment,a),r=!0)},o(a){A(n.$$.fragment,a),r=!1},d(a){a&&Q(e),_t(n),o&&o.d()}}}function a5(t){let e,n,i,r=t[13]&&Vf(t),o=t[12]&&jf(t);return{c(){e=ft("div"),r&&r.c(),n=pe(),o&&o.c(),S(e,"slot","details"),S(e,"class","PinturaColorPickerPanel")},m(a,s){tt(a,e,s),r&&r.m(e,null),Et(e,n),o&&o.m(e,null),i=!0},p(a,s){a[13]?r?(r.p(a,s),8192&s[0]&&k(r,1)):(r=Vf(a),r.c(),k(r,1),r.m(e,n)):r&&(Te(),A(r,1,1,()=>{r=null}),Ce()),a[12]?o?(o.p(a,s),4096&s[0]&&k(o,1)):(o=jf(a),o.c(),k(o,1),o.m(e,null)):o&&(Te(),A(o,1,1,()=>{o=null}),Ce())},i(a){i||(k(r),k(o),i=!0)},o(a){A(r),A(o),i=!1},d(a){a&&Q(e),r&&r.d(),o&&o.d()}}}function s5(t){let e,n;return e=new e1({props:{buttonClass:rn(["PinturaColorPickerButton",t[5]]),$$slots:{details:[a5],label:[i5]},$$scope:{ctx:t}}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};32&r[0]&&(o.buttonClass=rn(["PinturaColorPickerButton",i[5]])),67108831&r[0]|536870912&r[1]&&(o.$$scope={dirty:r,ctx:i}),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function l5(t,e,n){let i,r,o,a,s,l,c,d,u,p,h,y,m,f,b,{label:v}=e,{name:w}=e,{options:T=[]}=e,{selectedIndex:I=-1}=e,{value:P}=e,{buttonClass:_}=e,{optionLabelClass:C}=e,{optionMapper:F}=e,{onchange:G}=e,{title:O}=e,{hidePresetLabel:$=!0}=e,{locale:N}=e,{enableOpacity:it=!0}=e,{enablePresets:M=!0}=e,{enablePicker:W=!0}=e,{enableInput:ot=!1}=e,{enableEyeDropper:at=!1}=e;const q=(rt,kt)=>{if(p=[rt[0],rt[1],rt[2]],kt){let Nt=((Ut,qt,Dt)=>{let ve=Math.max(Ut,qt,Dt),It=ve-Math.min(Ut,qt,Dt),Ie=It&&(ve==Ut?(qt-Dt)/It:ve==qt?2+(Dt-Ut)/It:4+(Ut-qt)/It);return[60*(Ie<0?Ie+6:Ie)/360,ve&&It/ve,ve]})(...p),$t=Nt[0],Be=Nt[1],nt=Nt[2];dn(vt)&&($t=vt),dn(bt)&&(Be=bt),dn(K)&&(nt=K),n(16,l=$t),n(36,c=Be),n(37,d=nt),n(17,u=dn(rt[3])?rt[3]:1)}n(18,h=Lr(rt)),n(19,y=Lr([...p,0])),n(20,m=Lr([...p,1])),n(21,f=Lr(Nf(l,1,1)))},ct=()=>{const rt=[...Nf(l,c,d),u];q(rt),G(rt)},V=rt=>{const kt=rt.length===3?[...rt,1]:rt;ut(),q(kt,!0),G(kt)},ut=()=>{bt=void 0,K=void 0,vt=void 0};let bt,K,vt;const X=(rt,kt)=>{const Nt=oi(rt.x/kt.width,0,1),$t=oi(rt.y/kt.height,0,1);var Be,nt;nt=1-$t,n(36,c=Be=Nt),n(37,d=nt),bt=Be,K=nt,ct()};let Z,mt,Bt,st;const gt=rt=>{const kt=Oi(zm(rt),st);X(nr(Ue(Bt),kt),mt)},Jt=rt=>{mt=void 0,document.documentElement.removeEventListener("pointermove",gt),document.documentElement.removeEventListener("pointerup",Jt)};let le;return t.$$set=rt=>{"label"in rt&&n(0,v=rt.label),"name"in rt&&n(1,w=rt.name),"options"in rt&&n(2,T=rt.options),"selectedIndex"in rt&&n(3,I=rt.selectedIndex),"value"in rt&&n(4,P=rt.value),"buttonClass"in rt&&n(5,_=rt.buttonClass),"optionLabelClass"in rt&&n(6,C=rt.optionLabelClass),"optionMapper"in rt&&n(7,F=rt.optionMapper),"onchange"in rt&&n(34,G=rt.onchange),"title"in rt&&n(8,O=rt.title),"hidePresetLabel"in rt&&n(9,$=rt.hidePresetLabel),"locale"in rt&&n(10,N=rt.locale),"enableOpacity"in rt&&n(11,it=rt.enableOpacity),"enablePresets"in rt&&n(12,M=rt.enablePresets),"enablePicker"in rt&&n(13,W=rt.enablePicker),"enableInput"in rt&&n(14,ot=rt.enableInput),"enableEyeDropper"in rt&&n(35,at=rt.enableEyeDropper)},t.$$.update=()=>{16&t.$$.dirty[1]&&n(15,i=at&&(qp===null&&(qp=ir()&&"EyeDropper"in window),qp)),16&t.$$.dirty[0]|128&t.$$.dirty[1]&&(!P||b&&Os(P,b)||(n(38,b=[...P]),q(P,!0))),32&t.$$.dirty[1]&&n(25,r=100*c),64&t.$$.dirty[1]&&n(24,o=100-100*d),256&t.$$.dirty[1]&&n(40,a=!!le&&le.length>=4&&le.length<=5),51216&t.$$.dirty[0]|512&t.$$.dirty[1]&&n(23,s=(ot||i)&&P?((rt,kt,Nt)=>{let $t=rt.map(Be=>Math.round(255*Be).toString(16).toLowerCase().padStart(2,"0"));return(!kt&&$t.length>3||$t[3]==="ff")&&$t.pop(),Nt&&($t=$t.map(Be=>Be.substring(0,1))),"#"+$t.join("")})(P,it,a):void 0)},[v,w,T,I,P,_,C,F,O,$,N,it,M,W,ot,i,l,u,h,y,m,f,Z,s,o,r,V,rt=>{n(16,l=rt),vt=rt,ct()},rt=>{n(17,u=rt),ct()},rt=>{rt.stopPropagation(),mt=sr(Z.offsetWidth,Z.offsetHeight),Bt=(kt=>pt(kt.offsetX,kt.offsetY))(rt),st=zm(rt),X(Bt,mt),document.documentElement.addEventListener("pointermove",gt),document.documentElement.addEventListener("pointerup",Jt)},rt=>{mt=sr(Z.offsetWidth,Z.offsetHeight);const kt=r/100*mt.width,Nt=o/100*mt.height;X({x:kt+rt.detail.x,y:Nt+rt.detail.y},mt)},rt=>{const{value:kt}=rt.target,Nt=kt.length;if(!kt.startsWith("#")||Nt<4||Nt===6||Nt===8||Nt>9||!it&&Nt>7)return;const $t=Nu(kt);$t&&(n(39,le=kt),ut(),q($t),G($t))},rt=>{rt.stopPropagation()},rt=>{new EyeDropper().open().then(({sRGBHex:kt})=>{const Nt=Nu(kt);Nt&&(Nt[3]=1,n(39,le=P),ut(),q(Nt),G(Nt))}).catch(kt=>{})},G,at,c,d,b,le,a,function(rt){Nn[rt?"unshift":"push"](()=>{Z=rt,n(22,Z)})},([rt,kt])=>[rt,Si(kt)?kt(N):kt],rt=>V(rt.value)]}class c5 extends Tn{constructor(e){super(),Sn(this,e,l5,s5,yn,{label:0,name:1,options:2,selectedIndex:3,value:4,buttonClass:5,optionLabelClass:6,optionMapper:7,onchange:34,title:8,hidePresetLabel:9,locale:10,enableOpacity:11,enablePresets:12,enablePicker:13,enableInput:14,enableEyeDropper:35},null,[-1,-1])}}function d5(t){let e,n,i;return n=new vo({props:{items:t[0]}}),{c(){e=ft("div"),zt(n.$$.fragment),S(e,"class","PinturaShorthandControl PinturaShapeStyle")},m(r,o){tt(r,e,o),Ft(n,e,null),i=!0},p(r,[o]){const a={};1&o&&(a.items=r[0]),n.$set(a)},i(r){i||(k(n.$$.fragment,r),i=!0)},o(r){A(n.$$.fragment,r),i=!1},d(r){r&&Q(e),_t(n)}}}function u5(t,e,n){let i,r,{value:o}=e,{onchange:a}=e,{controls:s=[]}=e;return t.$$set=l=>{n(6,e=ki(ki({},e),Xc(l))),"value"in l&&n(1,o=l.value),"onchange"in l&&n(2,a=l.onchange),"controls"in l&&n(3,s=l.controls)},t.$$.update=()=>{n(4,i=(l=>{const{controls:c,...d}=l;return d})(e)),30&t.$$.dirty&&n(0,r=s.map((l,c)=>{const[d,u,p]=l;return[d,u,{...i,...p,value:o[c],onchange:h=>{const y=[...o];y[c]=h,a(y)}}]}))},e=Xc(e),[r,o,a,s,i]}class p5 extends Tn{constructor(e){super(),Sn(this,e,u5,d5,yn,{value:1,onchange:2,controls:3})}}function h5(t){let e,n;return e=new x0({props:{label:t[4],options:t[1],title:t[2],selectedIndex:t[5],onchange:t[10]}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,[r]){const o={};16&r&&(o.label=i[4]),2&r&&(o.options=i[1]),4&r&&(o.title=i[2]),32&r&&(o.selectedIndex=i[5]),9&r&&(o.onchange=i[10]),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function m5(t,e,n){let i,r,o,a,{options:s}=e,{title:l}=e,{onchange:c}=e,{selectedIndex:d=-1}=e,{value:u}=e,{label:p}=e;return t.$$set=h=>{"options"in h&&n(1,s=h.options),"title"in h&&n(2,l=h.title),"onchange"in h&&n(3,c=h.onchange),"selectedIndex"in h&&n(0,d=h.selectedIndex),"value"in h&&n(6,u=h.value),"label"in h&&n(7,p=h.label)},t.$$.update=()=>{67&t.$$.dirty&&n(9,i=((h,y,m)=>{if(h)return y>-1?h[y]:m!==void 0?h.find(f=>f[0]===m):h[0]})(s,d,u)),514&t.$$.dirty&&n(5,r=s&&s.findIndex(h=>h===i)),512&t.$$.dirty&&n(8,o=i&&i[1]),384&t.$$.dirty&&n(4,a=p||o)},[d,s,l,c,a,r,u,p,o,i,h=>{n(0,d=h.index),c&&c(h)}]}class g5 extends Tn{constructor(e){super(),Sn(this,e,m5,h5,yn,{options:1,title:2,onchange:3,selectedIndex:0,value:6,label:7})}}function Xf(t,e,n){const i=t.slice();return i[9]=e[n][0],i[0]=e[n][1],i[10]=e[n][2],i[2]=e[n][3],i}function f5(t){let e,n,i;const r=[t[10]];var o=t[3][t[9]]||t[9];function a(s){let l={};for(let c=0;c<r.length;c+=1)l=ki(l,r[c]);return{props:l}}return o&&(e=zu(o,a())),{c(){e&&zt(e.$$.fragment),n=Ei()},m(s,l){e&&Ft(e,s,l),tt(s,n,l),i=!0},p(s,l){const c=4&l?Tr(r,[_r(s[10])]):{};if(o!==(o=s[3][s[9]]||s[9])){if(e){Te();const d=e;A(d.$$.fragment,1,0,()=>{_t(d,1)}),Ce()}o?(e=zu(o,a()),zt(e.$$.fragment),k(e.$$.fragment,1),Ft(e,n.parentNode,n)):e=null}else o&&e.$set(c)},i(s){i||(e&&k(e.$$.fragment,s),i=!0)},o(s){e&&A(e.$$.fragment,s),i=!1},d(s){s&&Q(n),e&&_t(e,s)}}}function $5(t){let e,n=t[9],i=t[9]&&Yp(t);return{c(){i&&i.c(),e=Ei()},m(r,o){i&&i.m(r,o),tt(r,e,o)},p(r,o){r[9]?n?yn(n,r[9])?(i.d(1),i=Yp(r),i.c(),i.m(e.parentNode,e)):i.p(r,o):(i=Yp(r),i.c(),i.m(e.parentNode,e)):n&&(i.d(1),i=null),n=r[9]},i:tn,o(r){A(i)},d(r){r&&Q(e),i&&i.d(r)}}}function y5(t){let e,n,i=t[10].innerHTML+"";return{c(){e=new w2(!1),n=Ei(),e.a=n},m(r,o){e.m(i,r,o),tt(r,n,o)},p(r,o){4&o&&i!==(i=r[10].innerHTML+"")&&e.p(i)},i:tn,o:tn,d(r){r&&Q(n),r&&e.d()}}}function x5(t){let e,n=t[10].textContent+"";return{c(){e=Mi(n)},m(i,r){tt(i,e,r)},p(i,r){4&r&&n!==(n=i[10].textContent+"")&&Yi(e,n)},i:tn,o:tn,d(i){i&&Q(e)}}}function b5(t){let e,n;return e=new vo({props:{items:t[2],discardEmptyItems:!0}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};4&r&&(o.items=i[2]),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function Yp(t){let e,n,i,r,o;const a=[b5,x5,y5],s=[];function l(u,p){return u[2]&&u[2].length?0:u[10].textContent?1:u[10].innerHTML?2:-1}~(n=l(t))&&(i=s[n]=a[n](t));let c=[t[4](t[10])],d={};for(let u=0;u<c.length;u+=1)d=ki(d,c[u]);return{c(){e=ft(t[9]),i&&i.c(),r=pe(),/-/.test(t[9])?bg(e,d):xg(e,d)},m(u,p){tt(u,e,p),~n&&s[n].m(e,null),Et(e,r),o=!0},p(u,p){let h=n;n=l(u),n===h?~n&&s[n].p(u,p):(i&&(Te(),A(s[h],1,1,()=>{s[h]=null}),Ce()),~n?(i=s[n],i?i.p(u,p):(i=s[n]=a[n](u),i.c()),k(i,1),i.m(e,r)):i=null),d=Tr(c,[4&p&&u[4](u[10])]),/-/.test(u[9])?bg(e,d):xg(e,d)},i(u){o||(k(i),o=!0)},o(u){A(i),o=!1},d(u){u&&Q(e),~n&&s[n].d()}}}function qf(t,e){let n,i,r,o,a,s;const l=[$5,f5],c=[];function d(u,p){return 4&p&&(i=null),i==null&&(i=!u[5](u[9])),i?0:1}return r=d(e,-1),o=c[r]=l[r](e),{key:t,first:null,c(){n=Ei(),o.c(),a=Ei(),this.first=n},m(u,p){tt(u,n,p),c[r].m(u,p),tt(u,a,p),s=!0},p(u,p){let h=r;r=d(e=u,p),r===h?c[r].p(e,p):(Te(),A(c[h],1,1,()=>{c[h]=null}),Ce(),o=c[r],o?o.p(e,p):(o=c[r]=l[r](e),o.c()),k(o,1),o.m(a.parentNode,a))},i(u){s||(k(o),s=!0)},o(u){A(o),s=!1},d(u){u&&Q(n),c[r].d(u),u&&Q(a)}}}function v5(t){let e,n,i=[],r=new Map,o=t[2];const a=s=>s[0]+s[1];for(let s=0;s<o.length;s+=1){let l=Xf(t,o,s),c=a(l);r.set(c,i[s]=qf(c,l))}return{c(){for(let s=0;s<i.length;s+=1)i[s].c();e=Ei()},m(s,l){for(let c=0;c<i.length;c+=1)i[c].m(s,l);tt(s,e,l),n=!0},p(s,[l]){62&l&&(o=s[2],Te(),i=Va(i,l,a,1,s,o,r,e.parentNode,_s,qf,e,Xf),Ce())},i(s){if(!n){for(let l=0;l<o.length;l+=1)k(i[l]);n=!0}},o(s){for(let l=0;l<i.length;l+=1)A(i[l]);n=!1},d(s){for(let l=0;l<i.length;l+=1)i[l].d(s);s&&Q(e)}}}function w5(t,e,n){let i,r,{items:o}=e,{discardEmptyItems:a=!0}=e,{key:s=""}=e;const l={Button:Ds,ImageButton:nx,ImageButtonList:y0,Dropdown:x0,Select:g5,RadioGroup:fl,Input:lx,Panel:N4,ProgressIndicator:tx,ShapeStyle:t5,ToggleSlider:K4,ColorPicker:c5,ShorthandControl:p5},c=u=>!Qe(u)||!!l[u],d=u=>{if(!u)return!1;const[p,,h,y=[]]=u;return!!c(p)||y.some(d)||h.textContent||h.innerHTML};return t.$$set=u=>{"items"in u&&n(6,o=u.items),"discardEmptyItems"in u&&n(7,a=u.discardEmptyItems),"key"in u&&n(0,s=u.key)},t.$$.update=()=>{1&t.$$.dirty&&n(1,i=s),192&t.$$.dirty&&n(2,r=(o&&a?o.filter(d):o)||[])},[s,i,r,l,(u={})=>{const{textContent:p,innerHTML:h,...y}=u;return y},c,o,a]}class vo extends Tn{constructor(e){super(),Sn(this,e,w5,v5,yn,{items:6,discardEmptyItems:7,key:0})}get items(){return this.$$.ctx[6]}set items(e){this.$$set({items:e}),U()}get discardEmptyItems(){return this.$$.ctx[7]}set discardEmptyItems(e){this.$$set({discardEmptyItems:e}),U()}get key(){return this.$$.ctx[0]}set key(e){this.$$set({key:e}),U()}}let Kp=null;var S5=t=>{if(Kp===null&&(Kp=ir()&&"visualViewport"in window),!Kp)return!1;const e=visualViewport.height,n=()=>{t(visualViewport.height<e?"visible":"hidden")};return visualViewport.addEventListener("resize",n),()=>visualViewport.removeEventListener("resize",n)};function Yf(t){let e,n;const i=[{onclick:t[1]},t[3]];let r={};for(let o=0;o<i.length;o+=1)r=ki(r,i[o]);return e=new Ds({props:r}),{c(){zt(e.$$.fragment)},m(o,a){Ft(e,o,a),n=!0},p(o,a){const s=10&a[0]?Tr(i,[2&a[0]&&{onclick:o[1]},8&a[0]&&_r(o[3])]):{};e.$set(s)},i(o){n||(k(e.$$.fragment,o),n=!0)},o(o){A(e.$$.fragment,o),n=!1},d(o){_t(e,o)}}}function Kf(t){let e,n;const i=[{onclick:t[0]},{class:"PinturaInputFormButtonConfirm"},t[2]];let r={};for(let o=0;o<i.length;o+=1)r=ki(r,i[o]);return e=new Ds({props:r}),{c(){zt(e.$$.fragment)},m(o,a){Ft(e,o,a),n=!0},p(o,a){const s=5&a[0]?Tr(i,[1&a[0]&&{onclick:o[0]},i[1],4&a[0]&&_r(o[2])]):{};e.$set(s)},i(o){n||(k(e.$$.fragment,o),n=!0)},o(o){A(e.$$.fragment,o),n=!1},d(o){_t(e,o)}}}function T5(t){let e,n,i,r,o,a,s,l,c=t[3]&&Yf(t);const d=t[24].default,u=ur(d,t,t[23],null);let p=t[2]&&Kf(t);return{c(){e=ft("div"),n=ft("div"),c&&c.c(),i=pe(),r=ft("div"),u&&u.c(),o=pe(),p&&p.c(),S(r,"class","PinturaInputFormFields"),S(n,"class","PinturaInputFormInner"),S(e,"class","PinturaInputForm"),S(e,"data-layout",t[4]),S(e,"style",t[6])},m(h,y){tt(h,e,y),Et(e,n),c&&c.m(n,null),Et(n,i),Et(n,r),u&&u.m(r,null),Et(n,o),p&&p.m(n,null),t[25](e),a=!0,s||(l=[St(r,"keydown",t[10]),St(e,"focusin",t[7]),St(e,"focusout",t[8]),St(e,"measure",t[9]),qn(Cr.call(null,e))],s=!0)},p(h,y){h[3]?c?(c.p(h,y),8&y[0]&&k(c,1)):(c=Yf(h),c.c(),k(c,1),c.m(n,i)):c&&(Te(),A(c,1,1,()=>{c=null}),Ce()),u&&u.p&&(!a||8388608&y[0])&&hr(u,d,h,h[23],a?pr(d,h[23],y,null):mr(h[23]),null),h[2]?p?(p.p(h,y),4&y[0]&&k(p,1)):(p=Kf(h),p.c(),k(p,1),p.m(n,null)):p&&(Te(),A(p,1,1,()=>{p=null}),Ce()),(!a||16&y[0])&&S(e,"data-layout",h[4]),(!a||64&y[0])&&S(e,"style",h[6])},i(h){a||(k(c),k(u,h),k(p),a=!0)},o(h){A(c),A(u,h),A(p),a=!1},d(h){h&&Q(e),c&&c.d(),u&&u.d(h),p&&p.d(),t[25](null),s=!1,Zn(l)}}}function C5(t,e,n){let i,r,o,a,s,{$$slots:l={},$$scope:c}=e,{onconfirm:d}=e,{oncancel:u}=e,{autoFocus:p=!0}=e,{autoPositionCursor:h=!0}=e,{buttonConfirm:y}=e,{buttonCancel:m}=e,{layout:f="stack"}=e,{parentRect:b}=e,{align:v}=e,{justify:w}=e,{parentMargin:T=16}=e,{panelOffset:I=hi()}=e,P=!1,_,C,F="",G=0;const O=()=>{const M=s.querySelector("input, textarea");M.focus(),G>=1||M.select()},$=()=>{P=!0,it||!Io()&&!Gu()||n(19,F="top:1em;bottom:auto;"),Io()&&(M=>{let W;const ot=q=>W=q.touches[0].screenY,at=q=>{const ct=q.touches[0].screenY,V=q.target;/textarea/i.test(V.nodeName)?(ct>W?V.scrollTop==0&&q.preventDefault():ct<W?V.scrollTop+V.offsetHeight==V.scrollHeight&&q.preventDefault():q.preventDefault(),W=ct):q.preventDefault()};M.addEventListener("touchstart",ot),M.addEventListener("touchmove",at)})(s),n(20,G=1)};let N;const it=S5(M=>{o?M!=="hidden"||P?(clearTimeout(C),C=void 0,n(19,F=`top:${visualViewport.height-_.height-I.y}px`),M==="visible"?(n(5,s.dataset.stick=!0,s),O(),$()):(P=!1,n(20,G=0))):O():n(19,F="top: 4.5em; bottom: auto")});return ds(()=>{p&&O()}),Ho(()=>{it&&it()}),t.$$set=M=>{"onconfirm"in M&&n(0,d=M.onconfirm),"oncancel"in M&&n(1,u=M.oncancel),"autoFocus"in M&&n(11,p=M.autoFocus),"autoPositionCursor"in M&&n(12,h=M.autoPositionCursor),"buttonConfirm"in M&&n(2,y=M.buttonConfirm),"buttonCancel"in M&&n(3,m=M.buttonCancel),"layout"in M&&n(4,f=M.layout),"parentRect"in M&&n(13,b=M.parentRect),"align"in M&&n(14,v=M.align),"justify"in M&&n(15,w=M.justify),"parentMargin"in M&&n(16,T=M.parentMargin),"panelOffset"in M&&n(17,I=M.panelOffset),"$$scope"in M&&n(23,c=M.$$scope)},t.$$.update=()=>{385024&t.$$.dirty[0]&&n(21,i=b&&_?((M,W,ot,at,q)=>{let ct,V;return ct=at==="center"?M.x+.5*M.width-.5*W.width:at==="right"?M.x+M.width-W.width-q:M.x+q,V=ot==="center"?M.y+.5*M.height-.5*W.height:ot==="bottom"?M.y+M.height-W.height-q:M.y+q,`left:${ct}px;top:${V}px;right:auto;bottom:auto;`})(b,_,v,w,T):void 0),32&t.$$.dirty[0]&&n(22,r=s&&getComputedStyle(s)),4194304&t.$$.dirty[0]&&(o=r&&r.getPropertyValue("--editor-modal")==="1"),3670016&t.$$.dirty[0]&&n(6,a=`opacity:${G};${i||F}`)},[d,u,y,m,f,s,a,M=>{var W;((ot=>/textarea/i.test(ot))(M.target)||ix(M.target))&&(N=Date.now(),h&&((W=M.target).selectionStart=W.selectionEnd=W.value.length),clearTimeout(C),C=setTimeout($,200))},M=>{Date.now()-N>50||(M.stopPropagation(),O())},({detail:M})=>{n(18,_={width:M.width,height:M.height})},M=>M.key==="Enter"?d():M.key==="Escape"?u():void 0,p,h,b,v,w,T,I,_,F,G,i,r,c,l,function(M){Nn[M?"unshift":"push"](()=>{s=M,n(5,s)})}]}class cx extends Tn{constructor(e){super(),Sn(this,e,C5,T5,yn,{onconfirm:0,oncancel:1,autoFocus:11,autoPositionCursor:12,buttonConfirm:2,buttonCancel:3,layout:4,parentRect:13,align:14,justify:15,parentMargin:16,panelOffset:17},null,[-1,-1])}}var Jf=(t,e)=>{t.fastSeek&&t.fastSeek(e),t.currentTime=e};const M5=["aspectRatio","isRotatedSideways","flip","cropSize"],Qf=l0.map(([t])=>t).filter(t=>!M5.includes(t));var bs=(t,e)=>new CustomEvent("ping",{detail:{type:t,data:e},cancelable:!0,bubbles:!0}),dx=(t,e)=>(e?p0(t,e):t).replace(/([a-z])([A-Z])/g,"$1-$2").replace(/\s+/g,"-").toLowerCase(),t$=(t,e=ni)=>{const{subscribe:n,set:i}=me(void 0);return{subscribe:n,destroy:((r,o)=>{const a=matchMedia(r);return a.addListener(o),o(a),{get matches(){return a.matches},destroy:()=>a.removeListener(o)}})(t,({matches:r})=>i(e(r))).destroy}},e$=(t,e,n)=>new Promise((i,r)=>{(async()=>{c0(t)&&i(await N2(t));const o=await e.read(t),a=l=>Ey(l,n).then(c=>e.apply(c,o)).then(i).catch(r);if(ky(t)||!My()||Ba()||Io())return a(t);let s;try{s=await ju((l,c)=>createImageBitmap(l).then(d=>c(null,d)).catch(c),[t])}catch{}s&&s.width?await Uu()?m0()&&o>1?i(await(async l=>Qc(await Xl(l)))(s)):i(s):i(e.apply(s,o)):a(t)})()}),n$=(t,e)=>new Promise(async n=>{if(t.width<e.width&&t.height<e.height)return n(t);const i=Math.min(e.width/t.width,e.height/t.height),r=i*t.width,o=i*t.height,a=fi("canvas",{width:r,height:o}),s=a.getContext("2d",{willReadFrequently:!0}),l=Vc(t)?await Xl(t):t;s.drawImage(l,0,0,r,o),n(Qc(a))});let Jp=null;var k5=()=>{if(Jp===null){let t=fi("canvas");Jp=!!Ku(t),dr(t),t=void 0}return Jp};const i$=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],sl={precision:1e-4},du={precision:.01*sl.precision};var E5=()=>{const t=[],e=[],n=[],i=()=>{e.forEach(o=>o(n))},r=o=>{o.unsub=o.subscribe(a=>((s,l)=>{const c=t.indexOf(s);c<0||(n[c]=l,i())})(o,a)),i()};return{get length(){return t.length},clear:()=>{t.forEach(o=>o.unsub()),t.length=0,n.length=0},unshift:o=>{t.unshift(o),r(o)},get:o=>t[o],push:o=>{t.push(o),r(o)},remove:o=>{o.unsub();const a=t.indexOf(o);t.splice(a,1),n.splice(a,1)},forEach:o=>t.forEach(o),filter:o=>t.filter(o),subscribe:o=>(e.push(o),o(n),()=>{e.splice(e.indexOf(o),1)})}},Qp=t=>t[0]<.25&&t[1]<.25&&t[2]<.25,ux=(t={})=>new Promise(e=>{const{accept:n="image/*"}=t,i=fi("input",{style:"position:absolute;visibility:hidden;width:0;height:0;",type:"file",accept:n}),r=()=>{const[o]=i.files;i.parentNode&&i.remove(),i.removeEventListener("change",r),e(o)};i.addEventListener("change",r),Io()&&document.body.append(i),i.click()}),Wu=t=>{try{return t()}catch(e){console.error(e)}},P5=([t,e])=>t+.5*(e-t),ks=t=>Math.round(100*t),w0=t=>pt(t.clientX,t.clientY),Ph=(t,e,n)=>{const i=w0(t);return Oi(Oi(i,e),n)};function I5(t,e,n){let i,r,o,a,s,l,c,d,u,p,h,y,m,f,b,v,w,T,I,P,_,{root:C}=e,{locale:F}=e,{stores:G}=e,{allowPan:O=!0}=e,{allowZoom:$=!0}=e,{enablePan:N=!0}=e,{enableZoom:it=!0}=e,{enableZoomControls:M=it}=e,{enableZoomInput:W=!0}=e,{enablePanInput:ot=!0}=e,{enablePanLimit:at=!0}=e,{panLimitGutterScalar:q=0}=e,{zoomOptions:ct=[.25,.5,1,1.25,1.5,2,3,4,6,8,16]}=e,{zoomAdjustStep:V=.25}=e,{zoomAdjustFactor:ut=.1}=e,{zoomAdjustWheelFactor:bt=1}=e,{elasticity:K=5}=e,{imageSelectionRectCentered:vt}=e,{imageSelectionRectScalar:X}=e,{zoomLevel:Z=null}=e,{zoomControls:mt}=e,{zoomMultiTouching:Bt=!1}=e;const{isAnimated:st,isInteracting:gt,rootRect:Jt,stageRect:le,stageScalar:rt,imageSelectionPan:kt,imageSelectionZoom:Nt,imageSelectionStageFitScalar:$t,imageSelectionRect:Be,imageSelectionStoredState:nt,imagePreviewUpscale:Ut}=G;D(t,st,J=>n(70,P=J)),D(t,gt,J=>n(69,T=J)),D(t,Jt,J=>n(66,b=J)),D(t,le,J=>n(65,f=J)),D(t,rt,J=>n(46,I=J)),D(t,kt,J=>n(64,h=J)),D(t,Nt,J=>n(43,p=J)),D(t,$t,J=>n(44,y=J)),D(t,Be,J=>n(67,v=J)),D(t,nt,J=>n(71,_=J)),D(t,Ut,J=>n(45,m=J));const qt=yi("fixScrollDirection");D(t,qt,J=>n(68,w=J));let Dt=!1,ve,It,Ie,lt;const Ze=J=>{const Xt=C.querySelector(".PinturaMain > .PinturaUtilMain")||C.querySelector('div[tabindex="0"] .PinturaUtilMain');return!!Xt&&!!Xt.contains(J.target)&&!ml(J.target)},nn=(J={})=>{const{pan:Xt=h,zoom:jt=p}=J;At(nt,_={translation:Xt,zoom:jt},_)},he=()=>h&&h.x===0&&h.y===0,Ke=()=>{At(Nt,p=void 0,p),he()||At(kt,h=hi(),h),We.set(void 0,{hard:!0})},Ae=()=>{Ke(),nn()},We=fn(void 0,{precision:.01});We.subscribe(J=>{if(J===void 0)return At(Nt,p=void 0,p),void(he()||At(kt,h=hi(),h));const Xt=p;J<=1?he()||At(kt,h=hi(),h):J<=Xt&&At(kt,h=Po(h,.8),h),At(Nt,p=J,p)});const xn=J=>{We.update(Xt=>{const jt=J(Xt||y);return nn({zoom:jt}),jt})},xt=J=>{J?We.set(J,{hard:P===!1}):(J=void 0,We.set(void 0,{hard:!0})),At(Nt,p=J,p),nn({zoom:J})},de=(J,Xt)=>{const jt=X*Xt,se={...vt},Fe=1-oi(q,0,1);Sr(se,jt<Fe?jt:Fe);const ke={...vt};Sr(ke,jt),ta(ke,J);const be={...ke};return ke.x>se.x&&(be.x=se.x),ke.y>se.y&&(be.y=se.y),ke.x+ke.width<se.x+se.width&&(be.x=se.x+se.width-ke.width),ke.y+ke.height<se.y+se.height&&(be.y=se.y+se.height-ke.height),Oi(wn(be),wn(se))},Ve=({translation:J,zoom:Xt=1,elastify:jt=!0})=>{if(!ve)return;let se=J;const Fe=pt(ve.x+se.x,ve.y+se.y);if(!at)return Fe;const ke=de(Fe,Xt);return jt?Uw(ke,Fe,K):ke};let Oe,Ne;const _e=()=>{Ne=void 0,At(gt,T=!0,T),n(34,Dt=ot),Oe=!1,Ie=!1,ve={...h},It=m?p||y:o?p||1:p||y},Je=J=>{const{scalar:Xt,translation:jt,isMultiTouching:se}=J.detail;if(!ve||!se&&!ot)return;se&&Po(jt,.5),(ot||se)&&(Oe=!0),Bt||n(13,Bt=se);const Fe=i?oi(It*Xt,s,l):1,ke=Ve({translation:jt,zoom:Fe,elastify:!0}),be=Ts(ke);lt=Ts(h),Ie=be<lt,i&&Nt.set(Fe),kt.set(ke),Ne=Bt&&{translation:J.detail.translation,scalar:Xt}},kn=J=>{At(gt,T=!1,T),n(34,Dt=!1),n(13,Bt=!1),Ie&&lt<50&&(ve=void 0,It=void 0,kt.set(hi()))},En=J=>{At(gt,T=!1,T),n(34,Dt=!1),n(13,Bt=!1),Promise.resolve().then(()=>{if(Oe&&ve){const Xt=Ne||J.detail,jt=i?oi(It*Xt.scalar,s,l):1,se=Ve({elastify:!1,translation:Xt.translation,zoom:jt});kt.set(se)}ve=void 0,It=void 0,ot&&J.detail.isDoubleTap&&Ae(),nn()})};let Zt,Dn=Date.now(),H=0,Wt=!1,z=!1;const Qt=J=>{if(!Ze(J)||(J.preventDefault(),J.stopPropagation(),z))return;clearTimeout(Zt);const Xt=t1(J,{fixScrollDirection:w}),jt=Date.now(),se=jt-Dn;Dn=jt;const Fe=Math.abs(Xt/se)>.2;H=Fe?H+1:0;const ke=1+-1*Xt*bt/(Fe?50:100),be=Ph(J,b,f);ce(be,ke,{isZoomingFast:Fe})},ce=(J,Xt,{isZoomingFast:jt})=>{const se=m?p||y:o?p||1:p||y,Fe=se*Xt,ke=hi(),be=h,mi=m?y:o?1:y,si=Math.abs(Fe-mi),ge=Fe<se,an=se>mi&&ge||se<mi&&Fe>se,we=H>=5;if(jt||(Wt=!1),H>0&&!Wt&&(Wt=an),we&&Wt)return Ae(),z=!0,void setTimeout(()=>{z=!1},100);if(we)return;!jt&&an&&si<=.05&&(Zt=setTimeout(()=>{Ae()},250)),At(Nt,p=oi(Fe,s,l),p);const Ge=Mn(v);Sr(Ge,se),ta(Ge,be);const Le=wn(Ge),Ht=Mn(Ge);Sr(Ht,p-se+1,J);const Pe=wn(Ht),Cn=Bm(Oi(Pe,Le),se);((Un,bi,Pi)=>{Un.x=bi,Un.y=Pi})(ke,be.x+Cn.x,be.y+Cn.y),At(kt,h=ge&&jt?Po(Ue(h),.85):de(ke,se),h),nn()},ye=J=>(J?"add":"remove")+"EventListener";let ue,Yt,Gt,hn;const Xe=J=>{J.preventDefault(),Yt={...h},hn=Mn(v),Gt=Ph(J,b,f),ue=m?p||y:o?p||1:p||y},on=J=>{J.preventDefault(),At(Nt,p=oi(J.scale*ue,s,l),p);const Xt=Mn(hn);Sr(Xt,ue),ta(Xt,Yt);const jt=wn(Xt),se=Mn(Xt);Sr(se,p-ue+1,Gt);const Fe=wn(se),ke=Bm(Oi(Fe,jt),ue),be={x:Yt.x+ke.x,y:Yt.y+ke.y};At(kt,h=de(be,p),h)},xe=J=>{J.preventDefault()},Me=J=>{C[ye(J)]("wheel",Qt),Io()||(C[ye(J)]("gesturestart",Xe),C[ye(J)]("gesturechange",on),C[ye(J)]("gestureend",xe))},Yn=J=>{const Xt=ye(J);C[Xt]("interactionstart",_e),C[Xt]("interactionupdate",Je),C[Xt]("interactionrelease",kn),C[Xt]("interactionend",En)};let Se;return ds(()=>{Se=zs(C,{drag:!0,pinch:!0,inertia:!0,inertiaDurationMultiplier:10,shouldStartInteraction:Ze})}),Ho(()=>{Me(!1),Yn(!1),Se.destroy(),Se=void 0}),t.$$set=J=>{"root"in J&&n(14,C=J.root),"locale"in J&&n(15,F=J.locale),"stores"in J&&n(16,G=J.stores),"allowPan"in J&&n(17,O=J.allowPan),"allowZoom"in J&&n(18,$=J.allowZoom),"enablePan"in J&&n(19,N=J.enablePan),"enableZoom"in J&&n(20,it=J.enableZoom),"enableZoomControls"in J&&n(21,M=J.enableZoomControls),"enableZoomInput"in J&&n(22,W=J.enableZoomInput),"enablePanInput"in J&&n(23,ot=J.enablePanInput),"enablePanLimit"in J&&n(24,at=J.enablePanLimit),"panLimitGutterScalar"in J&&n(25,q=J.panLimitGutterScalar),"zoomOptions"in J&&n(26,ct=J.zoomOptions),"zoomAdjustStep"in J&&n(27,V=J.zoomAdjustStep),"zoomAdjustFactor"in J&&n(28,ut=J.zoomAdjustFactor),"zoomAdjustWheelFactor"in J&&n(29,bt=J.zoomAdjustWheelFactor),"elasticity"in J&&n(30,K=J.elasticity),"imageSelectionRectCentered"in J&&n(31,vt=J.imageSelectionRectCentered),"imageSelectionRectScalar"in J&&n(32,X=J.imageSelectionRectScalar),"zoomLevel"in J&&n(33,Z=J.zoomLevel),"zoomControls"in J&&n(12,mt=J.zoomControls),"zoomMultiTouching"in J&&n(13,Bt=J.zoomMultiTouching)},t.$$.update=()=>{var J,Xt;5505024&t.$$.dirty[0]&&n(36,i=$&&it&&W),655360&t.$$.dirty[0]&&n(35,r=O&&N),393216&t.$$.dirty[0]&&(O||$?(At(Nt,p=it?_.zoom:void 0,p),At(kt,h=N?Ue(_.translation):he()?h:hi(),h),We.set(p)):Ke()),32768&t.$$.dirty[1]&&(o=I>=1),67141632&t.$$.dirty[0]|57344&t.$$.dirty[1]&&n(40,a=[(m||I<1)&&[y,ks(y)+"%",{sublabel:F.labelZoomFit}],...ct.map(jt=>[jt,ks(jt)+"%"])].filter(Boolean).map(jt=>(jt[0]===1&&(jt[2]={sublabel:F.labelZoomActual}),jt)).sort((jt,se)=>{const Fe=jt[0]||y,ke=se[0]||y;return Fe<ke?-1:ke<Fe?1:0})),8704&t.$$.dirty[1]&&n(38,s=Math.min(a.reduce((jt,[se])=>se<jt?se:jt,Number.MAX_SAFE_INTEGER),y)),512&t.$$.dirty[1]&&n(37,l=a.reduce((jt,[se])=>se>jt?se:jt,Number.MIN_SAFE_INTEGER)),4&t.$$.dirty[1]&&Z!==null&&xt(Z),61440&t.$$.dirty[1]&&n(42,d=p||(m||I<1?y:1)),2560&t.$$.dirty[1]&&n(39,(J=a.map(([jt])=>jt),Xt=d,c=J.findIndex(jt=>jt===Xt))),2048&t.$$.dirty[1]&&n(41,u=ks(d)+"%"),405045248&t.$$.dirty[0]|6080&t.$$.dirty[1]&&n(12,mt=($||$)&&M?[["Button","zoom-out",{hideLabel:!0,label:F.labelZoomOut,icon:F.iconZoomOut,disabled:p===s,onclick:()=>xn(jt=>Math.max(s,jt-V)),onhold:()=>xn(jt=>Math.max(s,jt*(1-ut)))}],["Dropdown","zoom-level",{label:u,labelClass:"PinturaFixedWidthCharacters",options:a,selectedIndex:c,onchange:jt=>xt(jt.value)}],["Button","zoom-in",{hideLabel:!0,label:F.labelZoomIn,icon:F.iconZoomIn,disabled:p===l,onclick:()=>xn(jt=>Math.min(l,jt+V)),onhold:()=>xn(jt=>Math.min(l,jt*(1+ut)))}]]:[]),16384&t.$$.dirty[0]|32&t.$$.dirty[1]&&C&&Me(i),16384&t.$$.dirty[0]|16&t.$$.dirty[1]&&C&&Yn(r),8404992&t.$$.dirty[0]|24&t.$$.dirty[1]&&C&&C.style.setProperty("--cursor",r&&ot?Dt?"grabbing":"grab":"")},[st,gt,Jt,le,rt,kt,Nt,$t,Be,nt,Ut,qt,mt,Bt,C,F,G,O,$,N,it,M,W,ot,at,q,ct,V,ut,bt,K,vt,X,Z,Dt,r,i,l,s,c,a,u,d,p,y,m,I]}class R5 extends Tn{constructor(e){super(),Sn(this,e,I5,null,yn,{root:14,locale:15,stores:16,allowPan:17,allowZoom:18,enablePan:19,enableZoom:20,enableZoomControls:21,enableZoomInput:22,enablePanInput:23,enablePanLimit:24,panLimitGutterScalar:25,zoomOptions:26,zoomAdjustStep:27,zoomAdjustFactor:28,zoomAdjustWheelFactor:29,elasticity:30,imageSelectionRectCentered:31,imageSelectionRectScalar:32,zoomLevel:33,zoomControls:12,zoomMultiTouching:13},null,[-1,-1,-1,-1])}}const{window:ll}=a0;function r$(t){let e,n,i,r=t[41]&&o$(t),o=t[38]&&c$(t);return{c(){r&&r.c(),e=pe(),o&&o.c(),n=Ei()},m(a,s){r&&r.m(a,s),tt(a,e,s),o&&o.m(a,s),tt(a,n,s),i=!0},p(a,s){a[41]?r?(r.p(a,s),1024&s[1]&&k(r,1)):(r=o$(a),r.c(),k(r,1),r.m(e.parentNode,e)):r&&(Te(),A(r,1,1,()=>{r=null}),Ce()),a[38]?o?(o.p(a,s),128&s[1]&&k(o,1)):(o=c$(a),o.c(),k(o,1),o.m(n.parentNode,n)):o&&(Te(),A(o,1,1,()=>{o=null}),Ce())},i(a){i||(k(r),k(o),i=!0)},o(a){A(r),A(o),i=!1},d(a){r&&r.d(a),a&&Q(e),o&&o.d(a),a&&Q(n)}}}function o$(t){let e,n,i,r,o,a;const s=[L5,A5],l=[];function c(d,u){return d[39]?0:d[35]?1:-1}return~(i=c(t))&&(r=l[i]=s[i](t)),{c(){e=ft("div"),n=ft("p"),r&&r.c(),S(n,"style",t[72]),S(e,"class","PinturaStatus"),S(e,"style",o="opacity: "+t[54])},m(d,u){tt(d,e,u),Et(e,n),~i&&l[i].m(n,null),a=!0},p(d,u){let p=i;i=c(d),i===p?~i&&l[i].p(d,u):(r&&(Te(),A(l[p],1,1,()=>{l[p]=null}),Ce()),~i?(r=l[i],r?r.p(d,u):(r=l[i]=s[i](d),r.c()),k(r,1),r.m(n,null)):r=null),(!a||1024&u[2])&&S(n,"style",d[72]),(!a||8388608&u[1]&&o!==(o="opacity: "+d[54]))&&S(e,"style",o)},i(d){a||(k(r),a=!0)},o(d){A(r),a=!1},d(d){d&&Q(e),~i&&l[i].d()}}}function A5(t){let e,n,i,r;e=new Q2({props:{text:t[35].text||"",onmeasure:t[221]}});let o=t[35].aside&&a$(t);return{c(){zt(e.$$.fragment),n=pe(),o&&o.c(),i=Ei()},m(a,s){Ft(e,a,s),tt(a,n,s),o&&o.m(a,s),tt(a,i,s),r=!0},p(a,s){const l={};16&s[1]&&(l.text=a[35].text||""),e.$set(l),a[35].aside?o?(o.p(a,s),16&s[1]&&k(o,1)):(o=a$(a),o.c(),k(o,1),o.m(i.parentNode,i)):o&&(Te(),A(o,1,1,()=>{o=null}),Ce())},i(a){r||(k(e.$$.fragment,a),k(o),r=!0)},o(a){A(e.$$.fragment,a),A(o),r=!1},d(a){_t(e,a),a&&Q(n),o&&o.d(a),a&&Q(i)}}}function L5(t){let e,n,i,r;return e=new Q2({props:{text:t[39],onmeasure:t[221]}}),i=new ex({props:{class:"PinturaStatusIcon",offset:t[82],opacity:t[83],$$slots:{default:[_5]},$$scope:{ctx:t}}}),{c(){zt(e.$$.fragment),n=pe(),zt(i.$$.fragment)},m(o,a){Ft(e,o,a),tt(o,n,a),Ft(i,o,a),r=!0},p(o,a){const s={};256&a[1]&&(s.text=o[39]),e.$set(s);const l={};1048576&a[2]&&(l.offset=o[82]),2097152&a[2]&&(l.opacity=o[83]),8&a[0]|32768&a[19]&&(l.$$scope={dirty:a,ctx:o}),i.$set(l)},i(o){r||(k(e.$$.fragment,o),k(i.$$.fragment,o),r=!0)},o(o){A(e.$$.fragment,o),A(i.$$.fragment,o),r=!1},d(o){_t(e,o),o&&Q(n),_t(i,o)}}}function a$(t){let e,n;return e=new ex({props:{class:"PinturaStatusButton",offset:t[82],opacity:t[83],$$slots:{default:[O5]},$$scope:{ctx:t}}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};1048576&r[2]&&(o.offset=i[82]),2097152&r[2]&&(o.opacity=i[83]),16&r[1]|32768&r[19]&&(o.$$scope={dirty:r,ctx:i}),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function s$(t){let e,n;return e=new tx({props:{progress:t[35].progressIndicator.progress}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};16&r[1]&&(o.progress=i[35].progressIndicator.progress),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function l$(t){let e,n;const i=[t[35].closeButton,{hideLabel:!0}];let r={};for(let o=0;o<i.length;o+=1)r=ki(r,i[o]);return e=new Ds({props:r}),{c(){zt(e.$$.fragment)},m(o,a){Ft(e,o,a),n=!0},p(o,a){const s=16&a[1]?Tr(i,[_r(o[35].closeButton),i[1]]):{};e.$set(s)},i(o){n||(k(e.$$.fragment,o),n=!0)},o(o){A(e.$$.fragment,o),n=!1},d(o){_t(e,o)}}}function O5(t){let e,n,i,r=t[35].progressIndicator.visible&&s$(t),o=t[35].closeButton&&t[35].text&&l$(t);return{c(){r&&r.c(),e=pe(),o&&o.c(),n=Ei()},m(a,s){r&&r.m(a,s),tt(a,e,s),o&&o.m(a,s),tt(a,n,s),i=!0},p(a,s){a[35].progressIndicator.visible?r?(r.p(a,s),16&s[1]&&k(r,1)):(r=s$(a),r.c(),k(r,1),r.m(e.parentNode,e)):r&&(Te(),A(r,1,1,()=>{r=null}),Ce()),a[35].closeButton&&a[35].text?o?(o.p(a,s),16&s[1]&&k(o,1)):(o=l$(a),o.c(),k(o,1),o.m(n.parentNode,n)):o&&(Te(),A(o,1,1,()=>{o=null}),Ce())},i(a){i||(k(r),k(o),i=!0)},o(a){A(r),A(o),i=!1},d(a){r&&r.d(a),a&&Q(e),o&&o.d(a),a&&Q(n)}}}function F5(t){let e,n=t[3].iconSupportError+"";return{c(){e=Or("g")},m(i,r){tt(i,e,r),e.innerHTML=n},p(i,r){8&r[0]&&n!==(n=i[3].iconSupportError+"")&&(e.innerHTML=n)},d(i){i&&Q(e)}}}function _5(t){let e,n;return e=new Vo({props:{$$slots:{default:[F5]},$$scope:{ctx:t}}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};8&r[0]|32768&r[19]&&(o.$$scope={dirty:r,ctx:i}),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function c$(t){let e,n,i,r,o,a,s,l,c,d,u,p,h,y,m=t[10]&&d$(t),f=t[46]&&t[45]&&u$(t);const b=[H5,V5],v=[];function w(C,F){return C[46]?0:1}function T(C){t[439](C)}function I(C){t[440](C)}function P(C){t[441](C)}i=w(t),r=v[i]=b[i](t),a=new Cw({props:{isAnimated:t[53],isTransparent:t[20],pixelRatio:t[57],textPixelRatio:t[6],backgroundColor:t[56],maskRect:t[58],maskOpacity:t[73]?t[73].maskOpacity:1,maskMarkupOpacity:t[7],maskFrameOpacity:t[5],clipAnnotationsToImage:t[85],images:t[55],interfaceImages:t[86],loadImageData:t[28],enableGrid:t[11],gridSize:t[87],gridColors:[t[88],t[89]],gridOpacity:t[90],selectionColor:t[91],csp:t[92]||{},willRequest:t[81]||t[93],willRender:t[436],didRender:t[437]}});let _={root:t[2],locale:t[3],stores:t[202],allowPan:t[95],enablePan:t[17],enablePanLimit:t[21],panLimitGutterScalar:t[22],enablePanInput:t[96],allowZoom:t[97],enableZoom:t[18],enableZoomInput:t[19]!==void 0?t[19]:t[98],enableZoomControls:t[99],zoomOptions:t[13]||t[23],zoomAdjustStep:t[14]||t[24],zoomAdjustFactor:t[15]||t[25],zoomAdjustWheelFactor:t[16]||t[26],imageSelectionRectCentered:t[100],imageSelectionRectScalar:t[101],elasticity:Ih*t[8]};return t[0]!==void 0&&(_.zoomLevel=t[0]),t[33]!==void 0&&(_.zoomControls=t[33]),t[34]!==void 0&&(_.zoomMultiTouching=t[34]),d=new R5({props:_}),Nn.push(()=>Ro(d,"zoomLevel",T)),Nn.push(()=>Ro(d,"zoomControls",I)),Nn.push(()=>Ro(d,"zoomMultiTouching",P)),{c(){m&&m.c(),e=pe(),f&&f.c(),n=pe(),r.c(),o=pe(),zt(a.$$.fragment),s=pe(),l=ft("div"),c=pe(),zt(d.$$.fragment),S(l,"class","PinturaRootPortal")},m(C,F){m&&m.m(C,F),tt(C,e,F),f&&f.m(C,F),tt(C,n,F),v[i].m(C,F),tt(C,o,F),Ft(a,C,F),tt(C,s,F),tt(C,l,F),t[438](l),tt(C,c,F),Ft(d,C,F),y=!0},p(C,F){C[10]?m?(m.p(C,F),1024&F[0]&&k(m,1)):(m=d$(C),m.c(),k(m,1),m.m(e.parentNode,e)):m&&(Te(),A(m,1,1,()=>{m=null}),Ce()),C[46]&&C[45]?f?(f.p(C,F),49152&F[1]&&k(f,1)):(f=u$(C),f.c(),k(f,1),f.m(n.parentNode,n)):f&&(Te(),A(f,1,1,()=>{f=null}),Ce());let G=i;i=w(C),i===G?v[i].p(C,F):(Te(),A(v[G],1,1,()=>{v[G]=null}),Ce(),r=v[i],r?r.p(C,F):(r=v[i]=b[i](C),r.c()),k(r,1),r.m(o.parentNode,o));const O={};4194304&F[1]&&(O.isAnimated=C[53]),1048576&F[0]&&(O.isTransparent=C[20]),67108864&F[1]&&(O.pixelRatio=C[57]),64&F[0]&&(O.textPixelRatio=C[6]),33554432&F[1]&&(O.backgroundColor=C[56]),134217728&F[1]&&(O.maskRect=C[58]),2048&F[2]&&(O.maskOpacity=C[73]?C[73].maskOpacity:1),128&F[0]&&(O.maskMarkupOpacity=C[7]),32&F[0]&&(O.maskFrameOpacity=C[5]),8388608&F[2]&&(O.clipAnnotationsToImage=C[85]),16777216&F[1]&&(O.images=C[55]),16777216&F[2]&&(O.interfaceImages=C[86]),268435456&F[0]&&(O.loadImageData=C[28]),2048&F[0]&&(O.enableGrid=C[11]),33554432&F[2]&&(O.gridSize=C[87]),201326592&F[2]&&(O.gridColors=[C[88],C[89]]),268435456&F[2]&&(O.gridOpacity=C[90]),536870912&F[2]&&(O.selectionColor=C[91]),1073741824&F[2]&&(O.csp=C[92]||{}),524288&F[2]|1&F[3]&&(O.willRequest=C[81]||C[93]),512&F[0]|270991424&F[1]|2&F[3]&&(O.willRender=C[436]),62&F[2]&&(O.didRender=C[437]),a.$set(O);const $={};4&F[0]&&($.root=C[2]),8&F[0]&&($.locale=C[3]),4&F[3]&&($.allowPan=C[95]),131072&F[0]&&($.enablePan=C[17]),2097152&F[0]&&($.enablePanLimit=C[21]),4194304&F[0]&&($.panLimitGutterScalar=C[22]),8&F[3]&&($.enablePanInput=C[96]),16&F[3]&&($.allowZoom=C[97]),262144&F[0]&&($.enableZoom=C[18]),524288&F[0]|32&F[3]&&($.enableZoomInput=C[19]!==void 0?C[19]:C[98]),64&F[3]&&($.enableZoomControls=C[99]),8396800&F[0]&&($.zoomOptions=C[13]||C[23]),16793600&F[0]&&($.zoomAdjustStep=C[14]||C[24]),33587200&F[0]&&($.zoomAdjustFactor=C[15]||C[25]),67174400&F[0]&&($.zoomAdjustWheelFactor=C[16]||C[26]),128&F[3]&&($.imageSelectionRectCentered=C[100]),256&F[3]&&($.imageSelectionRectScalar=C[101]),256&F[0]&&($.elasticity=Ih*C[8]),!u&&1&F[0]&&(u=!0,$.zoomLevel=C[0],Wo(()=>u=!1)),!p&&4&F[1]&&(p=!0,$.zoomControls=C[33],Wo(()=>p=!1)),!h&&8&F[1]&&(h=!0,$.zoomMultiTouching=C[34],Wo(()=>h=!1)),d.$set($)},i(C){y||(k(m),k(f),k(r),k(a.$$.fragment,C),k(d.$$.fragment,C),y=!0)},o(C){A(m),A(f),A(r),A(a.$$.fragment,C),A(d.$$.fragment,C),y=!1},d(C){m&&m.d(C),C&&Q(e),f&&f.d(C),C&&Q(n),v[i].d(C),C&&Q(o),_t(a,C),C&&Q(s),C&&Q(l),t[438](null),C&&Q(c),_t(d,C)}}}function d$(t){let e,n,i,r,o;return n=new vo({props:{items:t[69]}}),{c(){e=ft("div"),zt(n.$$.fragment),S(e,"class","PinturaNav PinturaNavTools")},m(a,s){tt(a,e,s),Ft(n,e,null),i=!0,r||(o=[St(e,"measure",t[425]),qn(Cr.call(null,e))],r=!0)},p(a,s){const l={};128&s[2]&&(l.items=a[69]),n.$set(l)},i(a){i||(k(n.$$.fragment,a),i=!0)},o(a){A(n.$$.fragment,a),i=!1},d(a){a&&Q(e),_t(n),r=!1,Zn(o)}}}function u$(t){let e,n,i;return n=new us({props:{elasticity:t[8]*Rh,scrollDirection:t[76]?"y":"x",$$slots:{default:[W5]},$$scope:{ctx:t}}}),{c(){e=ft("div"),zt(n.$$.fragment),S(e,"class","PinturaNav PinturaNavMain")},m(r,o){tt(r,e,o),Ft(n,e,null),i=!0},p(r,o){const a={};256&o[0]&&(a.elasticity=r[8]*Rh),16384&o[2]&&(a.scrollDirection=r[76]?"y":"x"),12288&o[1]|135168&o[2]|32768&o[19]&&(a.$$scope={dirty:o,ctx:r}),n.$set(a)},i(r){i||(k(n.$$.fragment,r),i=!0)},o(r){A(n.$$.fragment,r),i=!1},d(r){r&&Q(e),_t(n)}}}function D5(t){let e,n;const i=[t[79],{tabs:t[44]}];let r={$$slots:{default:[N5,({tab:o})=>({603:o}),({tab:o})=>[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,o?16384:0]]},$$scope:{ctx:t}};for(let o=0;o<i.length;o+=1)r=ki(r,i[o]);return e=new Ju({props:r}),e.$on("select",t[426]),{c(){zt(e.$$.fragment)},m(o,a){Ft(e,o,a),n=!0},p(o,a){const s=8192&a[1]|131072&a[2]?Tr(i,[131072&a[2]&&_r(o[79]),8192&a[1]&&{tabs:o[44]}]):{};49152&a[19]&&(s.$$scope={dirty:a,ctx:o}),e.$set(s)},i(o){n||(k(e.$$.fragment,o),n=!0)},o(o){A(e.$$.fragment,o),n=!1},d(o){_t(e,o)}}}function z5(t){let e,n;return e=new vo({props:{items:t[44]}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};8192&r[1]&&(o.items=i[44]),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function B5(t){let e,n=t[603].icon+"";return{c(){e=Or("g")},m(i,r){tt(i,e,r),e.innerHTML=n},p(i,r){16384&r[19]&&n!==(n=i[603].icon+"")&&(e.innerHTML=n)},d(i){i&&Q(e)}}}function N5(t){let e,n,i,r,o,a=t[603].label+"";return e=new Vo({props:{$$slots:{default:[B5]},$$scope:{ctx:t}}}),{c(){zt(e.$$.fragment),n=pe(),i=ft("span"),r=Mi(a)},m(s,l){Ft(e,s,l),tt(s,n,l),tt(s,i,l),Et(i,r),o=!0},p(s,l){const c={};49152&l[19]&&(c.$$scope={dirty:l,ctx:s}),e.$set(c),(!o||16384&l[19])&&a!==(a=s[603].label+"")&&Yi(r,a)},i(s){o||(k(e.$$.fragment,s),o=!0)},o(s){A(e.$$.fragment,s),o=!1},d(s){_t(e,s),s&&Q(n),s&&Q(i)}}}function W5(t){let e,n,i,r;const o=[z5,D5],a=[];function s(l,c){return l[74]?0:1}return e=s(t),n=a[e]=o[e](t),{c(){n.c(),i=Ei()},m(l,c){a[e].m(l,c),tt(l,i,c),r=!0},p(l,c){let d=e;e=s(l),e===d?a[e].p(l,c):(Te(),A(a[d],1,1,()=>{a[d]=null}),Ce(),n=a[e],n?n.p(l,c):(n=a[e]=o[e](l),n.c()),k(n,1),n.m(i.parentNode,i))},i(l){r||(k(n),r=!0)},o(l){A(n),r=!1},d(l){a[e].d(l),l&&Q(i)}}}function V5(t){let e,n,i;function r(a){t[432](a)}let o={locale:t[3],class:"PinturaMain",view:t[207](t[43]),props:t[206](t[43],t[27]),stores:t[202]};return t[1][t[43]]!==void 0&&(o.component=t[1][t[43]]),e=new Y2({props:o}),Nn.push(()=>Ro(e,"component",r)),e.$on("measure",t[233]),e.$on("show",t[433]),e.$on("hide",t[434]),e.$on("fade",t[435]),{c(){zt(e.$$.fragment)},m(a,s){Ft(e,a,s),i=!0},p(a,s){const l={};8&s[0]&&(l.locale=a[3]),4096&s[1]&&(l.view=a[207](a[43])),134217728&s[0]|4096&s[1]&&(l.props=a[206](a[43],a[27])),!n&&2&s[0]|4096&s[1]&&(n=!0,l.component=a[1][a[43]],Wo(()=>n=!1)),e.$set(l)},i(a){i||(k(e.$$.fragment,a),i=!0)},o(a){A(e.$$.fragment,a),i=!1},d(a){_t(e,a)}}}function H5(t){let e,n;const i=[{class:"PinturaMain"},{visible:t[62]},t[79],{panels:t[78]}];let r={$$slots:{default:[U5,({panel:o,panelIsActive:a})=>({601:o,602:a}),({panel:o,panelIsActive:a})=>[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(o?4096:0)|(a?8192:0)]]},$$scope:{ctx:t}};for(let o=0;o<i.length;o+=1)r=ki(r,i[o]);return e=new Qu({props:r}),e.$on("measure",t[431]),{c(){zt(e.$$.fragment)},m(o,a){Ft(e,o,a),n=!0},p(o,a){const s=196609&a[2]?Tr(i,[i[0],1&a[2]&&{visible:o[62]},131072&a[2]&&_r(o[79]),65536&a[2]&&{panels:o[78]}]):{};134217738&a[0]|45056&a[19]&&(s.$$scope={dirty:a,ctx:o}),e.$set(s)},i(o){n||(k(e.$$.fragment,o),n=!0)},o(o){A(e.$$.fragment,o),n=!1},d(o){_t(e,o)}}}function U5(t){let e,n,i;function r(a){t[427](a,t[601])}let o={locale:t[3],view:t[207](t[601]),props:t[206](t[601],t[27]),isActive:t[602],stores:t[202]};return t[1][t[601]]!==void 0&&(o.component=t[1][t[601]]),e=new Y2({props:o}),Nn.push(()=>Ro(e,"component",r)),e.$on("measure",t[233]),e.$on("show",function(){return t[428](t[601])}),e.$on("hide",function(){return t[429](t[601])}),e.$on("fade",function(...a){return t[430](t[601],...a)}),{c(){zt(e.$$.fragment)},m(a,s){Ft(e,a,s),i=!0},p(a,s){t=a;const l={};8&s[0]&&(l.locale=t[3]),4096&s[19]&&(l.view=t[207](t[601])),134217728&s[0]|4096&s[19]&&(l.props=t[206](t[601],t[27])),8192&s[19]&&(l.isActive=t[602]),!n&&2&s[0]|4096&s[19]&&(n=!0,l.component=t[1][t[601]],Wo(()=>n=!1)),e.$set(l)},i(a){i||(k(e.$$.fragment,a),i=!0)},o(a){A(e.$$.fragment,a),i=!1},d(a){_t(e,a)}}}function p$(t){let e,n;return{c(){e=ft("span"),S(e,"class","PinturaEditorOverlay"),S(e,"style",n="opacity:"+t[102])},m(i,r){tt(i,e,r)},p(i,r){512&r[3]&&n!==(n="opacity:"+i[102])&&S(e,"style",n)},d(i){i&&Q(e)}}}function h$(t){let e,n;const i=[{layout:"row"},{parentRect:t[50]},t[60]];let r={$$slots:{default:[G5]},$$scope:{ctx:t}};for(let o=0;o<i.length;o+=1)r=ki(r,i[o]);return e=new cx({props:r}),{c(){zt(e.$$.fragment)},m(o,a){Ft(e,o,a),n=!0},p(o,a){const s=537395200&a[1]?Tr(i,[i[0],524288&a[1]&&{parentRect:o[50]},536870912&a[1]&&_r(o[60])]):{};1610612736&a[1]|32768&a[19]&&(s.$$scope={dirty:a,ctx:o}),e.$set(s)},i(o){n||(k(e.$$.fragment,o),n=!0)},o(o){A(e.$$.fragment,o),n=!1},d(o){_t(e,o)}}}function G5(t){let e,n,i;return{c(){e=ft("input"),e.value=n=t[60].text,S(e,"placeholder",i=t[60].placeholder),S(e,"type","text"),S(e,"spellcheck","false"),S(e,"autocorrect","off"),S(e,"autocapitalize","off")},m(r,o){tt(r,e,o),t[442](e)},p(r,o){536870912&o[1]&&n!==(n=r[60].text)&&e.value!==n&&(e.value=n),536870912&o[1]&&i!==(i=r[60].placeholder)&&S(e,"placeholder",i)},d(r){r&&Q(e),t[442](null)}}}function j5(t){let e,n,i,r,o,a;hl(t[424]);let s=t[40]&&r$(t),l=t[102]>0&&p$(t),c=t[60]&&h$(t);return{c(){e=ft("div"),s&&s.c(),n=pe(),l&&l.c(),i=pe(),c&&c.c(),S(e,"id",t[4]),S(e,"class",t[77]),S(e,"data-env",t[75]),S(e,"dir",t[12])},m(d,u){tt(d,e,u),s&&s.m(e,null),Et(e,n),l&&l.m(e,null),Et(e,i),c&&c.m(e,null),t[443](e),r=!0,o||(a=[St(ll,"keydown",t[224]),St(ll,"keyup",t[225]),St(ll,"blur",t[226]),St(ll,"paste",t[230]),St(ll,"resize",t[424]),St(e,"ping",function(){Hn(t[68])&&t[68].apply(this,arguments)}),St(e,"contextmenu",t[227]),St(e,"touchstart",t[222],{passive:!1}),St(e,"touchmove",function(){Hn(t[71])&&t[71].apply(this,arguments)}),St(e,"pointermove",function(){Hn(t[70])&&t[70].apply(this,arguments)}),St(e,"transitionend",t[212]),St(e,"dropfiles",t[228]),St(e,"measure",t[444]),St(e,"click",function(){Hn(t[42]?t[229]:ae)&&(t[42]?t[229]:ae).apply(this,arguments)}),qn(Cr.call(null,e,{observeViewRect:!0,isMeasureRoot:!0})),qn(vw.call(null,e)),qn(q2.call(null,e))],o=!0)},p(d,u){(t=d)[40]?s?(s.p(t,u),512&u[1]&&k(s,1)):(s=r$(t),s.c(),k(s,1),s.m(e,n)):s&&(Te(),A(s,1,1,()=>{s=null}),Ce()),t[102]>0?l?l.p(t,u):(l=p$(t),l.c(),l.m(e,i)):l&&(l.d(1),l=null),t[60]?c?(c.p(t,u),536870912&u[1]&&k(c,1)):(c=h$(t),c.c(),k(c,1),c.m(e,null)):c&&(Te(),A(c,1,1,()=>{c=null}),Ce()),(!r||16&u[0])&&S(e,"id",t[4]),(!r||32768&u[2])&&S(e,"class",t[77]),(!r||8192&u[2])&&S(e,"data-env",t[75]),(!r||4096&u[0])&&S(e,"dir",t[12])},i(d){r||(k(s),k(c),r=!0)},o(d){A(s),A(c),r=!1},d(d){d&&Q(e),s&&s.d(),l&&l.d(),c&&c.d(),t[443](null),o=!1,Zn(a)}}}const Ih=1,Rh=10;function Z5(t,e,n){let i,r,o,a,s,l,c,d,u,p,h,y,m,f,b,v,w,T,I,P,_,C,F,G,O,$,N,it,M,W,ot,at,q,ct,V,ut,bt,K,vt,X,Z,mt,Bt,st,gt,Jt,le,rt,kt,Nt,$t,Be,nt,Ut,qt,Dt,ve,It,Ie,lt,Ze,nn,he,Ke,Ae,We,xn,xt,de,Ve,Oe,Ne,_e,Je,kn,En,Zt,Dn,H,Wt,z,Qt,ce,ye,ue,Yt,Gt,hn,Xe,on,xe,Me,Yn,Se,J,Xt,jt,se,Fe,ke,be,mi,si,ge,an,we,Ge,Le,Ht,Pe,Cn,Un,bi,Pi,Hi,Xn,Ui,yr,gr,Mr,Uo,li,uo,ii,ui,un,rr,Jr,Ao,po,Lo,Dr,Gi,ci,jr,Qr,zr,Zr,xr,to,kr,Br,eo,Nr,wo,ho,Er,Pr,Ir,Wr,ji,An,Wi,Fi,gi,Ii,Ki,Go,ca,mo,_i,Di,Oo,no,zi,fr,Bi,Ji,Xr,go,io,L,ee,sn,je,re,ie,bn,Kt,ai,zn,Pn,br,Qi,fo,da,wa,R,te,Re,$n,In,Ln,He,pn,On,mn,Gn,Ri,$i,vi,Rn,vr,jo,Ns,Ha,Ua,Sa,Ga,ps,ja,ua,Za,xi,ro=tn,oo=tn;D(t,xw,g=>n(412,je=g)),t.$$.on_destroy.push(()=>ro()),t.$$.on_destroy.push(()=>oo());const Rr=za(),Qn=la();let{class:So}=e,{layout:Ta}=e,{stores:qr}=e,{locale:ti}=e,{id:nd}=e,{util:hs}=e,{utils:Kl}=e,{animations:ms="auto"}=e,{disabled:Ws=!1}=e,{status:To}=e,{previewUpscale:$l=!1}=e,{previewPad:Jl=!1}=e,{previewMaskOpacity:id=.95}=e,{previewImageDataMaxSize:yl}=e,{previewImageTextPixelRatio:Ql}=e,{markupMaskOpacity:xl=1}=e,{zoomMaskOpacity:gs=.85}=e,{elasticityMultiplier:Xa=10}=e,{willRevert:tc=()=>Promise.resolve(!0)}=e,{willProcessImage:Vs=()=>Promise.resolve(!0)}=e,{willRenderCanvas:bl=ni}=e,{willRenderToolbar:qa=ni}=e,{willRenderUtilTabs:vl=ni}=e,{willSetHistoryInitialState:Ya=ni}=e,{enableButtonExport:x=!0}=e,{enableButtonRevert:B=!0}=e,{enableNavigateHistory:E=!0}=e,{enableToolbar:Y=!0}=e,{enableUtils:et=!0}=e,{enableButtonClose:Tt=!1}=e,{enableDropImage:Ct=!1}=e,{enablePasteImage:Pt=!1}=e,{enableBrowseImage:Mt=!1}=e,{enableTransparencyGrid:Rt=!1}=e,{layoutDirectionPreference:Lt="auto"}=e,{layoutHorizontalUtilsPreference:Vt="left"}=e,{layoutVerticalUtilsPreference:qe="bottom"}=e,{layoutVerticalToolbarPreference:oe="top"}=e,{layoutVerticalControlGroupsPreference:ne="bottom"}=e,{layoutVerticalControlTabsPreference:fe="bottom"}=e,{textDirection:$e}=e,{markupEditorZoomLevel:De=null}=e,{markupEditorZoomLevels:Ye}=e,{markupEditorZoomAdjustStep:vn}=e,{markupEditorZoomAdjustFactor:ln}=e,{markupEditorZoomAdjustWheelFactor:Fn}=e,{markupEditorInteractionMode:pi=!1}=e,{muteAudio:Wn=!0}=e,{willSetMediaInitialTimeOffset:_n=(g,j)=>g*P5(j[0])}=e,{enablePan:wi=!0}=e,{enableZoom:ri=!0}=e,{enableZoomControls:Zi=!0}=e,{enableZoomInput:di}=e,{enablePanInput:Vr}=e,{enableCanvasAlpha:Ar=!1}=e,{enablePanLimit:ao}=e,{panLimitGutterScalar:Ka}=e,{pan:pa=null}=e,{zoomPresetOptions:Hs=[.25,.5,1,1.25,1.5,2,3,4,6,8,16]}=e,{zoomAdjustStep:Us=.25}=e,{zoomAdjustFactor:Ca=.1}=e,{zoomAdjustWheelFactor:Zo=1}=e,{zoomLevel:Hr=null}=e,{fixScrollDirection:Ma=!1}=e;const ka=me(Ma);let Ea,Co;$o("fixScrollDirection",ka);let{imagePreviewSrc:Pa}=e,{imageOrienter:Ia={read:()=>1,apply:g=>g}}=e,{pluginComponents:ha}=e,{pluginOptions:Ra={}}=e;const Ja=Rr.sub,wr={};let{root:jn}=e;const Xo=()=>{be.setAttribute("data-redraw","true"),js.set({})},o1=me(!0);D(t,o1,g=>n(477,Uo=g));const ec=me(void 0);D(t,ec,g=>n(422,In=g));const Qa=me(0);D(t,Qa,g=>n(419,te=g));const P0=me(!1),rd=g=>{P0.set(g.type==="play"),Rr.pub(g.type)};let I0,a1,R0,s1,l1=!1;const c1=()=>{if(!o||!wl())return;s1=u,At(ec,In=void 0,In);const g=be;l1=!1;const j=1/24,ht=ts();(Math.abs(c*ht-te*ht)<=j||ht-ht*te<=j)&&At(Qa,te=l,te),od(te*ts()),g.play().catch(()=>{});let wt=ic();const dt=()=>{if(wl())return;R0=requestAnimationFrame(dt);let yt=ic();yt-wt<=0&&(yt=wt+.01),wt=yt,At(Qa,te=yt/ts(),te),s1>=0&&te>=c&&(At(Qa,te=c,te),Gs()),u>-1&&(l1=!0),l1&&u===-1&&p>0&&(At(Qa,te=s[p][0],te),od(te*ts())),At(sd,fo=te*ts(),fo),Xo()};dt()},Gs=()=>{o&&!wl()&&(At(ec,In=void 0,In),s1=void 0,be.pause(),cancelAnimationFrame(R0),Xo())},wl=()=>be&&be.paused,d1=()=>{if(o)return wl()?c1():Gs()},u1=()=>{o&&(be.muted=!0)},p1=()=>{o&&(be.muted=!1)},A0=()=>{o&&At(nc,$n=!$n,$n)},nc=me(Wn);D(t,nc,g=>n(421,$n=g));const ts=()=>{if(o)return be.duration},ic=()=>{if(o)return be.currentTime},od=g=>{o&&(Jf(be,g),At(Qa,te=g/Re,te))},js=me({});D(t,js,g=>n(52,ii=g)),$o("redrawTrigger",js);const ad=me(Xa);D(t,ad,g=>n(494,wa=g)),$o("elasticityMultiplier",ad);let rc=[];const h1=fn();D(t,h1,g=>n(102,xi=g));const L0=h0()||1024,O0=sr(L0,L0),F0=F2(),Ax=g=>Promise.resolve(da&&da(g,{resourceType:"image"})).then(j=>{if(j===!1)return;const{headers:ht,credentials:wt}=j||{};return fetch(g,{headers:ht,credentials:wt}).then(dt=>{if(dt.status!==200)throw`${dt.status} (${dt.statusText})`;return dt.blob()}).then(dt=>e$(dt,Ia,F0)).then(dt=>n$(dt,m))});let{imageSourceToImageData:m1=g=>Qe(g)?Ax(g):Zc(g)?new Promise(j=>j(Qc(g))):Xh(g)||td(g)?e$(g,Ia,F0).then(j=>n$(j,m)):void 0}=e;const g1=(()=>{let g,j;const ht=Qf.reduce((wt,dt)=>(wt[dt]=function(yt,Ot,ze){let cn=[];return{set:Ot,update:ze,publish:Bn=>{cn.forEach(Kn=>Kn(Bn))},subscribe:Bn=>(cn.push(Bn),yt(Bn),()=>{cn=cn.filter(Kn=>Kn!==Bn)})}}(yt=>{if(!j)return yt();j.stores[dt].subscribe(yt)()},yt=>{j&&j.stores[dt].set(yt)},yt=>{j&&j.stores[dt].update(yt)}),wt),{});return{update:wt=>{if(j=wt,g&&(g.forEach(dt=>dt()),g=void 0),!wt)return ht.file.publish(void 0),void ht.loadState.publish(void 0);g=Qf.map(dt=>wt.stores[dt].subscribe(yt=>{ht[dt].publish(yt)}))},stores:ht,destroy:()=>{g&&g.forEach(wt=>wt())}}})(),{file:f1,size:Zs,duration:$1,currentTime:sd,trim:y1,volume:_0,minDuration:Lx,maxDuration:x1,loadState:ld,processState:b1,cropAspectRatio:cd,cropLimitToImage:v1,crop:ma,cropMinSize:Ox,cropMaxSize:Fx,cropRange:_x,cropOrigin:Dx,cropRectAspectRatio:zx,rotation:Sl,rotationRange:Bx,targetSize:Nx,flipX:dd,flipY:ud,backgroundColor:pd,backgroundImage:D0,colorMatrix:z0,convolutionMatrix:B0,gamma:N0,vignette:W0,noise:V0,decoration:hd,annotation:md,manipulation:gd,redaction:fd,frame:Xs,selection:w1,state:$d}=g1.stores;D(t,f1,g=>n(396,Nr=g)),D(t,Zs,g=>n(369,ge=g)),D(t,$1,g=>n(420,Re=g)),D(t,sd,g=>n(493,fo=g)),D(t,y1,g=>n(417,Qi=g)),D(t,_0,g=>n(418,R=g)),D(t,x1,g=>n(423,Ln=g)),D(t,ld,g=>n(388,ci=g)),D(t,b1,g=>n(387,Gi=g)),D(t,cd,g=>n(490,ie=g)),D(t,v1,g=>n(85,mn=g)),D(t,ma,g=>n(407,Di=g)),D(t,Sl,g=>n(372,Ge=g)),D(t,dd,g=>n(371,we=g)),D(t,ud,g=>n(370,an=g)),D(t,pd,g=>n(378,yr=g)),D(t,hd,g=>n(48,si=g)),D(t,md,g=>n(49,Le=g)),D(t,gd,g=>n(375,Hi=g)),D(t,fd,g=>n(376,Xn=g)),D(t,Xs,g=>n(47,mi=g)),D(t,w1,g=>n(59,zn=g)),D(t,$d,g=>n(479,Er=g)),$o("components",{DynamicComponentTree:vo}),$o("previewcontrols",{play:c1,pause:Gs,togglePlayPause:d1,mute:u1,unmute:p1,toggleMute:A0,setCurrentTime:od,getCurrentTime:ic,getDuration:ts,frameOffset:Qa,framePeekOffset:ec,isPlaying:P0,isMuted:nc});const H0=(g,j,ht=0)=>new Promise((wt,dt)=>{if(c0(g))return void z2(g).then(cn=>{const Bn=dn(fo)?fo:_n(cn.duration,Qi||[[0,1]]);B2(cn,Bn).then(wt)});let yt,Ot=!1;j.cancel=()=>Ot=!0;const ze=Date.now();m1(g).then(cn=>{const Bn=Date.now()-ze;clearTimeout(yt),yt=setTimeout(()=>{Ot||wt(cn)},Math.max(0,ht-Bn))}).catch(dt)}),{images:U0,shapePreprocessor:G0,imageScrambler:j0,imageRedactionRendering:Z0,willRequest:X0,willRequestResource:q0,csp:Y0}=qr;let oc;D(t,U0,g=>n(416,br=g)),D(t,G0,g=>n(415,Pn=g)),D(t,j0,g=>n(379,gr=g)),D(t,Z0,g=>n(377,Ui=g)),D(t,X0,g=>n(81,da=g)),D(t,q0,g=>n(93,Ns=g)),D(t,Y0,g=>n(92,jo=g));const Wx=Vn(D0,(g,j)=>{if(!g)return j(void 0);oc&&(oc.cancel(),oc=void 0),oc={cancel:ae},H0(g,oc).then(j).catch(ht=>{})}),Vx=$d.subscribe(g=>Rr.pub("update",g)),Hx=me();$o("ui",me({})),$o("selection",w1);const S1=me(!0);D(t,S1,g=>n(95,Ua=g));const T1=me(!0);D(t,T1,g=>n(97,Ga=g));const C1=me(!0);D(t,C1,g=>n(414,ai=g));const yd=me(!0);D(t,yd,g=>n(491,bn=g));const M1=me(!0);D(t,M1,g=>n(98,ps=g));const k1=me();D(t,k1,g=>n(99,ja=g));const xd=me();D(t,xd,g=>n(492,Kt=g));const E1=Vn([xd,yd],()=>Kt!==void 0?Kt:bn);D(t,E1,g=>n(96,Sa=g));const ac=me([0,0,0]);D(t,ac,g=>n(56,An=g));const bd=me([1,1,1]);D(t,bd,g=>n(475,Pi=g));const sc=fn([1,1,1]);D(t,sc,g=>n(474,bi=g));const P1=me();D(t,P1,g=>n(91,vr=g));const K0=me(),I1=me();D(t,I1,g=>n(51,li=g));const Tl=me();D(t,Tl,g=>n(373,Pe=g));const Cl=me(Cs());D(t,Cl,g=>n(80,Pr=g));const R1=me(0);D(t,R1,g=>n(413,re=g));const lc=me(Cs());D(t,lc,g=>n(84,On=g));const qs=me();D(t,qs,g=>n(472,ke=g));const vd=t$("(pointer: fine)",g=>g?"pointer-fine":"pointer-coarse");D(t,vd,g=>n(394,Br=g));const wd=t$("(hover: hover)",g=>g?"pointer-hover":"pointer-no-hover");D(t,wd,g=>n(393,kr=g));const J0=me(!1),cc=me(!1);D(t,cc,g=>n(374,Un=g));const A1=zl(void 0,g=>{const j=fn(0),ht=[cc.subscribe(wt=>{j.set(wt?1:0,{hard:!un})}),j.subscribe(g)];return()=>ht.forEach(wt=>wt())});D(t,A1,g=>n(473,Cn=g));const Sd=me();D(t,Sd,g=>n(478,Zr=g));const Td=me();let L1;D(t,Td,g=>n(53,un=g)),$o("isAnimated",Td);const Cd=me($l);D(t,Cd,g=>n(397,wo=g));const Ys=me(!1);D(t,Ys,g=>n(484,zi=g)),$o("imageIsStatic",Ys);const dc=me();D(t,dc,g=>n(485,fr=g));const O1=me();D(t,O1,g=>n(482,Oo=g));const Q0=zl(void 0,g=>{const j=me(void 0),ht=[ma.subscribe(()=>{if(!Di)return;if(zi)return j.set(Mn(Di));const wt=sf(Di,Oo,5*Xa);j.set(wt)}),j.subscribe(g)];return()=>ht.forEach(wt=>wt())}),qo=me();D(t,qo,g=>n(481,_i=g));const Md=me();D(t,Md,g=>n(483,no=g));const F1=me(void 0);D(t,F1,g=>n(488,L=g));const tm=me(hi());D(t,tm,g=>n(489,ee=g));const em=(g,j)=>{if(!j||!g)return{top:0,right:0,bottom:0,left:0};const ht=a2(j,g,f),wt=o2(ht,g);return{top:Math.abs(wt.top),right:Math.abs(wt.right),bottom:Math.abs(wt.bottom),left:Math.abs(wt.left)}},nm=me({}),_1=Vn([qs,Cl,lc,nm],([g,j,ht,wt],dt)=>{if(!g)return dt(void 0);let yt=0;W.length!==1||h||oe==="bottom"||(yt=ht.y+ht.height),dt(Ci(g.x+j.x,g.y+j.y+yt,g.width,g.height))});let uc={left:0,right:0,top:0,bottom:0};const kd=me(!1),Ml=Vn([kd,Xs,_1,cc],([g,j,ht,wt],dt)=>{if(!ht)return dt({left:0,right:0,top:0,bottom:0});if(!g)return;const yt=Math.min(ht.width,ht.height),Ot=em({width:yt,height:yt},j);en(uc.top,4)===en(Ot.top,4)&&en(uc.bottom,4)===en(Ot.bottom,4)&&en(uc.right,4)===en(Ot.right,4)&&en(uc.left,4)===en(Ot.left,4)||(uc=Ot,dt(Ot))});D(t,Ml,g=>n(405,Go=g));const kl=Vn([kd,Ml],([g,j],ht)=>{if(!g)return ht(!1);ht(Object.values(j).some(wt=>wt>0))});D(t,kl,g=>n(406,ca=g));const Ux=Vn([kd,qs,kl,Ml],([g,j,ht,wt],dt)=>{if(j)return g&&ht?void dt(Ci(j.x+wt.left,j.y+wt.top,j.width-wt.left-wt.right,j.height-wt.top-wt.bottom)):dt({...j})}),Aa=Vn([_1,kl,Ml],([g,j,ht],wt)=>g?j?void wt(Ci(g.x+ht.left,g.y+ht.top,g.width-ht.left-ht.right,g.height-ht.top-ht.bottom)):wt(g):wt(void 0));D(t,Aa,g=>n(50,Ht=g));const Gx=Vn([Ys,Zs,Sl],([g,j,ht],wt)=>{if(!g||!j)return wt(void 0);const dt=Fr(j);wt($r(dt,ht))}),D1=Vn([Gx],([g],j)=>{if(!g)return j(void 0);const ht=Vi(g);j(jc(ht))});D(t,D1,g=>n(409,Xr=g));const es=Vn([Aa,ma,D1,Cd],([g,j,ht,wt],dt)=>{if(!g||!j||!(!fr&&!Oo))return;const{width:yt,height:Ot}=ht||j,ze=Math.min(g.width/yt,g.height/Ot);dt(wt?ze:Math.min(1,ze))});D(t,es,g=>n(408,Ji=g)),$o("imageStaticVisualCorners",Vn([Ys,Zs,Sl,Aa,qs,es],([g,j,ht,wt,dt,yt],Ot)=>{if(!(g&&wt&&dt&&j))return Ot(void 0);const ze=Fr(j),cn=jc(Sr(ze,yt)),Bn=xu(wt,cn);cn.x=Bn.x,cn.y=Bn.y,Ot($r(cn,ht))}));const El=me(void 0);D(t,El,g=>n(411,sn=g));const im=Vn([ma,Aa],([g,j])=>{if(j&&g)return Math.min(j.width/g.width,j.height/g.height)}),z1=Vn([ma,qo],([g,j])=>g&&j?Math.min(g.width/j.width,g.height/j.height):1);D(t,z1,g=>n(101,Za=g));const pc=Vn([El,z1],([g,j])=>g&&j?j*g:1);D(t,pc,g=>n(487,go=g));const Ks=me(hi());D(t,Ks,g=>n(410,io=g));const rm=me({scalar:go,translation:io}),om=()=>{rm.set({scalar:void 0,translation:hi()})},Ed=zl(void 0,g=>{const j=fn(void 0,{precision:1e-4}),ht=Oc()===1?yt=>Bo(yt,Math.round):ni,wt=()=>{if(!_i)return;const yt=Un||!Zr;if(zi){const ze=Mn(_i);return ta(ze,ee),ta(ze,Ht),j.set(ze,{hard:yt})}const Ot=sf(_i,L,Ih*Xa);Ot.width<0&&(Ot.width=0,Ot.x=_i.x),Ot.height<0&&(Ot.height=0,Ot.y=_i.y),ta(Ot,Ht),ta(Ot,io),Sr(Ot,go),!yt&&ht(Ot),j.set(Ot,{hard:yt})},dt=[Aa.subscribe(wt),qo.subscribe(wt),pc.subscribe(wt),Ks.subscribe(wt),Xs.subscribe(wt),j.subscribe(g)];return()=>dt.forEach(yt=>yt())});D(t,Ed,g=>n(58,Ki=g));const B1=me(1);D(t,B1,g=>n(480,mo=g));const N1=()=>{if(!Di||!Ht)return;let g=Ms(Mn(Di),Ji||1);const j=xu(Ht,Ms(Mn(Xr),Ji));ta(g,j);const ht=ke.width/g.width,wt=ke.height/g.height,dt=Math.min(1,ht,wt);B1.set(dt),Sr(g,dt),((yt,Ot)=>{const[ze,cn,Bn,Kn]=pl(yt);ze<Ot.y&&(yt.y=Math.max(Ot.y,yt.y)),cn>Ot.width&&(yt.x=Ot.width-yt.width),Bn>Ot.height&&(yt.y=Ot.height-yt.height),Kn<Ot.x&&(yt.x=Math.max(Ot.x,yt.x))})(g,{...ke,x:0,y:0}),qo.set(g)},am=Vn([Aa,es,ma,Zs],([g,j,ht,wt],dt)=>{g&&(ht||wt)&&dt(sm(g,j||1,ht||wt))});D(t,am,g=>n(100,ua=g));const sm=(g,j,ht)=>ht.width<=g.width&&ht.height<=g.height?xu(g,Ms(Mn(ht),j)):Kr(g,lr(ht));let W1,lm;const V1=g=>{if(h&&W1&&ea(W1,g)&&lm===Ji)return;if(zi)return N1();W1=g,lm=Ji;const j=sm(g,Ji,Di||ge);qo.set(j)};let cm=!1;const jx=es.subscribe(g=>{!cm&&g!==void 0&&Di&&(V1(Ht),cm=!0)}),Zx=Aa.subscribe(g=>{g&&Ji!==void 0&&Di&&V1(g)}),Xx=Ys.subscribe(g=>{!g&&Ht&&V1(Ht)});let H1;const qx=Md.subscribe(g=>{if(!g)return H1=void 0,void At(dc,fr=void 0,fr);H1=Bi;const j=Mn(Di);dc.set(j)}),Yx=qo.subscribe(g=>{if(!g||!no)return;const j=(ht=Mn(g),wt=no,ht.x-=wt.x,ht.y-=wt.y,ht.width-=wt.width,ht.height-=wt.height,ht);var ht,wt;((yt,Ot)=>{yt.x/=Ot,yt.y/=Ot,yt.width/=Ot,yt.height/=Ot})(j,H1);const dt=((yt,Ot)=>(yt.x+=Ot.x,yt.y+=Ot.y,yt.width+=Ot.width,yt.height+=Ot.height,yt))(Mn(fr),j);ma.set(dt)}),Kx=ma.subscribe(g=>{if(!g||!_i)return;if(zi)return void(no||N1());if(Un||no||Oo)return;const j=lr(_i),ht=lr(g);if(en(j,6)===en(ht,6))return;const{width:wt,height:dt}=Di,yt=Math.min(Ht.width/wt,Ht.height/dt),Ot=sr(g.width*yt,g.height*yt),ze=.5*(_i.width-Ot.width),cn=.5*(_i.height-Ot.height),Bn=Ci(Math.max(0,Math.min(Ht.width-Ot.width,_i.x+ze)),Math.max(0,Math.min(Ht.height-Ot.height,_i.y+cn)),Ot.width,Ot.height);qo.set(Bn)}),dm=Vn([es,ma,qo,Ys],([g,j,ht,wt],dt)=>{if(!g||!j||!ht)return;if(wt)return dt(mo);const yt=ht.width/j.width,Ot=ht.height/j.height;dt(Math.max(yt,Ot)/g)}),Pd=Vn([es,dm],([g,j],ht)=>{j&&ht(g*j)});D(t,Pd,g=>n(486,Bi=g));let Pl={left:0,right:0,top:0,bottom:0};const um=Vn([Xs,qo],([g,j],ht)=>{if(!j)return ht(Pl);const wt=em(j,g);en(Pl.top,4)===en(wt.top,4)&&en(Pl.bottom,4)===en(wt.bottom,4)&&en(Pl.right,4)===en(wt.right,4)&&en(Pl.left,4)===en(wt.left,4)||(Pl=wt,ht(wt))}),Jx=Vn([um],([g],j)=>{j(Object.values(g).some(ht=>ht>0))}),U1=fn(.075,{stiffness:.03,damping:.4,precision:.001}),Qx=Vn([sc,ac,U1,Ed,pc,Xs,Jx,um,kl],([g,j,ht,wt,dt,yt,Ot,ze,cn],Bn)=>{if(!wt||h)return Bn([]);let{x:Kn,y:gn,width:Xi,height:ei}=wt;Kn+=.5,gn+=.5,Xi-=.5,ei-=.5;const or=[];if(yt){if(Ot){let{left:Jn,right:Ko,top:tl,bottom:Rl}=ze;Jn*=dt,Ko*=dt,tl*=dt,Rl*=dt;const $p=Qp(j)?[1,1,1,.125]:[0,0,0,.075];or.push({x:Kn-Jn-.5,y:gn-tl-.5,width:Xi+Jn+Ko+1,height:ei+tl+Rl+1,strokeWidth:1,strokeColor:$p,opacity:cn?1:.5})}const Fo=Qp(g);yt&&yt.frameColor&&Qp(yt.frameColor)||Fo||(or.push({x:Kn-1,y:gn-1,width:Xi+2,height:ei+2,strokeWidth:2,strokeColor:[0,0,0,.1],opacity:ht}),or.push({x:Kn+1,y:gn+1,width:Xi-2,height:ei-2,strokeWidth:2,strokeColor:[0,0,0,.1],opacity:ht}))}Bn([...or,{x:Kn,y:gn,width:Xi,height:ei,strokeWidth:1,strokeColor:g,opacity:ht}])}),hc=me([]);D(t,hc,g=>n(399,Ir=g));const pm=Vn([Qx,hc],([g,j],ht)=>{ht([...g,...j])});D(t,pm,g=>n(94,Ha=g));const G1=fn(0,{precision:.001});D(t,G1,g=>n(401,ji=g));const j1=fn();D(t,j1,g=>n(404,gi=g));const Z1=fn();D(t,Z1,g=>n(403,Fi=g));const X1=fn();D(t,X1,g=>n(402,Wi=g));const q1=fn();D(t,q1,g=>n(400,Wr=g));const mc=me(!1);D(t,mc,g=>n(386,Dr=g));const gc=me();let fs;D(t,gc,g=>n(389,jr=g));const Y1=Vn([mc,gc],([g,j],ht)=>{if(!g||!j)return void ht(void 0);if(fs&&(fs.cancel(),n(292,fs=void 0)),ed(j))return ht(Sy(j));const wt=Yo.length?0:un?250:0;n(292,fs={cancel:ae}),H0(j,fs,wt).then(ht).catch(dt=>{At(ld,ci.error=dt,ci)}).finally(()=>{n(292,fs=void 0)})});ro(),ro=xo(Y1,g=>n(368,be=g));let{imagePreviewCurrent:fc}=e;const K1=me({});D(t,K1,g=>n(391,xr=g));const Id=me([]);D(t,Id,g=>n(86,Gn=g));const Rd=Vn([Aa,Tl,Zs,Q0,qo,Pd,Sl,dd,ud,pc,Ks,J0],([g,j,ht,wt,dt,yt,Ot,ze,cn,Bn,Kn,gn],Xi)=>{if(!g||!dt)return;const ei=aw(g,j,ht,wt,dt,Bn,Kn,yt,Ot,ze,cn);!gn&&$(ei),Xi(ei)});D(t,Rd,g=>n(392,to=g));const hm=Vn([z0,B0,N0,W0,V0],([g,j,ht,wt,dt],yt)=>{const Ot=g&&Object.keys(g).map(ze=>g[ze]).filter(Boolean);yt({gamma:ht||void 0,vignette:wt||void 0,noise:dt||void 0,convolutionMatrix:j||void 0,colorMatrix:Ot&&Ot.length&&i0(Ot)})});let Ad,J1;const mm=(()=>{if(!Io())return!1;const g=navigator.userAgent.match(/OS (\d+)_(\d+)_?(\d+)?/i)||[],[,j,ht]=g.map(wt=>parseInt(wt,10)||0);return j>13||j===13&&ht>=4})(),$c=me({});D(t,$c,g=>n(380,uo=g)),$o("env",$c);const gm=Oc(),Q1=zl(gm,g=>{const j=()=>g(Oc()),ht=matchMedia(`(resolution: ${gm}dppx)`);return ht.addListener(j),()=>ht.removeListener(j)});D(t,Q1,g=>n(57,Ii=g));const La=((g,j,ht)=>{const{sub:wt,pub:dt}=za(),{willUndo:yt=()=>!0}=ht||{},Ot=[],ze=me(0),cn=[],Bn=()=>cn.forEach(gn=>gn({index:xa(ze),length:Ot.length})),Kn={get index(){return xa(ze)},set index(gn){gn=Number.isInteger(gn)?gn:0,gn=oi(gn,0,Ot.length-1),ze.set(gn),j(Ot[Kn.index]),Bn()},get state(){return Ot[Ot.length-1]},length:()=>Ot.length,undo(){if(yt()===!1)return;const gn=Kn.index--;return dt("undo",gn),gn},redo(){const gn=Kn.index++;return dt("redo",Kn.index),gn},revert(){Ot.length=1,Kn.index=0,dt("revert")},write(gn){gn&&j({...g(),...gn});const Xi=g(),ei=Ot[Ot.length-1];JSON.stringify(Xi)!==JSON.stringify(ei)&&(Ot.length=Kn.index+1,Ot.push(Xi),ze.set(Ot.length-1),Bn(),dt("writehistory"))},set(gn={}){Ot.length=0,Kn.index=0;const Xi=Array.isArray(gn)?gn:[gn];Ot.push(...Xi),Kn.index=Ot.length-1},get:()=>[...Ot],subscribe:gn=>(cn.push(gn),gn({index:Kn.index,length:Ot.length}),()=>cn.splice(cn.indexOf(gn),1)),on:wt};return Kn})(()=>Er,g=>{At($d,Er=g,Er),Cl.set(Pr)},{willUndo:()=>!rb()||(ib(),!1)});oo(),oo=xo(La,g=>n(398,ho=g));const fm=()=>{const g={x:0,y:0,...ge},j=Bo(Kr(g,Er.cropAspectRatio),Math.round),ht=Ya({...Er,rotation:0,crop:j},Er),wt=[ht];JSON.stringify(ht)!==JSON.stringify(Er)&&wt.push({...Er}),La.set(wt)},tb=ld.subscribe(g=>{g&&g.complete&&fm()}),eb=()=>tc().then(g=>g&&La.revert()),nb=[md,hd,fd,gd],ib=()=>{nb.forEach(g=>{g.update(j=>j.length&&lo(j[j.length-1])?j.slice(0,-1):j)})},rb=()=>M.filter(g=>g.length).some(g=>lo(g[g.length-1])),$s=me(!1);D(t,$s,g=>n(381,ui=g));const ob=()=>{At($s,ui=!0,ui),Vs().then(g=>{if(!g)return void At($s,ui=!1,ui);let j;j=xc.subscribe(ht=>{ht===1&&(j&&j(),Qn("processImage"))})})},ab=b1.subscribe(g=>{if(!g)return void At($s,ui=!1,ui);At($s,ui=!0,ui);const{complete:j,abort:ht}=g;(j||ht)&&At($s,ui=!1,ui)}),Yo=E5();D(t,Yo,g=>n(55,Qr=g));const sb=Vn([Yo],([g],j)=>{if(!g.length)return j();const{origin:ht,translation:wt,rotation:dt,scale:yt}=g[0];j({origin:ht,translation:wt,rotation:dt,scale:yt})}),Ld=me();D(t,Ld,g=>n(395,eo=g));let Od,Fd=[];const $m=me(),tp=me(),lb=Vn([El,tp,es,im],([g,j,ht,wt])=>g||(j||ht<1?wt:1)),ym={...qr,imageFile:f1,imageSize:Zs,mediaDuration:$1,mediaMinDuration:Lx,mediaMaxDuration:x1,mediaTrim:y1,imageBackgroundColor:pd,imageBackgroundImage:D0,imageCropAspectRatio:cd,imageCropMinSize:Ox,imageCropMaxSize:Fx,imageCropLimitToImage:v1,imageCropRect:ma,imageCropRectOrigin:Dx,imageCropRectSnapshot:dc,imageCropRectAspectRatio:zx,imageCropRange:_x,imageRotation:Sl,imageRotationRange:Bx,imageFlipX:dd,imageFlipY:ud,imageOutputSize:Nx,imageColorMatrix:z0,imageConvolutionMatrix:B0,imageGamma:N0,imageVignette:W0,imageNoise:V0,imageManipulation:gd,imageDecoration:hd,imageAnnotation:md,imageRedaction:fd,imageFrame:Xs,imagePreview:Y1,imagePreviewSource:gc,imageTransforms:Rd,imagePreviewModifiers:K1,history:La,animation:Sd,pixelRatio:Q1,elasticityMultiplier:Xa,scrollElasticity:Rh,rangeInputElasticity:5,redrawTrigger:js,pointerAccuracy:vd,pointerHoverable:wd,env:$c,rootRect:Tl,stageRect:Aa,stageRectBase:_1,stageRecenter:nm,stageScalar:es,stagePadding:Ml,stagePadded:kl,presentationScalar:Pd,imagePreviewUpscale:tp,utilRect:qs,utilRectPadded:Ux,allowPlayPause:o1,allowPan:S1,allowZoom:T1,allowZoomControls:C1,enableZoomInput:M1,enablePanInput:yd,enablePanInputStatus:E1,imageSelectionMultiTouching:$m,rootBackgroundColor:ac,rootForegroundColor:bd,rootLineColor:sc,rootColorSecondary:K0,imageOutlineOpacity:U1,utilTools:Ld,imageSelectionPan:Ks,imageSelectionZoom:El,imageSelectionZoomCurrent:lb,imageSelectionStageFitScalar:im,imageSelectionStoredState:rm,imageOverlayMarkup:hc,interfaceImages:Id,isInteracting:cc,isTransformingImage:J0,isInteractingFraction:A1,imageCropRectIntent:O1,imageCropRectPresentation:Q0,imageSelectionRect:qo,imageSelectionRectIntent:F1,imageSelectionRectPresentation:Ed,imageSelectionRectSnapshot:Md,imageScalar:dm,imageTransformsInterpolated:sb,imageEffects:hm};delete ym.image;const cb="util-"+ba();let ep=[];const xm=g=>ot.find(([j])=>g===j);let yc=[];const np=g=>{n(62,yc=yc.concat(g))},ip=g=>{n(62,yc=yc.filter(j=>j!==g))},rp=(g,j)=>{n(298,V[g]=j,V)};let bm=Io();const vm=(g,j,ht)=>{let wt=Ze.getPropertyValue(g);wt=ht?ht(wt):/^[0-9]+$/.test(wt)?parseFloat(wt):void 0,j.set(wt,{hard:!un})},Js=(g,j,ht=!1)=>{const wt=(dt=>{const yt=Ze.getPropertyValue(dt);return Nu(yt)})(g);wt&&wt[3]!==0&&(ht||(wt.length=3),j.set(wt,{hard:!un}))},op=me();D(t,op,g=>n(87,Ri=g));const ap=me();D(t,ap,g=>n(88,$i=g));const sp=me();D(t,sp,g=>n(89,vi=g));const _d=fn(0,{damping:.9});D(t,_d,g=>n(90,Rn=g));const wm=()=>{Js("color",bd),Js(Ar?"--color-background":"background-color",ac),Js("outline-color",sc),Js("--color-primary",P1),Js("--color-secondary",K0),Js("--grid-color-even",ap,!0),Js("--grid-color-odd",sp,!0),vm("--grid-size",op),vm("--editor-inset-top",R1,g=>parseInt(g,10))},Sm=Vn([Rd,hm,pd,Wx],([g,j,ht,wt])=>g&&{...g,...j,backgroundColor:ht,backgroundImage:wt});D(t,Sm,g=>n(390,zr=g));const db=()=>{const g=Yo.length?void 0:{resize:1.05},j=((ht,wt,dt={})=>{const{resize:yt=1,opacity:Ot=0}=dt,ze={opacity:[fn(Ot,{...sl,stiffness:.1}),ni],resize:[fn(yt,{...sl,stiffness:.1}),ni],translation:[fn(void 0,sl),ni],rotation:[fn(void 0,du),ni],origin:[fn(void 0,sl),ni],scale:[fn(void 0,du),ni],gamma:[fn(void 0,du),ei=>ei||1],vignette:[fn(void 0,du),ei=>ei||0],colorMatrix:[fn([...i$],sl),ei=>ei||[...i$]],convolutionMatrix:[me(void 0),ei=>ei&&ei.clarity||void 0],backgroundColor:[fn(void 0,sl),(ei,or,Fo)=>{if(Array.isArray(ei)){if(Array.isArray(or)){const Jn=[...ei];or[3]===0?(Jn[3]=0,Fo(Jn)):Jn[3]===0&&((ei=[...or])[3]=0)}return ei}}],backgroundImage:[me(void 0),ni]},cn=Object.entries(ze).map(([ei,or])=>[ei,or[0]]),Bn=cn.map(([,ei])=>ei),Kn=Object.entries(ze).reduce((ei,[or,Fo])=>{const[Jn,Ko]=Fo;return ei[or]=(tl,Rl)=>Jn.set(Ko(tl,gn[or],$p=>{Jn.set($p,{hard:!0})}),Rl),ei},{});let gn;const Xi=Vn(Bn,ei=>(gn=ei.reduce((or,Fo,Jn)=>(or[cn[Jn][0]]=Fo,or),{}),gn.data=ht,gn.size=wt,gn.scale*=ei[1],gn));return Xi.get=()=>gn,Xi.set=(ei,or)=>{const Fo={hard:!or};Object.entries(ei).forEach(([Jn,Ko])=>{Kn[Jn]&&Kn[Jn](Ko,Fo)})},Xi})(be,ge,g);Yo.unshift(j),Tm(zr)},Tm=g=>{Yo.forEach((j,ht)=>{const wt=ht===0?1:0;j.set({...g,opacity:wt,resize:1},Zr)})};let Dd;const xc=g0(void 0,{duration:500});let lp;D(t,xc,g=>n(54,po=g));const zd=me(!1);let ns;D(t,zd,g=>n(385,Lo=g));const Bd=fn(void 0,{stiffness:.1,damping:.7,precision:.25});D(t,Bd,g=>n(82,He=g));const Nd=fn(0,{stiffness:.1,precision:.05});D(t,Nd,g=>n(83,pn=g));const bc=fn(0,{stiffness:.02,damping:.5,precision:.25});D(t,bc,g=>n(383,Jr=g));const cp=fn(void 0,{stiffness:.02,damping:.5,precision:.25});D(t,cp,g=>n(384,Ao=g));const Wd=fn(void 0,{stiffness:.02,damping:.5,precision:.25});let Vd;D(t,Wd,g=>n(382,rr=g));const ub=()=>{Qn("abortLoadImage")},pb=()=>{Qn("abortProcessImage"),At($s,ui=!1,ui)},Cm=g=>{g.target&&g.target.dataset.touchScroll==="true"||g.preventDefault()},hb=mm?g=>{const j=g.touches?g.touches[0]:g;j.pageX>20&&j.pageX<window.innerWidth-20||Cm(g)}:ae,Qs=me([]);D(t,Qs,g=>n(476,Mr=g)),$o("keysPressed",Qs);const dp=g=>{!g||jl(g)&&!(j=>/^image/.test(j.type)&&!/svg/.test(j.type))(g)||!jl(g)&&!/^http/.test(g)||Qn("loadImage",g)},mb=g=>{g&&dp(g)};let Il,vc,up=[];const Mm=me();$o("rootPortal",Mm),$o("rootRect",Tl);const km=()=>({foregroundColor:[...Pi],lineColor:[...bi],utilVisibility:{...V},isInteracting:Un,isInteractingFraction:Cn,rootRect:Mn(Pe),stageRect:Mn(Ht),manipulationShapesDirty:Xd,annotationShapesDirty:Ud,decorationShapesDirty:jd,frameShapesDirty:Zd}),Em=(g,j,ht)=>Ai(g,sr(Math.round(j.width/ht),Math.round(j.height/ht))),Pm=(g,j,ht)=>{var wt;return g._translate=pt((wt=j).x,wt.y),g._scale=ht,g},Hd=g=>{const j=[];return g.forEach(ht=>j.push(gb(ht))),j.filter(Boolean)},gb=g=>ar(g)?(g.points=[pt(g.x1,g.y1),pt(g.x2,g.y2)],g):(!(j=>tr(j)&&!j.text.length)(g)||g.backgroundColor&&g.backgroundColor[3]!==0||(_u(g)&&(g.width=5,g.height=g.lineHeight),g.strokeWidth=1,g.strokeColor=[1,1,1,.5],g.backgroundColor=[0,0,0,.1]),g);let Im,pp=[],hp=[],mp=[],gp=[],fp=[],Rm={};const Am=(g,j,ht,wt,dt,yt,Ot)=>{const{manipulationShapesDirty:ze,annotationShapesDirty:cn,decorationShapesDirty:Bn,frameShapesDirty:Kn,selectionRect:gn,scale:Xi}=g,ei=Im!==Xi,or=ei||!ea(Rm,gn);or&&(Im=Xi,Rm=gn),ze&&(mp=j.filter(tu).map(Li).map(Jn=>Ai(Jn,ge))),(cn||ht!==Le)&&(pp=ht.filter(tu).map(Li).sort((Jn,Ko)=>Jn.alwaysOnTop?1:Ko.alwaysOnTop?-1:0).map(Jn=>Ai(Jn,ge))),(ei||Gd||cn||ht!==Le)&&(hp=Hd(pp.map(Jn=>f(Jn,{flipX:we,flipY:an,rotation:Ge,scale:Xi,context:Fr(ge)})).flat())),(Bn||wt!==si||or)&&(gp=Hd(wt.filter(tu).map(Li).sort((Jn,Ko)=>Jn.alwaysOnTop?1:Ko.alwaysOnTop?-1:0).map(Jn=>Em(Jn,gn,Xi)).map(Jn=>f(Jn,{context:gn})).flat().map(Jn=>Pm(Jn,gn,Xi)))),(Kn||yt!==mi||or)&&(fp=yt?Hd([yt].map(Li).map(Jn=>Em(Jn,gn,Xi)).map(f).flat().map(Jn=>Pm(Jn,gn,Xi))):[]);let Fo=Hd(dt.filter(tu));return typeof window<"u"&&(Jn=>{if(Jn&&Jn._l052uvt)return;const[Ko]=[[85,110,108,105,99,101,110,115,101,100,32,80,105,110,116,117,114,97,32,105,110,115,116,97,110,99,101]].map(tl=>tl.map(Rl=>String.fromCharCode(Rl)).join(""));Fo=[...Fo,{x:gn.x+.5*gn.width-82,y:gn.y+gn.height-16-12,width:164,height:16,text:Ko,fontWeight:900,fontSize:12,color:[1,1,1,.25]}]})(window),{manipulationShapesDirty:ze,manipulationShapes:mp,annotationShapesDirty:cn,annotationShapes:hp,decorationShapesDirty:Bn,decorationShapes:gp,frameShapesDirty:Kn,frameShapes:fp,interfaceShapes:Fo,selectionShapes:Ot.map(Li).map(Jn=>Ai(Jn,ge))}};let Ud=!0,Gd=!0,jd=!0,Zd=!0,Xd=!0;return Ho(()=>{Gs(),be&&Qe(be.src)&&/^blob:/.test(be.src)&&URL.revokeObjectURL(be.src),Vx(),Zx(),jx(),Xx(),qx(),Yx(),Kx(),tb(),ab(),vd.destroy(),wd.destroy(),g1.destroy(),Yo.clear(),pp.length=0,hp.length=0,mp.length=0,gp.length=0,fp.length=0;try{n(235,fc=void 0),n(293,Dd=void 0)}catch{}}),t.$$set=g=>{"class"in g&&n(236,So=g.class),"layout"in g&&n(237,Ta=g.layout),"stores"in g&&n(238,qr=g.stores),"locale"in g&&n(3,ti=g.locale),"id"in g&&n(4,nd=g.id),"util"in g&&n(239,hs=g.util),"utils"in g&&n(240,Kl=g.utils),"animations"in g&&n(241,ms=g.animations),"disabled"in g&&n(242,Ws=g.disabled),"status"in g&&n(234,To=g.status),"previewUpscale"in g&&n(243,$l=g.previewUpscale),"previewPad"in g&&n(244,Jl=g.previewPad),"previewMaskOpacity"in g&&n(5,id=g.previewMaskOpacity),"previewImageDataMaxSize"in g&&n(245,yl=g.previewImageDataMaxSize),"previewImageTextPixelRatio"in g&&n(6,Ql=g.previewImageTextPixelRatio),"markupMaskOpacity"in g&&n(7,xl=g.markupMaskOpacity),"zoomMaskOpacity"in g&&n(246,gs=g.zoomMaskOpacity),"elasticityMultiplier"in g&&n(8,Xa=g.elasticityMultiplier),"willRevert"in g&&n(247,tc=g.willRevert),"willProcessImage"in g&&n(248,Vs=g.willProcessImage),"willRenderCanvas"in g&&n(9,bl=g.willRenderCanvas),"willRenderToolbar"in g&&n(249,qa=g.willRenderToolbar),"willRenderUtilTabs"in g&&n(250,vl=g.willRenderUtilTabs),"willSetHistoryInitialState"in g&&n(251,Ya=g.willSetHistoryInitialState),"enableButtonExport"in g&&n(252,x=g.enableButtonExport),"enableButtonRevert"in g&&n(253,B=g.enableButtonRevert),"enableNavigateHistory"in g&&n(254,E=g.enableNavigateHistory),"enableToolbar"in g&&n(10,Y=g.enableToolbar),"enableUtils"in g&&n(255,et=g.enableUtils),"enableButtonClose"in g&&n(256,Tt=g.enableButtonClose),"enableDropImage"in g&&n(257,Ct=g.enableDropImage),"enablePasteImage"in g&&n(258,Pt=g.enablePasteImage),"enableBrowseImage"in g&&n(259,Mt=g.enableBrowseImage),"enableTransparencyGrid"in g&&n(11,Rt=g.enableTransparencyGrid),"layoutDirectionPreference"in g&&n(260,Lt=g.layoutDirectionPreference),"layoutHorizontalUtilsPreference"in g&&n(261,Vt=g.layoutHorizontalUtilsPreference),"layoutVerticalUtilsPreference"in g&&n(262,qe=g.layoutVerticalUtilsPreference),"layoutVerticalToolbarPreference"in g&&n(263,oe=g.layoutVerticalToolbarPreference),"layoutVerticalControlGroupsPreference"in g&&n(264,ne=g.layoutVerticalControlGroupsPreference),"layoutVerticalControlTabsPreference"in g&&n(265,fe=g.layoutVerticalControlTabsPreference),"textDirection"in g&&n(12,$e=g.textDirection),"markupEditorZoomLevel"in g&&n(266,De=g.markupEditorZoomLevel),"markupEditorZoomLevels"in g&&n(13,Ye=g.markupEditorZoomLevels),"markupEditorZoomAdjustStep"in g&&n(14,vn=g.markupEditorZoomAdjustStep),"markupEditorZoomAdjustFactor"in g&&n(15,ln=g.markupEditorZoomAdjustFactor),"markupEditorZoomAdjustWheelFactor"in g&&n(16,Fn=g.markupEditorZoomAdjustWheelFactor),"markupEditorInteractionMode"in g&&n(267,pi=g.markupEditorInteractionMode),"muteAudio"in g&&n(268,Wn=g.muteAudio),"willSetMediaInitialTimeOffset"in g&&n(269,_n=g.willSetMediaInitialTimeOffset),"enablePan"in g&&n(17,wi=g.enablePan),"enableZoom"in g&&n(18,ri=g.enableZoom),"enableZoomControls"in g&&n(270,Zi=g.enableZoomControls),"enableZoomInput"in g&&n(19,di=g.enableZoomInput),"enablePanInput"in g&&n(271,Vr=g.enablePanInput),"enableCanvasAlpha"in g&&n(20,Ar=g.enableCanvasAlpha),"enablePanLimit"in g&&n(21,ao=g.enablePanLimit),"panLimitGutterScalar"in g&&n(22,Ka=g.panLimitGutterScalar),"pan"in g&&n(272,pa=g.pan),"zoomPresetOptions"in g&&n(23,Hs=g.zoomPresetOptions),"zoomAdjustStep"in g&&n(24,Us=g.zoomAdjustStep),"zoomAdjustFactor"in g&&n(25,Ca=g.zoomAdjustFactor),"zoomAdjustWheelFactor"in g&&n(26,Zo=g.zoomAdjustWheelFactor),"zoomLevel"in g&&n(0,Hr=g.zoomLevel),"fixScrollDirection"in g&&n(273,Ma=g.fixScrollDirection),"imagePreviewSrc"in g&&n(276,Pa=g.imagePreviewSrc),"imageOrienter"in g&&n(277,Ia=g.imageOrienter),"pluginComponents"in g&&n(278,ha=g.pluginComponents),"pluginOptions"in g&&n(27,Ra=g.pluginOptions),"root"in g&&n(2,jn=g.root),"imageSourceToImageData"in g&&n(28,m1=g.imageSourceToImageData),"imagePreviewCurrent"in g&&n(235,fc=g.imagePreviewCurrent)},t.$$.update=()=>{if(33554432&t.$$.dirty[8]&&ka.set(Ma),8&t.$$.dirty[0]&&n(350,i=!!ti),1&t.$$.dirty[0]|262144&t.$$.dirty[8]&&n(0,Hr=Hr===null?De:Hr),2&t.$$.dirty[0]|1073741824&t.$$.dirty[8]){let dt=!1;ha.forEach(([yt])=>{wr[yt]||(n(1,wr[yt]={},wr),dt=!0)}),dt&&n(290,rc=[...ha])}var g,j,ht,wt;if(8388608&t.$$.dirty[7]|2048&t.$$.dirty[9]|512&t.$$.dirty[11]&&n(348,W=i&&rc.length?Kl||rc.map(([dt])=>dt):[]),134217728&t.$$.dirty[0]|2048&t.$$.dirty[9]|128&t.$$.dirty[11]|16777216&t.$$.dirty[12]&&n(349,ot=((dt,yt,Ot,ze)=>{const cn=yt.filter(([Bn])=>dt.includes(Bn)).filter(([Bn,{isSupported:Kn}])=>Kn({...ze,...Ot[Bn]})).map(([Bn,Kn])=>[Bn,Kn.Component]);return Os(cn,ep,(Bn,Kn)=>Bn[0]===Kn[0]&&Bn[1]===Kn[1])?ep:(ep=cn,cn)})(W,rc,Ra,{src:Nr})),256&t.$$.dirty[11]&&n(302,at=ot.length),8&t.$$.dirty[0]|8388608&t.$$.dirty[9]|128&t.$$.dirty[11]&&n(347,q=at&&W.map(dt=>{const yt=xm(dt);if(yt)return{id:dt,view:yt[1],tabIcon:ti[dt+"Icon"],tabLabel:ti[dt+"Label"]}}).filter(Boolean)||[]),64&t.$$.dirty[11]&&n(367,r=!!q.find(dt=>dt.id==="trim")),201326592&t.$$.dirty[11]|131072&t.$$.dirty[13]&&n(301,o=!!(Re&&be&&r)),4194304&t.$$.dirty[7]|8388608&t.$$.dirty[9]&&n(43,ct=at&&hs&&typeof hs=="string"&&xm(hs)?hs:at>0?ot[0][0]:void 0),4096&t.$$.dirty[1]|4194304&t.$$.dirty[9]&&o&&ct&&Gs(),4194304&t.$$.dirty[9]|134217728&t.$$.dirty[11]&&(o?(be.addEventListener("play",rd),be.addEventListener("pause",rd)):be&&be.nodeName==="video"&&(be.removeEventListener("play",rd),be.removeEventListener("pause",rd))),4194304&t.$$.dirty[9]&&o&&Qa.set(ic()/ts()),589824&t.$$.dirty[13]&&(dt=>{if(!wl())return;const yt=Date.now();if(a1&&yt-a1<16)return;a1=yt;const Ot=Re*dt;if(Ot.toFixed(1)===I0)return;I0=Ot.toFixed(1);const ze=be,cn=()=>{ze.removeEventListener("seeked",cn),Xo()};ze.addEventListener("seeked",cn),Jf(ze,Ot)})(In||te),65536&t.$$.dirty[13]&&n(365,a=te&&en(te,6)),1196032&t.$$.dirty[13]&&n(363,s=Qi||[[0,Math.min(Re,Ln)/Re]]),4194304&t.$$.dirty[11]&&(l=s[0][0]),4194304&t.$$.dirty[11]&&(c=s[s.length-1][1]),4194304&t.$$.dirty[11]&&n(366,d=s.map(([dt,yt])=>[en(dt,6),en(yt,6)])),50331648&t.$$.dirty[11]&&n(364,u=d.findIndex(([dt,yt])=>a>=dt&&a<=yt)),58720256&t.$$.dirty[11]&&(p=u===-1&&d.findIndex((dt,yt,Ot)=>{const ze=Ot[yt-1];return ze?a<=dt[0]&&a>=ze[1]:a<=dt[0]})),1048576&t.$$.dirty[8]&&nc.set(Wn),134217728&t.$$.dirty[11]|262144&t.$$.dirty[13]&&(be&&$n?u1():p1()),4194304&t.$$.dirty[9]|65536&t.$$.dirty[13]&&o&&sd.set(ts()*te),134217728&t.$$.dirty[11]|32768&t.$$.dirty[13]&&be&&(dt=>{o&&(be.volume=Math.min(1,dt))})(R),256&t.$$.dirty[0]&&At(ad,wa=Xa,wa),1048576&t.$$.dirty[7]&&n(359,h=Ta==="overlay"),128&t.$$.dirty[8]|262144&t.$$.dirty[11]&&n(45,y=et&&!h),134217730&t.$$.dirty[0]&&Ra&&Object.entries(Ra).forEach(([dt,yt])=>{Object.entries(yt).forEach(([Ot,ze])=>{wr[dt]&&n(1,wr[dt][Ot]=ze,wr)})}),512&t.$$.dirty[13]&&n(360,w=!je),16777216&t.$$.dirty[7]|1572864&t.$$.dirty[11]&&At(Td,un=ms==="always"?b:ms!=="never"&&b&&w,un),4194304&t.$$.dirty[1]|33554432&t.$$.dirty[7]&&h1.set(Ws?1:0,{hard:!un}),268435456&t.$$.dirty[7]&&(m=yl?(g=yl,j=O0,sr(Math.min(g.width,j.width),Math.min(g.height,j.height))):O0),8192&t.$$.dirty[13]&&g1.update(br[0]),4096&t.$$.dirty[13]&&(f=Pn?(dt,yt)=>Pn(dt,{flipX:void 0,flipY:void 0,rotation:void 0,...yt,isPreview:!0}):ni),268435456&t.$$.dirty[1]&&Array.isArray(zn)&&Qn("selectionchange",[...zn]),4194304&t.$$.dirty[8]|2048&t.$$.dirty[13]&&k1.set(ai&&Zi),8912896&t.$$.dirty[8]&&xd.set(pi==="pan"||Vr),1048576&t.$$.dirty[1]&&li&&Tl.set(Ci(li.x,li.y,li.width,li.height)),262144&t.$$.dirty[11]|65538&t.$$.dirty[12]&&Pe&&h&&ci&&ci.complete&&(()=>{const dt=ie,yt=lr(Pe);dt&&dt===yt||(cd.set(lr(Pe)),fm())})(),128&t.$$.dirty[11]&&n(46,vt=W.length>1),32768&t.$$.dirty[1]&&(vt||Cl.set(Cs())),1024&t.$$.dirty[0]|1024&t.$$.dirty[13]&&(Y||lc.set(Ci(0,re,0,0))),1048576&t.$$.dirty[11]|4&t.$$.dirty[12]&&n(362,v=!Un&&b),1048576&t.$$.dirty[1]&&n(303,Yn=li&&li.width>0&&li.height>0),8&t.$$.dirty[0]|25165824&t.$$.dirty[9]&&n(40,Se=Yn&&ti&&!!at),512&t.$$.dirty[1]&&setTimeout(()=>n(291,L1=Se),1),16777216&t.$$.dirty[7]|4096&t.$$.dirty[9]|2621440&t.$$.dirty[11]&&At(Sd,Zr=ms==="always"?v:ms!=="never"&&v&&L1&&w,Zr),67108864&t.$$.dirty[7]|262144&t.$$.dirty[11]&&Cd.set($l||h),134217728&t.$$.dirty[7]&&kd.set(Jl),16777216&t.$$.dirty[8]&&pa&&Ks.set(pa),4&t.$$.dirty[0]|288&t.$$.dirty[13]&&jn&&(jn.dispatchEvent(bs("markupzoom",sn)),jn.dispatchEvent(bs("zoom",dn(sn)?sn:Ji))),4&t.$$.dirty[0]|128&t.$$.dirty[13]&&jn&&(jn.dispatchEvent(bs("markuppan",io)),jn.dispatchEvent(bs("pan",io))),16&t.$$.dirty[13]&&Di&&om(),64&t.$$.dirty[13]&&Xr&&N1(),4198400&t.$$.dirty[1]&&ct&&U1.set(.075,{hard:!un}),536870912&t.$$.dirty[7]&&n(357,T=gs),12&t.$$.dirty[13]&&n(358,I=ca?-Math.max(...Object.values(Go)):0),138936320&t.$$.dirty[1]|196608&t.$$.dirty[11]&&Ki){let dt=Ki.x-Ht.x,yt=Ht.x+Ht.width-(Ki.x+Ki.width),Ot=Ki.y-Ht.y,ze=Ht.y+Ht.height-(Ki.y+Ki.height),cn=Math.min(dt,Ot,yt,ze);G1.set(cn>I?0:Math.min(T,Math.abs(cn/64)),{hard:!un})}if(67108864&t.$$.dirty[1]&&n(356,P=.55/Ii),4718592&t.$$.dirty[1]|32768&t.$$.dirty[11]&&Ht&&j1.set({x:0,y:Ht.y,width:Ht.x<64?0:Ht.x,height:Ht.height+P},{hard:!un}),4718592&t.$$.dirty[1]|32768&t.$$.dirty[11]|2&t.$$.dirty[12]&&Ht&&Z1.set({x:0,y:0,width:Pe.width,height:Ht.y+P},{hard:!un}),4718592&t.$$.dirty[1]|32768&t.$$.dirty[11]|2&t.$$.dirty[12]&&Ht){let dt=Ht.x+Ht.width,yt=Pe.width-(Ht.x+Ht.width);yt<64&&(dt+=yt,yt=0),X1.set({x:dt,y:Ht.y,width:yt,height:Ht.height+P},{hard:!un})}if(4718592&t.$$.dirty[1]|2&t.$$.dirty[12]&&Ht&&q1.set({x:0,y:Ht.y+Ht.height,width:Pe.width,height:Pe.height-(Ht.y+Ht.height)},{hard:!un}),33554432&t.$$.dirty[1]|536870912&t.$$.dirty[12]|2&t.$$.dirty[13]&&n(352,_=gi&&{id:"stage-overlay",backgroundColor:An,opacity:ji,...gi}),33554432&t.$$.dirty[1]|536870912&t.$$.dirty[12]|1&t.$$.dirty[13]&&n(355,C=Fi&&{id:"stage-overlay",backgroundColor:An,opacity:ji,...Fi}),33554432&t.$$.dirty[1]|1610612736&t.$$.dirty[12]&&n(354,F=Wi&&{id:"stage-overlay",backgroundColor:An,opacity:ji,...Wi}),33554432&t.$$.dirty[1]|805306368&t.$$.dirty[12]&&n(353,G=Wr&&{id:"stage-overlay",backgroundColor:An,opacity:ji,...Wr}),30720&t.$$.dirty[11]&&n(351,O=[C,F,G,_].filter(Boolean)),1024&t.$$.dirty[11]|134217728&t.$$.dirty[12]&&O&&Ir&&hc.update(dt=>[...dt.filter(yt=>yt.id!=="stage-overlay"),...O]),268435456&t.$$.dirty[8]|16777216&t.$$.dirty[12]&&gc.set(Pa||Nr||void 0),4&t.$$.dirty[0]|262144&t.$$.dirty[7]|134217728&t.$$.dirty[11]&&(n(235,fc=be),be&&jn.dispatchEvent(bs("loadpreview",fc))),131072&t.$$.dirty[12]&&jr&&(Ks.set(hi()),El.set(void 0),om(),Id.set([])),67108864&t.$$.dirty[12]&&n(307,N=ho.index>0),67108864&t.$$.dirty[12]&&n(306,it=ho.index<ho.length-1),393216&t.$$.dirty[1]|24&t.$$.dirty[12]&&(M=[Le,si,Xn,Hi]),8&t.$$.dirty[1]&&$m.set(Od),33554432&t.$$.dirty[12]&&tp.set(wo),4096&t.$$.dirty[1]&&Hx.set(ct),524288&t.$$.dirty[9]|64&t.$$.dirty[11]&&n(298,V=q.reduce((dt,yt)=>(dt[yt.id]=V&&V[yt.id]||0,dt),{})),4096&t.$$.dirty[1]&&n(79,ut={name:cb,selected:ct}),64&t.$$.dirty[11]&&n(329,bt=q.map(dt=>({id:dt.id,icon:dt.tabIcon,label:dt.tabLabel}))),64&t.$$.dirty[11]&&n(78,K=q.map(dt=>dt.id)),524288&t.$$.dirty[7]&&n(77,X=rn(["PinturaRoot","PinturaRootComponent",So])),2&t.$$.dirty[12]&&n(343,Z=Pe&&(Pe.width>1e3?"wide":Pe.width<600?"narrow":void 0)),2&t.$$.dirty[12]&&n(330,mt=Pe&&(Pe.width<=320||Pe.height<=460)),2&t.$$.dirty[12]&&n(342,Bt=Pe&&(Pe.height>1e3?"tall":Pe.height<600?"short":void 0)),4&t.$$.dirty[0]&&n(309,st=jn&&jn.parentNode&&jn.parentNode.classList.contains("PinturaModal")),1&t.$$.dirty[1]|1073741824&t.$$.dirty[9]|2&t.$$.dirty[12]&&n(335,gt=st&&Pe&&Ad>Pe.width),2&t.$$.dirty[1]|1073741824&t.$$.dirty[9]|2&t.$$.dirty[12]&&n(334,Jt=st&&Pe&&J1>Pe.height),50331648&t.$$.dirty[10]&&n(336,le=gt&&Jt),1048576&t.$$.dirty[0]&&n(333,rt=Ar),4&t.$$.dirty[11]&&n(304,kt=Z==="narrow"),4096&t.$$.dirty[8]|2&t.$$.dirty[12]&&n(344,(ht=Pe,wt=Lt,Nt=Pe?wt==="auto"?ht.width>ht.height?"landscape":"portrait":wt==="horizontal"?ht.width<500?"portrait":"landscape":wt==="vertical"?ht.height<400?"landscape":"portrait":void 0:"landscape")),8&t.$$.dirty[11]&&n(76,$t=Nt==="landscape"),33554432&t.$$.dirty[9]|2&t.$$.dirty[11]&&n(332,Be=kt||Bt==="short"),1&t.$$.dirty[1]|2&t.$$.dirty[12]&&n(331,nt=bm&&Pe&&Ad===Pe.width&&!mm),4&t.$$.dirty[1]|8388608&t.$$.dirty[12]&&n(305,Ut=[...eo||[],...Fd].filter(Boolean)),8192&t.$$.dirty[8]&&n(341,qt="has-navigation-preference-"+Vt),16384&t.$$.dirty[8]&&n(340,Dt="has-navigation-preference-"+qe),32768&t.$$.dirty[8]&&n(337,ve="has-toolbar-preference-"+oe),65536&t.$$.dirty[8]&&n(339,It="has-controlgroups-preference-"+ne),131072&t.$$.dirty[8]&&n(338,Ie="has-controltabs-preference-"+fe),2&t.$$.dirty[12]&&n(346,lt=Pe!==void 0&&Pe.width>0&&Pe.height>0),4&t.$$.dirty[0]|32&t.$$.dirty[11]&&n(345,Ze=lt&&jn&&getComputedStyle(jn)),16&t.$$.dirty[11]&&Ze&&wm(),1024&t.$$.dirty[0]|4243456&t.$$.dirty[1]|34603008&t.$$.dirty[7]|1073741824&t.$$.dirty[9]|2146435072&t.$$.dirty[10]|15&t.$$.dirty[11]|6291712&t.$$.dirty[12]&&$c.set({...uo,layoutMode:Ta,orientation:Nt,horizontalSpace:Z,verticalSpace:Bt,navigationHorizontalPreference:qt,navigationVerticalPreference:Dt,controlGroupsVerticalPreference:It,controlTabsVerticalpreference:Ie,toolbarVerticalPreference:ve,isModal:st,isDisabled:Ws,isCentered:le,isCenteredHorizontally:gt,isCenteredVertically:Jt,isAnimated:un,isTransparent:rt,pointerAccuracy:Br,pointerHoverable:kr,isCompact:Be,hasSwipeNavigation:nt,hasLimitedSpace:mt,hasToolbar:Y,hasNavigation:vt&&y,isIOS:bm,browserVersion:m0()?"chrome-"+(navigator.userAgent.match(/Chrome\/([0-9]+)/)||[])[1]:void 0}),256&t.$$.dirty[12]&&n(75,nn=Object.entries(uo).map(([dt,yt])=>/^is|has/.test(dt)?yt?dx(dt):void 0:yt).filter(Boolean).join(" ")),4096&t.$$.dirty[1]&&ct&&Ld.set([]),4096&t.$$.dirty[1]|4&t.$$.dirty[8]|524288&t.$$.dirty[10]|256&t.$$.dirty[12]&&n(44,he=vl(bt.map(dt=>({...dt,selected:ct===dt.id})),{...uo},()=>js.set({}))),8192&t.$$.dirty[1]&&n(74,Ke=!!he.find(dt=>Array.isArray(dt))),1572864&t.$$.dirty[12]&&n(73,Ae=to&&Object.entries(xr).filter(([,dt])=>dt!=null).reduce((dt,[,yt])=>dt={...dt,...yt},{})),65536&t.$$.dirty[12]&&n(326,de=ci&&ci.task==="any-to-file"),65536&t.$$.dirty[10]&&de&&Yo&&Yo.clear(),262144&t.$$.dirty[12]&&n(328,We=!!zr&&!!zr.translation),16384&t.$$.dirty[9]|262144&t.$$.dirty[10]|134217728&t.$$.dirty[11]&&We&&be&&be!==Dd&&(n(293,Dd=be),db()),262144&t.$$.dirty[10]|262144&t.$$.dirty[12]&&We&&Tm(zr),16777216&t.$$.dirty[1]&&Qr&&Qr.length>1){let dt=[];Yo.forEach((yt,Ot)=>{Ot!==0&&yt.get().opacity<=0&&dt.push(yt)}),dt.forEach(yt=>Yo.remove(yt))}if(8&t.$$.dirty[0]|131072&t.$$.dirty[10]&&n(39,xt=ti&&xn.length&&ti.labelSupportError(xn)),65536&t.$$.dirty[12]&&n(318,Ve=ci&&!!ci.error),65536&t.$$.dirty[12]&&n(42,Oe=!ci||!ci.complete&&ci.task===void 0),65536&t.$$.dirty[12]&&n(319,Ne=ci&&(ci.taskLengthComputable?ci.taskProgress:1/0)),65536&t.$$.dirty[10]&&de&&At(mc,Dr=!1,Dr),4194304&t.$$.dirty[1]|32768&t.$$.dirty[9]|65536&t.$$.dirty[12]&&ci&&ci.complete){const dt=un?250:0;clearTimeout(lp),n(294,lp=setTimeout(()=>{At(mc,Dr=!0,Dr)},dt))}if(2048&t.$$.dirty[1]|256&t.$$.dirty[10]|81920&t.$$.dirty[12]&&n(323,_e=ci&&!Ve&&!Oe&&!Dr),8192&t.$$.dirty[9]|134217728&t.$$.dirty[11]|131072&t.$$.dirty[12]&&n(322,Je=!(!jr||be&&!fs)),4194304&t.$$.dirty[1]|16384&t.$$.dirty[12]&&(Dr?setTimeout(()=>_d.set(1,{hard:!un}),un?500:0):_d.set(0,{hard:!un})),33280&t.$$.dirty[12]&&n(317,kn=!!(ui||Gi&&Gi.progress!==void 0&&!Gi.complete)),128&t.$$.dirty[10]&&kn&&Gs(),2048&t.$$.dirty[1]|65536&t.$$.dirty[12]&&n(320,En=ci&&!(ci.error||Oe)),8&t.$$.dirty[0]|65536&t.$$.dirty[12]&&n(321,Zt=ti&&(ci?!ci.complete||ci.error?p0(ti.statusLabelLoadImage(ci),ci.error&&ci.error.metadata,"{","}"):ti.statusLabelLoadImage({progress:1/0,task:"blob-to-bitmap"}):ti.statusLabelLoadImage(ci))),8&t.$$.dirty[0]|32768&t.$$.dirty[12]&&n(316,Dn=Gi&&ti&&ti.statusLabelProcessImage(Gi)),32768&t.$$.dirty[12]&&n(314,H=Gi&&(Gi.taskLengthComputable?Gi.taskProgress:1/0)),32768&t.$$.dirty[12]&&n(315,Wt=Gi&&!Gi.error),32768&t.$$.dirty[12]&&n(313,z=!(!Gi||!Gi.error)),8&t.$$.dirty[0]|2048&t.$$.dirty[1]|131072&t.$$.dirty[7]|16376&t.$$.dirty[10])if(To){let dt,yt,Ot,ze,cn;Qe(To)&&(dt=To),dn(To)?yt=To:Array.isArray(To)&&([dt,yt,cn]=To,yt===!1&&(ze=!0),dn(yt)&&(Ot=!0)),n(35,ns=(dt||yt)&&{text:dt,aside:ze||Ot,progressIndicator:{visible:Ot,progress:yt},closeButton:ze&&{label:ti.statusLabelButtonClose,icon:ti.statusIconButtonClose,onclick:cn||(()=>n(234,To=void 0))}})}else n(35,ns=ti&&Oe||Ve||_e||Je?{text:Zt,aside:Ve||En,progressIndicator:{visible:En,progress:Ne},closeButton:Ve&&{label:ti.statusLabelButtonClose,icon:ti.statusIconButtonClose,onclick:ub}}:ti&&kn&&Dn?{text:Dn,aside:z||Wt,progressIndicator:{visible:Wt,progress:H},closeButton:z&&{label:ti.statusLabelButtonClose,icon:ti.statusIconButtonClose,onclick:pb}}:void 0);if(131072&t.$$.dirty[7]&&n(325,Qt=To!==void 0),4194304&t.$$.dirty[1]|1073741824&t.$$.dirty[9]|32768&t.$$.dirty[12]&&st&&Gi&&Gi.complete&&(zd.set(!0),setTimeout(()=>zd.set(!1),un?100:0)),4&t.$$.dirty[0]|4096&t.$$.dirty[1]|16384&t.$$.dirty[12]&&Dr&&jn&&jn.dispatchEvent(bs("selectutil",ct)),2304&t.$$.dirty[1]|45440&t.$$.dirty[10]|8192&t.$$.dirty[12]&&n(324,ce=Lo||xt||Oe||Ve||_e||Je||kn||Qt),16384&t.$$.dirty[10]&&At(xc,po=ce?1:0,po),4194304&t.$$.dirty[1]|16384&t.$$.dirty[10]&&xc.set(ce?1:0,{duration:un?500:1}),8388608&t.$$.dirty[1]&&n(41,ye=po>0),16&t.$$.dirty[1]&&n(312,ue=!(!ns||!ns.aside)),4195344&t.$$.dirty[1]|65536&t.$$.dirty[9]|4&t.$$.dirty[10]|4096&t.$$.dirty[12]&&ye&&ns){clearTimeout(Vd);const dt={hard:un===!1};if(ue){const yt=!!ns.error||!un;Nd.set(1,dt),Bd.set(Ao,{hard:yt}),n(295,Vd=setTimeout(()=>{bc.set(16,dt)},1))}else Nd.set(0,dt),n(295,Vd=setTimeout(()=>{bc.set(0,dt)},1))}if(1024&t.$$.dirty[1]&&(ye||(Wd.set(void 0,{hard:!0}),Bd.set(void 0,{hard:!0}),bc.set(0,{hard:!0}))),2048&t.$$.dirty[12]&&n(311,Yt=.5*Jr),2&t.$$.dirty[10]|1024&t.$$.dirty[12]&&n(72,Gt=`transform: translateX(${rr-Yt}px)`),256&t.$$.dirty[1]|402653184&t.$$.dirty[11]&&n(38,Fe=be&&ge&&!xt),128&t.$$.dirty[1]|1073741824&t.$$.dirty[9]|1&t.$$.dirty[10]&&n(308,Xe=hn&&(Fe||st)?Cm:ae),536870912&t.$$.dirty[9]&&n(71,on=Xe),536870912&t.$$.dirty[9]&&n(70,xe=Xe),8&t.$$.dirty[0]|2097152&t.$$.dirty[1]|370&t.$$.dirty[8]|503316480&t.$$.dirty[9]|256&t.$$.dirty[12]&&n(69,Me=ti&&ii&&Wu(()=>qa([["div","alpha",{class:"PinturaNavGroup"},[["div","alpha-set",{class:"PinturaNavSet"},[Tt&&["Button","close",{label:ti.labelClose,icon:ti.iconButtonClose,onclick:()=>Qn("close"),hideLabel:!0}],B&&["Button","revert",{label:ti.labelButtonRevert,icon:ti.iconButtonRevert,disabled:!N,onclick:eb,hideLabel:!0}]]]]],["div","beta",{class:"PinturaNavGroup PinturaNavGroupFloat"},[E&&["div","history",{class:"PinturaNavSet"},[["Button","undo",{label:ti.labelButtonUndo,icon:ti.iconButtonUndo,disabled:!N,onclick:La.undo,hideLabel:!0}],["Button","redo",{label:ti.labelButtonRedo,icon:ti.iconButtonRedo,disabled:!it,onclick:La.redo,hideLabel:!0}]]],Ut.length&&["div","plugin-tools",{class:"PinturaNavSet"},Ut.filter(Boolean).map(([dt,yt,Ot])=>[dt,yt,{...Ot}])]]],["div","gamma",{class:"PinturaNavGroup"},[x&&["Button","export",{label:ti.labelButtonExport,icon:kt&&ti.iconButtonExport,class:"PinturaButtonExport",onclick:ob,hideLabel:kt}]]]],{...uo},()=>js.set({})))),16&t.$$.dirty[12]&&n(300,J=Xn&&!!Xn.length),2097152&t.$$.dirty[9]|268435456&t.$$.dirty[11]|16&t.$$.dirty[12]&&n(299,Xt=J&&h2(ge,Xn)),3145728&t.$$.dirty[9]|134217728&t.$$.dirty[11]|192&t.$$.dirty[12]&&J&&((dt,yt,Ot,ze)=>{if(!yt)return;const cn={dataSizeScalar:Ot};ze&&ze[3]>0&&(cn.backgroundColor=[...ze]),yt(dt,cn).then(Bn=>{Il&&dr(Il),n(296,Il=Bn)})})(be,gr,Xt,yr),131072&t.$$.dirty[9]|268435456&t.$$.dirty[11]|48&t.$$.dirty[12]&&Xn&&Il&&ge){const{width:dt,height:yt}=ge,Ot=Ba()?"pixelated":Ui==="auto"?"auto":"pixelated";n(297,up=Xn.map(ze=>{const cn=Ci(ze.x,ze.y,ze.width,ze.height),Bn=$r(Mn(cn),ze.rotation).map(Kn=>pt(Kn.x/dt,Kn.y/yt));return{...ze,id:"redaction",flipX:!1,flipY:!1,cornerRadius:0,strokeWidth:0,strokeColor:void 0,backgroundColor:[0,0,0,0],backgroundImage:Il,backgroundImageRendering:Ot,backgroundCorners:Bn}}))}262144&t.$$.dirty[9]|8&t.$$.dirty[12]&&n(37,jt=[...up,...Hi||[]]),32&t.$$.dirty[1]&&vc&&Mm.set(vc),4&t.$$.dirty[0]|128&t.$$.dirty[1]&&Fe&&jn&&jn.dispatchEvent(bs("ready")),262144&t.$$.dirty[1]&&n(63,Ud=!0),1879048192&t.$$.dirty[11]|1&t.$$.dirty[12]&&n(64,Gd=!0),131072&t.$$.dirty[1]&&n(65,jd=!0),65536&t.$$.dirty[1]&&n(66,Zd=!0),64&t.$$.dirty[1]&&n(67,Xd=!0)},n(361,b=!f0()),$=Oc()===1?g=>{g&&(Eo(g.origin,Math.round),Eo(g.translation,Math.round))}:ni,n(327,xn=[!k5()&&"WebGL"].filter(Boolean)),n(310,hn=Io()||Gu()&&va()),n(68,se=((g,j=!0)=>ht=>{ht.type==="ping"&&(j&&ht.stopPropagation(),g(ht.detail.type,ht.detail.data))})(Rr.pub)),[Hr,wr,jn,ti,nd,id,Ql,xl,Xa,bl,Y,Rt,$e,Ye,vn,ln,Fn,wi,ri,di,Ar,ao,Ka,Hs,Us,Ca,Zo,Ra,m1,Y1,La,Ad,J1,Fd,Od,ns,vc,jt,Fe,xt,Se,ye,Oe,ct,he,y,vt,mi,si,Le,Ht,li,ii,un,po,Qr,An,Ii,Ki,zn,Ea,Co,yc,Ud,Gd,jd,Zd,Xd,se,Me,xe,on,Gt,Ae,Ke,nn,$t,X,K,ut,Pr,da,He,pn,On,mn,Gn,Ri,$i,vi,Rn,vr,jo,Ns,Ha,Ua,Sa,Ga,ps,ja,ua,Za,xi,o1,ec,Qa,nc,js,ad,h1,f1,Zs,$1,sd,y1,_0,x1,ld,b1,cd,v1,ma,Sl,dd,ud,pd,hd,md,gd,fd,Xs,w1,$d,U0,G0,j0,Z0,X0,q0,Y0,S1,T1,C1,yd,M1,k1,xd,E1,ac,bd,sc,P1,I1,Tl,Cl,R1,lc,qs,vd,wd,cc,A1,Sd,Td,Cd,Ys,dc,O1,qo,Md,F1,tm,Ml,kl,Aa,D1,es,El,z1,pc,Ks,Ed,B1,am,Pd,hc,pm,G1,j1,Z1,X1,q1,mc,gc,K1,Id,Rd,$c,Q1,$s,Yo,Ld,ym,np,ip,rp,(g,j)=>j[g],g=>q.find(j=>j.id===g).view,op,ap,sp,_d,({target:g,propertyName:j})=>{g===jn&&/background|outline/.test(j)&&Ze&&wm()},Sm,xc,zd,Bd,Nd,bc,cp,Wd,g=>{const j=!(!ns||!ns.closeButton)||!un;cp.set(g.detail.width,{hard:j}),Wd.set(Math.round(.5*-g.detail.width),{hard:j})},hb,Qs,g=>{const{keyCode:j,metaKey:ht,ctrlKey:wt,shiftKey:dt}=g;if(j===9&&Ws)return void g.preventDefault();if(g.target&&j===32&&jn.contains(g.target)&&!ml(g.target)&&(Uo&&o&&d1(),g.preventDefault()),j===90&&(ht||wt))return void(dt&&ht?La.redo():La.undo());if(j===89&&wt)return void La.redo();if(j===229)return;const yt=new Set([...Mr,j]);Qs.set(Array.from(yt))},({key:g,keyCode:j})=>{if(g==="Meta")return Qs.set([]);Qs.set(Mr.filter(ht=>ht!==j))},()=>{Qs.set([])},g=>{ml(g.target)||g.preventDefault()},g=>{Ct&&dp(g.detail.resources[0])},()=>{Mt&&ux().then(mb)},g=>{if(!Pt)return;const j=oi((window.innerWidth-Math.abs(Pe.x))/Pe.width,0,1),ht=oi((window.innerHeight-Math.abs(Pe.y))/Pe.height,0,1);j<.75&&ht<.75||dp((g.clipboardData||window.clipboardData).files[0])},km,Am,g=>{ke&&ea(g.detail,ke)||At(qs,ke=g.detail,ke)},To,fc,So,Ta,qr,hs,Kl,ms,Ws,$l,Jl,yl,gs,tc,Vs,qa,vl,Ya,x,B,E,et,Tt,Ct,Pt,Mt,Lt,Vt,qe,oe,ne,fe,De,pi,Wn,_n,Zi,Vr,pa,Ma,()=>n(60,Ea=void 0),(g,j,ht)=>{const{text:wt="",placeholder:dt="",autoClose:yt=!0,align:Ot="top",justify:ze="center",buttonConfirm:cn,buttonCancel:Bn}=ht;n(60,Ea={align:Ot,justify:ze,text:wt,placeholder:dt,buttonConfirm:cn,buttonCancel:Bn,onconfirm:()=>{g(Co.value),yt&&n(60,Ea=void 0)},oncancel:()=>{j(void 0),n(60,Ea=void 0)}})},Pa,Ia,ha,Ja,c1,Gs,wl,d1,u1,p1,A0,ts,ic,od,rc,L1,fs,Dd,lp,Vd,Il,up,V,Xt,J,o,at,Yn,kt,Ut,it,N,Xe,st,hn,Yt,ue,z,H,Wt,Dn,kn,Ve,Ne,En,Zt,Je,_e,ce,Qt,de,xn,We,bt,mt,nt,Be,rt,Jt,gt,le,ve,Ie,It,Dt,qt,Bt,Z,Nt,Ze,lt,q,W,ot,i,O,_,G,F,C,P,T,I,h,w,b,v,s,u,a,d,r,be,ge,an,we,Ge,Pe,Un,Hi,Xn,Ui,yr,gr,uo,ui,rr,Jr,Ao,Lo,Dr,Gi,ci,jr,zr,xr,to,kr,Br,eo,Nr,wo,ho,Ir,Wr,ji,Wi,Fi,gi,Go,ca,Di,Ji,Xr,io,sn,je,re,ai,Pn,br,Qi,R,te,Re,$n,In,Ln,function(){n(31,Ad=ll.innerWidth),n(32,J1=ll.innerHeight)},g=>At(lc,On=g.detail,On),({detail:g})=>n(43,ct=g),function(g,j){t.$$.not_equal(wr[j],g)&&(wr[j]=g,n(1,wr),n(278,ha),n(27,Ra))},g=>np(g),g=>ip(g),(g,{detail:j})=>rp(g,j),g=>At(Cl,Pr=g.detail,Pr),function(g){t.$$.not_equal(wr[ct],g)&&(wr[ct]=g,n(1,wr),n(278,ha),n(27,Ra))},()=>np(ct),()=>ip(ct),({detail:g})=>rp(ct,g),g=>{const j={...g,...km()},{annotationShapes:ht,decorationShapes:wt,interfaceShapes:dt,frameShapes:yt,selectionShapes:Ot}=bl({annotationShapes:Le,decorationShapes:si,interfaceShapes:Ha,frameShapes:mi,selectionShapes:zn},j);return Am(j,jt,ht,wt,dt,yt,Ot)},()=>{n(63,Ud=!1),n(64,Gd=!1),n(65,jd=!1),n(66,Zd=!1),n(67,Xd=!1)},function(g){Nn[g?"unshift":"push"](()=>{vc=g,n(36,vc)})},function(g){Hr=g,n(0,Hr),n(266,De)},function(g){Fd=g,n(33,Fd)},function(g){Od=g,n(34,Od)},function(g){Nn[g?"unshift":"push"](()=>{Co=g,n(61,Co)})},function(g){Nn[g?"unshift":"push"](()=>{jn=g,n(2,jn)})},g=>At(I1,li=g.detail,li)]}class m$ extends Tn{constructor(e){super(),Sn(this,e,Z5,j5,yn,{class:236,layout:237,stores:238,locale:3,id:4,util:239,utils:240,animations:241,disabled:242,status:234,previewUpscale:243,previewPad:244,previewMaskOpacity:5,previewImageDataMaxSize:245,previewImageTextPixelRatio:6,markupMaskOpacity:7,zoomMaskOpacity:246,elasticityMultiplier:8,willRevert:247,willProcessImage:248,willRenderCanvas:9,willRenderToolbar:249,willRenderUtilTabs:250,willSetHistoryInitialState:251,enableButtonExport:252,enableButtonRevert:253,enableNavigateHistory:254,enableToolbar:10,enableUtils:255,enableButtonClose:256,enableDropImage:257,enablePasteImage:258,enableBrowseImage:259,enableTransparencyGrid:11,layoutDirectionPreference:260,layoutHorizontalUtilsPreference:261,layoutVerticalUtilsPreference:262,layoutVerticalToolbarPreference:263,layoutVerticalControlGroupsPreference:264,layoutVerticalControlTabsPreference:265,textDirection:12,markupEditorZoomLevel:266,markupEditorZoomLevels:13,markupEditorZoomAdjustStep:14,markupEditorZoomAdjustFactor:15,markupEditorZoomAdjustWheelFactor:16,markupEditorInteractionMode:267,muteAudio:268,willSetMediaInitialTimeOffset:269,enablePan:17,enableZoom:18,enableZoomControls:270,enableZoomInput:19,enablePanInput:271,enableCanvasAlpha:20,enablePanLimit:21,panLimitGutterScalar:22,pan:272,zoomPresetOptions:23,zoomAdjustStep:24,zoomAdjustFactor:25,zoomAdjustWheelFactor:26,zoomLevel:0,fixScrollDirection:273,hideTextInput:274,showTextInput:275,imagePreviewSrc:276,imageOrienter:277,pluginComponents:278,pluginOptions:27,sub:279,pluginInterface:1,root:2,play:280,pause:281,isPaused:282,togglePlayPause:283,mute:284,unmute:285,toggleMute:286,getDuration:287,getCurrentTime:288,setCurrentTime:289,imageSourceToImageData:28,imagePreview:29,imagePreviewCurrent:235,history:30},null,[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1])}get class(){return this.$$.ctx[236]}set class(e){this.$$set({class:e}),U()}get layout(){return this.$$.ctx[237]}set layout(e){this.$$set({layout:e}),U()}get stores(){return this.$$.ctx[238]}set stores(e){this.$$set({stores:e}),U()}get locale(){return this.$$.ctx[3]}set locale(e){this.$$set({locale:e}),U()}get id(){return this.$$.ctx[4]}set id(e){this.$$set({id:e}),U()}get util(){return this.$$.ctx[239]}set util(e){this.$$set({util:e}),U()}get utils(){return this.$$.ctx[240]}set utils(e){this.$$set({utils:e}),U()}get animations(){return this.$$.ctx[241]}set animations(e){this.$$set({animations:e}),U()}get disabled(){return this.$$.ctx[242]}set disabled(e){this.$$set({disabled:e}),U()}get status(){return this.$$.ctx[234]}set status(e){this.$$set({status:e}),U()}get previewUpscale(){return this.$$.ctx[243]}set previewUpscale(e){this.$$set({previewUpscale:e}),U()}get previewPad(){return this.$$.ctx[244]}set previewPad(e){this.$$set({previewPad:e}),U()}get previewMaskOpacity(){return this.$$.ctx[5]}set previewMaskOpacity(e){this.$$set({previewMaskOpacity:e}),U()}get previewImageDataMaxSize(){return this.$$.ctx[245]}set previewImageDataMaxSize(e){this.$$set({previewImageDataMaxSize:e}),U()}get previewImageTextPixelRatio(){return this.$$.ctx[6]}set previewImageTextPixelRatio(e){this.$$set({previewImageTextPixelRatio:e}),U()}get markupMaskOpacity(){return this.$$.ctx[7]}set markupMaskOpacity(e){this.$$set({markupMaskOpacity:e}),U()}get zoomMaskOpacity(){return this.$$.ctx[246]}set zoomMaskOpacity(e){this.$$set({zoomMaskOpacity:e}),U()}get elasticityMultiplier(){return this.$$.ctx[8]}set elasticityMultiplier(e){this.$$set({elasticityMultiplier:e}),U()}get willRevert(){return this.$$.ctx[247]}set willRevert(e){this.$$set({willRevert:e}),U()}get willProcessImage(){return this.$$.ctx[248]}set willProcessImage(e){this.$$set({willProcessImage:e}),U()}get willRenderCanvas(){return this.$$.ctx[9]}set willRenderCanvas(e){this.$$set({willRenderCanvas:e}),U()}get willRenderToolbar(){return this.$$.ctx[249]}set willRenderToolbar(e){this.$$set({willRenderToolbar:e}),U()}get willRenderUtilTabs(){return this.$$.ctx[250]}set willRenderUtilTabs(e){this.$$set({willRenderUtilTabs:e}),U()}get willSetHistoryInitialState(){return this.$$.ctx[251]}set willSetHistoryInitialState(e){this.$$set({willSetHistoryInitialState:e}),U()}get enableButtonExport(){return this.$$.ctx[252]}set enableButtonExport(e){this.$$set({enableButtonExport:e}),U()}get enableButtonRevert(){return this.$$.ctx[253]}set enableButtonRevert(e){this.$$set({enableButtonRevert:e}),U()}get enableNavigateHistory(){return this.$$.ctx[254]}set enableNavigateHistory(e){this.$$set({enableNavigateHistory:e}),U()}get enableToolbar(){return this.$$.ctx[10]}set enableToolbar(e){this.$$set({enableToolbar:e}),U()}get enableUtils(){return this.$$.ctx[255]}set enableUtils(e){this.$$set({enableUtils:e}),U()}get enableButtonClose(){return this.$$.ctx[256]}set enableButtonClose(e){this.$$set({enableButtonClose:e}),U()}get enableDropImage(){return this.$$.ctx[257]}set enableDropImage(e){this.$$set({enableDropImage:e}),U()}get enablePasteImage(){return this.$$.ctx[258]}set enablePasteImage(e){this.$$set({enablePasteImage:e}),U()}get enableBrowseImage(){return this.$$.ctx[259]}set enableBrowseImage(e){this.$$set({enableBrowseImage:e}),U()}get enableTransparencyGrid(){return this.$$.ctx[11]}set enableTransparencyGrid(e){this.$$set({enableTransparencyGrid:e}),U()}get layoutDirectionPreference(){return this.$$.ctx[260]}set layoutDirectionPreference(e){this.$$set({layoutDirectionPreference:e}),U()}get layoutHorizontalUtilsPreference(){return this.$$.ctx[261]}set layoutHorizontalUtilsPreference(e){this.$$set({layoutHorizontalUtilsPreference:e}),U()}get layoutVerticalUtilsPreference(){return this.$$.ctx[262]}set layoutVerticalUtilsPreference(e){this.$$set({layoutVerticalUtilsPreference:e}),U()}get layoutVerticalToolbarPreference(){return this.$$.ctx[263]}set layoutVerticalToolbarPreference(e){this.$$set({layoutVerticalToolbarPreference:e}),U()}get layoutVerticalControlGroupsPreference(){return this.$$.ctx[264]}set layoutVerticalControlGroupsPreference(e){this.$$set({layoutVerticalControlGroupsPreference:e}),U()}get layoutVerticalControlTabsPreference(){return this.$$.ctx[265]}set layoutVerticalControlTabsPreference(e){this.$$set({layoutVerticalControlTabsPreference:e}),U()}get textDirection(){return this.$$.ctx[12]}set textDirection(e){this.$$set({textDirection:e}),U()}get markupEditorZoomLevel(){return this.$$.ctx[266]}set markupEditorZoomLevel(e){this.$$set({markupEditorZoomLevel:e}),U()}get markupEditorZoomLevels(){return this.$$.ctx[13]}set markupEditorZoomLevels(e){this.$$set({markupEditorZoomLevels:e}),U()}get markupEditorZoomAdjustStep(){return this.$$.ctx[14]}set markupEditorZoomAdjustStep(e){this.$$set({markupEditorZoomAdjustStep:e}),U()}get markupEditorZoomAdjustFactor(){return this.$$.ctx[15]}set markupEditorZoomAdjustFactor(e){this.$$set({markupEditorZoomAdjustFactor:e}),U()}get markupEditorZoomAdjustWheelFactor(){return this.$$.ctx[16]}set markupEditorZoomAdjustWheelFactor(e){this.$$set({markupEditorZoomAdjustWheelFactor:e}),U()}get markupEditorInteractionMode(){return this.$$.ctx[267]}set markupEditorInteractionMode(e){this.$$set({markupEditorInteractionMode:e}),U()}get muteAudio(){return this.$$.ctx[268]}set muteAudio(e){this.$$set({muteAudio:e}),U()}get willSetMediaInitialTimeOffset(){return this.$$.ctx[269]}set willSetMediaInitialTimeOffset(e){this.$$set({willSetMediaInitialTimeOffset:e}),U()}get enablePan(){return this.$$.ctx[17]}set enablePan(e){this.$$set({enablePan:e}),U()}get enableZoom(){return this.$$.ctx[18]}set enableZoom(e){this.$$set({enableZoom:e}),U()}get enableZoomControls(){return this.$$.ctx[270]}set enableZoomControls(e){this.$$set({enableZoomControls:e}),U()}get enableZoomInput(){return this.$$.ctx[19]}set enableZoomInput(e){this.$$set({enableZoomInput:e}),U()}get enablePanInput(){return this.$$.ctx[271]}set enablePanInput(e){this.$$set({enablePanInput:e}),U()}get enableCanvasAlpha(){return this.$$.ctx[20]}set enableCanvasAlpha(e){this.$$set({enableCanvasAlpha:e}),U()}get enablePanLimit(){return this.$$.ctx[21]}set enablePanLimit(e){this.$$set({enablePanLimit:e}),U()}get panLimitGutterScalar(){return this.$$.ctx[22]}set panLimitGutterScalar(e){this.$$set({panLimitGutterScalar:e}),U()}get pan(){return this.$$.ctx[272]}set pan(e){this.$$set({pan:e}),U()}get zoomPresetOptions(){return this.$$.ctx[23]}set zoomPresetOptions(e){this.$$set({zoomPresetOptions:e}),U()}get zoomAdjustStep(){return this.$$.ctx[24]}set zoomAdjustStep(e){this.$$set({zoomAdjustStep:e}),U()}get zoomAdjustFactor(){return this.$$.ctx[25]}set zoomAdjustFactor(e){this.$$set({zoomAdjustFactor:e}),U()}get zoomAdjustWheelFactor(){return this.$$.ctx[26]}set zoomAdjustWheelFactor(e){this.$$set({zoomAdjustWheelFactor:e}),U()}get zoomLevel(){return this.$$.ctx[0]}set zoomLevel(e){this.$$set({zoomLevel:e}),U()}get fixScrollDirection(){return this.$$.ctx[273]}set fixScrollDirection(e){this.$$set({fixScrollDirection:e}),U()}get hideTextInput(){return this.$$.ctx[274]}get showTextInput(){return this.$$.ctx[275]}get imagePreviewSrc(){return this.$$.ctx[276]}set imagePreviewSrc(e){this.$$set({imagePreviewSrc:e}),U()}get imageOrienter(){return this.$$.ctx[277]}set imageOrienter(e){this.$$set({imageOrienter:e}),U()}get pluginComponents(){return this.$$.ctx[278]}set pluginComponents(e){this.$$set({pluginComponents:e}),U()}get pluginOptions(){return this.$$.ctx[27]}set pluginOptions(e){this.$$set({pluginOptions:e}),U()}get sub(){return this.$$.ctx[279]}get pluginInterface(){return this.$$.ctx[1]}get root(){return this.$$.ctx[2]}set root(e){this.$$set({root:e}),U()}get play(){return this.$$.ctx[280]}get pause(){return this.$$.ctx[281]}get isPaused(){return this.$$.ctx[282]}get togglePlayPause(){return this.$$.ctx[283]}get mute(){return this.$$.ctx[284]}get unmute(){return this.$$.ctx[285]}get toggleMute(){return this.$$.ctx[286]}get getDuration(){return this.$$.ctx[287]}get getCurrentTime(){return this.$$.ctx[288]}get setCurrentTime(){return this.$$.ctx[289]}get imageSourceToImageData(){return this.$$.ctx[28]}set imageSourceToImageData(e){this.$$set({imageSourceToImageData:e}),U()}get imagePreview(){return this.$$.ctx[29]}get imagePreviewCurrent(){return this.$$.ctx[235]}set imagePreviewCurrent(e){this.$$set({imagePreviewCurrent:e}),U()}get history(){return this.$$.ctx[30]}}typeof window<"u"&&(t=>{if(t&&t._l052uvt)return;const[e,n,i]=[[99,111,110,115,111,108,101],[108,111,103],[84,104,105,115,32,118,101,114,115,105,111,110,32,111,102,32,80,105,110,116,117,114,97,32,105,115,32,102,111,114,32,116,101,115,116,105,110,103,32,112,117,114,112,111,115,101,115,32,111,110,108,121,46,32,86,105,115,105,116,32,104,116,116,112,115,58,47,47,112,113,105,110,97,46,110,108,47,112,105,110,116,117,114,97,32,116,111,32,112,117,114,99,104,97,115,101,32,97,32,108,105,99,101,110,115,101,46,32,86,105,115,105,116,32,104,116,116,112,115,58,47,47,112,113,105,110,97,46,110,108,47,112,105,110,116,117,114,97,47,99,104,97,116,32,105,102,32,121,111,117,32,104,97,118,101,32,97,110,121,32,113,117,101,115,116,105,111,110,115,46]].map(r=>r.map(o=>String.fromCharCode(o)).join(""));t&&t[e]&&t[e][n](i)})(window);const X5=["klass","stores","isVisible","isActive","isActiveFraction","locale"],q5=["history","klass","stores","navButtons","pluginComponents","pluginInterface","pluginOptions","sub","imagePreviewSrc","imagePreview","imagePreviewCurrent"],Y5=["locale"];let th;const px=new Set([]),Cu={},Ah=new Map,K5=(...t)=>{t.filter(e=>!!e.util).forEach(e=>{const[n,i,r=()=>!0]=e.util;Ah.has(n)||(Ah.set(n,{Component:i,isSupported:r}),$0(i).filter(o=>!X5.includes(o)).forEach(o=>{px.add(o),Cu[o]?Cu[o].push(n):Cu[o]=[n]}))})};var hx=[...A2,"init","update","undo","redo","revert","writehistory","destroy","show","hide","close","ready","zoom","pan","loadpreview","selectshape","blurshape","updateshape","addshape","removeshape","selectstyle","markuptap","markupzoom","markuppan","selectutil","selectcontrol","selectiondown","selectionup","selectionchange"],J5=(t,e,n={})=>{const{prefix:i="pintura:"}=n;return hx.map(r=>t.on(r,o=>Zc(e)?((a,s,l)=>a.dispatchEvent(new CustomEvent(s,{detail:l,bubbles:!0,cancelable:!0})))(e,`${i}${r}`,o):e(r,o)))};const Q5=()=>[.75,.25,.25,0,0,.25,.75,.25,0,0,.25,.25,.75,0,0,0,0,0,1,0],t3=()=>[1.398,-.316,.065,-.273,.201,-.051,1.278,-.08,-.273,.201,-.051,.119,1.151,-.29,.215,0,0,0,1,0],e3=()=>[1.073,-.015,.092,-.115,-.017,.107,.859,.184,-.115,-.017,.015,.077,1.104,-.115,-.017,0,0,0,1,0],n3=()=>[1.06,0,0,0,0,0,1.01,0,0,0,0,0,.93,0,0,0,0,0,1,0],i3=()=>[1.1,0,0,0,-.1,0,1.1,0,0,-.1,0,0,1.2,0,-.1,0,0,0,1,0],r3=()=>[.212,.715,.114,0,0,.212,.715,.114,0,0,.212,.715,.114,0,0,0,0,0,1,0],o3=()=>[.15,1.3,-.25,.1,-.2,.15,1.3,-.25,.1,-.2,.15,1.3,-.25,.1,-.2,0,0,0,1,0],a3=()=>[.163,.518,.084,-.01,.208,.163,.529,.082,-.02,.21,.171,.529,.084,0,.214,0,0,0,1,0],s3=()=>[.338,.991,.117,.093,-.196,.302,1.049,.096,.078,-.196,.286,1.016,.146,.101,-.196,0,0,0,1,0],l3=()=>[.393,.768,.188,0,0,.349,.685,.167,0,0,.272,.533,.13,0,0,0,0,0,1,0],c3=()=>[.289,.62,.185,0,.077,.257,.566,.163,0,.115,.2,.43,.128,0,.188,0,0,0,1,0],d3=()=>[.269,.764,.172,.05,.1,.239,.527,.152,0,.176,.186,.4,.119,0,.159,0,0,0,1,0],u3=()=>[.547,.764,.134,0,-.147,.281,.925,.12,0,-.135,.225,.558,.33,0,-.113,0,0,0,1,0],mx={chrome:t3,fade:e3,pastel:Q5,cold:i3,warm:n3,monoDefault:r3,monoWash:a3,monoNoir:o3,monoStark:s3,sepiaDefault:l3,sepiaRust:d3,sepiaBlues:c3,sepiaColor:u3};var p3={filterFunctions:mx,filterOptions:[["Default",[[void 0,t=>t.labelDefault]]],["Classic",[["chrome",t=>t.filterLabelChrome],["fade",t=>t.filterLabelFade],["cold",t=>t.filterLabelCold],["warm",t=>t.filterLabelWarm],["pastel",t=>t.filterLabelPastel]]],["Monochrome",[["monoDefault",t=>t.filterLabelMonoDefault],["monoNoir",t=>t.filterLabelMonoNoir],["monoStark",t=>t.filterLabelMonoStark],["monoWash",t=>t.filterLabelMonoWash]]],["Sepia",[["sepiaDefault",t=>t.filterLabelSepiaDefault],["sepiaRust",t=>t.filterLabelSepiaRust],["sepiaBlues",t=>t.filterLabelSepiaBlues],["sepiaColor",t=>t.filterLabelSepiaColor]]]]};const h3={borderColor:"strokeColor",borderWidth:"strokeWidth",lineWidth:"strokeWidth",fontColor:"color",lineColor:"strokeColor",src:"backgroundImage",fit:"backgroundSize"},uu=t=>t===0||t==="0%"||t==="0px"?0:/px$/.test(t)?parseInt(t,10):/\%$/.test(t)?t:t<=1?100*t+"%":void 0,pu=(t,e)=>{let n,i;return/%$/.test(t)?(n=parseFloat(t),i=parseFloat(e),n+i+"%"):/px$/.test(t)?(n=parseInt(t,10),i=parseInt(e,10),n+i+"px"):void 0},g$=(t,e)=>{const n=t,i=e,r=1.5707963267948966-e,o=Math.sin(1.5707963267948966),a=Math.sin(i),s=Math.sin(r),l=Math.cos(r),c=n/o;return pt(l*(c*a),l*(c*s))},m3=(t,{flip:e,aspectRatio:n,rotation:i,center:r,zoom:o,scaleToFit:a})=>{const s={flipX:!1,flipY:!1},l=!r||r&&r.x===.5&&r.y===.5;e&&e.horizontal&&(s.flipX=e.horizontal),e&&e.vertical&&(s.flipY=e.vertical);const c=((y,m)=>m!=null?1/m:y.width/y.height)(t,n),d=a!==!1,u=((y,m,f=1)=>{const b=y.height/y.width,v=m;let w=1,T=b;T>v&&(T=v,w=T/b);const I=Math.max(1/w,v/T),P=y.width/(f*I*w);return{width:P,height:P*m}})(t,n,o),p=l?t:((y,m)=>{const f=m.x>.5?1-m.x:m.x,b=m.y>.5?1-m.y:m.y;return sr(2*f*y.width,2*b*y.height)})(t,d?r:{x:.5,y:.5}),h=((y,m)=>{let f=y.width,b=f*m;b>y.height&&(b=y.height,f=b/m);const v=.5*(y.width-f),w=.5*(y.height-b);return Ci(v,w,f,b)})(t,n);if((n||!l||o)&&(s.crop=Kr(Fr(p),c)),typeof i=="number"&&i!==null&&i!==0){i!=null&&(s.rotation=i);const y=((C,F)=>{const G=C.width,O=C.height,$=g$(G,F),N=g$(O,F),it=pt(C.x+Math.abs($.x),C.y-Math.abs($.y)),M=pt(C.x+C.width+Math.abs(N.y),C.y+Math.abs(N.x)),W=pt(C.x-Math.abs(N.y),C.y+C.height-Math.abs(N.x));return{width:Yr(it,M),height:Yr(it,W)}})(h,i),m=Math.max(y.width/p.width,y.height/p.height),f=pt(r.x*t.width,r.y*t.height),b=Ny(t,i),v=ul(b),w=pt(.5*(b.width-t.width),.5*(b.height-t.height)),T=$r({x:w.x+f.x-u.width/m*.5,y:w.y+f.y-u.height/m*.5,width:u.width/m,height:u.height/m},i),I=ls(T.map(Ue),i,v.x,v.y),P=wn(Vi(I)),_=ls(I.map(Ue),-2*i,P.x,P.y);s.crop=Vi(_)}else o!=null&&Sr(s.crop,1/o);return d||(s.cropLimitToImage=!1),s};var g3=(t,e,n={})=>{const i={};if(!((o={})=>{if("markup"in o||"color"in o||"filter"in o)return!0;const{crop:a}=o;return!(!a||!("flip"in a||"center"in a||"aspectRatio"in a||"rotation"in a))})(n))return n;if(n.crop&&Object.assign(i,m3(e,n.crop)),n.markup){const o=Array.isArray(n.markup)?n.markup:Object.values(n.markup);i.decoration=o.map(a=>((s,l,c)=>{const d=Object.keys(c).reduce((u,p)=>{let h=c[p];return p=h3[p]||p,/px$/.test(h)?h=uu(h):/^(?:x|y|left|right|top|bottom|width|height|fontSize|borderWidth|strokeWidth)$/.test(p)&&typeof h=="number"&&(p!=="strokeWidth"&&p!=="borderWidth"&&p!=="fontSize"||(h=Math.min(s.width,s.height)*h+"px"),h=uu(h)),/color/i.test(p)&&h&&(h=Nu(h)),h===null&&(h=void 0),u[p]=h,u},{});if(l==="line"&&(d.lineDecoration.length>=1&&(d.lineEnd="arrow"),d.lineDecoration.length===2&&(d.lineStart="arrow"),d.x1=d.x,d.y1=d.y,d.x2=pu(d.x,d.width),d.y2=pu(d.y,d.height),delete d.x,delete d.y,delete d.width,delete d.height,delete d.lineDecoration,delete d.lineStyle),l==="text"){if(!dn(d.y)){const u=Math.min(s.width,s.height);d.y=u*(parseFloat(d.y)/100)}d.y=d.y-d.fontSize,delete d.width,delete d.height,delete d.borderStyle,d.lineHeight=d.lineHeight||"120%"}if(l==="ellipse"){let u,p;if(/%$/.test(d.width)){u=parseFloat(d.width)/100,p=parseFloat(d.height)/100;const h=u*s.width,y=p*s.height;u=h/s.width*100,p=y/s.height*100}else u=d.width,p=d.height;d.rx=.5*u,d.ry=.5*p,/%$/.test(d.width)&&(d.rx+="%",d.ry+="%"),d.x=pu(d.x,d.rx),d.y=pu(d.y,d.ry),delete d.width,delete d.height,delete d.borderStyle}if(l==="rect"&&delete d.borderStyle,l==="path"){let u,p=[];for(const h of d.points)u?yo(u,h)<1e-9||(p.push(h),u=h,u=h):(p.push(h),u=h);d.points=p.map(h=>({x:uu(h.x),y:uu(h.y)}))}return d})(i.crop||e,a[0],a[1]))}if(n.color||n.colors){const o=n.color||n.colors;Object.keys(o).filter(a=>o[a]).map(a=>[a,Array.isArray(o[a].matrix)?o[a].matrix:Object.values(o[a].matrix)]).forEach(([a,s])=>{i.colorMatrix||(i.colorMatrix={}),i.colorMatrix[a]=s})}if(n.filter||n.filters){const o=n.filters||n.filter;i.colorMatrix||(i.colorMatrix={});const a=t?t.filterFunctions:mx;i.colorMatrix.filter=typeof o=="string"&&a[o]?a[o]():o.matrix}const r=n.size?n.size:!!n.resize&&n.resize.size;return r&&r.width&&r.height&&(i.targetSize={width:r.width,height:r.height}),i};const f3={base:0,min:-.25,max:.25,getLabel:t=>ks(t/.25),getStore:({imageColorMatrix:t})=>t,getValue:t=>{if(t.brightness)return t.brightness[4]},setValue:(t,e)=>t.update(n=>({...n,brightness:[1,0,0,0,e,0,1,0,0,e,0,0,1,0,e,0,0,0,1,0]}))},$3={base:1,min:.5,max:1.5,getLabel:t=>ks(2*(t-.5)-1),getStore:({imageColorMatrix:t})=>t,getValue:t=>{if(t.contrast)return t.contrast[0]},setValue:(t,e)=>t.update(n=>({...n,contrast:[e,0,0,0,.5*(1-e),0,e,0,0,.5*(1-e),0,0,e,0,.5*(1-e),0,0,0,1,0]}))},y3={base:1,min:0,max:2,getLabel:t=>ks(t-1),getStore:({imageColorMatrix:t})=>t,getValue:t=>{if(t.saturation)return(t.saturation[0]-.213)/.787},setValue:(t,e)=>t.update(n=>({...n,saturation:[.213+.787*e,.715-.715*e,.072-.072*e,0,0,.213-.213*e,.715+.285*e,.072-.072*e,0,0,.213-.213*e,.715-.715*e,.072+.928*e,0,0,0,0,0,1,0]}))},x3={base:1,min:.5,max:1.5,getLabel:t=>ks(2*(t-.5)-1),getStore:({imageColorMatrix:t})=>t,getValue:t=>{if(t.exposure)return t.exposure[0]},setValue:(t,e)=>t.update(n=>({...n,exposure:[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0]}))},b3={base:1,min:.15,max:4,getLabel:t=>ks(t<1?(t-.15)/.85-1:(t-1)/3),getStore:({imageGamma:t})=>t},v3={base:0,min:-1,max:1,getStore:({imageVignette:t})=>t},w3={base:0,min:-1,max:1,getStore:({imageConvolutionMatrix:t})=>t,getValue:t=>{if(t.clarity)return t.clarity[0]===0?t.clarity[1]/-1:t.clarity[1]/-2},setValue:(t,e)=>{t.update(n=>({...n,clarity:e>=0?[0,-1*e,0,-1*e,1+4*e,-1*e,0,-1*e,0]:[-1*e,-2*e,-1*e,-2*e,1+-3*e,-2*e,-1*e,-2*e,-1*e]}))}},S3={base:0,min:-1,max:1,getStore:({imageColorMatrix:t})=>t,getValue:t=>{if(!t.temperature)return;const e=t.temperature[0];return e>=1?(e-1)/.1:(1-e)/-.15},setValue:(t,e)=>t.update(n=>({...n,temperature:e>0?[1+.1*e,0,0,0,0,0,1,0,0,0,0,0,1+.1*-e,0,0,0,0,0,1,0]:[1+.15*e,0,0,0,0,0,1+.05*e,0,0,0,0,0,1+.15*-e,0,0,0,0,0,1,0]}))};var T3={finetuneControlConfiguration:{gamma:b3,brightness:f3,contrast:$3,saturation:y3,exposure:x3,temperature:S3,clarity:w3,vignette:v3},finetuneOptions:[["brightness",t=>t.finetuneLabelBrightness],["contrast",t=>t.finetuneLabelContrast],["saturation",t=>t.finetuneLabelSaturation],["exposure",t=>t.finetuneLabelExposure],["temperature",t=>t.finetuneLabelTemperature],["gamma",t=>t.finetuneLabelGamma],!f0()&&["clarity",t=>t.finetuneLabelClarity],["vignette",t=>t.finetuneLabelVignette]].filter(Boolean)},Zl=t=>t.charAt(0).toUpperCase()+t.slice(1);let Ec=null;var eh=()=>{if(Ec===null)if(ir())try{Ec=document.fonts.check("16px TestNonExistingFont")===!1}catch{Ec=!1}else Ec=!1;return Ec};const Jc=(t,e)=>n=>n[e?`${e}${Zl(t)}`:t],C3=t=>[t,""+t],n1=(t,e)=>n=>[t[n],Jc(n,e)],gx=t=>Array.isArray(t)&&t.every(dn)?t.map(C3):t,ol=[1,.2549,.2118],f$=[1,1,1,0],M3=t=>{const{hideLabel:e=!0}=t||{};return W3(["new","add","subtract"].map(n=>[n,Jc(n,"shapeLabelSelectionMode"),{icon:Jc(n,"shapeIconSelectionMode"),hideLabel:e}]),{title:n=>n.shapeTitleSelectionMode,layout:"radio"})},k3=t=>$x(t,{title:e=>e.shapeTitleBrushSize,layout:"radio",optionHideLabel:!0,optionIcon:(e,n)=>`<circle fill="currentColor" stroke-width=".05em" stroke="currentColor" fill-opacity=".25" cx="12" cy="12" r="${2+8*n}"/>`}),$$={eraser:()=>({eraseRadius:8,cursorStyle:"ellipse",cursorSize:"eraseRadius"}),path:()=>({points:[],disableAddPoints:!1}),line:()=>({x1:0,y1:0,x2:0,y2:0,disableErase:!1}),rectangle:()=>({x:0,y:0,width:0,height:0}),ellipse:()=>({x:0,y:0,rx:0,ry:0}),text:()=>({x:0,y:0,text:"Text"})},ys=(t,e={},n)=>{if(!$$[t])return;const{position:i="relative",inputMode:r="drag",isSelection:o=!1}=n||{};return[{...$$[t](),...e},{position:i,inputMode:r,isSelection:o}]},E3=t=>{const e={sharpie:ys("path",{bitmap:!0,strokeJoin:"round",strokeCap:"round",strokeWidth:"0.5%",strokeColor:[...ol],cursorStyle:"ellipse",cursorSize:"strokeWidth",disableErase:!1,disableResize:!0,disableMove:!0}),eraser:ys("eraser"),path:ys("path",{pathClose:void 0,strokeWidth:"0.5%",strokeColor:[...ol],backgroundColor:[0,0,0,0]},{inputMode:"step"}),line:ys("line",{strokeColor:[...ol],strokeWidth:"0.5%"}),arrow:ys("line",{lineStart:"none",lineEnd:"arrow-solid",strokeColor:[...ol],strokeWidth:"0.5%"}),rectangle:ys("rectangle",{strokeColor:[...f$],backgroundColor:[...ol]}),ellipse:ys("ellipse",{strokeColor:[...f$],backgroundColor:[...ol]}),text:ys("text",{color:[...ol],fontSize:"2%"})};return t&&Object.entries(t).forEach(([n,i])=>{Array.isArray(i)?e[n]=i:Fs(i)&&e[n]&&(e[n]=[{...e[n][0],...i},e[n][1]])}),e},nh=(t,e,n)=>[t,e||Jc(t,"shapeLabelTool"),{icon:Jc(t,"shapeIconTool"),...n}],P3=(t=["move","view","sharpie","eraser","path","line","arrow","rectangle","ellipse","text","preset"])=>t.map(e=>Qe(e)?nh(e):Array.isArray(e)?Fs(e[1])?nh(e[0],void 0,e[1]):nh(e[0],e[1],e[2]):void 0).filter(Boolean),I3=t=>Object.keys(t).map(n1(t,"shapeTitleColor")),R3=t=>Object.keys(t).map(n1(t,"labelSize")),A3=t=>Object.keys(t).map(n1(t,"labelSize")),y$=t=>Object.keys(t).map(n1(t,"labelSize")),L3=t=>[...t],O3=t=>t.map(e=>[e,n=>n["shapeLabelFontStyle"+e.filter(i=>i!=="normal").map(Zl).join("")]]),F3=t=>t.map(e=>[dx(e),n=>n["shapeTitleLineDecoration"+Zl(e)],{icon:n=>n["shapeIconLineDecoration"+Zl(e)]}]),Na=(t,e)=>{const{defaultKey:n,defaultValue:i,defaultOptions:r}=e||{},o=[];return n&&(o[0]=[i,a=>a[n],{...r}]),[...o,...t]},x$=t=>t.split(",").map(e=>e.trim()).some(e=>document.fonts.check("16px "+e)),b$=(t={})=>["ToggleSlider",{...t}],_3=(t,e={defaultKey:"labelDefault"})=>["Dropdown",{title:n=>n.shapeTitleFontFamily,onload:({options:n=[]})=>{eh()&&n.map(([i])=>i).filter(Boolean).filter(i=>!x$(i)).forEach(i=>{const r="PinturaFontTest-"+i.replace(/[^a-zA-Z0-9]+/g,"").toLowerCase();document.getElementById(r)||document.body.append(fi("span",{textContent:" ",id:r,class:"PinturaFontTest",style:`font-family:${i};font-size:0;color:transparent;`}))})},ondestroy:()=>{eh()&&document.querySelectorAll(".PinturaFontTest").forEach(n=>n.remove())},optionLabelStyle:n=>"font-family: "+n,options:Na(t,e),optionFilter:n=>{if(!eh())return!0;const[i]=n;return i?x$(i):!0}}],S0=(t,e={})=>["ColorPicker",{options:Na(t),...e}],D3=(t,e={})=>S0(t,{title:n=>n.labelColor,...e}),fx=t=>(e,n={})=>S0(e,{title:i=>i[t],...n}),z3=fx("shapeTitleBackgroundColor"),B3=fx("shapeTitleTextColor"),N3=(t,e={})=>S0(t,{title:n=>n.shapeTitleStrokeColor,options:Na(t),buttonClass:"PinturaColorPickerButtonStroke",onchange:(n,i)=>{const r=i.strokeWidth;(dn(r)||Qe(r)?parseFloat(r):0)>0||(i.strokeWidth=e&&e.defaultStrokeWidth||"0.5%")},...e}),$x=(t,e)=>{const{title:n,optionHideLabel:i=!1,layout:r,optionIcon:o=!1}=e||{},a=gx(t),s=t.map(([u])=>Qe(u)?parseFloat(u):u),l=Math.max(...s),c=Math.min(...s),d=l-c;return[r==="radio"?"RadioGroup":"Dropdown",{title:n===!1?void 0:n||(u=>u.shapeTitleStrokeWidth),options:u=>{const p=e?a.map(h=>{const[y,m,f={}]=h,b=Qe(y)?parseFloat(y):y,v=(b-c)/d;let w;return o==="line"?w=`<path stroke="currentColor" stroke-linecap="square" stroke-width="${.1+.875*v}em" d="M3,12 H20"/>`:o==="dot"?w=`<circle fill="currentColor" cx="12" cy="12" r="${2+8*v}"/>`:Qe(o)?w=o:Si(o)&&(w=o(b,v)),[y,m,{icon:w,hideLabel:i,...f}]}):a;return Ee(u,"backgroundColor")?Na(p,{defaultKey:"shapeLabelStrokeNone"}):Na(p)},onchange:(u,p)=>{if(!u)return;const h=p.strokeColor||[];if(h[3])return;const y=[...h];y[3]=1,p.strokeColor=y}}]},W3=(t,e)=>{const{title:n,layout:i}=e||{};return[i==="radio"?"RadioGroup":"Dropdown",{title:n,options:Na(t)}]},yx=(t,e,n)=>["Dropdown",{title:i=>i[e],options:Na(t,{defaultKey:"labelNone",defaultOptions:{icon:'<g stroke="currentColor" stroke-linecap="round" stroke-width=".125em"><path d="M5,12 H14"/></g>'}}),optionIconStyle:n}],V3=t=>yx(t,"shapeTitleLineStart","transform: scaleX(-1)"),H3=t=>yx(t,"shapeTitleLineEnd"),U3=t=>["Dropdown",{title:e=>e.shapeTitleFontStyle,optionLabelStyle:e=>e&&`font-style:${e[0]};font-weight:${e[1]}`,options:Na(t,{defaultKey:"shapeLabelFontStyleNormal"})}],xx=t=>["ShorthandControl",t],bx=(t,e,n,i)=>{i||t.find(([o])=>o===n)||(i={defaultKey:"labelAuto",defaultValue:n});const r=gx(t);return["Dropdown",{title:e,options:Na(r,i),...i}]},G3=(t,e)=>bx(t,n=>n.shapeTitleFontSize,"4%",e),j3=(t,e)=>bx(t,n=>n.shapeTitleLineHeight,"120%",e),Z3=t=>["RadioGroup",{title:e=>e.shapeTitleTextAlign,options:Na(t)}],ih={colorOptions:()=>I3({transparent:[1,1,1,0],white:[1,1,1],silver:[.8667,.8667,.8667],gray:[.6667,.6667,.6667],black:[0,0,0],navy:[0,.1216,.2471],blue:[0,.4549,.851],aqua:[.498,.8588,1],teal:[.2235,.8,.8],olive:[.2392,.6,.4392],green:[.1804,.8,.251],yellow:[1,.8627,0],orange:[1,.5216,.1059],red:[1,.2549,.2118],maroon:[.5216,.0784,.2941],fuchsia:[.9412,.0706,.7451],purple:[.6941,.051,.7882]}),lineEndStyleOptions:()=>F3(["bar","arrow","arrowSolid","circle","circleSolid","square","squareSolid"]),fontFamilyOptions:()=>L3([["Helvetica, Arial, Verdana, 'Droid Sans', sans-serif","Sans Serif"],["'Arial Black', 'Avenir-Black', 'Arial Bold'","Black"],["'Arial Narrow', 'Futura-CondensedMedium'","Narrow"],["'Trebuchet MS'","Humanist"],["Georgia, 'Avenir-Black', 'Times New Roman', 'Droid Serif', serif","Serif"],["Palatino","Old-Style"],["'Times New Roman', 'TimesNewRomanPSMT'","Transitional"],["Menlo, Monaco, 'Lucida Console', monospace","Monospaced"],["'Courier New', monospace","Slab Serif"]]),fontStyleOptions:()=>O3([["normal","bold"],["italic","normal"],["italic","bold"]]),textAlignOptions:()=>["left","center","right"].map(t=>[t,e=>e["shapeTitleTextAlign"+Zl(t)],{hideLabel:!0,icon:e=>e["shapeIconTextAlign"+Zl(t)]}]),strokeWidthOptions:()=>y$({extraSmall:"0.25%",small:"0.5%",mediumSmall:"1%",medium:"1.75%",mediumLarge:"2.5%",large:"3.5%",extraLarge:"5%"}),brushSizeOptions:()=>y$(Object.entries({extraSmall:"0.25%",small:"0.5%",mediumSmall:"1%",medium:"1.75%",mediumLarge:"2.5%",large:"3.5%",extraLarge:"5%"}).reduce((t,[e,n])=>(t[e]=2*parseFloat(n)+"%",t),{})),fontSizeOptions:()=>R3({extraSmall:"2%",small:"4%",mediumSmall:"8%",medium:"10%",mediumLarge:"15%",large:"20%",extraLarge:"25%"}),lineHeightOptions:()=>A3({extraSmall:"40%",small:"60%",mediumSmall:"100%",medium:"120%",mediumLarge:"140%",large:"180%",extraLarge:"220%"})},X3=new Intl.NumberFormat("default",{minimumFractionDigits:1,maximumFractionDigits:1}),vx=(t,e)=>Qe(e)?t+"%":t,wx=(t,e,n,i)=>Qe(i)?Math.round(t/n*100)+"%":""+X3.format(t),rh={getValue:t=>parseFloat(t),setValue:vx,label:wx,step:.05,labelClass:"PinturaPercentageLabel"},q3={factory:xx,options:{title:"Text shadow",controls:[["ToggleSlider","x",{...rh,min:-100,max:100,labelPrefix:"X"}],["ToggleSlider","y",{...rh,min:-100,max:100,labelPrefix:"Y"}],["ToggleSlider","blur",{...rh,min:0,max:25,labelPrefix:t=>t.shapeTitleTextShadowBlur}],["ColorPicker","color",{enablePresets:!1}]]}},hu={defaultColor:{factory:D3,items:"colorOptions"},defaultNumber:{factory:b$},defaultPercentage:{factory:b$,options:{getValue:t=>parseFloat(t),setValue:t=>t+"%",step:.05,label:(t,e,n)=>Math.round(t/n*100)+"%",labelClass:"PinturaPercentageLabel"}},backgroundColor:{items:"colorOptions",factory:z3},strokeColor:{items:"colorOptions",factory:N3},strokeWidth:{items:"strokeWidthOptions",factory:$x},brushSize:{items:"brushSizeOptions",factory:k3},drawMode:{factory:M3},lineStart:{items:"lineEndStyleOptions",factory:V3},lineEnd:{items:"lineEndStyleOptions",factory:H3},color:{items:"colorOptions",factory:B3},fontFamily:{items:"fontFamilyOptions",factory:_3},fontStyle_fontWeight:{items:"fontStyleOptions",factory:U3},fontSize:{items:"fontSizeOptions",factory:G3},lineHeight:{items:"lineHeightOptions",factory:j3},textAlign:{items:"textAlignOptions",factory:Z3},textShadowX_textShadowY_textShadowBlur_textShadowColor:q3,textOutlineWidth_textOutlineColor:{factory:xx,options:{title:"Text outline",controls:[["ToggleSlider","width",{getValue:t=>parseFloat(t),setValue:vx,label:wx,min:0,max:15,step:.05,labelClass:"PinturaPercentageLabel",labelPrefix:t=>t.shapeTitleTextOutlineWidth}],["ColorPicker","color",{enablePresets:!1}]]}},cornerRadius:{factory:"defaultPercentage",options:{min:0,max:50,title:t=>t.shapeTitleCornerRadius}},frameColor:{factory:"defaultColor"},frameSize:{factory:"defaultPercentage",options:{min:.2,max:10,title:t=>t.labelSize}},frameInset:{factory:"defaultPercentage",options:{min:.5,max:10,title:t=>t.labelOffset}},frameOffset:{factory:"defaultPercentage",options:{min:.5,max:10,title:t=>t.labelOffset}},frameRadius:{factory:"defaultPercentage",options:{min:.5,max:10,title:t=>t.labelRadius}},frameAmount:{factory:"defaultNumber",options:{min:1,max:5,step:1,title:t=>t.labelAmount}}},Y3=(t={})=>{const e={...hu,...t},n={};return Object.entries(e).forEach(([i,r])=>{if(!/Options$/.test(i))if(hu[i]&&Fs(r)&&!qi(r)){const{component:o,factory:a,items:s,options:l={}}=e[i];if(Qe(a))n[i]=[a,l];else{const c=hu[i].items;let d=Qe(c)?e[c]||ih[c]():void 0;Qe(s)&&ih[s]?d=e[s]?e[s].every(p=>!Array.isArray(p))?e[s].map(p=>[p,p]):e[s]:ih[s]():(s||l.items)&&(d=s||l.items);let u=a||hu[i].factory;Si(u)?n[i]=d?u(d,l):u(l):o&&(n[i]=[o,{...l,items:s}])}}else n[i]=r}),n};function K3(t){let e,n,i,r,o;const a=t[7].default,s=ur(a,t,t[6],null);return{c(){e=ft("div"),n=ft("div"),s&&s.c(),S(n,"class","PinturaToolbarInner"),S(e,"class","PinturaToolbar"),S(e,"data-layout",t[1]),S(e,"data-overflow",t[0])},m(l,c){tt(l,e,c),Et(e,n),s&&s.m(n,null),i=!0,r||(o=[St(n,"measure",t[3]),qn(Cr.call(null,n)),St(e,"measure",t[2]),qn(Cr.call(null,e))],r=!0)},p(l,[c]){s&&s.p&&(!i||64&c)&&hr(s,a,l,l[6],i?pr(a,l[6],c,null):mr(l[6]),null),(!i||2&c)&&S(e,"data-layout",l[1]),(!i||1&c)&&S(e,"data-overflow",l[0])},i(l){i||(k(s,l),i=!0)},o(l){A(s,l),i=!1},d(l){l&&Q(e),s&&s.d(l),r=!1,Zn(o)}}}function J3(t,e,n){let i,r,{$$slots:o={},$$scope:a}=e,s=0,l=0,c=0;const d=()=>{n(0,r=i==="compact"&&s>c?"overflow":void 0)};return t.$$set=u=>{"$$scope"in u&&n(6,a=u.$$scope)},t.$$.update=()=>{48&t.$$.dirty&&n(1,i=l>c?"compact":"default")},[r,i,({detail:u})=>{const{width:p}=u;n(5,c=p),d()},({detail:u})=>{const{width:p}=u;p>l&&n(4,l=p),s=p,r||d()},l,c,a,o]}class Sx extends Tn{constructor(e){super(),Sn(this,e,J3,K3,yn,{})}}function Q3(t){let e,n,i,r;const o=t[5].default,a=ur(o,t,t[4],null);return{c(){e=ft("div"),a&&a.c(),S(e,"class",t[0])},m(s,l){tt(s,e,l),a&&a.m(e,null),n=!0,i||(r=[St(e,"measure",function(){Hn(t[1]&&t[3])&&(t[1]&&t[3]).apply(this,arguments)}),qn(t[2].call(null,e))],i=!0)},p(s,[l]){t=s,a&&a.p&&(!n||16&l)&&hr(a,o,t,t[4],n?pr(o,t[4],l,null):mr(t[4]),null),(!n||1&l)&&S(e,"class",t[0])},i(s){n||(k(a,s),n=!0)},o(s){A(a,s),n=!1},d(s){s&&Q(e),a&&a.d(s),i=!1,Zn(r)}}}function t6(t,e,n){let{$$slots:i={},$$scope:r}=e;const o=la();let{class:a=null}=e;const s=yi("measurable");let l=!1;return ds(()=>n(1,l=!0)),t.$$set=c=>{"class"in c&&n(0,a=c.class),"$$scope"in c&&n(4,r=c.$$scope)},[a,l,s,({detail:c})=>o("measure",c),r,i]}class e6 extends Tn{constructor(e){super(),Sn(this,e,t6,Q3,yn,{class:0})}}const n6=t=>({}),v$=t=>({}),i6=t=>({}),w$=t=>({}),r6=t=>({}),S$=t=>({});function T$(t){let e,n;const i=t[4].header,r=ur(i,t,t[3],S$);return{c(){e=ft("div"),r&&r.c(),S(e,"class","PinturaUtilHeader")},m(o,a){tt(o,e,a),r&&r.m(e,null),n=!0},p(o,a){r&&r.p&&(!n||8&a)&&hr(r,i,o,o[3],n?pr(i,o[3],a,r6):mr(o[3]),S$)},i(o){n||(k(r,o),n=!0)},o(o){A(r,o),n=!1},d(o){o&&Q(e),r&&r.d(o)}}}function C$(t){let e,n;const i=t[4].footer,r=ur(i,t,t[3],v$);return{c(){e=ft("div"),r&&r.c(),S(e,"class","PinturaUtilFooter")},m(o,a){tt(o,e,a),r&&r.m(e,null),n=!0},p(o,a){r&&r.p&&(!n||8&a)&&hr(r,i,o,o[3],n?pr(i,o[3],a,n6):mr(o[3]),v$)},i(o){n||(k(r,o),n=!0)},o(o){A(r,o),n=!1},d(o){o&&Q(e),r&&r.d(o)}}}function o6(t){let e,n,i,r,o,a,s=t[1]&&T$(t);const l=t[4].main,c=ur(l,t,t[3],w$),d=c||function(p){let h,y;return h=new e6({props:{class:"PinturaStage"}}),h.$on("measure",p[5]),{c(){zt(h.$$.fragment)},m(m,f){Ft(h,m,f),y=!0},p:tn,i(m){y||(k(h.$$.fragment,m),y=!0)},o(m){A(h.$$.fragment,m),y=!1},d(m){_t(h,m)}}}(t);let u=t[2]&&C$(t);return{c(){s&&s.c(),e=pe(),n=ft("div"),d&&d.c(),i=pe(),u&&u.c(),r=pe(),o=Ei(),S(n,"class","PinturaUtilMain")},m(p,h){s&&s.m(p,h),tt(p,e,h),tt(p,n,h),d&&d.m(n,null),t[6](n),tt(p,i,h),u&&u.m(p,h),tt(p,r,h),tt(p,o,h),a=!0},p(p,[h]){p[1]?s?(s.p(p,h),2&h&&k(s,1)):(s=T$(p),s.c(),k(s,1),s.m(e.parentNode,e)):s&&(Te(),A(s,1,1,()=>{s=null}),Ce()),c&&c.p&&(!a||8&h)&&hr(c,l,p,p[3],a?pr(l,p[3],h,i6):mr(p[3]),w$),p[2]?u?(u.p(p,h),4&h&&k(u,1)):(u=C$(p),u.c(),k(u,1),u.m(r.parentNode,r)):u&&(Te(),A(u,1,1,()=>{u=null}),Ce())},i(p){a||(k(s),k(d,p),k(u),k(!1),a=!0)},o(p){A(s),A(d,p),A(u),A(!1),a=!1},d(p){s&&s.d(p),p&&Q(e),p&&Q(n),d&&d.d(p),t[6](null),p&&Q(i),u&&u.d(p),p&&Q(r),p&&Q(o)}}}function a6(t,e,n){let{$$slots:i={},$$scope:r}=e,{hasHeader:o=!!e.$$slots.header}=e,{hasFooter:a=!!e.$$slots.footer}=e,{root:s}=e;return t.$$set=l=>{n(7,e=ki(ki({},e),Xc(l))),"hasHeader"in l&&n(1,o=l.hasHeader),"hasFooter"in l&&n(2,a=l.hasFooter),"root"in l&&n(0,s=l.root),"$$scope"in l&&n(3,r=l.$$scope)},e=Xc(e),[s,o,a,r,i,function(l){aa.call(this,t,l)},function(l){Nn[l?"unshift":"push"](()=>{s=l,n(0,s)})}]}class i1 extends Tn{constructor(e){super(),Sn(this,e,a6,o6,yn,{hasHeader:1,hasFooter:2,root:0})}}function M$(t){let e,n;return{c(){e=ft("div"),S(e,"class","PinturaRangeInputMeter"),S(e,"style",n=`transform: translateX(${t[9].x-t[12].x}px) translateY(${t[9].y-t[12].y}px)`)},m(i,r){tt(i,e,r),e.innerHTML=t[7]},p(i,r){128&r[0]&&(e.innerHTML=i[7]),512&r[0]&&n!==(n=`transform: translateX(${i[9].x-i[12].x}px) translateY(${i[9].y-i[12].y}px)`)&&S(e,"style",n)},d(i){i&&Q(e)}}}function s6(t){let e,n,i,r,o,a,s,l,c,d,u,p=t[9]&&M$(t);return{c(){e=ft("div"),n=ft("span"),i=pe(),r=ft("button"),o=Mi(t[1]),s=pe(),l=ft("div"),p&&p.c(),S(n,"class","PinturaRangeInputValue"),S(r,"class","PinturaRangeInputReset"),S(r,"type","button"),r.disabled=a=t[0]===t[2],S(l,"class","PinturaRangeInputInner"),S(l,"style",t[8]),S(l,"data-value-limited",t[5]),S(e,"class","PinturaRangeInput"),S(e,"tabindex","0")},m(h,y){tt(h,e,y),Et(e,n),n.innerHTML=t[3],Et(e,i),Et(e,r),Et(r,o),Et(e,s),Et(e,l),p&&p.m(l,null),d||(u=[St(r,"click",t[17]),St(l,"interactionstart",t[13]),St(l,"interactionupdate",t[15]),St(l,"interactionend",t[16]),St(l,"interactionrelease",t[14]),qn(c=zs.call(null,l,{inertia:t[6]})),St(l,"measure",t[37]),qn(Cr.call(null,l)),St(e,"wheel",t[19],{passive:!1}),St(e,"nudge",t[20]),qn(Bs.call(null,e,{direction:"horizontal",preventDefault:!0}))],d=!0)},p(h,y){8&y[0]&&(n.innerHTML=h[3]),2&y[0]&&Yi(o,h[1]),5&y[0]&&a!==(a=h[0]===h[2])&&(r.disabled=a),h[9]?p?p.p(h,y):(p=M$(h),p.c(),p.m(l,null)):p&&(p.d(1),p=null),256&y[0]&&S(l,"style",h[8]),32&y[0]&&S(l,"data-value-limited",h[5]),c&&Hn(c.update)&&64&y[0]&&c.update.call(null,{inertia:h[6]})},i:tn,o:tn,d(h){h&&Q(e),p&&p.d(),d=!1,Zn(u)}}}function l6(t,e,n){let i,r,o,a,s,l,c,d,u,p,{labelReset:h="Reset"}=e,{direction:y="x"}=e,{min:m=0}=e,{max:f=1}=e,{base:b=m}=e,{value:v=0}=e,{valueLabel:w=0}=e,{valueMin:T}=e,{valueMax:I}=e,{oninputstart:P=ae}=e,{oninputmove:_=ae}=e,{oninputend:C=ae}=e,{elasticity:F=0}=e,{nudgeMultiplier:G}=e,{step:O=8}=e;const $=yi("isAnimated");D(t,$,st=>n(6,d=st));const N=yi("fixScrollDirection");D(t,N,st=>n(43,u=st));const it=(st,gt,Jt)=>Math.ceil((st-Jt)/gt)*gt+Jt;let M,W,ot;const at={x:2,y:0},q=(st,gt,Jt)=>`M ${st-Jt} ${gt} a ${Jt} ${Jt} 0 1 0 0 -1`;let ct,V,ut=!1,bt={snap:!1,elastic:!1};const K=(st,gt,Jt)=>{const le=st[y]+gt[y],rt=oi(le,ct[1][y],ct[0][y]),kt=F?rt+Ss(le-rt,F):rt,Nt=Jt.elastic?kt:rt,$t=pt(0,0);return $t[y]=Nt,vt.set($t,{hard:Jt.snap}),oi(Z($t,y),m,f)},vt=fn();D(t,vt,st=>n(9,p=st));const X=(st,gt)=>{const Jt=.5*(M[gt]-a[gt])-(Fc(st,m,f)*a[gt]-.5*a[gt]);return{x:gt==="x"?Jt:0,y:gt==="y"?Jt:0}},Z=(st,gt)=>{const Jt=-(st[gt]-.5*M[gt])/a[gt];return m+Jt*i},mt=vt.subscribe(st=>{st&&V&&_(oi(Z(st,y),m,f))}),Bt=st=>{const gt=[X(T??m,y),X(I??f,y)],Jt={x:y==="x"?p.x+st:0,y:y==="y"?p.y+st:0},le=oi(Jt[y],gt[1][y],gt[0][y]),rt={...p,[y]:le};At(vt,p=rt,p);const kt=oi(Z(rt,y),m,f);P(),_(kt),C(kt)};return Ho(()=>{mt()}),t.$$set=st=>{"labelReset"in st&&n(1,h=st.labelReset),"direction"in st&&n(21,y=st.direction),"min"in st&&n(22,m=st.min),"max"in st&&n(23,f=st.max),"base"in st&&n(2,b=st.base),"value"in st&&n(0,v=st.value),"valueLabel"in st&&n(3,w=st.valueLabel),"valueMin"in st&&n(24,T=st.valueMin),"valueMax"in st&&n(25,I=st.valueMax),"oninputstart"in st&&n(26,P=st.oninputstart),"oninputmove"in st&&n(27,_=st.oninputmove),"oninputend"in st&&n(28,C=st.oninputend),"elasticity"in st&&n(29,F=st.elasticity),"nudgeMultiplier"in st&&n(30,G=st.nudgeMultiplier),"step"in st&&n(31,O=st.step)},t.$$.update=()=>{if(12582912&t.$$.dirty[0]&&n(33,i=f-m),20971520&t.$$.dirty[0]&&n(35,r=T!=null?Math.max(T,m):m),41943040&t.$$.dirty[0]&&n(34,o=I!=null?Math.min(I,f):f),12582916&t.$$.dirty[0]&&n(36,s=Fc(b,m,f)),16&t.$$.dirty[0]|32&t.$$.dirty[1]&&M){const st=.5*M.y;let gt,Jt=40*s,le="",rt=M.y,kt="";for(let Nt=0;Nt<=40;Nt++){const $t=at.x+10*Nt,Be=st;le+=q($t,Be,Nt%5==0?2:.75)+" ",gt=$t+at.x,Nt===Jt&&(kt=`<path d="M${$t} ${Be-4} l2 3 l-2 -1 l-2 1 z"/>`)}n(7,W=`<svg width="${gt}" height="${rt}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${gt} ${rt}" aria-hidden="true" focusable="false">
        ${kt}
        <rect rx="4" ry="4" y="${st-4}"" height="8"/>
        <path fill-rule="evenodd" d="${le.trim()}"/></svg>`),n(32,ot={x:gt-2*at.x,y:rt})}16&t.$$.dirty[0]|2&t.$$.dirty[1]&&(a=M&&ot),12582912&t.$$.dirty[0]|24&t.$$.dirty[1]&&n(5,l=r!==m||o!==f),32&t.$$.dirty[0]|24&t.$$.dirty[1]&&n(8,c=l?function(st,gt){const le=Fc(st,m,f),rt=Fc(gt,m,f);return`--range-mask-from:${100*en(it(le,.025,0)-.0125)}%;--range-mask-to:${100*en(it(rt,.025,0)-.0125)}%`}(r,o):""),2097233&t.$$.dirty[0]|4&t.$$.dirty[1]&&i&&M&&M.x&&M.y&&vt.set(X(v,y),{hard:d===!1})},[v,h,b,w,M,l,d,W,c,p,$,N,at,()=>{ut=!1,V=xa(vt),ct=[X(T??m,y),X(I??f,y)],P()},()=>{ut=!0},({detail:st})=>{bt.snap=!ut,bt.elastic=!ut,K(V,st.translation,bt)},({detail:st})=>{bt.snap=!1,bt.elastic=!1;const gt=K(V,st.translation,bt);if(V=void 0,ct=void 0,Math.abs(gt-b)<.01)return C(b);C(gt)},()=>{n(0,v=oi(b,r,o)),P(),C(v)},vt,st=>{st.preventDefault(),st.stopPropagation();const gt=t1(st,{fixScrollDirection:u})*O;Bt(gt)},({detail:st})=>{Bt(st[y]*Math.abs(G||8))},y,m,f,T,I,P,_,C,F,G,O,ot,i,o,r,s,st=>n(4,M=(gt=>pt(gt.width,gt.height))(st.detail))]}class T0 extends Tn{constructor(e){super(),Sn(this,e,l6,s6,yn,{labelReset:1,direction:21,min:22,max:23,base:2,value:0,valueLabel:3,valueMin:24,valueMax:25,oninputstart:26,oninputmove:27,oninputend:28,elasticity:29,nudgeMultiplier:30,step:31},null,[-1,-1])}}var c6={[Es]:t=>({x:t.x,y:t.y}),[ia]:t=>({x:t.x+t.width,y:t.y}),[Ps]:t=>({x:t.x+t.width,y:t.y}),[ra]:t=>({x:t.x+t.width,y:t.y+t.height}),[Is]:t=>({x:t.x,y:t.y+t.height}),[oa]:t=>({x:t.x,y:t.y+t.height}),[Rs]:t=>({x:t.x,y:t.y}),[na]:t=>({x:t.x,y:t.y})};function k$(t,e,n){const i=t.slice();return i[14]=e[n].key,i[15]=e[n].translate,i[16]=e[n].scale,i[17]=e[n].type,i[18]=e[n].opacity,i}function E$(t,e){let n,i,r,o,a,s,l,c;return{key:t,first:null,c(){n=ft("div"),S(n,"role","button"),S(n,"aria-label",i=`Drag ${e[17]} ${e[14]}`),S(n,"tabindex",r=e[17]==="edge"?-1:0),S(n,"class","PinturaRectManipulator"),S(n,"data-direction",o=e[14]),S(n,"data-shape",a=e[17]==="edge"?"edge":""+e[0]),S(n,"style",s=`--tx:${e[15].x};--ty:${e[15].y};--sx:${e[16].x};--sy:${e[16].y};opacity:${e[18]}`),this.first=n},m(d,u){tt(d,n,u),l||(c=[St(n,"nudge",function(){Hn(e[6](e[14]))&&e[6](e[14]).apply(this,arguments)}),qn(Bs.call(null,n,{preventDefault:!0})),St(n,"interactionstart",function(){Hn(e[5]("resizestart",e[14]))&&e[5]("resizestart",e[14]).apply(this,arguments)}),St(n,"interactionupdate",function(){Hn(e[5]("resizemove",e[14]))&&e[5]("resizemove",e[14]).apply(this,arguments)}),St(n,"interactionend",function(){Hn(e[5]("resizeend",e[14]))&&e[5]("resizeend",e[14]).apply(this,arguments)}),qn(zs.call(null,n))],l=!0)},p(d,u){e=d,2&u&&i!==(i=`Drag ${e[17]} ${e[14]}`)&&S(n,"aria-label",i),2&u&&r!==(r=e[17]==="edge"?-1:0)&&S(n,"tabindex",r),2&u&&o!==(o=e[14])&&S(n,"data-direction",o),3&u&&a!==(a=e[17]==="edge"?"edge":""+e[0])&&S(n,"data-shape",a),2&u&&s!==(s=`--tx:${e[15].x};--ty:${e[15].y};--sx:${e[16].x};--sy:${e[16].y};opacity:${e[18]}`)&&S(n,"style",s)},d(d){d&&Q(n),l=!1,Zn(c)}}}function d6(t){let e,n=[],i=new Map,r=t[1];const o=a=>a[14];for(let a=0;a<r.length;a+=1){let s=k$(t,r,a),l=o(s);i.set(l,n[a]=E$(l,s))}return{c(){for(let a=0;a<n.length;a+=1)n[a].c();e=Ei()},m(a,s){for(let l=0;l<n.length;l+=1)n[l].m(a,s);tt(a,e,s)},p(a,[s]){99&s&&(r=a[1],n=Va(n,s,o,1,a,r,i,e.parentNode,k2,E$,e,k$))},i:tn,o:tn,d(a){for(let s=0;s<n.length;s+=1)n[s].d(a);a&&Q(e)}}}function u6(t,e,n){let i,r,o,a,{rect:s=null}=e,{visible:l=!1}=e,{style:c}=e;const d=yi("isAnimated");D(t,d,m=>n(11,a=m));const u=fn(void 0,{precision:1e-4,stiffness:.2,damping:.4});D(t,u,m=>n(10,o=m));const p=fn(0,{precision:.001});let h;D(t,p,m=>n(9,r=m));const y=la();return t.$$set=m=>{"rect"in m&&n(7,s=m.rect),"visible"in m&&n(8,l=m.visible),"style"in m&&n(0,c=m.style)},t.$$.update=()=>{2304&t.$$.dirty&&u.set(l?1:.5,{hard:a===!1}),2304&t.$$.dirty&&p.set(l?1:0,{hard:a===!1}),1664&t.$$.dirty&&n(1,i=Object.keys(uh).map((m,f)=>{const b=uh[m],v=c6[b](s),w=b.length===1?"edge":"corner",T=w==="corner";return{key:b,type:w,scale:{x:/^(t|b)$/.test(b)?s.width:T?oi(o,.5,1.25):1,y:/^(r|l)$/.test(b)?s.height:T?oi(o,.5,1.25):1},translate:{x:v.x,y:v.y},opacity:r}}))},[c,i,d,u,p,(m,f)=>({detail:b})=>{h&&f!==h||m!=="resizestart"&&h===void 0||(m==="resizestart"&&(h=f),m==="resizeend"&&(h=void 0),y(m,{direction:f,translation:b&&b.translation}))},m=>({detail:f})=>{y("resizestart",{direction:m,translation:{x:0,y:0}}),y("resizemove",{direction:m,translation:f}),y("resizeend",{direction:m,translation:{x:0,y:0}})},s,l,r,o,a]}class p6 extends Tn{constructor(e){super(),Sn(this,e,u6,d6,yn,{rect:7,visible:8,style:0})}}var h6=t=>{function e(a,s){t.dispatchEvent(new CustomEvent(a,{detail:s}))}const n=a=>{a.preventDefault(),t.addEventListener("gesturechange",i),t.addEventListener("gestureend",r),e("gesturedown")},i=a=>{a.preventDefault(),e("gestureupdate",a.scale)},r=a=>{e("gestureup",a.scale),a.preventDefault(),o()},o=()=>{t.removeEventListener("gesturechange",i),t.removeEventListener("gestureend",r)};return t.addEventListener("gesturestart",n),{destroy:()=>{o(),t.removeEventListener("gesturestart",n)}}},C0={[Es]:Is,[Ps]:Rs,[Is]:Es,[Rs]:Ps,[na]:ra,[ia]:oa,[ra]:na,[oa]:ia},M0=t=>{const e=t===Rs||t===Ps,n=t===Es||t===Is;return[t===Ps||t===ia||t===ra,t===Rs||t===oa||t===na,t===Es||t===ia||t===na,t===Is||t===ra||t===oa,e,n,e||n]},P$=(t,e,n,i={})=>{const{target:r,translate:o}=e,{aspectRatio:a,minSize:s,maxSize:l}=i,c=Uc[C0[r]],d=nr(pt(t.x,t.y),pt(c[0]*t.width,c[1]*t.height)),u=Uc[r],p=nr(Mn(t),pt(u[0]*t.width,u[1]*t.height)),[h,y,m,f,b,v,w]=M0(r);let T=o.x,I=o.y;b?I=0:v&&(T=0);const{inner:P,outer:_}=m6(d,r,n,{aspectRatio:a,minSize:s,maxSize:l});let[C,F,G,O]=pl(t);if(h?O=d.x:y&&(F=d.x),f?C=d.y:m&&(G=d.y),h){const $=P.x+P.width,N=_.x+_.width;F=oi(p.x+T,$,N)}else if(y){const $=_.x,N=P.x;O=oi(p.x+T,$,N)}if(f){const $=P.y+P.height,N=_.y+_.height;G=oi(p.y+I,$,N)}else if(m){const $=_.y,N=P.y;C=oi(p.y+I,$,N)}if(O>P.x&&(O=P.x),F<P.x+P.width&&(F=P.x+P.width),C>P.y&&(C=P.y),G<P.y+P.height&&(G=P.y+P.height),O<_.x){const $=_.x-O;O=_.x,F+=$}if(F>_.x+_.width){const $=F-(_.x+_.width);F=_.x+_.width,O-=$}if(C<_.y){const $=_.y-C;C=_.y,G+=$}if(G>_.y+_.height){const $=G-(_.y+_.height);G=_.y+_.height,C-=$}if(a)if(w){let $=F-O,N=G-C;b?(N=$/a,C=d.y-.5*N,G=d.y+.5*N):v&&($=N*a,O=d.x-.5*$,F=d.x+.5*$)}else{const $=pt(p.x+T-d.x,p.y+I-d.y);r===ia?($.x=Math.max(0,$.x),$.y=Math.min(0,$.y)):r===ra?($.x=Math.max(0,$.x),$.y=Math.max(0,$.y)):r===oa?($.x=Math.min(0,$.x),$.y=Math.max(0,$.y)):r===na&&($.x=Math.min(0,$.x),$.y=Math.min(0,$.y));const N=Ts($),it=Ts(pt(P.width,P.height)),M=Ts(pt(_.width,_.height)),W=oi(N,it,M),ot=pt(a,1),at=Po(bo(ot),W);r===ia?(F=d.x+at.x,C=d.y-at.y):r===ra?(F=d.x+at.x,G=d.y+at.y):r===oa?(O=d.x-at.x,G=d.y+at.y):r===na&&(O=d.x-at.x,C=d.y-at.y)}return Ci(O,C,F-O,G-C)};const m6=(t,e,n,i)=>{const{aspectRatio:r,minSize:o,maxSize:a}=i,s=e===Ps||e===ia||e===ra,l=e===Rs||e===oa||e===na,c=e===Es||e===ia||e===na,d=e===Is||e===ra||e===oa,u=e===Rs||e===Ps,p=e===Es||e===Is,h=Mn(n);s?(h.x=t.x,h.width-=t.x):l&&(h.width=t.x),d?(h.y=t.y,h.height-=t.y):c&&(h.height=t.y);const y=((P,_)=>sa(0,0,P,_))(Math.min(h.width,a.width),Math.min(h.height,a.height));if(r){if(u){const P=Math.min(t.y,n.height-t.y);y.height=Math.min(2*P,y.height)}else if(p){const P=Math.min(t.x,n.width-t.x);y.width=Math.min(2*P,y.width)}}const m=r?dl(Ls(Fr(o),r)):o,f=r?dl(Kr(y,r)):y;let b,v,w,T;s?b=t.x:l&&(v=t.x),d?w=t.y:c&&(T=t.y),s?v=b+m.width:l&&(b=v-m.width),d?T=w+m.height:c&&(w=T-m.height),u?(w=t.y-.5*m.height,T=t.y+.5*m.height):p&&(b=t.x-.5*m.width,v=t.x+.5*m.width);const I=Vi([pt(b,w),pt(v,T)]);return s?v=b+f.width:l&&(b=v-f.width),d?T=w+f.height:c&&(w=T-f.height),u?(w=t.y-.5*f.height,T=t.y+.5*f.height):p&&(b=t.x-.5*f.width,v=t.x+.5*f.width),b=Math.max(n.x,b),v=Math.min(n.x+n.width,v),w=Math.max(n.y,w),T=Math.min(n.y+n.height,T),{inner:I,outer:Vi([pt(b,w),pt(v,T)])}};var I$=t=>180*t/Math.PI;function g6(t){let e,n,i;return n=new T0({props:{elasticity:t[5],min:t[9],max:t[10],value:t[11],valueMin:Math.max(t[9],t[0]),valueMax:Math.min(t[10],t[1]),labelReset:t[6],base:t[12],valueLabel:Math.round(I$(t[11]))+"&deg;",oninputstart:t[2],oninputmove:t[17],oninputend:t[18]}}),{c(){e=ft("div"),zt(n.$$.fragment),S(e,"class","PinturaImageRotator")},m(r,o){tt(r,e,o),Ft(n,e,null),i=!0},p(r,[o]){const a={};32&o&&(a.elasticity=r[5]),512&o&&(a.min=r[9]),1024&o&&(a.max=r[10]),2048&o&&(a.value=r[11]),513&o&&(a.valueMin=Math.max(r[9],r[0])),1026&o&&(a.valueMax=Math.min(r[10],r[1])),64&o&&(a.labelReset=r[6]),4096&o&&(a.base=r[12]),2048&o&&(a.valueLabel=Math.round(I$(r[11]))+"&deg;"),4&o&&(a.oninputstart=r[2]),392&o&&(a.oninputmove=r[17]),400&o&&(a.oninputend=r[18]),n.$set(a)},i(r){i||(k(n.$$.fragment,r),i=!0)},o(r){A(n.$$.fragment,r),i=!1},d(r){r&&Q(e),_t(n)}}}function f6(t,e,n){let i,r,o,a,s,l,c,{rotation:d}=e,{valueMin:u}=e,{valueMax:p}=e,{oninputstart:h=ae}=e,{oninputmove:y=ae}=e,{oninputend:m=ae}=e,{elasticity:f=0}=e,{labelReset:b}=e,{rotationMin:v}=e,{rotationMax:w}=e;return t.$$set=T=>{"rotation"in T&&n(13,d=T.rotation),"valueMin"in T&&n(0,u=T.valueMin),"valueMax"in T&&n(1,p=T.valueMax),"oninputstart"in T&&n(2,h=T.oninputstart),"oninputmove"in T&&n(3,y=T.oninputmove),"oninputend"in T&&n(4,m=T.oninputend),"elasticity"in T&&n(5,f=T.elasticity),"labelReset"in T&&n(6,b=T.labelReset),"rotationMin"in T&&n(14,v=T.rotationMin),"rotationMax"in T&&n(15,w=T.rotationMax)},t.$$.update=()=>{16384&t.$$.dirty&&n(9,i=v+1e-9),32768&t.$$.dirty&&n(10,r=w-1e-9),1536&t.$$.dirty&&n(12,o=i+.5*(r-i)),32768&t.$$.dirty&&n(16,a=2*w),8192&t.$$.dirty&&n(8,s=Math.sign(d)),73728&t.$$.dirty&&n(7,l=Math.round(Math.abs(d)/a)*a),8576&t.$$.dirty&&n(11,c=d-s*l)},[u,p,h,y,m,f,b,l,s,i,r,c,o,d,v,w,a,T=>y(s*l+T),T=>m(s*l+T)]}class $6 extends Tn{constructor(e){super(),Sn(this,e,f6,g6,yn,{rotation:13,valueMin:0,valueMax:1,oninputstart:2,oninputmove:3,oninputend:4,elasticity:5,labelReset:6,rotationMin:14,rotationMax:15})}}function y6(t){let e,n,i,r,o;return{c(){e=ft("div"),n=ft("p"),i=Mi(t[0]),r=Mi(" × "),o=Mi(t[1]),S(e,"class","PinturaImageInfo")},m(a,s){tt(a,e,s),Et(e,n),Et(n,i),Et(n,r),Et(n,o)},p(a,[s]){1&s&&Yi(i,a[0]),2&s&&Yi(o,a[1])},i:tn,o:tn,d(a){a&&Q(e)}}}function x6(t,e,n){let{width:i}=e,{height:r}=e;return t.$$set=o=>{"width"in o&&n(0,i=o.width),"height"in o&&n(1,r=o.height)},[i,r]}class b6 extends Tn{constructor(e){super(),Sn(this,e,x6,y6,yn,{width:0,height:1})}}function v6(t){let e,n;return e=new fl({props:{class:"PinturaPresetListFilter",layout:"row",options:t[8],selectedIndex:t[7],onchange:t[10]}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};256&r&&(o.options=i[8]),128&r&&(o.selectedIndex=i[7]),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function w6(t){let e,n;return e=new x0({props:{icon:t[0],label:t[1],labelClass:t[2],hideLabel:t[3],options:t[9],selectedIndex:t[4],onchange:t[5],optionMapper:t[6],$$slots:{controls:[v6]},$$scope:{ctx:t}}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,[r]){const o={};1&r&&(o.icon=i[0]),2&r&&(o.label=i[1]),4&r&&(o.labelClass=i[2]),8&r&&(o.hideLabel=i[3]),512&r&&(o.options=i[9]),16&r&&(o.selectedIndex=i[4]),32&r&&(o.onchange=i[5]),64&r&&(o.optionMapper=i[6]),262528&r&&(o.$$scope={dirty:r,ctx:i}),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}const R$='fill="none" stroke="currentColor"';function S6(t,e,n){let i,r,o,{icon:a}=e,{label:s}=e,{labelClass:l}=e,{hideLabel:c}=e,{options:d}=e,{selectedIndex:u}=e,{onchange:p}=e,{optionMapper:h}=e,{filter:y="landscape"}=e,{onfilterchange:m=ae}=e;const f=(v,w,T,I,P)=>`
    <rect ${R$} x="${v}" y="${w}" width="${T}" height="${I}" rx="${P}"/>`,b=(v,w)=>`<path ${R$} d="M${v} ${w} l2 2 l3 -4"/>`;return t.$$set=v=>{"icon"in v&&n(0,a=v.icon),"label"in v&&n(1,s=v.label),"labelClass"in v&&n(2,l=v.labelClass),"hideLabel"in v&&n(3,c=v.hideLabel),"options"in v&&n(12,d=v.options),"selectedIndex"in v&&n(4,u=v.selectedIndex),"onchange"in v&&n(5,p=v.onchange),"optionMapper"in v&&n(6,h=v.optionMapper),"filter"in v&&n(11,y=v.filter),"onfilterchange"in v&&n(13,m=v.onfilterchange)},t.$$.update=()=>{6144&t.$$.dirty&&n(9,i=((v,w)=>(v||[]).map(T=>Qe(T[0])?(T[1]=T[1].map(w),T):w(T)))(d,(v=>w=>{const[T,I,P={}]=w;return dn(T)&&(P.hidden=v==="landscape"?T<1:T>1),[T,I,P]})(y))),2048&t.$$.dirty&&n(7,r=y==="landscape"?0:1),128&t.$$.dirty&&n(8,o=[["landscape","Landscape",{hideLabel:!0,icon:f(2,6,19,12,2)+(r===0?b(9,12):"")}],["portrait","Portrait",{hideLabel:!0,icon:f(5,3,13,18,2)+(r===1?b(9,12):"")}]])},[a,s,l,c,u,p,h,r,o,i,v=>{n(11,y=v.value),m(v.value)},y,d,m]}class T6 extends Tn{constructor(e){super(),Sn(this,e,S6,w6,yn,{icon:0,label:1,labelClass:2,hideLabel:3,options:12,selectedIndex:4,onchange:5,optionMapper:6,filter:11,onfilterchange:13})}}const A$=t=>Eo(t,e=>en(e,6)),L$=t=>Bo(t,e=>en(e,6)),xs=(t,e,n=1e-4)=>Math.abs(t-e)<n;var C6=(t,e,n,i,r={})=>{const{aspectRatio:o}=r;t=L$(t),i=i.map(A$);const a=Hm(t,C0[n.target]),s=Eo(a,b=>en(b,6)),l=o?Ls(r.minSize,o):r.minSize,c=o?Kr(r.maxSize,o):r.maxSize,d=Hm(e,n.target);if(Yr(d,a)<1){e=Mn(t);const b=Math.min(l.width/t.width,l.height/t.height);Sr(e,b,a)}e=Vm(Mn(e),l,c,a);let u=Mn(e);e=L$(e);const p=zy(i,1),h=Mo(t),y=Mo(e),m=h.findIndex(b=>ws(Eo(b,v=>en(v,6)),s)),f=b=>p.map(v=>Uh(v,b)).filter(Boolean).pop();if(o){const b=y.map((v,w)=>{if(w===m)return;const T=pt(a.x-v.x,a.y-v.y);bo(T),Po(T,.5);const I=pt(a.x-T.x,a.y-T.y),P=As(I,A$(v)),_=f(P);if(!_)return;const C=h[w];return{intersection:_,cornerDist:Yr(a,C),intersectionDist:Yr(a,_)}}).filter(Boolean);if(b.length){const v=b.reduce((w,T)=>{const I=T.intersectionDist/T.cornerDist;return I<w?I:w},Number.MAX_SAFE_INTEGER);u=Mn(t),Sr(u,v,a)}}else{const b=n.target.length===1,v=!(i[0].y===i[1].y||i[0].x===i[1].x),w=h.map((T,I)=>{if(I===m)return;const P=y[I],_=!xs(P.x,s.x)&&!xs(P.y,s.y);if(!b&&!v&&_||b&&(xs(P.x,s.x)||xs(P.y,s.y)))return;const C=Ue(b?T:a),F=Oi(Ue(C),P);bo(F),Po(F,.5),b?nr(C,F):Oi(C,F);const G=As(C,P);return f(G)||void 0}).filter(Boolean);if(w.length){const[T,I,P,_]=M0(n.target);let[C,F,G,O]=pl(e);w.forEach(({x:$,y:N})=>{const it=en($,6),M=en(N,6);P&&!xs(M,s.y)&&(C=Math.max(C,N)),T&&!xs(it,s.x)&&(F=Math.min(F,$)),_&&!xs(M,s.y)&&(G=Math.min(G,N)),I&&!xs(it,s.x)&&(O=Math.max(O,$))}),u=Bb([C,F,G,O]),Sr(u,.9999,a)}}return Vm(u,l,c,a),u};function M6(t){let e,n;return e=new vo({props:{items:t[11]}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};2048&r[0]&&(o.items=i[11]),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function k6(t){let e,n,i;return n=new Sx({props:{$$slots:{default:[M6]},$$scope:{ctx:t}}}),{c(){e=ft("div"),zt(n.$$.fragment),S(e,"slot","header")},m(r,o){tt(r,e,o),Ft(n,e,null),i=!0},p(r,o){const a={};2048&o[0]|4&o[7]&&(a.$$scope={dirty:o,ctx:r}),n.$set(a)},i(r){i||(k(n.$$.fragment,r),i=!0)},o(r){A(n.$$.fragment,r),i=!1},d(r){r&&Q(e),_t(n)}}}function O$(t){let e,n;return e=new Ds({props:{onclick:t[88],label:t[4].cropLabelButtonRecenter,icon:t[4].cropIconButtonRecenter,class:"PinturaButtonCenter",disabled:!t[9],hideLabel:!0,style:`opacity: ${t[29]}; transform: translate3d(${t[30].x}px, ${t[30].y}px, 0)`}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};16&r[0]&&(o.label=i[4].cropLabelButtonRecenter),16&r[0]&&(o.icon=i[4].cropIconButtonRecenter),512&r[0]&&(o.disabled=!i[9]),1610612736&r[0]&&(o.style=`opacity: ${i[29]}; transform: translate3d(${i[30].x}px, ${i[30].y}px, 0)`),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function F$(t){let e,n;return e=new p6({props:{rect:t[8],visible:t[12],style:t[1]}}),e.$on("resizestart",t[68]),e.$on("resizemove",t[69]),e.$on("resizeend",t[70]),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};256&r[0]&&(o.rect=i[8]),4096&r[0]&&(o.visible=i[12]),2&r[0]&&(o.style=i[1]),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function _$(t){let e,n;return e=new b6({props:{width:Math.round(t[13].width),height:Math.round(t[13].height)}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};8192&r[0]&&(o.width=Math.round(i[13].width)),8192&r[0]&&(o.height=Math.round(i[13].height)),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function E6(t){let e,n,i,r,o,a,s,l,c=t[21]&&t[10]&&O$(t),d=t[21]&&F$(t),u=t[22]&&_$(t);return{c(){e=ft("div"),n=ft("div"),c&&c.c(),i=pe(),d&&d.c(),o=pe(),u&&u.c(),S(n,"class","PinturaStage"),S(e,"slot","main")},m(p,h){tt(p,e,h),Et(e,n),c&&c.m(n,null),Et(n,i),d&&d.m(n,null),t[162](n),Et(e,o),u&&u.m(e,null),a=!0,s||(l=[qn(Cr.call(null,n)),St(n,"measure",t[160]),St(n,"wheel",function(){Hn(t[2]&&t[87])&&(t[2]&&t[87]).apply(this,arguments)},{passive:!1}),St(n,"interactionstart",t[74]),St(n,"interactionupdate",t[75]),St(n,"interactionrelease",t[77]),St(n,"interactionend",t[76]),qn(r=zs.call(null,n,{drag:!0,inertia:!0,pinch:t[2],shouldStartInteraction:z$,getEventPosition:t[163]})),St(n,"gesturedown",t[84]),St(n,"gestureupdate",t[85]),St(n,"gestureup",t[86]),qn(h6.call(null,n))],s=!0)},p(p,h){(t=p)[21]&&t[10]?c?(c.p(t,h),2098176&h[0]&&k(c,1)):(c=O$(t),c.c(),k(c,1),c.m(n,i)):c&&(Te(),A(c,1,1,()=>{c=null}),Ce()),t[21]?d?(d.p(t,h),2097152&h[0]&&k(d,1)):(d=F$(t),d.c(),k(d,1),d.m(n,null)):d&&(Te(),A(d,1,1,()=>{d=null}),Ce()),r&&Hn(r.update)&&16777220&h[0]&&r.update.call(null,{drag:!0,inertia:!0,pinch:t[2],shouldStartInteraction:z$,getEventPosition:t[163]}),t[22]?u?(u.p(t,h),4194304&h[0]&&k(u,1)):(u=_$(t),u.c(),k(u,1),u.m(e,null)):u&&(Te(),A(u,1,1,()=>{u=null}),Ce())},i(p){a||(k(c),k(d),k(u),a=!0)},o(p){A(c),A(d),A(u),a=!1},d(p){p&&Q(e),c&&c.d(),d&&d.d(),t[162](null),u&&u.d(),s=!1,Zn(l)}}}function D$(t){let e,n,i,r;const o=[{class:"PinturaControlList"},{tabs:t[7]},t[18]];let a={$$slots:{default:[P6,({tab:c})=>({218:c}),({tab:c})=>[0,0,0,0,0,0,0,c?2:0]]},$$scope:{ctx:t}};for(let c=0;c<o.length;c+=1)a=ki(a,o[c]);e=new Ju({props:a}),e.$on("select",t[161]);const s=[{class:"PinturaControlPanels"},{panelClass:"PinturaControlPanel"},{panels:t[17]},t[18]];let l={$$slots:{default:[A6,({panel:c})=>({217:c}),({panel:c})=>[0,0,0,0,0,0,0,c?1:0]]},$$scope:{ctx:t}};for(let c=0;c<s.length;c+=1)l=ki(l,s[c]);return i=new Qu({props:l}),{c(){zt(e.$$.fragment),n=pe(),zt(i.$$.fragment)},m(c,d){Ft(e,c,d),tt(c,n,d),Ft(i,c,d),r=!0},p(c,d){const u=262272&d[0]?Tr(o,[o[0],128&d[0]&&{tabs:c[7]},262144&d[0]&&_r(c[18])]):{};6&d[7]&&(u.$$scope={dirty:d,ctx:c}),e.$set(u);const p=393216&d[0]?Tr(s,[s[0],s[1],131072&d[0]&&{panels:c[17]},262144&d[0]&&_r(c[18])]):{};511721496&d[0]|5&d[7]&&(p.$$scope={dirty:d,ctx:c}),i.$set(p)},i(c){r||(k(e.$$.fragment,c),k(i.$$.fragment,c),r=!0)},o(c){A(e.$$.fragment,c),A(i.$$.fragment,c),r=!1},d(c){_t(e,c),c&&Q(n),_t(i,c)}}}function P6(t){let e,n,i=t[218].label+"";return{c(){e=ft("span"),n=Mi(i)},m(r,o){tt(r,e,o),Et(e,n)},p(r,o){2&o[7]&&i!==(i=r[218].label+"")&&Yi(n,i)},d(r){r&&Q(e)}}}function I6(t){let e,n;return e=new T0({props:{elasticity:t[25]*t[44],base:_6,min:t[23],max:F6,valueMin:t[27][0],valueMax:t[27][1],value:t[28],labelReset:t[4].labelReset,valueLabel:Math.round(100*t[28])+"%",oninputstart:t[81],oninputmove:t[82],oninputend:t[83]}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};33554432&r[0]&&(o.elasticity=i[25]*i[44]),8388608&r[0]&&(o.min=i[23]),134217728&r[0]&&(o.valueMin=i[27][0]),134217728&r[0]&&(o.valueMax=i[27][1]),268435456&r[0]&&(o.value=i[28]),16&r[0]&&(o.labelReset=i[4].labelReset),268435456&r[0]&&(o.valueLabel=Math.round(100*i[28])+"%"),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function R6(t){let e,n;return e=new $6({props:{elasticity:t[25]*t[44],rotation:t[14],labelReset:t[4].labelReset,valueMin:t[26][0],valueMax:t[26][1],rotationMin:-t[3],rotationMax:t[3],oninputstart:t[71],oninputmove:t[72],oninputend:t[73]}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};33554432&r[0]&&(o.elasticity=i[25]*i[44]),16384&r[0]&&(o.rotation=i[14]),16&r[0]&&(o.labelReset=i[4].labelReset),67108864&r[0]&&(o.valueMin=i[26][0]),67108864&r[0]&&(o.valueMax=i[26][1]),8&r[0]&&(o.rotationMin=-i[3]),8&r[0]&&(o.rotationMax=i[3]),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function A6(t){let e,n,i,r;const o=[R6,I6],a=[];function s(l,c){return l[217]===l[93]+"-rotation"?0:l[217]===l[93]+"-zoom"?1:-1}return~(e=s(t))&&(n=a[e]=o[e](t)),{c(){n&&n.c(),i=Ei()},m(l,c){~e&&a[e].m(l,c),tt(l,i,c),r=!0},p(l,c){let d=e;e=s(l),e===d?~e&&a[e].p(l,c):(n&&(Te(),A(a[d],1,1,()=>{a[d]=null}),Ce()),~e?(n=a[e],n?n.p(l,c):(n=a[e]=o[e](l),n.c()),k(n,1),n.m(i.parentNode,i)):n=null)},i(l){r||(k(n),r=!0)},o(l){A(n),r=!1},d(l){~e&&a[e].d(l),l&&Q(i)}}}function L6(t){let e,n,i=t[19]&&D$(t);return{c(){e=ft("div"),i&&i.c(),S(e,"slot","footer"),S(e,"style",t[16])},m(r,o){tt(r,e,o),i&&i.m(e,null),n=!0},p(r,o){r[19]?i?(i.p(r,o),524288&o[0]&&k(i,1)):(i=D$(r),i.c(),k(i,1),i.m(e,null)):i&&(Te(),A(i,1,1,()=>{i=null}),Ce()),(!n||65536&o[0])&&S(e,"style",r[16])},i(r){n||(k(i),n=!0)},o(r){A(i),n=!1},d(r){r&&Q(e),i&&i.d()}}}function O6(t){let e,n,i;function r(a){t[164](a)}let o={hasHeader:t[20],$$slots:{footer:[L6],main:[E6],header:[k6]},$$scope:{ctx:t}};return t[15]!==void 0&&(o.root=t[15]),e=new i1({props:o}),Nn.push(()=>Ro(e,"root",r)),e.$on("measure",t[165]),{c(){zt(e.$$.fragment)},m(a,s){Ft(e,a,s),i=!0},p(a,s){const l={};1048576&s[0]&&(l.hasHeader=a[20]),2146402302&s[0]|4&s[7]&&(l.$$scope={dirty:s,ctx:a}),!n&&32768&s[0]&&(n=!0,l.root=a[15],Wo(()=>n=!1)),e.$set(l)},i(a){i||(k(e.$$.fragment,a),i=!0)},o(a){A(e.$$.fragment,a),i=!1},d(a){_t(e,a)}}}const F6=1,_6=0,z$=(t,e)=>t.target===e;function D6(t,e,n){let i,r,o,a,s,l,c,d,u,p,h,y,m,f,b,v,w,T,I,P,_,C,F,G,O,$,N,it,M,W,ot,at,q,ct,V,ut,bt,K,vt,X,Z,mt,Bt,st,gt,Jt,le,rt,kt,Nt,$t,Be,nt,Ut,qt,Dt,ve,It,Ie,lt,Ze,nn,he,Ke,Ae,We,xn,xt,de,Ve,Oe,Ne,_e=tn,Je=()=>(_e(),_e=xo(kn,R=>n(12,M=R)),kn);t.$$.on_destroy.push(()=>_e());let{isActive:kn}=e;Je();let{stores:En}=e,{cropImageSelectionCornerStyle:Zt="circle"}=e,{cropWillRenderImageSelectionGuides:Dn=(R,te)=>{const Re=R=="rotate";return{rows:Re?5:3,cols:Re?5:3,opacity:.25*te}}}=e,{cropAutoCenterImageSelectionTimeout:H}=e,{cropEnableZoomMatchImageAspectRatio:Wt=!0}=e,{cropEnableRotateMatchImageAspectRatio:z="never"}=e,{cropEnableRotationInput:Qt=!0}=e,{cropEnableZoom:ce=!0}=e,{cropEnableZoomInput:ye=!0}=e,{cropEnableZoomAutoHide:ue=!0}=e,{cropEnableImageSelection:Yt=!0}=e,{cropEnableInfoIndicator:Gt=!1}=e,{cropEnableZoomTowardsWheelPosition:hn=!0}=e,{cropEnableLimitWheelInputToCropSelection:Xe=!0}=e,{cropEnableCenterImageSelection:on=!0}=e,{cropEnableButtonRotateLeft:xe=!0}=e,{cropEnableButtonRotateRight:Me=!1}=e,{cropEnableButtonFlipHorizontal:Yn=!0}=e,{cropEnableButtonFlipVertical:Se=!1}=e,{cropSelectPresetOptions:J}=e,{cropEnableSelectPreset:Xt=!0}=e,{cropEnableFilterMatchAspectRatio:jt=!0}=e,{cropSelectPresetFilter:se=!1}=e,{cropEnableButtonToggleCropLimit:Fe=!1}=e,{cropWillRenderTools:ke=ni}=e,{cropActiveTransformTool:be="rotation"}=e,{cropMinimizeToolbar:mi="auto"}=e,{cropInteractionFocus:si="image"}=e,{cropRotationRange:ge=Qo}=e,{cropMaskOpacity:an=.85}=e,{locale:we={}}=e;const Ge=yi("isAnimated");D(t,Ge,R=>n(139,W=R));const Le=yi("elasticityMultiplier");D(t,Le,R=>n(25,xn=R));const Ht=yi("redrawTrigger");D(t,Ht,R=>n(159,We=R));const Pe=yi("imageIsStatic");D(t,Pe,R=>n(145,bt=R));const Cn=yi("imageStaticVisualCorners");D(t,Cn,R=>n(181,It=R));const Un=yi("fixScrollDirection");D(t,Un,R=>n(175,$t=R));let bi="idle";const Pi=me();D(t,Pi,R=>n(156,he=R));const Hi=()=>Dt===void 0,Xn=R=>1/R,Ui=R=>{jt&&se!==R&&(n(95,se=R),Dt&&Dt!==1&&yr()&&At(gi,Dt=Xn(Dt),Dt))},yr=()=>{if(Dt===1||!i)return!1;const R=Xn(Dt);return!!Wc(he).find(([te])=>te===R)},gr=(R,te,Re)=>Fa(Re)?te.width===Math.round(R.height)||te.height===Math.round(R.width):te.width===Math.round(R.width)||te.height===Math.round(R.height),Mr=()=>(Hi()||z==="always"&&yr())&&((R,te,Re)=>{const $n=cs(Ry(co(te),Re),He=>Math.abs(Math.round(He))),In=ul($n),Ln=wn(R);return ws(In,Ln)})(K,le,rt)&&gr(K,le,rt),Uo=R=>{if(z!=="never"&&Mr()){At(Br,rt+=R,rt);const te=Fa(rt),Re=te?le.height:le.width,$n=te?le.width:le.height;At(ji,K=Ci(0,0,Re,$n),K),Hi()||At(gi,Dt=as(Re,$n),Dt)}else At(Br,rt+=R,rt)},{history:li,env:uo,isInteracting:ii,isInteractingFraction:ui,isTransformingImage:un,rootRect:rr,stageRect:Jr,utilRect:Ao,utilRectPadded:po,rootLineColor:Lo,allowPan:Dr,allowZoom:Gi,allowPlayPause:ci,rangeInputElasticity:jr,presentationScalar:Qr,utilTools:zr,imagePreviewModifiers:Zr,imageOutlineOpacity:xr,imageFlipX:to,imageFlipY:kr,imageRotation:Br,imageRotationRange:eo,imageOutputSize:Nr,imageSelectionRect:wo,imageSelectionRectSnapshot:ho,imageSelectionRectIntent:Er,imageSelectionRectPresentation:Pr,imageCropRectIntent:Ir,imageCropRectOrigin:Wr,imageCropRect:ji,imageCropMinSize:An,imageCropMaxSize:Wi,imageCropRange:Fi,imageCropAspectRatio:gi,imageCropLimitToImage:Ii,imageSize:Ki,imageScalar:Go,imageOverlayMarkup:ca,stagePadded:mo,stageRecenter:_i}=En;let Di;D(t,uo,R=>n(140,ot=R)),D(t,ii,R=>n(144,ut=R)),D(t,un,R=>n(173,gt=R)),D(t,rr,R=>n(24,Be=R)),D(t,Jr,R=>n(151,st=R)),D(t,po,R=>n(148,Z=R)),D(t,Qr,R=>n(147,X=R)),D(t,zr,R=>n(183,lt=R)),D(t,Zr,R=>n(172,ct=R)),D(t,to,R=>n(158,Ae=R)),D(t,kr,R=>n(157,Ke=R)),D(t,Br,R=>n(14,rt=R)),D(t,eo,R=>n(26,xt=R)),D(t,Nr,R=>n(184,Ze=R)),D(t,wo,R=>n(150,Bt=R)),D(t,ho,R=>n(149,mt=R)),D(t,Er,R=>n(182,Ie=R)),D(t,Pr,R=>n(143,V=R)),D(t,Ir,R=>n(176,nt=R)),D(t,Wr,R=>n(178,qt=R)),D(t,ji,R=>n(13,K=R)),D(t,An,R=>n(154,Nt=R)),D(t,Wi,R=>n(180,ve=R)),D(t,Fi,R=>n(177,Ut=R)),D(t,gi,R=>n(179,Dt=R)),D(t,Ii,R=>n(153,kt=R)),D(t,Ki,R=>n(152,le=R)),D(t,Go,R=>n(146,vt=R)),D(t,mo,R=>n(142,q=R));const Oo=(R,te)=>{const Re={target:R,translate:te},$n=Jd(co(Nt),X),In=Jd(co(ve),X);let Ln=P$(mt,Re,{...Z,x:0,y:0},{aspectRatio:Dt,minSize:$n,maxSize:In});if(Ln=((pn,On,mn)=>{const[Gn,Ri,$i,vi]=pl(pn),Rn={...pn};if(Gn<On.y&&(pn.height=pn.height-(On.y-Gn),pn.y=On.y),Ri>On.x+On.width&&(pn.width=On.x+On.width-pn.x),$i>On.y+On.height&&(pn.height=On.y+On.height-pn.y),vi<On.x&&(pn.width=pn.width-(On.x-vi),pn.x=On.x),mn){const vr=Math.min(1,Rn.width/pn.width,Rn.height/pn.height);return Ms(Rn,vr)}return pn})(Ln,{...Z,x:0,y:0},Dt),!kt)return{boundsLimited:Ln,boundsIntent:Ln};let He=C6(mt,Ln,Re,It,{aspectRatio:Dt,minSize:$n,maxSize:In});return{boundsLimited:He,boundsIntent:He}},no=(R,te)=>{const Re={target:R,translate:te},$n=Jd(co(Nt),X),In=Jd(co(ve),X),Ln=((He,pn,On={})=>{const{target:mn,translate:Gn}=pn,{aspectRatio:Ri,minSize:$i}=On,vi=Uc[C0[mn]],Rn=nr(Mn(He),pt(vi[0]*He.width,vi[1]*He.height)),vr=Uc[mn],jo=nr(Mn(He),pt(vr[0]*He.width,vr[1]*He.height)),[Ns,Ha,Ua,Sa,Ga,ps,ja]=M0(mn);let ua=Gn.x,Za=Gn.y;Ga?Za=0:ps&&(ua=0);let[xi,ro,oo,Rr]=pl(He);if(Ns?Rr=Rn.x:Ha&&(ro=Rn.x),Sa?xi=Rn.y:Ua&&(oo=Rn.y),Ns?ro=jo.x+ua:Ha&&(Rr=jo.x+ua),Sa?oo=jo.y+Za:Ua&&(xi=jo.y+Za),$i&&Ga&&oo-xi<$i.height){const Qn=$i.height-(oo-xi);xi-=.5*Qn,oo+=.5*Qn}if($i&&ps&&ro-Rr<$i.width){const Qn=$i.width-(ro-Rr);Rr-=.5*Qn,ro+=.5*Qn}if(Ri)if(ja){let Qn=ro-Rr,So=oo-xi;Ga?(So=Qn/Ri,xi=Rn.y-.5*So,oo=Rn.y+.5*So):ps&&(Qn=So*Ri,Rr=Rn.x-.5*Qn,ro=Rn.x+.5*Qn)}else{const Qn=pt(jo.x+ua-Rn.x,jo.y+Za-Rn.y);mn===ia?(Qn.x=Math.max(0,Qn.x),Qn.y=Math.min(0,Qn.y)):mn===ra?(Qn.x=Math.max(0,Qn.x),Qn.y=Math.max(0,Qn.y)):mn===oa?(Qn.x=Math.min(0,Qn.x),Qn.y=Math.max(0,Qn.y)):mn===na&&(Qn.x=Math.min(0,Qn.x),Qn.y=Math.min(0,Qn.y));const So=Ts(Qn),Ta=pt(Ri,1),qr=Po(bo(Ta),So);mn===ia?(ro=Rn.x+qr.x,xi=Rn.y-qr.y):mn===ra?(ro=Rn.x+qr.x,oo=Rn.y+qr.y):mn===oa?(Rr=Rn.x-qr.x,oo=Rn.y+qr.y):mn===na&&(Rr=Rn.x-qr.x,xi=Rn.y-qr.y)}return Ci(Rr,xi,ro-Rr,oo-xi)})(mt,Re,{aspectRatio:Dt,minSize:$n});return{boundsLimited:P$(mt,Re,{...Z,x:0,y:0},{aspectRatio:Dt,minSize:$n,maxSize:In}),boundsIntent:Ln}};let zi,fr;const Bi=({translation:R,scalar:te})=>{bt&&(te=1,R=_c(Ue(R)));const Re=Math.min(Bt.width/K.width,Bt.height/K.height),$n=Po(Ue(R),1/Re);let In;if(fr){const Ln=Oi(Ue(fr),R);fr=R,In=ta(Mn(K),Ln)}else In=ta(Mn(zi),_c(Ue($n))),te!==void 0&&Sr(In,1/te);At(Ir,nt=In,nt),At(ji,K=In,K)},Ji=Vn([Fi,ji],([R,te],Re)=>{if(!te)return;const[$n,In]=R,Ln=lr(te);Re([dl(Bo(Ls($n,Ln),en)),dl(Bo(Kr(In,Ln),en))])});D(t,Ji,R=>n(174,Jt=R));const Xr=Vn([Ki,Ii,An,Wi,Fi,Br],([R,te,Re,$n,In,Ln],He)=>{if(!R)return;const pn=In[0],On=In[1];let mn,Gn;te?(mn=((Ri,$i,vi)=>Fa(vi)?1-1/Math.min(Ri.height/$i.width,Ri.width/$i.height):1-1/Math.min(Ri.width/$i.width,Ri.height/$i.height))(R,On,Ln),Gn=Math.min(pn.width/Re.width,pn.height/Re.height)):(mn=-1,Gn=1),He([mn,Gn].map(Ri=>en(Ri)))});D(t,Xr,R=>n(27,de=R));const go=Vn([Ki,ji,Fi,Br],([R,te,Re,$n],In)=>{if(!R||!te)return In(0);let Ln;const He=Re[0],pn=Re[1],On=te.width,mn=te.height,Gn=lr(te),Ri=Fa($n)?sr(R.height,R.width):R,$i=Kr(Ri,Gn);if(On<=$i.width||mn<=$i.height){const vi=$i.width-He.width,Rn=$i.height-He.height;Ln=vi===0||Rn===0?1:1-Math.min((On-He.width)/vi,(mn-He.height)/Rn)}else{const vi=pn.width-$i.width,Rn=pn.height-$i.height,vr=Kr({width:vi,height:Rn},Gn);Ln=-Math.min((On-$i.width)/vr.width,(mn-$i.height)/vr.height)}In(Ln)});D(t,go,R=>n(28,Ve=R));const io=R=>{const te=lr(zi);let Re,$n,In;const Ln=Fa(rt)?sr(le.height,le.width):le,He=Kr(Ln,te);if(R>=0){const mn=He.width-Ut[0].width,Gn=He.height-Ut[0].height;Re=He.width-mn*R,$n=He.height-Gn*R,In=Ls({width:Re,height:$n},te)}else{const mn=Ut[1].width-He.width,Gn=Ut[1].height-He.height;Re=He.width+mn*-R,$n=He.height+Gn*-R,In=Kr({width:Re,height:$n},te)}Re=In.width,$n=In.height;const pn=zi.x+.5*zi.width-.5*Re,On=zi.y+.5*zi.height-.5*$n;At(ji,K={x:pn,y:On,width:Re,height:$n},K)};let L;const ee=R=>{const te=Sr(Mn(L),1/R);At(Ir,nt=te,nt),At(ji,K=te,K)};let sn;const je=()=>{_i.set({})};let re;const ie=fn(0,{precision:1e-4});D(t,ie,R=>n(29,Oe=R));const bn=fn();D(t,bn,R=>n(30,Ne=R));const Kt=Vn([gi,Nr,Pi],([R,te,Re],$n)=>{if(!i)return;const In=Wc(Re),Ln=[...In].map(He=>He[0]).sort((He,pn)=>qi(He[0])&&!qi(pn[0])?1:-1).find(He=>{if(qi(He)&&te){const[pn,On]=He,mn=te.width===pn&&te.height===On,Gn=R===as(pn,On);return mn&&Gn}return He===R});if(!Ln)return $n(void 0);$n(In.map(He=>He[0]).findIndex(He=>qi(He)?Os(He,Ln):He===Ln))});D(t,Kt,R=>n(155,nn=R));const ai=(R,te)=>{if(!i||R===-1||R===void 0)return;const Re=Wc(te)[R][0];return Re?qi(Re)?as(Re[0],Re[1]):Re:void 0},zn=Vn([Lo,Pr,ui],([R,te,Re],$n)=>{const{rows:In,cols:Ln,opacity:He}=Dn(bi,Re);if(!te||He<=0)return $n([]);const{x:pn,y:On,width:mn,height:Gn}=te,Ri=mn/Ln,$i=Gn/In,vi=[];for(let Rn=1;Rn<=In-1;Rn++){const vr=On+$i*Rn;vi.push({id:"image-selection-guide-row-"+Rn,points:[pt(pn,vr),pt(pn+mn,vr)],opacity:He,strokeWidth:1,strokeColor:R})}for(let Rn=1;Rn<=Ln-1;Rn++){const vr=pn+Ri*Rn;vi.push({id:"image-selection-guide-col-"+Rn,points:[pt(vr,On),pt(vr,On+Gn)],opacity:He,strokeWidth:1,strokeColor:R})}$n(vi)});D(t,zn,R=>n(141,at=R));const Pn="crop-"+ba();let br,Qi=Pn+"-"+(Qt?be:"zoom"),fo=Qi,da;const wa=fn(W?20:0);return D(t,wa,R=>n(138,it=R)),t.$$set=R=>{"isActive"in R&&Je(n(0,kn=R.isActive)),"stores"in R&&n(97,En=R.stores),"cropImageSelectionCornerStyle"in R&&n(1,Zt=R.cropImageSelectionCornerStyle),"cropWillRenderImageSelectionGuides"in R&&n(98,Dn=R.cropWillRenderImageSelectionGuides),"cropAutoCenterImageSelectionTimeout"in R&&n(99,H=R.cropAutoCenterImageSelectionTimeout),"cropEnableZoomMatchImageAspectRatio"in R&&n(100,Wt=R.cropEnableZoomMatchImageAspectRatio),"cropEnableRotateMatchImageAspectRatio"in R&&n(101,z=R.cropEnableRotateMatchImageAspectRatio),"cropEnableRotationInput"in R&&n(102,Qt=R.cropEnableRotationInput),"cropEnableZoom"in R&&n(2,ce=R.cropEnableZoom),"cropEnableZoomInput"in R&&n(103,ye=R.cropEnableZoomInput),"cropEnableZoomAutoHide"in R&&n(104,ue=R.cropEnableZoomAutoHide),"cropEnableImageSelection"in R&&n(105,Yt=R.cropEnableImageSelection),"cropEnableInfoIndicator"in R&&n(106,Gt=R.cropEnableInfoIndicator),"cropEnableZoomTowardsWheelPosition"in R&&n(107,hn=R.cropEnableZoomTowardsWheelPosition),"cropEnableLimitWheelInputToCropSelection"in R&&n(108,Xe=R.cropEnableLimitWheelInputToCropSelection),"cropEnableCenterImageSelection"in R&&n(109,on=R.cropEnableCenterImageSelection),"cropEnableButtonRotateLeft"in R&&n(110,xe=R.cropEnableButtonRotateLeft),"cropEnableButtonRotateRight"in R&&n(111,Me=R.cropEnableButtonRotateRight),"cropEnableButtonFlipHorizontal"in R&&n(112,Yn=R.cropEnableButtonFlipHorizontal),"cropEnableButtonFlipVertical"in R&&n(113,Se=R.cropEnableButtonFlipVertical),"cropSelectPresetOptions"in R&&n(114,J=R.cropSelectPresetOptions),"cropEnableSelectPreset"in R&&n(115,Xt=R.cropEnableSelectPreset),"cropEnableFilterMatchAspectRatio"in R&&n(116,jt=R.cropEnableFilterMatchAspectRatio),"cropSelectPresetFilter"in R&&n(95,se=R.cropSelectPresetFilter),"cropEnableButtonToggleCropLimit"in R&&n(117,Fe=R.cropEnableButtonToggleCropLimit),"cropWillRenderTools"in R&&n(118,ke=R.cropWillRenderTools),"cropActiveTransformTool"in R&&n(119,be=R.cropActiveTransformTool),"cropMinimizeToolbar"in R&&n(120,mi=R.cropMinimizeToolbar),"cropInteractionFocus"in R&&n(121,si=R.cropInteractionFocus),"cropRotationRange"in R&&n(3,ge=R.cropRotationRange),"cropMaskOpacity"in R&&n(122,an=R.cropMaskOpacity),"locale"in R&&n(4,we=R.locale)},t.$$.update=()=>{4096&t.$$.dirty[0]|268435456&t.$$.dirty[3]&&Pe.set(si==="selection"&&M),2097152&t.$$.dirty[3]&&n(129,i=J&&Array.isArray(J)&&J.length),2097152&t.$$.dirty[3]|32&t.$$.dirty[4]&&Pi.set(i?J:[]),4096&t.$$.dirty[0]|32768&t.$$.dirty[4]&&M&&xr.set(1,{hard:!W}),4096&t.$$.dirty[0]&&Dr.set(!M),4096&t.$$.dirty[0]&&Gi.set(!M),4096&t.$$.dirty[0]&&M&&ci.set(!0),65536&t.$$.dirty[4]&&n(124,h=ot.layoutMode==="overlay"),4194304&t.$$.dirty[3]|1&t.$$.dirty[4]&&n(128,I=Xt&&!h),83886080&t.$$.dirty[4]&&n(137,l=Z&&Bt&&xu(Z,Bt)),67117056&t.$$.dirty[4]&&n(135,c=!(!Bt||!l)),67119104&t.$$.dirty[4]&&n(133,d=c&&ea(Bt,l,R=>en(R,5))),16400&t.$$.dirty[0]|52297732&t.$$.dirty[3]|1879114288&t.$$.dirty[4]|31&t.$$.dirty[5]&&n(11,r=We&&ke([xe&&["Button","rotate-left",{label:we.cropLabelButtonRotateLeft,labelClass:"PinturaToolbarContentWide",icon:we.cropIconButtonRotateLeft,onclick:()=>{Uo(-Math.PI/2),li.write()}}],Me&&["Button","rotate-right",{label:we.cropLabelButtonRotateRight,labelClass:"PinturaToolbarContentWide",icon:we.cropIconButtonRotateRight,onclick:()=>{Uo(Math.PI/2),li.write()}}],Yn&&["Button","flip-horizontal",{label:we.cropLabelButtonFlipHorizontal,labelClass:"PinturaToolbarContentWide",icon:we.cropIconButtonFlipHorizontal,onclick:()=>{Fa(rt)?At(kr,Ke=!Ke,Ke):At(to,Ae=!Ae,Ae),li.write()}}],Se&&["Button","flip-vertical",{label:we.cropLabelButtonFlipVertical,labelClass:"PinturaToolbarContentWide",icon:we.cropIconButtonFlipVertical,onclick:()=>{Fa(rt)?At(to,Ae=!Ae,Ae):At(kr,Ke=!Ke,Ke),li.write()}}],I&&i&&[se===!1?"Dropdown":T6,"select-preset",{icon:cr(we.cropIconSelectPreset,we,ai(nn,he)),label:cr(we.cropLabelSelectPreset,we,ai(nn,he)),labelClass:"PinturaToolbarContentWide",options:he,filter:se,onfilterchange:Ui,selectedIndex:nn,onchange:({value:R})=>{qi(R)?(At(gi,Dt=as(R[0],R[1]),Dt),At(Nr,Ze=Db(R),Ze)):At(gi,Dt=R,Dt),d&&je(),li.write()},optionMapper:R=>{let te=!1;const Re=qi(R.value)?R.value[0]/R.value[1]:R.value;if(Re){const $n=Bl(le,rt,Re);te=$n.width<Nt.width||$n.height<Nt.height}return R.icon=(($n,In={})=>{const{width:Ln=24,height:He=24,bounds:pn=16,radius:On=3}=In;let mn,Gn,Ri,$i,vi=qi($n)?as($n[0],$n[1]):$n,Rn=!!vi;return vi=Rn?vi:1,Ri=vi>1?pn:vi*pn,$i=Ri/vi,mn=Math.round(.5*(Ln-Ri)),Gn=Math.round(.5*(He-$i)),`<rect fill="${Rn?"currentColor":"none"}" stroke="${Rn?"none":"currentColor"}" stroke-width="${Ln/16}" stroke-dasharray="${[Ln/12,Ln/6].join(" ")}" x="${mn}" y="${Gn}" width="${Ri}" height="${$i}" rx="${On}"/>`})(R.value,{bounds:14}),{...R,disabled:te}}}],Fe&&["Dropdown","select-crop-limit",{icon:cr(we.cropIconCropBoundary,we,kt),label:we.cropLabelCropBoundary,labelClass:"PinturaToolbarContentWide",onchange:({value:R})=>{At(Ii,kt=R,kt),li.write()},options:[[!0,we.cropLabelCropBoundaryEdge,{icon:cr(we.cropIconCropBoundary,we,!0)}],[!1,we.cropLabelCropBoundaryNone,{icon:cr(we.cropIconCropBoundary,we,!1)}]]}]].filter(Boolean),ot,()=>Ht.set({})).filter(Boolean)),6144&t.$$.dirty[0]|134217728&t.$$.dirty[3]|65537&t.$$.dirty[4]&&At(zr,lt=M&&mi!=="never"&&(mi==="always"||ot.verticalSpace==="short"||h)?r.map(([R,te,Re])=>Array.isArray(Re)?[R,te,Re]:[R,te,{...Re,hideLabel:!0}]):[],lt),536870912&t.$$.dirty[4]&&n(23,o=kt?0:-1),150994944&t.$$.dirty[4]&&n(130,a=Z&&pt(-(st.x-Z.x),-(st.y-Z.y))),524352&t.$$.dirty[4]&&n(131,s=V&&a&&pt(Kc(V.x+.5*V.width+a.x),Kc(V.y+.5*V.height+a.y))),33554432&t.$$.dirty[4]&&n(134,u=mt!=null),16785408&t.$$.dirty[4]&&n(136,p=Z&&l&&(l.height===Z.height||l.width===Z.width)),12587008&t.$$.dirty[4]&&n(132,y=!p&&X<1&&vt<1),3840&t.$$.dirty[4]&&n(9,m=c&&!u&&(!d||y)),8192&t.$$.dirty[0]|8192&t.$$.dirty[3]|1&t.$$.dirty[4]&&n(22,f=Gt&&!!K&&!h),524352&t.$$.dirty[4]&&n(8,w=V&&a&&{x:V.x+a.x,y:V.y+a.y,width:V.width,height:V.height}),256&t.$$.dirty[0]|4096&t.$$.dirty[3]|1&t.$$.dirty[4]&&n(21,b=Yt&&!!w&&!h),65600&t.$$.dirty[3]|2097280&t.$$.dirty[4]&&n(10,v=on&&!!s&&!H&&!bt),512&t.$$.dirty[0]|1073741888&t.$$.dirty[3]|1048576&t.$$.dirty[4]&&m&&H&&!ut&&(clearTimeout(re),n(123,re=setTimeout(je,H))),1073741824&t.$$.dirty[3]|1048576&t.$$.dirty[4]&&ut&&clearTimeout(re),1536&t.$$.dirty[0]|32768&t.$$.dirty[4]&&ie.set(v&&m?1:0,{hard:W===!1}),32896&t.$$.dirty[4]&&bn.set(s,{hard:W===!1}),4096&t.$$.dirty[0]|262144&t.$$.dirty[4]&&(M&&!q?(At(Zr,ct.crop={maskOpacity:an,maskMarkupOpacity:an},ct),Zr.set(ct)):(delete ct.crop,Zr.set(ct))),131072&t.$$.dirty[4]&&at&&ca.update(R=>{const te=R.filter(Re=>!/^image\-selection\-guide/.test(Re.id));return M?[...te,...at]:te}),65536&t.$$.dirty[4]&&n(127,T=ot.verticalSpace!=="short"),134217728&t.$$.dirty[3]|9&t.$$.dirty[4]&&n(20,P=mi==="never"&&!h||T&&mi!=="always"),4&t.$$.dirty[0]|1024&t.$$.dirty[3]&&n(126,_=ce&&ye),2048&t.$$.dirty[3]|12&t.$$.dirty[4]&&n(125,C=ue?T&&_:_),512&t.$$.dirty[3]|2&t.$$.dirty[4]&&n(19,F=Qt||C),2&t.$$.dirty[4]&&(C||n(5,fo=Qi)),32&t.$$.dirty[0]&&n(18,G={name:Pn,selected:fo}),16&t.$$.dirty[0]|512&t.$$.dirty[3]|2&t.$$.dirty[4]&&n(7,O=[Qt&&{id:Pn+"-rotation",label:we.cropLabelTabRotation},C&&{id:Pn+"-zoom",label:we.cropLabelTabZoom}].filter(Boolean)),128&t.$$.dirty[0]&&n(17,$=O.map(R=>R.id)),64&t.$$.dirty[0]|1&t.$$.dirty[4]&&br&&!br.children.length&&h&&br.dispatchEvent(new CustomEvent("measure",{detail:br.rect})),4096&t.$$.dirty[0]|32768&t.$$.dirty[4]&&W&&wa.set(M?0:20),16384&t.$$.dirty[4]&&n(16,N=it?`transform: translateY(${it}px)`:void 0)},[kn,Zt,ce,ge,we,fo,br,O,w,m,v,r,M,K,rt,da,N,$,G,F,P,b,f,o,Be,xn,xt,de,Ve,Oe,Ne,Ge,Le,Ht,Pe,Cn,Un,Pi,uo,ii,un,rr,Jr,po,jr,Qr,zr,Zr,to,kr,Br,eo,Nr,wo,ho,Er,Pr,Ir,Wr,ji,An,Wi,Fi,gi,Ii,Ki,Go,mo,()=>{bi="select",At(ii,ut=!0,ut),At(ho,mt=Mn(Bt),mt),Di=bt?Oo:no},({detail:R})=>{const{boundsLimited:te,boundsIntent:Re}=Di(R.direction,R.translation);At(un,gt=!0,gt),At(Er,Ie=Re,Ie),At(wo,Bt=te,Bt)},({detail:R})=>{const{boundsLimited:te}=Di(R.direction,R.translation);At(un,gt=!1,gt),At(ii,ut=!1,ut),At(Er,Ie=void 0,Ie),Ts(R.translation)&&(At(wo,Bt=te,Bt),li.write()),At(ho,mt=void 0,mt),bi=void 0},()=>{bi="rotate",At(ii,ut=!0,ut),At(Wr,qt=Mn(K),qt)},R=>{At(un,gt=!0,gt),At(Br,rt=R,rt)},R=>{At(un,gt=!1,gt),At(ii,ut=!1,ut),At(Br,rt=R,rt),li.write(),At(Wr,qt=void 0,qt)},()=>{bi="pan",fr=void 0,At(ii,ut=!0,ut),zi=Mn(K)},({detail:R})=>{At(un,gt=!0,gt),Bi(R)},({detail:R})=>{At(un,gt=!1,gt),At(ii,ut=!1,ut),(Ts(R.translation)>0||R.scalar!==0)&&(Bi(R),li.write()),At(Ir,nt=void 0,nt),zi=void 0},({detail:{translation:R}})=>{bt&&(R=_c(Ue(R))),fr=R,At(ii,ut=!1,ut)},Ji,Xr,go,()=>{bi="zoom",At(ii,ut=!0,ut),zi=Mn(K)},R=>{At(un,gt=!1,gt),io(R)},R=>{io(R),li.write(),At(un,gt=!1,gt),At(ii,ut=!1,ut),zi=void 0},()=>{bi="zoom",zi||(L=Mn(K),At(ii,ut=!0,ut))},({detail:R})=>{L&&(At(un,gt=!0,gt),ee(R))},({detail:R})=>{L&&(At(un,gt=!1,gt),At(ii,ut=!1,ut),ee(R),At(Ir,nt=void 0,nt),L=void 0,li.write())},R=>{const te=Ph(R,Be,st);if(Xe&&!Ru(Bt,te))return;bi="zoom",At(ii,ut=!0,ut),At(un,gt=!0,gt),R.preventDefault(),R.stopPropagation();const Re=t1(R,{fixScrollDirection:$t}),$n=1+Re/100,In=Mn(K),Ln=Math.min(K.width/Nt.width,K.height/Nt.height)===1;if(Wt&&kt){const On=gr(K,le,rt);if(Hi()&&On&&Re>0&&d){At(ii,ut=!1,ut),At(un,gt=!1,gt);const mn=Fa(rt)?Fr({height:le.width,width:le.height}):Fr(le);return ea(In,mn)||(clearTimeout(sn),ea(li.state.crop,mn))?void 0:(At(ji,K=mn,K),void li.write())}}let He=wn(K);if(hn&&si!=="selection"&&Re<0&&!Ln){const On=Oi(Ue(te),Bt),mn=Math.min(Bt.width/K.width,Bt.height/K.height),Gn=Sr(Mn(Bt),1.1);He=Ru(Gn,te)?nr(Mn(K),Po(On,1/mn)):He}let pn=Sr(Mn(K),$n,He);if(Nm(Jt[1],pn)||(pn=Wm(wn(pn),Jt[1])),Nm(pn,Jt[0])||(pn=Wm(wn(pn),Jt[0])),ea(In,pn,en))return At(ii,ut=!1,ut),void At(un,gt=!1,gt);At(ji,K=Bo(pn,On=>en(On,5)),K),At(ii,ut=!1,ut),At(un,gt=!1,gt),clearTimeout(sn),sn=setTimeout(()=>{li.write()},500)},je,ie,bn,Kt,zn,Pn,wa,se,"crop",En,Dn,H,Wt,z,Qt,ye,ue,Yt,Gt,hn,Xe,on,xe,Me,Yn,Se,J,Xt,jt,Fe,ke,be,mi,si,an,re,h,C,_,T,I,i,a,s,y,d,u,c,p,l,it,W,ot,at,q,V,ut,bt,vt,X,Z,mt,Bt,st,le,kt,Nt,nn,he,Ke,Ae,We,function(R){aa.call(this,t,R)},({detail:R})=>n(5,fo=R),function(R){Nn[R?"unshift":"push"](()=>{br=R,n(6,br)})},R=>w0(R),function(R){da=R,n(15,da)},function(R){aa.call(this,t,R)}]}var z6={util:["crop",class extends Tn{constructor(t){super(),Sn(this,t,D6,O6,yn,{name:96,isActive:0,stores:97,cropImageSelectionCornerStyle:1,cropWillRenderImageSelectionGuides:98,cropAutoCenterImageSelectionTimeout:99,cropEnableZoomMatchImageAspectRatio:100,cropEnableRotateMatchImageAspectRatio:101,cropEnableRotationInput:102,cropEnableZoom:2,cropEnableZoomInput:103,cropEnableZoomAutoHide:104,cropEnableImageSelection:105,cropEnableInfoIndicator:106,cropEnableZoomTowardsWheelPosition:107,cropEnableLimitWheelInputToCropSelection:108,cropEnableCenterImageSelection:109,cropEnableButtonRotateLeft:110,cropEnableButtonRotateRight:111,cropEnableButtonFlipHorizontal:112,cropEnableButtonFlipVertical:113,cropSelectPresetOptions:114,cropEnableSelectPreset:115,cropEnableFilterMatchAspectRatio:116,cropSelectPresetFilter:95,cropEnableButtonToggleCropLimit:117,cropWillRenderTools:118,cropActiveTransformTool:119,cropMinimizeToolbar:120,cropInteractionFocus:121,cropRotationRange:3,cropMaskOpacity:122,locale:4},null,[-1,-1,-1,-1,-1,-1,-1,-1])}get name(){return this.$$.ctx[96]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),U()}get stores(){return this.$$.ctx[97]}set stores(t){this.$$set({stores:t}),U()}get cropImageSelectionCornerStyle(){return this.$$.ctx[1]}set cropImageSelectionCornerStyle(t){this.$$set({cropImageSelectionCornerStyle:t}),U()}get cropWillRenderImageSelectionGuides(){return this.$$.ctx[98]}set cropWillRenderImageSelectionGuides(t){this.$$set({cropWillRenderImageSelectionGuides:t}),U()}get cropAutoCenterImageSelectionTimeout(){return this.$$.ctx[99]}set cropAutoCenterImageSelectionTimeout(t){this.$$set({cropAutoCenterImageSelectionTimeout:t}),U()}get cropEnableZoomMatchImageAspectRatio(){return this.$$.ctx[100]}set cropEnableZoomMatchImageAspectRatio(t){this.$$set({cropEnableZoomMatchImageAspectRatio:t}),U()}get cropEnableRotateMatchImageAspectRatio(){return this.$$.ctx[101]}set cropEnableRotateMatchImageAspectRatio(t){this.$$set({cropEnableRotateMatchImageAspectRatio:t}),U()}get cropEnableRotationInput(){return this.$$.ctx[102]}set cropEnableRotationInput(t){this.$$set({cropEnableRotationInput:t}),U()}get cropEnableZoom(){return this.$$.ctx[2]}set cropEnableZoom(t){this.$$set({cropEnableZoom:t}),U()}get cropEnableZoomInput(){return this.$$.ctx[103]}set cropEnableZoomInput(t){this.$$set({cropEnableZoomInput:t}),U()}get cropEnableZoomAutoHide(){return this.$$.ctx[104]}set cropEnableZoomAutoHide(t){this.$$set({cropEnableZoomAutoHide:t}),U()}get cropEnableImageSelection(){return this.$$.ctx[105]}set cropEnableImageSelection(t){this.$$set({cropEnableImageSelection:t}),U()}get cropEnableInfoIndicator(){return this.$$.ctx[106]}set cropEnableInfoIndicator(t){this.$$set({cropEnableInfoIndicator:t}),U()}get cropEnableZoomTowardsWheelPosition(){return this.$$.ctx[107]}set cropEnableZoomTowardsWheelPosition(t){this.$$set({cropEnableZoomTowardsWheelPosition:t}),U()}get cropEnableLimitWheelInputToCropSelection(){return this.$$.ctx[108]}set cropEnableLimitWheelInputToCropSelection(t){this.$$set({cropEnableLimitWheelInputToCropSelection:t}),U()}get cropEnableCenterImageSelection(){return this.$$.ctx[109]}set cropEnableCenterImageSelection(t){this.$$set({cropEnableCenterImageSelection:t}),U()}get cropEnableButtonRotateLeft(){return this.$$.ctx[110]}set cropEnableButtonRotateLeft(t){this.$$set({cropEnableButtonRotateLeft:t}),U()}get cropEnableButtonRotateRight(){return this.$$.ctx[111]}set cropEnableButtonRotateRight(t){this.$$set({cropEnableButtonRotateRight:t}),U()}get cropEnableButtonFlipHorizontal(){return this.$$.ctx[112]}set cropEnableButtonFlipHorizontal(t){this.$$set({cropEnableButtonFlipHorizontal:t}),U()}get cropEnableButtonFlipVertical(){return this.$$.ctx[113]}set cropEnableButtonFlipVertical(t){this.$$set({cropEnableButtonFlipVertical:t}),U()}get cropSelectPresetOptions(){return this.$$.ctx[114]}set cropSelectPresetOptions(t){this.$$set({cropSelectPresetOptions:t}),U()}get cropEnableSelectPreset(){return this.$$.ctx[115]}set cropEnableSelectPreset(t){this.$$set({cropEnableSelectPreset:t}),U()}get cropEnableFilterMatchAspectRatio(){return this.$$.ctx[116]}set cropEnableFilterMatchAspectRatio(t){this.$$set({cropEnableFilterMatchAspectRatio:t}),U()}get cropSelectPresetFilter(){return this.$$.ctx[95]}set cropSelectPresetFilter(t){this.$$set({cropSelectPresetFilter:t}),U()}get cropEnableButtonToggleCropLimit(){return this.$$.ctx[117]}set cropEnableButtonToggleCropLimit(t){this.$$set({cropEnableButtonToggleCropLimit:t}),U()}get cropWillRenderTools(){return this.$$.ctx[118]}set cropWillRenderTools(t){this.$$set({cropWillRenderTools:t}),U()}get cropActiveTransformTool(){return this.$$.ctx[119]}set cropActiveTransformTool(t){this.$$set({cropActiveTransformTool:t}),U()}get cropMinimizeToolbar(){return this.$$.ctx[120]}set cropMinimizeToolbar(t){this.$$set({cropMinimizeToolbar:t}),U()}get cropInteractionFocus(){return this.$$.ctx[121]}set cropInteractionFocus(t){this.$$set({cropInteractionFocus:t}),U()}get cropRotationRange(){return this.$$.ctx[3]}set cropRotationRange(t){this.$$set({cropRotationRange:t}),U()}get cropMaskOpacity(){return this.$$.ctx[122]}set cropMaskOpacity(t){this.$$set({cropMaskOpacity:t}),U()}get locale(){return this.$$.ctx[4]}set locale(t){this.$$set({locale:t}),U()}}]};function B6(t){let e,n,i,r,o,a,s,l=t[77],c=(Si(t[77].label)?t[77].label(t[2]):t[77].label)+"";function d(...h){return t[51](t[77],...h)}const u=()=>t[52](n,l),p=()=>t[52](null,l);return{c(){e=ft("div"),n=ft("div"),i=pe(),r=ft("span"),o=Mi(c),S(n,"class",Tx),S(e,"slot","option"),S(e,"class","PinturaFilterOption")},m(h,y){tt(h,e,y),Et(e,n),u(),Et(e,i),Et(e,r),Et(r,o),a||(s=[St(n,"measure",d),qn(Cr.call(null,n))],a=!0)},p(h,y){l!==(t=h)[77]&&(p(),l=t[77],u()),4&y[0]|32768&y[2]&&c!==(c=(Si(t[77].label)?t[77].label(t[2]):t[77].label)+"")&&Yi(o,c)},d(h){h&&Q(e),p(),a=!1,Zn(s)}}}function N6(t){let e,n;return e=new fl({props:{locale:t[2],layout:"row",options:t[3],selectedIndex:t[12],onchange:t[32],$$slots:{option:[B6,({option:i})=>({77:i}),({option:i})=>[0,0,i?32768:0]]},$$scope:{ctx:t}}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};4&r[0]&&(o.locale=i[2]),8&r[0]&&(o.options=i[3]),4096&r[0]&&(o.selectedIndex=i[12]),1028&r[0]|98304&r[2]&&(o.$$scope={dirty:r,ctx:i}),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function W6(t){let e,n,i,r,o,a,s,l;function c(h){t[54](h)}function d(h){t[55](h)}function u(h){t[56](h)}let p={elasticity:t[13]*t[19],onscroll:t[53],$$slots:{default:[N6]},$$scope:{ctx:t}};return t[4]!==void 0&&(p.maskFeatherStartOpacity=t[4]),t[5]!==void 0&&(p.maskFeatherEndOpacity=t[5]),t[6]!==void 0&&(p.maskFeatherSize=t[6]),n=new us({props:p}),Nn.push(()=>Ro(n,"maskFeatherStartOpacity",c)),Nn.push(()=>Ro(n,"maskFeatherEndOpacity",d)),Nn.push(()=>Ro(n,"maskFeatherSize",u)),n.$on("measure",t[57]),{c(){e=ft("div"),zt(n.$$.fragment),S(e,"slot","footer"),S(e,"style",t[11])},m(h,y){tt(h,e,y),Ft(n,e,null),a=!0,s||(l=[St(e,"transitionend",t[30]),St(e,"measure",t[58]),qn(Cr.call(null,e,{observePosition:!0}))],s=!0)},p(h,y){const m={};8192&y[0]&&(m.elasticity=h[13]*h[19]),128&y[0]&&(m.onscroll=h[53]),5132&y[0]|65536&y[2]&&(m.$$scope={dirty:y,ctx:h}),!i&&16&y[0]&&(i=!0,m.maskFeatherStartOpacity=h[4],Wo(()=>i=!1)),!r&&32&y[0]&&(r=!0,m.maskFeatherEndOpacity=h[5],Wo(()=>r=!1)),!o&&64&y[0]&&(o=!0,m.maskFeatherSize=h[6],Wo(()=>o=!1)),n.$set(m),(!a||2048&y[0])&&S(e,"style",h[11])},i(h){a||(k(n.$$.fragment,h),a=!0)},o(h){A(n.$$.fragment,h),a=!1},d(h){h&&Q(e),_t(n),s=!1,Zn(l)}}}function V6(t){let e,n;return e=new i1({props:{$$slots:{footer:[W6]},$$scope:{ctx:t}}}),e.$on("measure",t[59]),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};16380&r[0]|65536&r[2]&&(o.$$scope={dirty:r,ctx:i}),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}let Tx="PinturaFilterPreview";function H6(t,e,n){let i,r,o,a,s,l,c,d,u,p,h,y,m,f,b,v,w,T,I,P,_=tn,C=()=>(_(),_=xo($,xt=>n(43,d=xt)),$),F=tn,G=()=>(F(),F=xo(O,xt=>n(49,w=xt)),O);t.$$.on_destroy.push(()=>_()),t.$$.on_destroy.push(()=>F());let{isActive:O}=e;G();let{isActiveFraction:$}=e;C();let{stores:N}=e,{locale:it}=e,{filterFunctions:M}=e,{filterOptions:W}=e;const ot=yi("elasticityMultiplier");D(t,ot,xt=>n(13,P=xt));const{history:at,interfaceImages:q,stageRectBase:ct,utilRect:V,animation:ut,scrollElasticity:bt,imageSize:K,imagePreview:vt,imageCropRect:X,imageRotation:Z,imageFlipX:mt,imageFlipY:Bt,imageBackgroundColor:st,imageGamma:gt,imageColorMatrix:Jt,allowPan:le,allowZoom:rt,allowZoomControls:kt,allowPlayPause:Nt}=N;D(t,q,xt=>n(60,u=xt)),D(t,ct,xt=>n(48,v=xt)),D(t,V,xt=>n(47,b=xt)),D(t,ut,xt=>n(50,T=xt)),D(t,K,xt=>n(62,h=xt)),D(t,vt,xt=>n(42,c=xt)),D(t,st,xt=>n(61,p=xt)),D(t,gt,xt=>n(44,y=xt)),D(t,Jt,xt=>n(40,s=xt));const $t=me({});D(t,$t,xt=>n(46,f=xt));const Be=(xt,de)=>At($t,f[xt.value]=de,f),nt=Vn($t,xt=>{if(!xt[void 0])return;const de=xt[void 0];return I&&Gc(I,de)?I:co(de)});D(t,nt,xt=>n(63,I=xt));const Ut=Vn([O,nt,X,K,Z,mt,Bt],([xt,de,Ve,Oe,Ne,_e,Je],kn)=>{if(!xt||!de||!Oe)return m;const En=Fr(Oe),Zt=wn(En),Dn=s0(Oe,Ve,Ne),H=wn(Dn),Wt=Oi(Ue(Zt),H),z=_c(Ue(Wt)),Qt=Math.max(de.width/Ve.width,de.height/Ve.height);kn({origin:z,translation:Wt,rotation:{x:Je?Math.PI:0,y:_e?Math.PI:0,z:Ne},scale:Qt})});D(t,Ut,xt=>n(45,m=xt));const qt=fn(T?20:0);let Dt;D(t,qt,xt=>n(39,a=xt));const ve={};let It,Ie,lt,Ze,nn,he,Ke={x:0,y:0};const Ae=me([]);D(t,Ae,xt=>n(41,l=xt));const We=xt=>{const de={...xt,data:c,size:h,offset:{...xt.offset},mask:{...xt.mask},backgroundColor:p};return de.opacity=d,de.offset.y+=a,de.mask.y+=a,de.id="filter",de},xn=()=>u.filter(xt=>xt.id!=="filter");return Ho(()=>{q.set([])}),t.$$set=xt=>{"isActive"in xt&&G(n(0,O=xt.isActive)),"isActiveFraction"in xt&&C(n(1,$=xt.isActiveFraction)),"stores"in xt&&n(34,N=xt.stores),"locale"in xt&&n(2,it=xt.locale),"filterFunctions"in xt&&n(35,M=xt.filterFunctions),"filterOptions"in xt&&n(3,W=xt.filterOptions)},t.$$.update=()=>{if(262144&t.$$.dirty[1]&&le.set(w),262144&t.$$.dirty[1]&&rt.set(w),262144&t.$$.dirty[1]&&kt.set(w),262144&t.$$.dirty[1]&&w&&Nt.set(!1),8&t.$$.dirty[0]&&n(38,i=Wc(W)),640&t.$$.dirty[1]&&n(12,r=((xt,de)=>{if(!xt||!xt.filter||!de)return 0;const Ve=xt.filter;return de.findIndex(([Oe])=>{if(!M[Oe])return!1;const Ne=M[Oe]();return Os(Ne,Ve)})})(s,i)),786432&t.$$.dirty[1]&&T&&qt.set(w?0:20),512&t.$$.dirty[0]|458752&t.$$.dirty[1]&&w&&b&&v&&he&&n(37,nn={x:v.x-b.x,y:v.y-b.y+he.y}),496&t.$$.dirty[0]|58096&t.$$.dirty[1]&&m&&nn&&Ke&&Ze&&Dt){const xt=nn.x+Ze.x+Ke.x,de=nn.y,Ve=Ze.x+nn.x,Oe=Ve+Ze.width;Ae.set(i.map(([Ne],_e)=>{const Je=f[Ne],kn=Ke.x+Je.x,En=kn+Je.width;if(En<0||kn>Ze.width)return!1;const Zt=xt+Je.x,Dn=de+Je.y,H=(z=>({origin:Ue(z.origin),translation:Ue(z.translation),rotation:{...z.rotation},scale:z.scale}))(m);H.offset=pt(.5*Je.width+Zt,.5*Je.height+Dn),H.maskOpacity=1,H.mask=Ci(Zt+0,Dn,Je.width+0,Je.height),H.maskFeather=[1,0,1,0,1,Oe,1,Oe],kn<lt&&It<1&&(H.maskFeather[0]=It,H.maskFeather[1]=Ve,H.maskFeather[2]=1,H.maskFeather[3]=Ve+lt),En>Ze.width-lt&&Ie<1&&(H.maskFeather[4]=Ie,H.maskFeather[5]=Oe-lt,H.maskFeather[6]=1,H.maskFeather[7]=Oe),H.maskCornerRadius=Dt[Ne];let Wt=s&&Object.keys(s).filter(z=>z!="filter").map(z=>s[z])||[];return Si(M[Ne])&&Wt.push(M[Ne]()),H.colorMatrix=Wt.length?i0(Wt):void 0,H.gamma=y,H}).filter(Boolean))}if(7424&t.$$.dirty[1])if(d>0&&l){const xt=[...xn(),...l.map(We)];q.set(xt)}else q.set(xn());256&t.$$.dirty[1]&&n(11,o=a?`transform: translateY(${a}px)`:void 0)},[O,$,it,W,It,Ie,lt,Ke,Ze,he,ve,o,r,P,ot,q,ct,V,ut,bt,K,vt,st,gt,Jt,$t,Be,nt,Ut,qt,xt=>{xt.target.className===Tx&&n(36,Dt=Object.keys(ve).reduce((de,Ve)=>{const Oe=ve[Ve],Ne=getComputedStyle(Oe),_e=["top-left","top-right","bottom-left","bottom-right"].map(Je=>Ne.getPropertyValue(`border-${Je}-radius`)).map(J2).map(Je=>1.25*Je);return de[Ve]=_e,de},{}))},Ae,({value:xt})=>{At(Jt,s={...s,filter:Si(M[xt])?M[xt]():void 0},s),at.write()},"filter",N,M,Dt,nn,i,a,s,l,c,d,y,m,f,b,v,w,T,(xt,de)=>Be(xt,de.detail),function(xt,de){Nn[xt?"unshift":"push"](()=>{ve[de.value]=xt,n(10,ve)})},xt=>n(7,Ke=xt),function(xt){It=xt,n(4,It)},function(xt){Ie=xt,n(5,Ie)},function(xt){lt=xt,n(6,lt)},xt=>n(8,Ze=xt.detail),xt=>n(9,he=xt.detail),function(xt){aa.call(this,t,xt)}]}var U6={util:["filter",class extends Tn{constructor(t){super(),Sn(this,t,H6,V6,yn,{name:33,isActive:0,isActiveFraction:1,stores:34,locale:2,filterFunctions:35,filterOptions:3},null,[-1,-1,-1])}get name(){return this.$$.ctx[33]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),U()}get isActiveFraction(){return this.$$.ctx[1]}set isActiveFraction(t){this.$$set({isActiveFraction:t}),U()}get stores(){return this.$$.ctx[34]}set stores(t){this.$$set({stores:t}),U()}get locale(){return this.$$.ctx[2]}set locale(t){this.$$set({locale:t}),U()}get filterFunctions(){return this.$$.ctx[35]}set filterFunctions(t){this.$$set({filterFunctions:t}),U()}get filterOptions(){return this.$$.ctx[3]}set filterOptions(t){this.$$set({filterOptions:t}),U()}}]};function B$(t){let e,n,i,r;e=new us({props:{elasticity:t[6]*t[9],class:"PinturaControlListScroller",$$slots:{default:[j6]},$$scope:{ctx:t}}});const o=[{class:"PinturaControlPanels"},{panelClass:"PinturaControlPanel"},{panels:t[4]},t[5]];let a={$$slots:{default:[Z6,({panel:s})=>({42:s}),({panel:s})=>[0,s?2048:0]]},$$scope:{ctx:t}};for(let s=0;s<o.length;s+=1)a=ki(a,o[s]);return i=new Qu({props:a}),{c(){zt(e.$$.fragment),n=pe(),zt(i.$$.fragment)},m(s,l){Ft(e,s,l),tt(s,n,l),Ft(i,s,l),r=!0},p(s,l){const c={};64&l[0]&&(c.elasticity=s[6]*s[9]),38&l[0]|8192&l[1]&&(c.$$scope={dirty:l,ctx:s}),e.$set(c);const d=48&l[0]?Tr(o,[o[0],o[1],16&l[0]&&{panels:s[4]},32&l[0]&&_r(s[5])]):{};128&l[0]|10240&l[1]&&(d.$$scope={dirty:l,ctx:s}),i.$set(d)},i(s){r||(k(e.$$.fragment,s),k(i.$$.fragment,s),r=!0)},o(s){A(e.$$.fragment,s),A(i.$$.fragment,s),r=!1},d(s){_t(e,s),s&&Q(n),_t(i,s)}}}function G6(t){let e,n,i=t[43].label+"";return{c(){e=ft("span"),n=Mi(i)},m(r,o){tt(r,e,o),Et(e,n)},p(r,o){4096&o[1]&&i!==(i=r[43].label+"")&&Yi(n,i)},d(r){r&&Q(e)}}}function j6(t){let e,n;const i=[{class:"PinturaControlList"},{tabs:t[1]},t[5]];let r={$$slots:{default:[G6,({tab:o})=>({43:o}),({tab:o})=>[0,o?4096:0]]},$$scope:{ctx:t}};for(let o=0;o<i.length;o+=1)r=ki(r,i[o]);return e=new Ju({props:r}),e.$on("select",t[24]),{c(){zt(e.$$.fragment)},m(o,a){Ft(e,o,a),n=!0},p(o,a){const s=34&a[0]?Tr(i,[i[0],2&a[0]&&{tabs:o[1]},32&a[0]&&_r(o[5])]):{};12288&a[1]&&(s.$$scope={dirty:a,ctx:o}),e.$set(s)},i(o){n||(k(e.$$.fragment,o),n=!0)},o(o){A(e.$$.fragment,o),n=!1},d(o){_t(e,o)}}}function Z6(t){let e,n;const i=[t[7][t[42]]];let r={};for(let o=0;o<i.length;o+=1)r=ki(r,i[o]);return e=new T0({props:r}),{c(){zt(e.$$.fragment)},m(o,a){Ft(e,o,a),n=!0},p(o,a){const s=128&a[0]|2048&a[1]?Tr(i,[_r(o[7][o[42]])]):{};e.$set(s)},i(o){n||(k(e.$$.fragment,o),n=!0)},o(o){A(e.$$.fragment,o),n=!1},d(o){_t(e,o)}}}function X6(t){let e,n,i=t[5]&&B$(t);return{c(){e=ft("div"),i&&i.c(),S(e,"slot","footer"),S(e,"style",t[3])},m(r,o){tt(r,e,o),i&&i.m(e,null),n=!0},p(r,o){r[5]?i?(i.p(r,o),32&o[0]&&k(i,1)):(i=B$(r),i.c(),k(i,1),i.m(e,null)):i&&(Te(),A(i,1,1,()=>{i=null}),Ce()),(!n||8&o[0])&&S(e,"style",r[3])},i(r){n||(k(i),n=!0)},o(r){A(i),n=!1},d(r){r&&Q(e),i&&i.d()}}}function q6(t){let e,n;return e=new i1({props:{$$slots:{footer:[X6]},$$scope:{ctx:t}}}),e.$on("measure",t[25]),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};254&r[0]|8192&r[1]&&(o.$$scope={dirty:r,ctx:i}),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function Y6(t,e,n){let i,r,o,a,s,l,c,d,u,p,h,y=tn,m=()=>(y(),y=xo(b,X=>n(21,c=X)),b);t.$$.on_destroy.push(()=>y());let{stores:f}=e,{isActive:b}=e;m();let{locale:v={}}=e,{finetuneControlConfiguration:w}=e,{finetuneOptions:T}=e,{finetuneNudgePrecision:I}=e;const{history:P,animation:_,scrollElasticity:C,rangeInputElasticity:F,imageColorMatrix:G,imageConvolutionMatrix:O,imageGamma:$,imageVignette:N,imageNoise:it,allowPan:M,allowZoom:W,allowZoomControls:ot,allowPlayPause:at}=f;D(t,_,X=>n(22,d=X));const q={imageColorMatrix:G,imageConvolutionMatrix:O,imageGamma:$,imageVignette:N,imageNoise:it},ct=yi("elasticityMultiplier");D(t,ct,X=>n(6,p=X));const V="finetune-"+ba(),ut=me({});D(t,ut,X=>n(23,u=X));const bt=me({});D(t,bt,X=>n(7,h=X));let K=[];const vt=fn(d?20:0);return D(t,vt,X=>n(20,l=X)),t.$$set=X=>{"stores"in X&&n(15,f=X.stores),"isActive"in X&&m(n(0,b=X.isActive)),"locale"in X&&n(16,v=X.locale),"finetuneControlConfiguration"in X&&n(17,w=X.finetuneControlConfiguration),"finetuneOptions"in X&&n(18,T=X.finetuneOptions),"finetuneNudgePrecision"in X&&n(19,I=X.finetuneNudgePrecision)},t.$$.update=()=>{var X;2097152&t.$$.dirty[0]&&M.set(c),2097152&t.$$.dirty[0]&&W.set(c),2097152&t.$$.dirty[0]&&ot.set(c),2097152&t.$$.dirty[0]&&c&&at.set(!0),327680&t.$$.dirty[0]&&n(1,i=T?T.map(([Z,mt])=>({id:Z,label:Si(mt)?mt(v):mt})):[]),2&t.$$.dirty[0]&&n(2,r=i.length?i[0].id:void 0),4&t.$$.dirty[0]&&n(5,o=r&&{name:V,selected:r}),2&t.$$.dirty[0]&&n(4,a=i.map(Z=>Z.id)),131072&t.$$.dirty[0]&&w&&(X=w,K&&K.forEach(Z=>Z()),K=a.map(Z=>{const{getStore:mt,getValue:Bt=ni}=X[Z];return mt(q).subscribe(st=>{const gt=st!=null?Bt(st):st;At(ut,u={...u,[Z]:gt},u)})})),8519680&t.$$.dirty[0]&&w&&u&&At(bt,h=Object.keys(u).reduce((Z,mt)=>{const{base:Bt,min:st,max:gt,getLabel:Jt,getStore:le,setValue:rt=($t,Be)=>$t.set(Be)}=w[mt],kt=le(q),Nt=u[mt]!=null?u[mt]:Bt;return Z[mt]={base:Bt,min:st,max:gt,value:Nt,valueLabel:Jt?Jt(Nt,st,gt,gt-st):Math.round(100*Nt),oninputmove:$t=>{rt(kt,$t)},oninputend:$t=>{rt(kt,$t),P.write()},elasticity:p*F,labelReset:v.labelReset,nudgeMultiplier:I},Z},{}),h),6291456&t.$$.dirty[0]&&d&&vt.set(c?0:20),1048576&t.$$.dirty[0]&&n(3,s=l?`transform: translateY(${l}px)`:void 0)},[b,i,r,s,a,o,p,h,_,C,ct,ut,bt,vt,"finetune",f,v,w,T,I,l,c,d,u,({detail:X})=>n(2,r=X),function(X){aa.call(this,t,X)}]}var K6={util:["finetune",class extends Tn{constructor(t){super(),Sn(this,t,Y6,q6,yn,{name:14,stores:15,isActive:0,locale:16,finetuneControlConfiguration:17,finetuneOptions:18,finetuneNudgePrecision:19},null,[-1,-1])}get name(){return this.$$.ctx[14]}get stores(){return this.$$.ctx[15]}set stores(t){this.$$set({stores:t}),U()}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),U()}get locale(){return this.$$.ctx[16]}set locale(t){this.$$set({locale:t}),U()}get finetuneControlConfiguration(){return this.$$.ctx[17]}set finetuneControlConfiguration(t){this.$$set({finetuneControlConfiguration:t}),U()}get finetuneOptions(){return this.$$.ctx[18]}set finetuneOptions(t){this.$$set({finetuneOptions:t}),U()}get finetuneNudgePrecision(){return this.$$.ctx[19]}set finetuneNudgePrecision(t){this.$$set({finetuneNudgePrecision:t}),U()}}]},Vu=(t,e)=>{const n=e.length;return t<0?t%n+n:t>=n?t%n:t};function N$(t,e,n){const i=t.slice();return i[46]=e[n].key,i[47]=e[n].index,i[48]=e[n].translate,i[49]=e[n].scale,i[50]=e[n].selected,i[12]=e[n].rotate,i[51]=e[n].dir,i[52]=e[n].center,i[53]=e[n].type,i[2]=e[n].visible,i}function W$(t){let e,n;return{c(){e=ft("div"),S(e,"class","PinturaShapeManipulator"),S(e,"data-control","point"),S(e,"style",n=`pointer-events:none;transform: translate3d(${t[52].x}px, ${t[52].y}px, 0) scale(${t[5]}, ${t[5]}); opacity: ${t[4]}`)},m(i,r){tt(i,e,r)},p(i,r){56&r[0]&&n!==(n=`pointer-events:none;transform: translate3d(${i[52].x}px, ${i[52].y}px, 0) scale(${i[5]}, ${i[5]}); opacity: ${i[4]}`)&&S(e,"style",n)},d(i){i&&Q(e)}}}function V$(t,e){let n,i,r,o,a,s,l,c,d,u;function p(...y){return e[18](e[47],...y)}let h=e[53]==="edge"&&e[2]&&W$(e);return{key:t,first:null,c(){n=ft("div"),l=pe(),h&&h.c(),c=Ei(),S(n,"role","button"),S(n,"aria-label",i=`Drag ${e[53]} ${e[46]}`),S(n,"tabindex",r=e[53]==="edge"?-1:0),S(n,"class","PinturaShapeManipulator"),S(n,"data-control",o=e[53]),S(n,"data-selected",a=e[50]),S(n,"style",s=`cursor:${e[51]?e[51]+"-resize":"move"};opacity:${e[4]};--tx:${e[48].x};--ty:${e[48].y};--r:${e[53]==="edge"?e[12]:0}rad;--sx:${e[53]==="point"?e[5]:e[49].x};--sy:${e[53]==="point"?e[5]:e[49].y};`),this.first=n},m(y,m){tt(y,n,m),tt(y,l,m),h&&h.m(y,m),tt(y,c,m),d||(u=[St(n,"nudge",p),qn(Bs.call(null,n,{preventDefault:!0})),St(n,"interactionstart",function(){Hn(e[9]("start",e[47]))&&e[9]("start",e[47]).apply(this,arguments)}),St(n,"interactionupdate",function(){Hn(e[9]("move",e[47]))&&e[9]("move",e[47]).apply(this,arguments)}),St(n,"interactionend",function(){Hn(e[9]("end",e[47]))&&e[9]("end",e[47]).apply(this,arguments)}),qn(zs.call(null,n,{observeKeys:!0}))],d=!0)},p(y,m){e=y,8&m[0]&&i!==(i=`Drag ${e[53]} ${e[46]}`)&&S(n,"aria-label",i),8&m[0]&&r!==(r=e[53]==="edge"?-1:0)&&S(n,"tabindex",r),8&m[0]&&o!==(o=e[53])&&S(n,"data-control",o),8&m[0]&&a!==(a=e[50])&&S(n,"data-selected",a),56&m[0]&&s!==(s=`cursor:${e[51]?e[51]+"-resize":"move"};opacity:${e[4]};--tx:${e[48].x};--ty:${e[48].y};--r:${e[53]==="edge"?e[12]:0}rad;--sx:${e[53]==="point"?e[5]:e[49].x};--sy:${e[53]==="point"?e[5]:e[49].y};`)&&S(n,"style",s),e[53]==="edge"&&e[2]?h?h.p(e,m):(h=W$(e),h.c(),h.m(c.parentNode,c)):h&&(h.d(1),h=null)},d(y){y&&Q(n),y&&Q(l),h&&h.d(y),y&&Q(c),d=!1,Zn(u)}}}function H$(t){let e,n,i,r;return{c(){e=ft("div"),S(e,"role","button"),S(e,"aria-label","Drag rotator"),S(e,"tabindex","0"),S(e,"class","PinturaShapeManipulator"),S(e,"data-control","rotate"),S(e,"style",n=`transform: translate3d(${t[0].x}px, ${t[0].y}px, 0) scale(${t[5]}, ${t[5]}); opacity: ${t[4]}`)},m(o,a){tt(o,e,a),i||(r=[St(e,"nudge",t[11]),qn(Bs.call(null,e,{preventDefault:!0})),St(e,"interactionstart",t[12]("start")),St(e,"interactionupdate",t[12]("move")),St(e,"interactionend",t[12]("end")),qn(zs.call(null,e,{observeKeys:!0}))],i=!0)},p(o,a){49&a[0]&&n!==(n=`transform: translate3d(${o[0].x}px, ${o[0].y}px, 0) scale(${o[5]}, ${o[5]}); opacity: ${o[4]}`)&&S(e,"style",n)},d(o){o&&Q(e),i=!1,Zn(r)}}}function J6(t){let e,n,i=[],r=new Map,o=t[3];const a=l=>l[46];for(let l=0;l<o.length;l+=1){let c=N$(t,o,l),d=a(c);r.set(d,i[l]=V$(d,c))}let s=t[1]&&H$(t);return{c(){for(let l=0;l<i.length;l+=1)i[l].c();e=pe(),s&&s.c(),n=Ei()},m(l,c){for(let d=0;d<i.length;d+=1)i[d].m(l,c);tt(l,e,c),s&&s.m(l,c),tt(l,n,c)},p(l,c){1592&c[0]&&(o=l[3],i=Va(i,c,a,1,l,o,r,e.parentNode,k2,V$,e,N$)),l[1]?s?s.p(l,c):(s=H$(l),s.c(),s.m(n.parentNode,n)):s&&(s.d(1),s=null)},i:tn,o:tn,d(l){for(let c=0;c<i.length;c+=1)i[c].d(l);l&&Q(e),s&&s.d(l),l&&Q(n)}}}function Q6(t,e,n){let i,r,o,a;const s=la(),l=.5*Qo,c=No-l,d=No+l,u=-No,p=u-l,h=u+l,y=wp-l,m=-wp+l,f=l,b=-l,v=No-Qo,w=v-l,T=v+l,I=wp-Qo,P=I-l,_=I+l,C=u-Qo,F=C+l,G=C-l,O=u+Qo,$=O+l,N=O-l;let{visible:it=!1}=e,{points:M=[]}=e,{rotatorPoint:W}=e,{selectedPoint:ot}=e,{enableDragEdges:at=!0}=e,{enableDragPoints:q=!0}=e,{enableRotatePoints:ct=!0}=e;const V=yi("isAnimated");D(t,V,X=>n(17,r=X));const ut=fn(.5,{precision:1e-4,stiffness:.3,damping:.7});D(t,ut,X=>n(5,a=X));const bt=fn(0,{precision:.001,stiffness:.3,damping:.7});D(t,bt,X=>n(4,o=X));const K=X=>{let Z="";return(X<=d&&X>=c||X>=p&&X<=h)&&(Z="ns"),(X<=m||X>=y||X>=b&&X<=f)&&(Z="ew"),(X>=P&&X<=_||X<=$&&X>=N)&&(Z="nesw"),(X>=w&&X<=T||X<=F&&X>=G)&&(Z="nwse"),Z},vt=(X,Z)=>{s("resizestart",{indexes:X,translation:hi(),isNudge:!0}),s("resizemove",{indexes:X,translation:Z,isNudge:!0}),s("resizeend",{indexes:X,translation:hi(),isNudge:!0})};return t.$$set=X=>{"visible"in X&&n(2,it=X.visible),"points"in X&&n(13,M=X.points),"rotatorPoint"in X&&n(0,W=X.rotatorPoint),"selectedPoint"in X&&n(14,ot=X.selectedPoint),"enableDragEdges"in X&&n(15,at=X.enableDragEdges),"enableDragPoints"in X&&n(16,q=X.enableDragPoints),"enableRotatePoints"in X&&n(1,ct=X.enableRotatePoints)},t.$$.update=()=>{131076&t.$$.dirty[0]&&ut.set(it?1:.5,{hard:r===!1}),131076&t.$$.dirty[0]&&bt.set(it?1:0,{hard:r===!1}),8192&t.$$.dirty[0]&&n(3,i=((X,Z)=>{let mt=0;const Bt=zo(X),st=[],gt=X.length;for(;mt<gt;mt++){const Jt=Vu(mt-1,X),le=Vu(mt+1,X),rt=X[Jt],kt=X[mt],Nt=X[le],$t=Math.atan2(Nt.y-kt.y,Nt.x-kt.x);if(q){const nt=bo(pt(rt.x-kt.x,rt.y-kt.y)),Ut=bo(pt(Nt.x-kt.x,Nt.y-kt.y)),qt=pt(nt.x+Ut.x,nt.y+Ut.y),Dt=at?q&&K(Math.atan2(qt.y,qt.x)):void 0;st.push({index:[mt],key:"point-"+mt,type:"point",selected:ot===mt,scale:{x:1,y:1},translate:{x:kt.x,y:kt.y},angle:void 0,rotate:ct,center:kt,dir:Dt})}if(!at||Array.isArray(at)&&!at.some(([nt,Ut])=>mt===nt&&le===Ut))continue;const Be=pt(kt.x+.5*(Nt.x-kt.x),kt.y+.5*(Nt.y-kt.y));st.push({index:[mt,le],key:"edge-"+mt,type:"edge",scale:{x:Yr(kt,Nt),y:1},translate:{x:kt.x,y:kt.y},angle:$t,rotate:$t,center:Be,visible:Array.isArray(at),dir:K(Math.atan2(Bt.y-Be.y,Bt.x-Be.x))})}return st})(M))},[W,ct,it,i,o,a,V,ut,bt,(X,Z)=>({detail:mt})=>{const Bt=mt&&mt.translation?mt.translation:pt(0,0);s("resize"+X,{...mt,indexes:Z,translation:Bt})},vt,({detail:X})=>{s("rotatestart",{translation:hi(),isNudge:!0}),s("rotatemove",{translation:X,isNudge:!0}),s("rotateend",{translation:hi(),isNudge:!0})},X=>({detail:Z})=>{const mt=Z&&Z.translation?Z.translation:pt(0,0);s("rotate"+X,{...Z,translation:mt})},M,ot,at,q,r,(X,{detail:Z})=>vt(X,Z)]}class tS extends Tn{constructor(e){super(),Sn(this,e,Q6,J6,yn,{visible:2,points:13,rotatorPoint:0,selectedPoint:14,enableDragEdges:15,enableDragPoints:16,enableRotatePoints:1},null,[-1,-1])}}var Lh=(t,e)=>{const n=w0(t);return Oi(n,e)},mu=t=>document.createTextNode(t),Cx=t=>(Ba()&&t.endsWith("<div><br></div>")?t.replace(/<div><br><\/div>$/,"<br><br>"):t).replace(/<div><br><\/div>/g,"<br>").replace(/<\/div>/g,"").replace(/<div>/g,"<br>");function U$(t){let e,n;return{c(){e=ft("pre"),S(e,"class","PinturaContentEditable"),S(e,"style",n=t[7]+";position:absolute;z-index:-1;pointer-events:none;")},m(i,r){tt(i,e,r),e.innerHTML=t[0]},p(i,r){1&r[0]&&(e.innerHTML=i[0]),128&r[0]&&n!==(n=i[7]+";position:absolute;z-index:-1;pointer-events:none;")&&S(e,"style",n)},d(i){i&&Q(e)}}}function eS(t){let e,n,i,r,o,a,s=t[8]&&U$(t);return{c(){s&&s.c(),e=pe(),n=ft("pre"),S(n,"class","PinturaContentEditable"),S(n,"data-wrap-content",i=t[4]||t[5]?"wrap":"nowrap"),S(n,"contenteditable",""),S(n,"spellcheck",t[1]),S(n,"autocorrect",t[2]),S(n,"autocapitalize",t[3]),S(n,"style",r=t[8]?t[15](t[7]):t[7])},m(l,c){s&&s.m(l,c),tt(l,e,c),tt(l,n,c),t[26](n),o||(a=[St(n,"input",t[13]),St(n,"compositionend",t[12]),St(n,"paste",t[14]),St(n,"keydown",t[10]),St(n,"keyup",t[11]),St(n,"blur",t[9])],o=!0)},p(l,c){l[8]?s?s.p(l,c):(s=U$(l),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),48&c[0]&&i!==(i=l[4]||l[5]?"wrap":"nowrap")&&S(n,"data-wrap-content",i),2&c[0]&&S(n,"spellcheck",l[1]),4&c[0]&&S(n,"autocorrect",l[2]),8&c[0]&&S(n,"autocapitalize",l[3]),384&c[0]&&r!==(r=l[8]?l[15](l[7]):l[7])&&S(n,"style",r)},i:tn,o:tn,d(l){s&&s.d(l),l&&Q(e),l&&Q(n),t[26](null),o=!1,Zn(a)}}}function nS(t,e,n){let i,r,{spellcheck:o="false"}=e,{autocorrect:a="off"}=e,{autocapitalize:s="off"}=e,{wrapLines:l=!0}=e,{allowNewline:c=!0}=e,{textFormat:d="text"}=e,{formatInput:u=ni}=e,{formatPaste:p=ni}=e,{style:h}=e,{innerHTML:y}=e,{oninput:m=ae}=e,{enableTextStyleShortcuts:f=!1}=e;const b=()=>{if(!w)return;const M=document.createRange();M.selectNodeContents(w);const W=G();W.removeAllRanges(),W.addRange(M)},v=la();let w;document.execCommand("defaultParagraphSeparator",!1,"br");const T=M=>M.replace(/<\/?(?:i|b|em|u|s|strike|strong|font)>/,"").replace(/style=".*?"/g,"").replace(/\n/gim,"<br>"),I=()=>{n(0,y=w.innerHTML);const M=Cx(y);v("input",M),m(M),requestAnimationFrame(()=>w&&w.scrollTo(0,0))},P=()=>{O(w);const M=d==="html"?w.innerHTML:T(w.innerHTML);n(6,w.innerHTML=u(M),w),$(w),I()},_={b:"bold",i:"italic",u:"underline",s:"strikethrough"},C=M=>{const W=fi("span");return W.dataset.bookmark=M,W},F=(M,W,ot)=>{const at=C(ot);if(M.nodeType===Node.TEXT_NODE){const q=M.textContent;if(ot==="start"){const ct=mu(q.substring(0,W)),V=mu(q.substring(W));M.replaceWith(ct,at,V)}else{const ct=mu(q.substring(0,W)),V=mu(q.substring(W));M.replaceWith(ct,at,V)}}else M.nodeType===Node.ELEMENT_NODE&&M.insertBefore(at,M.childNodes[W])},G=()=>{const M=w.getRootNode();return"getSelection"in M?M.getSelection():document.getSelection()},O=M=>{const W=G();if(!W.getRangeAt||!W.rangeCount)return;const ot=W.getRangeAt(0),{startOffset:at,endOffset:q,startContainer:ct,endContainer:V}=ot;if(M.contains(ot.startContainer)&&M.contains(ot.endContainer))if(ct.nodeType===Node.TEXT_NODE&&ct===V){const ut=ct.textContent,bt=ut.substring(0,at),K=C("start"),vt=q-at>0?ut.substring(at,q):"",X=C("end"),Z=ut.substring(q);ct.replaceWith(bt,K,vt,X,Z)}else F(ct,at,"start"),F(V,q+(ct===V?1:0),"end")},$=M=>{const W=N(M,"start"),ot=N(M,"end");if(!W||!ot)return;const at=document.createRange();at.setStart(W,0),at.setEnd(ot,0);const q=G();q.removeAllRanges(),q.addRange(at),W.remove(),ot.remove()},N=(M,W)=>{const ot=M.children;for(let at=0;at<ot.length;at++){const q=ot[at];if(q.dataset.bookmark===W)return q;if(q.children.length){const ct=N(q,W);if(ct)return ct}}};let it;return t.$$set=M=>{"spellcheck"in M&&n(1,o=M.spellcheck),"autocorrect"in M&&n(2,a=M.autocorrect),"autocapitalize"in M&&n(3,s=M.autocapitalize),"wrapLines"in M&&n(4,l=M.wrapLines),"allowNewline"in M&&n(5,c=M.allowNewline),"textFormat"in M&&n(16,d=M.textFormat),"formatInput"in M&&n(17,u=M.formatInput),"formatPaste"in M&&n(18,p=M.formatPaste),"style"in M&&n(19,h=M.style),"innerHTML"in M&&n(0,y=M.innerHTML),"oninput"in M&&n(20,m=M.oninput),"enableTextStyleShortcuts"in M&&n(21,f=M.enableTextStyleShortcuts)},t.$$.update=()=>{var M;if(64&t.$$.dirty[0]&&n(25,i=!!w),33554433&t.$$.dirty[0]&&i&&y&&(M=y)!==w.innerHTML&&(n(6,w.innerHTML=M,w),w===document.activeElement&&b()),524336&t.$$.dirty[0])if(!l&&c){const W=h.includes(":right")?"text-indent:-100px!important":h.includes(":center")?"":"min-width:calc(100% + 100px)!important";n(7,it=h+";overflow:visible;"+W)}else n(7,it=h);524288&t.$$.dirty[0]&&n(8,r=h.includes("text-stroke"))},[y,o,a,s,l,c,w,it,r,()=>{v("blur")},M=>{if(/escape/i.test(M.code))return M.stopPropagation(),void v("cancel");const W=M.ctrlKey||M.metaKey;if(d==="html"&&W&&/b|i|u|s/.test(M.key))return f&&(ot=>{const at=_[ot];at&&document.execCommand(at)})(M.key),void M.preventDefault();/enter/i.test(M.code)&&(M.stopPropagation(),M.isComposing||(W?v("confirm"):(c||M.preventDefault(),document.execCommand("insertLineBreak"),M.preventDefault())))},()=>{},M=>{M.data!==""&&P()},M=>{const{inputType:W}=M;W!=="insertCompositionText"&&W!=="deleteCompositionText"&&P()},M=>{M.preventDefault();const W=M.clipboardData.getData("text/plain"),ot=d==="html"?W:T(W),at=p(ot);if(!at.length)return;const q=G().getRangeAt(0);q.deleteContents(),q.insertNode(document.createTextNode(at)),I()},M=>M.replace("-webkit-text-stroke","--text-stroke").replace("text-shadow","--text-shadow"),d,u,p,h,m,f,()=>P(),()=>w&&w.focus(),b,i,function(M){Nn[M?"unshift":"push"](()=>{w=M,n(6,w)})}]}class iS extends Tn{constructor(e){super(),Sn(this,e,nS,eS,yn,{spellcheck:1,autocorrect:2,autocapitalize:3,wrapLines:4,allowNewline:5,textFormat:16,formatInput:17,formatPaste:18,style:19,innerHTML:0,oninput:20,enableTextStyleShortcuts:21,confirm:22,focus:23,select:24},null,[-1,-1])}get spellcheck(){return this.$$.ctx[1]}set spellcheck(e){this.$$set({spellcheck:e}),U()}get autocorrect(){return this.$$.ctx[2]}set autocorrect(e){this.$$set({autocorrect:e}),U()}get autocapitalize(){return this.$$.ctx[3]}set autocapitalize(e){this.$$set({autocapitalize:e}),U()}get wrapLines(){return this.$$.ctx[4]}set wrapLines(e){this.$$set({wrapLines:e}),U()}get allowNewline(){return this.$$.ctx[5]}set allowNewline(e){this.$$set({allowNewline:e}),U()}get textFormat(){return this.$$.ctx[16]}set textFormat(e){this.$$set({textFormat:e}),U()}get formatInput(){return this.$$.ctx[17]}set formatInput(e){this.$$set({formatInput:e}),U()}get formatPaste(){return this.$$.ctx[18]}set formatPaste(e){this.$$set({formatPaste:e}),U()}get style(){return this.$$.ctx[19]}set style(e){this.$$set({style:e}),U()}get innerHTML(){return this.$$.ctx[0]}set innerHTML(e){this.$$set({innerHTML:e}),U()}get oninput(){return this.$$.ctx[20]}set oninput(e){this.$$set({oninput:e}),U()}get enableTextStyleShortcuts(){return this.$$.ctx[21]}set enableTextStyleShortcuts(e){this.$$set({enableTextStyleShortcuts:e}),U()}get confirm(){return this.$$.ctx[22]}get focus(){return this.$$.ctx[23]}get select(){return this.$$.ctx[24]}}const G$=["i","b","u","strike"].map(t=>({tag:t,tagOpen:new RegExp(`<${t}>`,"g"),tagClose:new RegExp(`</${t}>`,"g"),placeholderOpen:new RegExp(`___${t}O___`,"g"),placeholderClose:new RegExp(`___${t}C___`,"g")}));var rS=t=>t=((e,n=G$)=>(n.forEach(({tag:i,placeholderOpen:r,placeholderClose:o})=>{e=e.replace(r,`<${i}>`).replace(o,`</${i}>`)}),e))(t=(t=((e,n=G$)=>(n.forEach(({tag:i,tagOpen:r,tagClose:o})=>{e=e.replace(r,`___${i}O___`).replace(o,`___${i}C___`)}),e))(t)).replace(/ {2,}/g," ").replace(/\u00a0/g,"&nbsp;").split(`
`).join("<br>")),gu=(t,e)=>Qe(t)?parseFloat(t)/100*e:t,Pc=(t,e)=>({x:Ur(t.x,e.width),y:Ur(t.y,e.height)});function j$(t,e,n){const i=t.slice();return i[299]=e[n],i[301]=n,i}function Z$(t,e){let n,i,r,o,a,s,l,c,d,u,p,h=e[299].name+"";function y(){return e[189](e[301])}return r=new v0({props:{color:e[299].color}}),{key:t,first:null,c(){n=ft("li"),i=ft("button"),zt(r.$$.fragment),o=pe(),a=ft("span"),s=Mi(h),c=pe(),S(i,"class","PinturaShapeListItem"),S(i,"type","button"),S(i,"aria-label",l="Select shape "+e[299].name),this.first=n},m(m,f){tt(m,n,f),Et(n,i),Ft(r,i,null),Et(i,o),Et(i,a),Et(a,s),Et(n,c),d=!0,u||(p=St(i,"click",y),u=!0)},p(m,f){e=m;const b={};2097152&f[0]&&(b.color=e[299].color),r.$set(b),(!d||2097152&f[0])&&h!==(h=e[299].name+"")&&Yi(s,h),(!d||2097152&f[0]&&l!==(l="Select shape "+e[299].name))&&S(i,"aria-label",l)},i(m){d||(k(r.$$.fragment,m),d=!0)},o(m){A(r.$$.fragment,m),d=!1},d(m){m&&Q(n),_t(r),u=!1,p()}}}function X$(t){let e,n;return e=new tS({props:{visible:!0,points:t[12],rotatorPoint:t[27],selectedPoint:t[16],enableDragEdges:t[17],enableDragPoints:t[29],enableRotatePoints:t[14]}}),e.$on("resizestart",t[38]),e.$on("resizemove",t[39]),e.$on("resizeend",t[40]),e.$on("rotatestart",t[41]),e.$on("rotatemove",t[42]),e.$on("rotateend",t[43]),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};4096&r[0]&&(o.points=i[12]),134217728&r[0]&&(o.rotatorPoint=i[27]),65536&r[0]&&(o.selectedPoint=i[16]),131072&r[0]&&(o.enableDragEdges=i[17]),536870912&r[0]&&(o.enableDragPoints=i[29]),16384&r[0]&&(o.enableRotatePoints=i[14]),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function q$(t){let e,n,i,r;const o=[aS,oS],a=[];function s(l,c){return l[4]==="modal"?0:l[4]==="inline"?1:-1}return~(e=s(t))&&(n=a[e]=o[e](t)),{c(){n&&n.c(),i=Ei()},m(l,c){~e&&a[e].m(l,c),tt(l,i,c),r=!0},p(l,c){let d=e;e=s(l),e===d?~e&&a[e].p(l,c):(n&&(Te(),A(a[d],1,1,()=>{a[d]=null}),Ce()),~e?(n=a[e],n?n.p(l,c):(n=a[e]=o[e](l),n.c()),k(n,1),n.m(i.parentNode,i)):n=null)},i(l){r||(k(n),r=!0)},o(l){A(n),r=!1},d(l){~e&&a[e].d(l),l&&Q(i)}}}function oS(t){let e,n,i,r,o,a={formatInput:t[45],wrapLines:!!t[13].width,textFormat:t[13].format,enableTextStyleShortcuts:t[5],allowNewline:t[28],style:t[26]};return n=new iS({props:a}),t[192](n),n.$on("input",t[46]),n.$on("keyup",t[49]),n.$on("cancel",t[51]),n.$on("confirm",t[50]),{c(){e=ft("div"),zt(n.$$.fragment),S(e,"class","PinturaInlineInput"),S(e,"style",t[25])},m(s,l){tt(s,e,l),Ft(n,e,null),i=!0,r||(o=St(e,"focusout",t[193]),r=!0)},p(s,l){const c={};8192&l[0]&&(c.wrapLines=!!s[13].width),8192&l[0]&&(c.textFormat=s[13].format),32&l[0]&&(c.enableTextStyleShortcuts=s[5]),268435456&l[0]&&(c.allowNewline=s[28]),67108864&l[0]&&(c.style=s[26]),n.$set(c),(!i||33554432&l[0])&&S(e,"style",s[25])},i(s){i||(k(n.$$.fragment,s),i=!0)},o(s){A(n.$$.fragment,s),i=!1},d(s){s&&Q(e),t[192](null),_t(n),r=!1,o()}}}function aS(t){let e,n;return e=new cx({props:{panelOffset:t[2],onconfirm:t[50],oncancel:t[51],buttonCancel:{icon:t[6].shapeIconInputCancel,label:t[6].shapeLabelInputCancel},buttonConfirm:{icon:t[6].shapeIconInputConfirm,label:t[6].shapeLabelInputConfirm,hideLabel:!0},$$slots:{default:[sS]},$$scope:{ctx:t}}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};4&r[0]&&(o.panelOffset=i[2]),64&r[0]&&(o.buttonCancel={icon:i[6].shapeIconInputCancel,label:i[6].shapeLabelInputCancel}),64&r[0]&&(o.buttonConfirm={icon:i[6].shapeIconInputConfirm,label:i[6].shapeLabelInputConfirm,hideLabel:!0}),83886336&r[0]|8388608&r[9]&&(o.$$scope={dirty:r,ctx:i}),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function sS(t){let e,n,i;return{c(){e=ft("textarea"),S(e,"spellcheck","false"),S(e,"autocorrect","off"),S(e,"autocapitalize","off"),S(e,"style",t[26])},m(r,o){tt(r,e,o),t[190](e),vg(e,t[24]),n||(i=[St(e,"keydown",t[48]),St(e,"keypress",t[47]),St(e,"keyup",t[49]),St(e,"input",t[46]),St(e,"input",t[191])],n=!0)},p(r,o){67108864&o[0]&&S(e,"style",r[26]),16777216&o[0]&&vg(e,r[24])},d(r){r&&Q(e),t[190](null),n=!1,Zn(i)}}}function Y$(t){let e,n,i,r,o;return n=new vo({props:{items:t[22],key:t[10]}}),{c(){e=ft("div"),zt(n.$$.fragment),S(e,"class","PinturaShapeControls"),S(e,"style",t[23])},m(a,s){tt(a,e,s),Ft(n,e,null),i=!0,r||(o=[St(e,"measure",t[194]),qn(Cr.call(null,e))],r=!0)},p(a,s){const l={};4194304&s[0]&&(l.items=a[22]),1024&s[0]&&(l.key=a[10]),n.$set(l),(!i||8388608&s[0])&&S(e,"style",a[23])},i(a){i||(k(n.$$.fragment,a),i=!0)},o(a){A(n.$$.fragment,a),i=!1},d(a){a&&Q(e),_t(n),r=!1,Zn(o)}}}function lS(t){let e,n,i,r,o,a,s,l,c,d,u=[],p=new Map,h=t[21];const y=v=>v[299].id;for(let v=0;v<h.length;v+=1){let w=j$(t,h,v),T=y(w);p.set(T,u[v]=Z$(T,w))}let m=t[15]&&X$(t),f=t[11]&&q$(t),b=t[18]>0&&Y$(t);return{c(){e=ft("div"),n=ft("nav"),i=ft("ul");for(let v=0;v<u.length;v+=1)u[v].c();r=pe(),m&&m.c(),o=pe(),f&&f.c(),a=pe(),b&&b.c(),S(n,"class","PinturaShapeList"),S(n,"data-visible",t[19]),S(e,"class","PinturaShapeEditor"),S(e,"tabindex","0")},m(v,w){tt(v,e,w),Et(e,n),Et(n,i);for(let T=0;T<u.length;T+=1)u[T].m(i,null);Et(e,r),m&&m.m(e,null),Et(e,o),f&&f.m(e,null),Et(e,a),b&&b.m(e,null),t[195](e),l=!0,c||(d=[St(n,"focusin",t[54]),St(n,"focusout",t[55]),St(e,"keydown",function(){Hn(t[0]?ae:t[44])&&(t[0]?ae:t[44]).apply(this,arguments)}),St(e,"nudge",function(){Hn(t[0]?ae:t[53])&&(t[0]?ae:t[53]).apply(this,arguments)}),St(e,"measure",t[188]),St(e,"pointermove",function(){Hn(t[0]?ae:t[56])&&(t[0]?ae:t[56]).apply(this,arguments)}),St(e,"pointerleave",function(){Hn(t[0]?ae:t[57])&&(t[0]?ae:t[57]).apply(this,arguments)}),St(e,"interactionstart",function(){Hn(t[0]?ae:t[32])&&(t[0]?ae:t[32]).apply(this,arguments)}),St(e,"interactionupdate",function(){Hn(t[0]?ae:t[34])&&(t[0]?ae:t[34]).apply(this,arguments)}),St(e,"interactioncancel",function(){Hn(t[0]?ae:t[33])&&(t[0]?ae:t[33]).apply(this,arguments)}),St(e,"interactionrelease",function(){Hn(t[0]?ae:t[35])&&(t[0]?ae:t[35]).apply(this,arguments)}),St(e,"interactionend",function(){Hn(t[0]?ae:t[36])&&(t[0]?ae:t[36]).apply(this,arguments)}),qn(Cr.call(null,e)),qn(Bs.call(null,e)),qn(s=zs.call(null,e,{drag:!0,inertia:!0,multiTouch:!1,observeKeys:!0,shouldStartInteraction:K$,getEventPosition:t[196]}))],c=!0)},p(v,w){t=v,2097282&w[0]&&(h=t[21],Te(),u=Va(u,w,y,1,t,h,p,i,_s,Z$,null,j$),Ce()),(!l||524288&w[0])&&S(n,"data-visible",t[19]),t[15]?m?(m.p(t,w),32768&w[0]&&k(m,1)):(m=X$(t),m.c(),k(m,1),m.m(e,o)):m&&(Te(),A(m,1,1,()=>{m=null}),Ce()),t[11]?f?(f.p(t,w),2048&w[0]&&k(f,1)):(f=q$(t),f.c(),k(f,1),f.m(e,a)):f&&(Te(),A(f,1,1,()=>{f=null}),Ce()),t[18]>0?b?(b.p(t,w),262144&w[0]&&k(b,1)):(b=Y$(t),b.c(),k(b,1),b.m(e,null)):b&&(Te(),A(b,1,1,()=>{b=null}),Ce()),s&&Hn(s.update)&&8&w[0]&&s.update.call(null,{drag:!0,inertia:!0,multiTouch:!1,observeKeys:!0,shouldStartInteraction:K$,getEventPosition:t[196]})},i(v){if(!l){for(let w=0;w<h.length;w+=1)k(u[w]);k(m),k(f),k(b),l=!0}},o(v){for(let w=0;w<u.length;w+=1)A(u[w]);A(m),A(f),A(b),l=!1},d(v){v&&Q(e);for(let w=0;w<u.length;w+=1)u[w].d();m&&m.d(),f&&f.d(),b&&b.d(),t[195](null),c=!1,Zn(d)}}}const K$=(t,e)=>t.target===e;function cS(t,e,n){let i,r,o,a,s,l,c,d,u,p,h,y,m,f,b,v,w,T,I,P,_,C,F,G,O,$,N,it,M,W,ot,at,q,ct,V,ut,bt,K,vt,X,Z,mt,Bt,st,gt,Jt,le,rt,kt,Nt,$t,Be,nt,Ut,qt,Dt,ve,It,Ie,lt,Ze,nn,he=tn,Ke=()=>(he(),he=xo(xt,x=>n(184,It=x)),xt);t.$$.on_destroy.push(()=>he());let{uid:Ae=ba()}=e,{ui:We}=e,{disabled:xn=!1}=e,{shapes:xt}=e;Ke();let{selection:de}=e,{offset:Ve}=e,{contextRotation:Oe=0}=e,{contextFlipX:Ne=!1}=e,{contextFlipY:_e=!1}=e,{contextZoom:Je=1}=e,{active:kn=!1}=e,{opacity:En=1}=e,{parentRect:Zt}=e,{rootRect:Dn}=e,{utilRect:H}=e,{hoverColor:Wt}=e,{caretColor:z}=e,{gridColor:Qt}=e,{snapColor:ce}=e,{textInputMode:ye="inline"}=e,{oninteractionstart:ue=ae}=e,{oninteractionupdate:Yt=ae}=e,{oninteractionrelease:Gt=ae}=e,{oninteractionend:hn=ae}=e,{oninteractioncancel:Xe=ae}=e,{onaddshape:on=ae}=e,{onupdateshape:xe=ae}=e,{onselectshape:Me=ae}=e,{onblurshape:Yn=ae}=e,{onremoveshape:Se=ae}=e,{ontapshape:J=ae}=e,{onhovershape:Xt=ae}=e,{ontriggerhistorywrite:jt=ae}=e,{onhovercanvas:se=ae}=e,{ontapcanvas:Fe=ae}=e,{onleavecanvas:ke=ae}=e,{beforeSelectShape:be=()=>!0}=e,{beforeDeselectShape:mi=()=>!0}=e,{beforeRemoveShape:si=()=>!0}=e,{beforeUpdateShape:ge=(x,B,E)=>B}=e,{willRenderShapeControls:an=ni}=e,{willRenderShapeTextControls:we=ni}=e,{willStartInteraction:Ge=(x,B)=>!0}=e,{mapEditorPointToImagePoint:Le}=e,{mapImagePointToEditorPoint:Ht}=e,{eraseRadius:Pe}=e,{selectRadius:Cn}=e,{enableButtonFlipVertical:Un=!1}=e,{enableTapToAddText:bi=!0}=e,{enableMultiSelect:Pi=!1}=e,{enableTextStyleControls:Hi=!0}=e,{locale:Xn}=e,{snapThreshold:Ui=0}=e,{snapPointer:yr=!0}=e,{enableSnapToContext:gr=!0}=e,{gridSize:Mr=0}=e;const Uo=x=>{if(Ui===0)return[];let B;return gr&&(B={...Zt,x:0,y:0}),[...It.filter(E=>E!==x).filter(E=>!lo(E)).filter(E=>(Y=>Y.disableAcceptSnap!==!0)(E)).map(E=>Ai({...E},Zt)),B].filter(Boolean)},li=(x,B,E,Y)=>x===0?{snapTargets:[]}:{snapThreshold:x,gridSize:B,gridRect:E,snapTargets:Uo(Y)},uo=yi("isAnimated");D(t,uo,x=>n(185,lt=x));const ii=x=>x.set(xa(x)),ui=x=>xa(x).find(lo),un=(x,B)=>{if(!ui(B))return mh(x),po(x,B)},rr=x=>{ui(x)&&x.update(B=>B.filter(E=>!lo(E)))},Jr=x=>{const B=ui(x);if(B)return lg(B),ii(x),B},Ao=(x,B,E=(Y,et)=>({...Y,...et}))=>{ui(B)&&B.update(Y=>Y.map(et=>lo(et)?E(et,x):et))},po=(x,B=xt)=>(B.update(E=>[...E,x]),x),Lo=(x,B,E)=>{const Y=ge({...x},B,{...E});return Da(x,Y,E),x},Dr=(x,B)=>{const E=Yr(x,B),Y=Kd(x,B),et=Math.PI/8,Tt=et*Math.round(Y/et)-Oe%et;B.x=x.x+E*Math.cos(Tt),B.y=x.y+E*Math.sin(Tt)},Gi=yi("keysPressed");D(t,Gi,x=>n(186,Ze=x));const ci=(x,B,E)=>x===0||B&&E?x:B||E?-x:x,jr=x=>{if(x.x===null&&x.y===null)return Qr();x.x&&n(140,zr=Le({x:x.x,y:0}).x),x.y&&n(141,Zr=Le({x:0,y:x.y}).y)},Qr=()=>{n(140,zr=null),n(141,Zr=null)};let zr=null,Zr=null;const xr=(x,B)=>{const E=Ht(x);return Le(nr(E,B))},to=(x,B,E)=>{const Y=(E-B)/x+1;return Array.from({length:Y},(et,Tt)=>B+Tt*x)},kr=x=>{let B=[],E=[],Y=x.points;if(x.x1!==void 0&&(Y=[{x:x.x1,y:x.y1},{x:x.x2,y:x.y2}]),Y){const et=Y.map(Ht),Tt=Vi(et),Ct=et[0],Pt=et[et.length-1];B=[Tt.x,Tt.x+.5*Tt.width,Tt.x+Tt.width,Ct.x,Pt.x],E=[Tt.y,Tt.y+.5*Tt.height,Tt.y+Tt.height,Ct.y,Pt.y]}else if(x.text||x.width!==void 0||x.rx!==void 0){let et;if(x.text&&x.height===void 0){const Vt=Do(x.text,x);et=Ci(x.x,x.y,Vt.width,Vt.height)}else et=x.width!==void 0?vs(x):vs({x:x.x-x.rx,y:x.y-x.ry,width:2*x.rx,height:2*x.ry});const Tt=Mo(et).map(Ht),Ct=Math.abs(x.rotation)>0?$r(et,x.rotation).map(Ht):Tt,Pt=Vi(Ct),Mt=wn(Pt),Rt=.5*Pt.width,Lt=.5*Pt.height;B=[Mt.x-Rt,Mt.x,Mt.x+Rt],E=[Mt.y-Lt,Mt.y,Mt.y+Lt]}else if(x.x!==void 0){const et=Ht(x);B=[et.x],E=[et.y]}return{x:B,y:E}},Br=(x,B,E)=>{let Y,et,Tt,Ct=Number.Infinity,Pt=null,Mt=null;for(let Rt=0;Rt<x.length;Rt++){et=x[Rt];for(let Lt=0;Lt<B.length;Lt++)Tt=B[Lt],Y=Math.abs(et-Tt),Y<E&&(Mt===null||Y<Ct)&&(Ct=Y,Pt=et,Mt=Tt)}return{origin:Pt,target:Mt}},eo=(x,B,E,Y,et)=>{const Tt={x:null,y:null},Ct={x:null,y:null},Pt=B.map(kr);if(Y>0){const Mt=Ht({x:0,y:0}),Rt=Ht({x:Y,y:Y}),Lt=Ht({x:et.width,y:et.height}),Vt=Rt.x-Mt.x,qe=to(Vt,Mt.x,Lt.x),oe=to(Vt,Mt.y,Lt.y);Pt.push({x:qe,y:oe})}return Pt.forEach(Mt=>{const{snapTranslation:Rt,snapLine:Lt}=((Vt,qe,oe)=>{const ne={x:null,y:null},fe={x:null,y:null},$e=Br(Vt.x,qe.x,oe);$e.target!==null&&(ne.x=$e.target,fe.x=$e.target-$e.origin);const De=Br(Vt.y,qe.y,oe);return De.target!==null&&(ne.y=De.target,fe.y=De.target-De.origin),{snapTranslation:fe,snapLine:ne}})(x,Mt,E);Rt.x!==null&&(Ct.x===null||Math.abs(Rt.x)<Math.abs(Ct.x))&&(Ct.x=Rt.x||0,Tt.x=Lt.x),Rt.y!==null&&(Ct.y===null||Math.abs(Rt.y)<Math.abs(Ct.y))&&(Ct.y=Rt.y||0,Tt.y=Lt.y)}),{snapTranslation:Ct,snapLines:Tt}},Nr=(x,B)=>(B.x!==null&&(x.x+=B.x),B.y!==null&&(x.y+=B.y),x),wo=(x,B,E,Y)=>{const{snapThreshold:et=0,gridSize:Tt=0,gridRect:Ct,snapTargets:Pt=[]}=Y||{};let Mt=null;if(ar(x)){if(et){const Vt=Ai({...x},Zt),qe=xr(rs(B),E),oe=xr(os(B),E),ne=kr({...Vt,x1:qe.x,y1:qe.y,x2:oe.x,y2:oe.y}),{snapTranslation:fe,snapLines:$e}=eo(ne,Pt,et,Tt,Ct);Nr(E,fe),jr($e)}const Rt=xr(rs(B),E),Lt=xr(os(B),E);Mt={x1:Rt.x,y1:Rt.y,x2:Lt.x,y2:Lt.y}}else if(x.points){if(Rp(Kt)&&Ii(Kt,{selectedPoint:void 0}),et){const Rt=Ai({...x},Zt),Lt=kr({...Rt,points:B.points.map(oe=>xr(oe,E))}),{snapTranslation:Vt,snapLines:qe}=eo(Lt,Pt,et,Tt,Ct);Nr(E,Vt),jr(qe)}Mt={points:B.points.map(Rt=>xr(Rt,E))}}else if(ko(x)||tr(x)||er(x)){if(et){const Rt=Ai({...x},Zt),Lt=xr(B,E),Vt=kr({...Rt,...Lt}),{snapTranslation:qe,snapLines:oe}=eo(Vt,Pt,et,Tt,Ct);Nr(E,qe),jr(oe)}Mt=xr(B,E)}Mt&&(Lo(x,Mt,Zt),Fi())},ho={0:1,1:0,2:3,3:2},Er={0:3,1:2,2:1,3:0};let Pr;const Ir=(x,B)=>{const E=x.points.filter((Y,et)=>et!==B);Ii(x,{points:E,selectedPoint:void 0})},Wr=()=>{if(It.length)return It.find(lo)},ji=()=>{if(It.length)return It.findIndex(lo)},An=()=>{const x=Wr();if(x)return lg(x),Fi(),x},Wi=()=>{if(!Wr())return;const x=[...It];x.splice(ji(),1),xt.set(x)},Fi=()=>{xt.set(It)},gi=(x,B=[],E=!0)=>{B.filter(Boolean).forEach(Y=>delete x[Y]),E&&Fi()},Ii=(x,B,E=!0)=>{x=Object.assign(x,B),E&&Fi()},Ki=(x,B,E,Y=!0)=>{x[B]=E,Y&&Fi()},Go=(x,B=!0)=>{It.forEach(E=>Ii(E,x,!1)),B&&Fi()},ca=()=>[...It].reverse().filter($a),mo=()=>[...It].reverse().find($a),_i=()=>!!mo(),Di=(x,B=!0,E=!1)=>{const Y=It.filter(Ct=>Ip(Ct)&&ga(Ct)),et=Y.findIndex(Ct=>Ct===x);if(((Ct,Pt=!1)=>{if(!si(Ct))return!1;xt.set(It.filter(Mt=>Mt!==Ct)),Pt||Se(Ct)})(x,E)===!1)return;if(no=x,Y.length-1<=0)return zi();if(!B)return!0;const Tt=et-1<0?Y.length-1:et-1;return Bi(Y[Tt]),!0},Oo=()=>{if(a){const B=[];return o.forEach((E,Y)=>{Ip(E)&&Di(E,Y===o.length-1,!0)&&B.push(E)}),void(B.length&&jt())}const x=mo();x&&Di(x)};let no;const zi=(x={})=>{const{storePrevious:B=!0}=x;Object.keys(ti).forEach(Y=>ti[Y]={});const E=fr();B&&(no=E),Go({isSelected:!1,isEditing:!1,_prerender:!1}),E&&Yn(E)},fr=()=>It.find($a),Bi=(x,B=!0,E=!1)=>{if(lo(x))return;const Y=fr()||no,et=$a(x);no=void 0,be(Y,x)&&(E||zi(),(Tt=>{Tt.isSelected=!0})(x),!et&&Me(x),B&&Fi())},Ji=x=>{xi&&xi.confirm&&x.isEditing&&xi.confirm();const B={isSelected:!1,isEditing:!1,_prerender:!1};x.selectedPoint>-1&&(B.selectedPoint=void 0),Ii(x,B),Yn(x)},Xr=x=>{Ii(x,{isSelected:!0,isEditing:!0,_prerender:ye==="inline"})},go=x=>{Ii(x,{isSelected:!0,isEditing:!1,_prerender:!1})},io=x=>{if(!x.length)return[];const B=x.filter(si);return xt.set(It.filter(E=>!B.includes(E))),B},L=x=>{const B=Do(x.text,x);return Ci(x.x,x.y,x.width?Math.min(x.width,B.width):B.width,x.height?Math.min(x.height,B.height):B.height)},ee=x=>{if(al(x))return vs(x);if(er(x))return Sp(x);const B=L(x);return B.width=Math.max(10,x.width||B.width),B},sn=(x,B,E=0,Y=()=>!0)=>[...x].reverse().filter(Y).map(et=>({shape:et,priority:1})).filter(et=>{const{shape:Tt}=et,Ct=Ai(Li(Tt),Zt),Pt=E+.5*(Ct.strokeWidth||0);if(ko(Ct))return Tp(B,Pt,Ct,Tt.rotation);if(tr(Ct)){const Mt=ee(Ct),Rt=Tp(B,Pt,Mt,Tt.rotation);let Lt=!1;if(Rt&&!$a(Tt)){const Vt=L(Ct);Tt.textAlign!=="right"||Tt.flipX||(Vt.x=Mt.x+Mt.width-Vt.width),Tt.textAlign==="center"&&(Vt.x=Mt.x+.5*Mt.width-.5*Vt.width),Lt=Tp(B,Pt,Vt,Tt.rotation,wn(Mt)),Lt||(et.priority=-1)}return Rt}return er(Ct)?((Mt,Rt,Lt,Vt,qe,oe)=>{const ne=Au(pt(Lt.x,Lt.y),Lt.rx,Lt.ry,Vt,qe,oe,12);return hh(Mt,Rt,ne)})(B,Pt,Ct,Tt.rotation,Tt.flipX,Tt.flipY):ar(Ct)?Lu(B,Math.max(16,Pt),rs(Ct),os(Ct)):Ni(Ct)&&Ct.pathClose?hh(B,Pt,Ct.points):!!Ni(Ct)&&(Ct.points.length===1?yo(B,Ct.points[0])<Pt*Pt:By(B,Math.max(16,Pt),Ct.points))}).sort((et,Tt)=>et.priority<Tt.priority?1:et.priority>Tt.priority?-1:0).map(et=>et.shape),je=(x,B,E,Y=0)=>{const et=Math.abs(Y),Tt=As(B,E),Ct=Hh(Tt,et),Pt=(({start:Mt,end:Rt},Lt)=>{if(Lt===0)return[pt(Mt.x,Mt.y),pt(Mt.x,Mt.y),pt(Rt.x,Rt.y),pt(Rt.x,Rt.y)];const Vt=Math.atan2(Rt.y-Mt.y,Rt.x-Mt.x),qe=Math.sin(Vt)*Lt,oe=Math.cos(Vt)*Lt;return[pt(qe+Mt.x,-oe+Mt.y),pt(-qe+Mt.x,oe+Mt.y),pt(-qe+Rt.x,oe+Rt.y),pt(qe+Rt.x,-oe+Rt.y)]})(Ct,et);return x.filter(Mt=>{const Rt=Ai(Li(Mt),Zt);if(ar(Rt)||Ni(Rt)){const Lt=Rt.points?[...Rt.points]:[rs(Rt),os(Rt)];return!!_y(Ct,Lt)}return((Lt,Vt)=>!!Lt.find(qe=>ph(qe,Vt))||!!Vt.find(qe=>ph(qe,Lt)))(Pt,((Lt,Vt=12)=>{if(ko(Lt))return $r(Lt,Lt.rotation,wn(Lt));if(tr(Lt)){const qe=ee(Lt);return $r(qe,Lt.rotation,wn(qe))}return er(Lt)?Au(pt(Lt.x,Lt.y),Lt.rx,Lt.ry,Lt.rotation,Lt.flipX,Lt.flipY,Vt):[]})(Rt))})};let re,ie,bn,Kt,ai,zn,Pn=!1,br=!1,Qi=!1,fo;const da=x=>{fo=x.map(B=>({shape:B,shapeOrigin:Li(B),shapeOriginComputed:Ai(Li(B),Zt)}))},wa=()=>{clearTimeout(ie),ie=void 0,n(143,Qi=!1),Qr()};let R=null;const te=x=>{const B=dn(x.rotation)&&x.rotation!==0;if(ko(x)){if(x.width<1&&x.height<1)return;const E=wn(x),Y=Mo(x);return(x.flipX||x.flipY)&&Nl(Y,x.flipX,x.flipY,E.x,E.y),B?ls(Y,x.rotation,E.x,E.y):Y}if(er(x)){if(x.rx<1&&x.ry<1)return;const E=x,Y=Mo(Sp(x));return(x.flipX||x.flipY)&&Nl(Y,x.flipX,x.flipY,E.x,E.y),B?ls(Y,x.rotation,E.x,E.y):Y}if(ar(x))return[rs(x),os(x)];if(Ni(x)){if(x.bitmap&&!x.pathClose){const E=Vi(x.points);return E.x-=.5*x.strokeWidth,E.y-=.5*x.strokeWidth,E.width+=x.strokeWidth,E.height+=x.strokeWidth,te({...x,...E})}return[...x.points]}if(tr(x)){if(x.width<5&&x.height<5)return;const E=ee(x);E.width=Math.max(10,E.width);const Y=wn(E),et=Mo(E);return(x.flipX||x.flipY)&&Nl(et,x.flipX,x.flipY,Y.x,Y.y),B?ls(et,x.rotation,Y.x,Y.y):et}return[]},Re=x=>{const B=te(x);let E,Y;return x.flipY?(E=zo([B[0],B[1]]),Y=bo(pt(B[1].x-B[2].x,B[1].y-B[2].y))):(E=zo([B[2],B[3]]),Y=bo(pt(B[2].x-B[1].x,B[2].y-B[1].y))),Po(Y,20/Je),{origin:E,dir:Y}},$n=x=>B=>B.id===x,In=x=>{const B=$n(x);return E=>E.filter((Y=>et=>!Y(et))(B))},Ln=x=>{const B=$n(x),E=In(x);return()=>We.update(Y=>Y.some(B)?E(Y):Y)},He=x=>{const B=In(x);return(...E)=>{We.update(Y=>[...B(Y),...E.filter(Boolean)])}},pn=Ln("markup-hover"),On=He("markup-hover");let mn;const Gn="markup-manipulator-segment-"+Ae,Ri=Ln(Gn),$i=He(Gn),vi=(x,B)=>{const E=x[B],Y=B-1<0?x[x.length-1]:x[B-1],et=B+1<x.length?x[B+1]:x[0],Tt=Oi(Ue(Y),E);bo(Tt);const Ct=nr(Po(Tt,10),E),Pt=Oi(Ue(et),E);return bo(Pt),[Ct,E,nr(Po(Pt,10),E)]},Rn=()=>{n(144,mn=void 0),pn()},vr="markup-multi-selection-segment-"+Ae,jo=Ln(vr),Ns=He(vr),Ha=(x,B)=>{if(Ui<=0)return x;if(B)return Qr(),x;const E=Le(x),Y=Uo(),{snapTranslation:et,snapLines:Tt}=eo(kr(E),Y,Ui,Mr,i);return jr(Tt),Nr(x,et),x},Ua=fn(0);D(t,Ua,x=>n(187,nn=x));const Sa="markup-grid-line-"+Ae,Ga=Ln(Sa),ps=He(Sa),ja="markup-snap-line",ua=Ln(ja),Za=He(ja);let xi;const ro=x=>{n(8,xi.innerHTML=rS(x),xi)},oo=x=>{const B=x.value===void 0?x.innerHTML:x.value,E=r.format==="text"?Cx(B).split(/<br>|<br\/>/g).join(`
`).replace(/&nbsp;/g," ").replace(/&amp;/g,"&"):B;return _u(r)&&r.disableNewline!==!1?(Y=>{const et=Y.split(/[\n\r]/g);return et.length>1?et.map(Tt=>Tt.trim()).filter(Tt=>Tt.length).join(" "):et[0]})(E):E},Rr=()=>{const x=oo(xi),B=Ol(r,x),E=B===!0?x:B;let Y=ct.x,et=ct.y;if(!r.height){const Tt=$r({...ut},r.rotation),Ct=Do(E,u),Pt=$r({x:Y,y:et,...Ct},r.rotation),[Mt,,Rt]=Tt,[Lt,,Vt]=Pt;let qe=Mt,oe=Lt;r.flipX&&(qe=Rt,oe=Vt);const ne=Oi(Ue(qe),oe);Y+=ne.x,et+=ne.y}Ii(r,{x:Qe(q.x)?Ur(Y,Zt.width):Y,y:Qe(q.y)?Ur(et,Zt.height):et,text:E})},Qn=()=>{c&&An(),xi&&xi.confirm&&xi.confirm(),Rr(),go(r),xe(r)},So=()=>{c?Wi():(Ii(r,{text:q.text,x:q.x,y:q.y}),go(r))},Ta=(x,B,{flipX:E,flipY:Y,rotation:et},Tt="top left")=>{let Ct,Pt;const[Mt,Rt,Lt,Vt]=$r(x,et),[qe,oe,ne,fe]=$r(B,et);return Tt==="top center"?(Ct=zo(Y?[Vt,Lt]:[Mt,Rt]),Pt=zo(Y?[fe,ne]:[qe,oe])):Tt==="top right"&&!E||Tt==="top left"&&E?(Ct=Y?Lt:Rt,Pt=Y?ne:oe):(Ct=Y?Vt:Mt,Pt=Y?fe:qe),Oi(Ue(Ct),Pt)},qr=(x,B,E)=>pt(Qe(x.x)?Ur(B.x+E.x,Zt.width):B.x+E.x,Qe(x.y)?Ur(B.y+E.y,Zt.height):B.y+E.y),ti={},nd=()=>Ir(r,r.selectedPoint),hs=()=>Xr(r),Kl=()=>{const x=cs(Do(r.text,u),Mt=>Math.ceil(Mt)),B=Ee(r,"height"),E=!B&&Ee(r,"width"),Y=r.id;let et=ti[Y];et||(ti[Y]={},et=ti[Y]);const Tt=Mt=>{const{width:Rt,...Lt}=u,Vt=Do(r.text,Lt),qe=Ta(Ci(u.x,u.y,Mt.width,Mt.height),Ci(u.x,u.y,Vt.width,Vt.height),u,"top "+r.textAlign),oe=u.disableNewline!==!1;gi(r,["width","height",oe&&"textAlign"]),Ii(r,{...qr(r,u,qe)})},Ct=Mt=>{const Rt=sr(et.width||u.width||x.width,x.height),Lt=et.textAlign||"left",Vt=Ta(Ci(u.x,u.y,Mt.width,Mt.height),Ci(u.x,u.y,Rt.width,Rt.height),u,"top "+Lt);gi(r,["height"]),Ii(r,{...qr(r,u,Vt),width:Qe(r.width)?Ur(Rt.width,Zt.width):Rt.width,textAlign:Lt})},Pt=Mt=>{const Rt=sr(et.width||x.width,et.height||x.height),Lt=et.textAlign||"left",Vt=Ta(Ci(u.x,u.y,Mt.width,Mt.height),Ci(u.x,u.y,Rt.width,Rt.height),u,"top "+Lt);Ii(r,{...qr(r,u,Vt),width:Qe(r.width)?Ur(Rt.width,Zt.width):Rt.width,height:Qe(r.width)?Ur(Rt.height,Zt.height):Rt.height,textAlign:Lt})};if(B){et.textAlign=r.textAlign,et.width=u.width,et.height=u.height;const Mt=sr(u.width,u.height);el(r,"auto-height")?Ct(Mt):el(r,"auto-width")&&Tt(Mt)}else if(E){et.textAlign=r.textAlign,et.width=u.width;const Mt=sr(u.width,x.height);el(r,"auto-width")?Tt(Mt):el(r,"fixed-size")&&Pt(Mt)}else{et.textAlign=r.textAlign;const Mt=sr(Math.ceil(x.width),Math.ceil(x.height));el(r,"fixed-size")?Pt(Mt):el(r,"auto-height")&&Ct(Mt)}},ms=x=>{x.stopPropagation();const B=r.flipX||!1;Ki(r,"flipX",!B),xe(r)},Ws=x=>{x.stopPropagation();const B=r.flipY||!1;Ki(r,"flipY",!B),xe(r)},To=x=>{Ki(r,"opacity",x)},$l=x=>{To(x),xe(r)},Jl=x=>{x.stopPropagation(),x.target.blur(),Oo()},id=x=>{x.stopPropagation(),It.findIndex(B=>B===r)!==It.length-1&&(xt.set(It.filter(B=>B!==r).concat([r])),xe(r))},yl=x=>{x.stopPropagation(),Ql()},Ql=()=>{const x=(a?o:[r]).filter(cg).map(B=>{const E=Li(B);E.id=ba();const Y=pt(50,-50);if(Ee(E,"points")){const et=Wl(E,["points"],Zt);et.points.forEach(Tt=>{Tt.x+=Y.x,Tt.y+=Y.y}),Da(E,et,Zt)}else if(ar(E)){const et=Wl(E,["x1","y1","x2","y2"],Zt);et.x1+=Y.x,et.y1+=Y.y,et.x2+=Y.x,et.y2+=Y.y,Da(E,et,Zt)}else{const et=Wl(E,["x","y"],Zt);et.x+=50,et.y-=50,Da(E,et,Zt)}return xt.set([...It,E]),on(E),E});if(x.length>1)return zi(),void x.forEach(B=>{Bi(B,!0,!0)});Bi(x[0])},xl=fn(0,{stiffness:.2,damping:.7});D(t,xl,x=>n(18,Ie=x));let gs;const Xa=(x,B)=>{const{disableTextLayout:E=[]}=B;return"height"in B?E.includes("auto-height")?x.shapeIconButtonTextLayoutAutoWidth:x.shapeIconButtonTextLayoutAutoHeight:"width"in B?E.includes("auto-width")?x.shapeIconButtonTextLayoutFixedSize:x.shapeIconButtonTextLayoutAutoWidth:E.includes("fixed-size")?x.shapeIconButtonTextLayoutAutoHeight:x.shapeIconButtonTextLayoutFixedSize},tc=(x,B)=>{const{disableTextLayout:E=[]}=B;return"height"in B?E.includes("auto-height")?x.shapeTitleButtonTextLayoutAutoWidth:x.shapeTitleButtonTextLayoutAutoHeight:"width"in B?E.includes("auto-width")?x.shapeTitleButtonTextLayoutFixedSize:x.shapeTitleButtonTextLayoutAutoWidth:E.includes("fixed-size")?x.shapeTitleButtonTextLayoutAutoHeight:x.shapeTitleButtonTextLayoutFixedSize};let Vs=!1,bl=hi(),qa;const vl=x=>{Xt(x),n(144,mn=x)};let Ya;return Ho(()=>{ua(),Ga(),Ri(),pn()}),t.$$set=x=>{"uid"in x&&n(58,Ae=x.uid),"ui"in x&&n(59,We=x.ui),"disabled"in x&&n(0,xn=x.disabled),"shapes"in x&&Ke(n(1,xt=x.shapes)),"selection"in x&&n(60,de=x.selection),"offset"in x&&n(2,Ve=x.offset),"contextRotation"in x&&n(61,Oe=x.contextRotation),"contextFlipX"in x&&n(62,Ne=x.contextFlipX),"contextFlipY"in x&&n(63,_e=x.contextFlipY),"contextZoom"in x&&n(64,Je=x.contextZoom),"active"in x&&n(65,kn=x.active),"opacity"in x&&n(66,En=x.opacity),"parentRect"in x&&n(67,Zt=x.parentRect),"rootRect"in x&&n(3,Dn=x.rootRect),"utilRect"in x&&n(68,H=x.utilRect),"hoverColor"in x&&n(69,Wt=x.hoverColor),"caretColor"in x&&n(70,z=x.caretColor),"gridColor"in x&&n(71,Qt=x.gridColor),"snapColor"in x&&n(72,ce=x.snapColor),"textInputMode"in x&&n(4,ye=x.textInputMode),"oninteractionstart"in x&&n(73,ue=x.oninteractionstart),"oninteractionupdate"in x&&n(74,Yt=x.oninteractionupdate),"oninteractionrelease"in x&&n(75,Gt=x.oninteractionrelease),"oninteractionend"in x&&n(76,hn=x.oninteractionend),"oninteractioncancel"in x&&n(77,Xe=x.oninteractioncancel),"onaddshape"in x&&n(78,on=x.onaddshape),"onupdateshape"in x&&n(79,xe=x.onupdateshape),"onselectshape"in x&&n(80,Me=x.onselectshape),"onblurshape"in x&&n(81,Yn=x.onblurshape),"onremoveshape"in x&&n(82,Se=x.onremoveshape),"ontapshape"in x&&n(83,J=x.ontapshape),"onhovershape"in x&&n(84,Xt=x.onhovershape),"ontriggerhistorywrite"in x&&n(85,jt=x.ontriggerhistorywrite),"onhovercanvas"in x&&n(86,se=x.onhovercanvas),"ontapcanvas"in x&&n(87,Fe=x.ontapcanvas),"onleavecanvas"in x&&n(88,ke=x.onleavecanvas),"beforeSelectShape"in x&&n(89,be=x.beforeSelectShape),"beforeDeselectShape"in x&&n(90,mi=x.beforeDeselectShape),"beforeRemoveShape"in x&&n(91,si=x.beforeRemoveShape),"beforeUpdateShape"in x&&n(92,ge=x.beforeUpdateShape),"willRenderShapeControls"in x&&n(93,an=x.willRenderShapeControls),"willRenderShapeTextControls"in x&&n(94,we=x.willRenderShapeTextControls),"willStartInteraction"in x&&n(95,Ge=x.willStartInteraction),"mapEditorPointToImagePoint"in x&&n(96,Le=x.mapEditorPointToImagePoint),"mapImagePointToEditorPoint"in x&&n(97,Ht=x.mapImagePointToEditorPoint),"eraseRadius"in x&&n(98,Pe=x.eraseRadius),"selectRadius"in x&&n(99,Cn=x.selectRadius),"enableButtonFlipVertical"in x&&n(100,Un=x.enableButtonFlipVertical),"enableTapToAddText"in x&&n(101,bi=x.enableTapToAddText),"enableMultiSelect"in x&&n(102,Pi=x.enableMultiSelect),"enableTextStyleControls"in x&&n(5,Hi=x.enableTextStyleControls),"locale"in x&&n(6,Xn=x.locale),"snapThreshold"in x&&n(103,Ui=x.snapThreshold),"snapPointer"in x&&n(104,yr=x.snapPointer),"enableSnapToContext"in x&&n(105,gr=x.enableSnapToContext),"gridSize"in x&&n(106,Mr=x.gridSize)},t.$$.update=()=>{var x,B;if(32&t.$$.dirty[2]|8192&t.$$.dirty[3]&&n(172,i=Mr>0?{x:0,y:0,...Zt}:void 0),1&t.$$.dirty[0]|536870912&t.$$.dirty[5]&&n(148,r=!xn&&It&&(Wr()||mo())),512&t.$$.dirty[3]|536870912&t.$$.dirty[5]&&n(164,o=Pi?It.filter($a):[]),512&t.$$.dirty[5]&&n(163,a=o.length>1),32&t.$$.dirty[2]|768&t.$$.dirty[5]&&n(183,s=a?o.map(E=>Ai(Li(E),Zt)):[]),16777216&t.$$.dirty[4]&&n(180,l=!!r),16777216&t.$$.dirty[4]&&n(166,c=r&&lo(r)),16777216&t.$$.dirty[4]|2048&t.$$.dirty[5]&&n(10,d=r&&!c?r.id:void 0),8&t.$$.dirty[0]|32&t.$$.dirty[2]|16777216&t.$$.dirty[4]&&n(13,u=Dn&&r&&Ai(Li(r),Zt)),16777216&t.$$.dirty[4]|2048&t.$$.dirty[5]&&n(146,p=!(!r||!c)),8192&t.$$.dirty[0]|16&t.$$.dirty[2]|16777216&t.$$.dirty[4]&&n(179,h=r&&En&&te(u)||[]),268435712&t.$$.dirty[5]&&n(176,y=a?s.map(te):[]),16777216&t.$$.dirty[4]|256&t.$$.dirty[5]&&n(182,m=!a&&r&&fh(x=r)&&cl(x)&&x.disableResize!==!0&&(al(x)||vu(x)||er(x)||ar(x)||Ni(x)&&Ee(x,"pathClose"))&&!is(r)),16777216&t.$$.dirty[4]|256&t.$$.dirty[5]&&n(14,f=!a&&r&&(E=>fh(E)&&E.disableRotate!==!0&&(al(E)||Ee(E,"text")||er(E)))(r)&&!is(r)),16777216&t.$$.dirty[4]|134217728&t.$$.dirty[5]&&n(17,b=m&&Ee(r,"text")&&!r.height?[[1,2],[3,0]]:(!r||!ar(r)&&!Ni(r))&&m),131072&t.$$.dirty[0]|16777216&t.$$.dirty[4]|134217728&t.$$.dirty[5]&&n(29,v=!!r&&!Array.isArray(b)&&m),768&t.$$.dirty[5]&&n(181,w=a?(E=>{const Y=E.map(Tt=>te(Ai(Tt,Zt))).flat(),et=Vi(Y);return Mo(et)})(o):[]),16777216&t.$$.dirty[4]|16777472&t.$$.dirty[5]&&n(15,T=r&&h.length>1||a),16&t.$$.dirty[3]|83886336&t.$$.dirty[5]&&n(177,I=a?w.map(Ht):h.map(Ht)),4&t.$$.dirty[0]|4194304&t.$$.dirty[5]&&n(12,P=I.map(E=>pt(E.x-Ve.x,E.y-Ve.y))),16777216&t.$$.dirty[4]&&n(16,_=r&&r.points&&dn(r.selectedPoint)?r.selectedPoint:-1),65536&t.$$.dirty[0]&&n(156,C=_>=0),69632&t.$$.dirty[0]|2&t.$$.dirty[5]&&n(161,F=C?P[_]:void 0),16777216&t.$$.dirty[4]|33554432&t.$$.dirty[5]&&n(28,G=l&&(vu(r)?!Ee(r,"disableNewline")||!r.disableNewline:r.disableNewline===!1)),16&t.$$.dirty[3]|1048576&t.$$.dirty[4]&&(mn&&Ht&&!$a(mn)&&ga(mn)?(E=>{const Y=te(Ai(Li(E),Zt));if(!Y)return;const et=Y.map(Ht),Tt=!!E.pathClose||!(!E.bitmap&&(Ni(E)||ar(E))),Ct=E.selectionStyle==="hook",Pt=Ct?et.map((Rt,Lt,Vt)=>({id:"markup-hover",points:vi(Vt,Lt),strokeColor:[0,0,0,.1],strokeWidth:2})):[{id:"markup-hover",points:et.map(Rt=>pt(Rt.x+1,Rt.y+1)),strokeColor:[0,0,0,.1],strokeWidth:2,pathClose:Tt}],Mt=Ct?et.map((Rt,Lt,Vt)=>({id:"markup-hover",points:vi(Vt,Lt),strokeColor:Wt,strokeWidth:2})):[{id:"markup-hover",points:et,strokeColor:Wt,strokeWidth:2,pathClose:Tt}];On(...Pt,...Mt)})(mn):pn()),61440&t.$$.dirty[0]|16&t.$$.dirty[2]&&n(178,O=T&&f&&En&&P?(E=>{const Y=Re(E),et=Ht({x:Y.origin.x+Y.dir.x,y:Y.origin.y+Y.dir.y});return{origin:Ht(Y.origin),position:et}})(u):void 0),4&t.$$.dirty[0]|8388608&t.$$.dirty[5]&&n(27,$=O&&pt(O.position.x-Ve.x,O.position.y-Ve.y)),1&t.$$.dirty[6]&&n(171,W=!!(Ze||[]).find(E=>[91,93,17].includes(E))),2048&t.$$.dirty[3]|65536&t.$$.dirty[5]&&n(173,N=!(W||!yr)),16&t.$$.dirty[2]|18874368&t.$$.dirty[4]|4458496&t.$$.dirty[5]&&r&&I&&En>0&&(r===mn&&Rn(),((E,Y,et)=>{if(!ga(Y))return;const Tt=Ni(Y),Ct=Tt&&Ee(Y,"pathClose"),Pt=Ct&&(di=>di.strokeWidth&&((Vr,Ar)=>{const ao=Vr.strokeColor;return!!ao&&(ao.length===3||ao[3]>0)})(di))(Y),Mt=lo(Y),Rt=is(Y),Lt=Y.selectionStyle==="hook",Vt=Y.disableShowPoints!==!0,{selectionOpacity:qe=1}=Y;if(Mt&&Tt&&!Ct)return;const oe=[],ne=[...I],fe=ne[ne.length-1],$e=ne[0],De=(Rt?.05:.1)*E*qe,Ye=De>0,vn=(Rt?.5:1)*E*qe,ln=vn>0,Fn=[0,0,0],pi=[1,1,1],Wn=Rt?1:1.5;Ze.includes(16)&&fe&&et&&Dr(fe,et);const _n=(ne.length&&Ct&&Mt&&et?yo($e,et):1/0)<=256,wi=(ne.length&&Ct&&Mt&&et?yo(fe,et):1/0)<=256;!_n&&et&&ne.push(et);const ri=ne.length>1,Zi=!!Y.pathClose||!(!Y.bitmap&&(Ni(Y)||ar(Y)))||ne.length>2&&_n;ri&&Ye&&(Lt?oe.push(...ne.map((di,Vr,Ar)=>({id:Gn,points:vi(Ar,Vr),strokeColor:Fn,opacity:De}))):oe.push({id:Gn,points:ne.map(di=>pt(di.x+1,di.y+1)),pathClose:Zi,strokeColor:Fn,strokeWidth:2,opacity:De})),Ct&&Ye&&Vt&&oe.push(...ne.map(di=>({id:Gn,...di,rx:2*Wn,ry:2*Wn,backgroundColor:Fn,opacity:De}))),O&&Ye&&oe.push({id:Gn,points:[pt(O.origin.x+1,O.origin.y+1),pt(O.position.x+1,O.position.y+1)],strokeColor:Fn,strokeWidth:2,opacity:De}),ri&&ln&&(Lt?oe.push(...ne.map((di,Vr,Ar)=>({id:Gn,points:vi(Ar,Vr),strokeColor:pi,strokeWidth:Wn,opacity:vn}))):oe.push({id:Gn,points:ne,pathClose:Zi,strokeColor:pi,strokeWidth:Wn,backgroundColor:Mt&&Ct&&Y.backgroundColor&&Y.backgroundColor[3]>0?Y.backgroundColor:[0,0,0,0],opacity:vn})),Ct&&Vt&&oe.push(...ne.map(di=>({id:Gn,...di,rx:3*Wn,ry:3*Wn,backgroundColor:[.5,.5,.5],strokeWidth:Wn,strokeColor:pi}))),Ct&&Mt&&Vt&&I.length>=3&&oe.push({...$e,id:Gn,rx:Wn*(_n?5:4),ry:Wn*(_n?5:4),backgroundColor:_n?Wt:[.5,.5,.5],strokeWidth:Wn,strokeColor:pi}),Ct&&Mt&&Pt&&Vt&&!_n&&h.length>=2&&oe.push({...fe,id:Gn,rx:Wn*(wi?5:4),ry:Wn*(wi?5:4),backgroundColor:wi?Wt:[.5,.5,.5],strokeWidth:Wn,strokeColor:pi}),O&&ln&&!Lt&&oe.push({id:Gn,points:[{x:O.origin.x,y:O.origin.y},{x:O.position.x,y:O.position.y}],strokeColor:pi,strokeWidth:Wn,opacity:vn}),$i(...oe)})(En,r,c&&Ni(r)?Ha({...qa},!N):void 0)),16777216&t.$$.dirty[4]&&(r||(Rn(),Ri())),16&t.$$.dirty[3]|2097152&t.$$.dirty[5])if(y.length){jo();const E=y.map(Y=>({id:vr,points:Y.map(Ht),strokeWidth:1,strokeColor:[1,1,1,.5],pathClose:!0}));Ns(...E)}else jo();1048576&t.$$.dirty[4]&&n(174,it=!!mn),262144&t.$$.dirty[4]&&n(175,M=!!Kt),2097152&t.$$.dirty[4]|1835008&t.$$.dirty[5]&&(!qa||M||it||Ha({...qa},!N)),512&t.$$.dirty[2]|8208&t.$$.dirty[3]|131072&t.$$.dirty[5]|2&t.$$.dirty[6]&&Mr>0&&i&&Ht&&((E,Y,et,Tt)=>{const Ct=Ht({x:0,y:0}),Pt=Ht({x:E,y:E}),Mt=Ht({x:Y.width,y:Y.height}),Rt=Pt.x-Ct.x;if(Ua.set(Rt>6?1:0),Tt<=0)return Ga();const Lt=to(Rt,Ct.x,Mt.x).map(qe=>({id:Sa,opacity:Tt,points:[{x:qe,y:Ct.y},{x:qe,y:Mt.y}],strokeWidth:1,strokeColor:et})),Vt=to(Rt,Ct.y,Mt.y).map(qe=>({id:Sa,opacity:Tt,points:[{x:Ct.x,y:qe},{x:Mt.x,y:qe}],strokeWidth:1,strokeColor:et}));ps(...Vt,...Lt)})(Mr,i,Qt,nn),1024&t.$$.dirty[2]|16&t.$$.dirty[3]|196608&t.$$.dirty[4]|65536&t.$$.dirty[5]&&Ht&&(W?ua():((E,Y,et)=>{if(E===null&&Y===null)return ua();let Tt,Ct;E!==null&&(Tt={id:ja,strokeColor:et,strokeWidth:1.5,points:[Ht({x:E,y:0}),Ht({x:E,y:Zt.height})]}),Y!==null&&(Ct={id:ja,strokeColor:et,strokeWidth:1.5,points:[Ht({x:0,y:Y}),Ht({x:Zt.width,y:Y})]}),Za(Tt,Ct)})(zr,Zr,ce)),8&t.$$.dirty[2]&&(E=>{if(!E)return Go({_prerender:!1});const Y=It.find(et=>et.isEditing);Y&&Ii(Y,{_prerender:ye==="inline"})})(kn),1&t.$$.dirty[6]&&Ze&&Ze.length&&(()=>{const[E]=Ze;E!==8&&E!==46||_i()&&(r.isEditing||(Ni(r)&&dn(r.selectedPoint)?setTimeout(()=>Ir(r,r.selectedPoint),0):setTimeout(()=>Oo(),0)))})(),272&t.$$.dirty[0]&&xi&&ye==="inline"&&xi.focus(),16777216&t.$$.dirty[4]&&n(170,ot=r&&tr(r)),16777216&t.$$.dirty[4]|32768&t.$$.dirty[5]&&n(11,at=ot&&Ol(r)!==!1&&is(r)),2048&t.$$.dirty[0]&&n(165,q=at?{...r}:void 0),32&t.$$.dirty[2]|1024&t.$$.dirty[5]&&n(167,ct=q&&Ai({...q},Zt)),4096&t.$$.dirty[5]&&n(169,V=ct&&Do(ct.text,ct)),20480&t.$$.dirty[5]&&(ut=ct&&Ci(ct.x,ct.y,V.width,V.height)),2048&t.$$.dirty[0]|16777216&t.$$.dirty[4]&&n(24,bt=at?r.text:""),2056&t.$$.dirty[0]|32&t.$$.dirty[2]|16777216&t.$$.dirty[4]&&n(168,K=Dn&&r&&at&&Ai({...Li(r),width:dn(r.width)?Math.floor(r.width):void 0,height:dn(r.height)?Math.floor(r.height):void 0},Zt)),2064&t.$$.dirty[0]|8192&t.$$.dirty[5]&&n(26,vt=at&&((E,Y)=>{const{textAlign:et="left",fontFamily:Tt="sans-serif",fontWeight:Ct="normal",fontStyle:Pt="normal",letterSpacing:Mt="normal",textShadowX:Rt=0,textShadowY:Lt=0,textShadowBlur:Vt=0,textShadowColor:qe,textOutlineWidth:oe=0,textOutlineColor:ne}=E,fe="!important",$e=`caret-color:${Z};text-align:${et}${fe};font-family:${Tt}${fe};font-weight:${Ct}${fe};font-style:${Pt}${fe};letter-spacing:${dn(Mt)?Mt+"px":"normal"}${fe}`;if(Y==="modal")return $e;const De=oe?`;-webkit-text-stroke:${2*oe}px ${Lr(ne)} ${fe}`:"",Ye=Vt||Rt||Lt?`;text-shadow:${Rt}px ${Lt}px ${Vt}px ${Lr(qe)} ${fe}`:"";let vn=E.fontSize,ln=1,Fn="";vn>1e3&&va()&&(ln=vn/1e3,Fn=`transform-origin:0 0;transform:scale(${ln})`,vn=1e3);let pi=E.lineHeight/ln;const Wn=Lr(E.color),_n=.5*Math.max(0,vn-pi);return`--font-scalar:${ln};--bottom-inset:${_n}px;padding:${_n}px 0 0${fe};color:${Wn}${fe};font-size:${vn}px${fe};line-height:${pi}px${fe};${$e};${Fn}${De}${Ye}`})(K,ye)),2052&t.$$.dirty[0]|1073741824&t.$$.dirty[1]|4&t.$$.dirty[2]|8192&t.$$.dirty[5]&&n(25,X=at&&((E,Y,et,Tt)=>{let Ct,Pt;E.width&&E.height?(Ct=wn(E),Pt=Wa(E)):(Pt=Do(r.text,u),Pt.width=u.width||Pt.width,Ct=pt(E.x+.5*Pt.width,E.y+.5*Pt.height));const Mt=Math.max(0,E.fontSize-E.lineHeight)+E.lineHeight,Rt=Ht(Ct);let Lt=Rt.x-Y.x-.5*Pt.width,Vt=Rt.y-Y.y-.5*Pt.height,qe=E.flipX,oe=E.flipY,ne=E.rotation;Ne&&_e?(qe=!qe,oe=!oe):Ne?(qe=!qe,ne=-ne):_e&&(oe=!oe,ne=-ne),ne+=Tt;const fe=et*(qe?-1:1),$e=et*(oe?-1:1);return`--line-height:${Mt}px;width:${Pt.width}px;height:${Pt.height}px;transform:translate(${Lt}px,${Vt}px) rotate(${ne}rad) scale(${fe}, ${$e})`})(K,Ve,Je,Oe)),256&t.$$.dirty[2]&&(Z=z?Lr(z):"auto"),2320&t.$$.dirty[0]&&at&&xi&&ye==="inline"&&ro(bt),289406976&t.$$.dirty[4]&&n(152,mt=r&&!p?r:mt),268435456&t.$$.dirty[4]&&n(154,Bt=mt&&dv(mt)),268435456&t.$$.dirty[4]&&n(149,st=mt&&el(mt)),268435456&t.$$.dirty[4]&&n(151,gt=mt&&cg(mt)),268435456&t.$$.dirty[4]&&n(150,Jt=mt&&Ip(mt)),268435456&t.$$.dirty[4]|256&t.$$.dirty[5]&&n(153,le=!a&&mt&&(E=>E.disableReorder!==!0)(mt)),268435456&t.$$.dirty[4]&&n(147,rt=mt&&Ol(mt)!==!1),268435456&t.$$.dirty[4]&&n(155,kt=mt&&Ee(mt,"backgroundImage")&&gh(mt,"opacity")),16777216&t.$$.dirty[4]&&n(158,Nt=r&&r.format==="html"),20971520&t.$$.dirty[4]|8&t.$$.dirty[5]&&n(162,$t=r&&(!p||Nt)),524288&t.$$.dirty[4]|1073741952&t.$$.dirty[5]&&xl.set($t&&!Qi?1:0,{hard:lt===!1}),4096&t.$$.dirty[0]|160&t.$$.dirty[5]&&n(160,Be=$t&&P.length?(B=Vi(P),Eo(pt(B.x+.5*B.width,B.y),Kc)):Be),512&t.$$.dirty[0]|64&t.$$.dirty[2]|96&t.$$.dirty[5]&&n(159,nt=(F||Be)&&gs&&H&&((E,Y,et,Tt)=>{const Ct=E.x,Pt=E.y,Mt=Ct+E.width;let Rt=Math.max(Y.x-.5*et.width,Ct),Lt=Math.max(Y.y-et.height+Tt,Pt);return Rt+et.width>Mt&&(Rt=Mt-et.width),pt(Rt,Lt)})(H,F||Be,gs,-16)),262144&t.$$.dirty[0]|16&t.$$.dirty[5]&&n(23,Ut=nt&&`transform: translate(${nt.x}px, ${nt.y}px);opacity:${Ie}`),2048&t.$$.dirty[0]&&n(157,qt=at?"text":"shape"),1088&t.$$.dirty[0]|131&t.$$.dirty[3]|2139095040&t.$$.dirty[4]|536870927&t.$$.dirty[5]&&n(22,Dt=qt==="text"&&we&&Nt?Wu(()=>we([["div","text-styles",{class:"PinturaShapeControlsGroup"},[...[["bold",{label:"B",style:"font-weight:900;",title:"Bold",shortcut:["CMD","B"]}],["italic",{label:"I",style:"font-family:Times New Roman;font-style:italic;",title:"Italic",shortcut:["CMD","I"]}],["underline",{label:"U",style:"text-decoration:underline;",title:"Underline",shortcut:["CMD","U"]}],["strikeThrough",{label:"S",style:"text-decoration:line-through;",title:"Strikethrough",shortcut:["CMD","S"]}]].map(([E,Y])=>["Button","style-"+E,{onclick:()=>document.execCommand(E),...Y,style:"font-size:1.25em;text-underline-offset:1px;text-decoration-thickness:1.5px;font-weight:400;"+Y.style}])]],["div","text-reset",{class:"PinturaShapeControlsGroup"},[["Button","style-reset",{onclick:()=>document.execCommand("removeFormat"),style:"font-weight:400;",label:'<span style="font-size:1.25em;font-style:italic;font-family:Times New Roman;text-decoration:underline;">T</span><span style="position:relative;top:.175rem;">&times;</span>',title:"Remove styles"}]]]],d)):qt==="shape"&&an&&d?Wu(()=>an(C?[["div","epsilon",{class:"PinturaShapeControlsGroup"},[["Button","remove-point",{onclick:nd,label:Xn.shapeTitleButtonRemove,icon:Xn.shapeIconButtonRemove,shortcut:["Backspace"],hideLabel:!0}]]]]:[kt&&["div","alpha",{class:"PinturaShapeControlsGroup"},[["ToggleSlider","adjust-opacity",{onrelease:$l,onchange:To,step:.01,value:Ee(r,"opacity")?r.opacity:1,label:(E,Y,et)=>Math.round(E/et*100)+"%",min:0,max:1,direction:"x"}]]],["div","beta",{class:"PinturaShapeControlsGroup"},[Bt&&["Button","flip-horizontal",{onclick:ms,label:Xn.shapeTitleButtonFlipHorizontal,icon:Xn.shapeIconButtonFlipHorizontal,hideLabel:!0}],Bt&&Un&&["Button","flip-vertical",{onclick:Ws,label:Xn.shapeTitleButtonFlipVertical,icon:Xn.shapeIconButtonFlipVertical,hideLabel:!0}],le&&["Button","to-front",{onclick:id,label:Xn.shapeTitleButtonMoveToFront,icon:Xn.shapeIconButtonMoveToFront,hideLabel:!0,disabled:It[It.length-1]===mt}],gt&&["Button","duplicate",{onclick:yl,label:Xn.shapeTitleButtonDuplicate,icon:Xn.shapeIconButtonDuplicate,shortcut:["CMD","D"],hideLabel:!0}],Jt&&["Button","remove",{onclick:Jl,label:Xn.shapeTitleButtonRemove,icon:Xn.shapeIconButtonRemove,shortcut:["Backspace"],hideLabel:!0}]].filter(Boolean)],rt&&st&&["div","gamma",{class:"PinturaShapeControlsGroup"},[["Button","text-layout",{onclick:Kl,label:cr(tc,Xn,r),icon:cr(Xa,Xn,r),hideLabel:!0}]]],rt&&["div","delta",{class:"PinturaShapeControlsGroup"},[["Button","edit-text",{label:Xn.shapeLabelInputText,onclick:hs}]]]].filter(Boolean),d)):[]),64&t.$$.dirty[0]|536870912&t.$$.dirty[5]&&n(21,ve=It.filter(ga).filter(E=>E.id).filter(E=>!lo(E)).map(E=>({id:E.id,color:tr(E)?E.color:ar(E)?E.strokeColor:E.backgroundColor,name:E.name||Xn["shapeLabelTool"+P2(mv(E))]})))},[xn,xt,Ve,Dn,ye,Hi,Xn,Bi,xi,gs,d,at,P,u,f,T,_,b,Ie,Vs,Ya,ve,Dt,Ut,bt,X,vt,$,G,v,uo,Gi,x=>{const{origin:B}=x.detail,E=Pi&&Ze.includes(16);fo=void 0,n(142,Kt=void 0),ai=void 0,zn=void 0,Pn=!1,bn=void 0,br=!1,Qr(),clearTimeout(ie),ie=setTimeout(()=>n(143,Qi=!0),250);const Y=Wr();if(!Y||Ni(Y)&&Ee(Y,"pathClose")||An(),re=Le(Ue(B)),Y&&Ni(Y)&&Ee(Y,"pathClose"))return ue(x);const et=sn(It,re,Cn,Ct=>ga(Ct)),Tt=et.length&&et.shift();if(r&&is(r)&&(Qn(),bi&&(br=!0)),!Tt&&r&&is(r)&&Ji(r),!!Ge(B)){if(Tt&&$a(Tt))return Pn=!0,n(142,Kt=Tt),a?(E&&Ji(Tt),void da(o)):(ai=Li(Kt),void(zn=Ai(Li(Kt),Zt)));if(bn=Tt||void 0,!ue(x)&&Tt){if(Bi(Tt,!0,E),n(142,Kt=Tt),a)return da(o);ai=Li(Kt),zn=Ai(Li(Kt),Zt)}}},x=>{wa(),Xe(x)},x=>{const{translation:B,ctrlKey:E,metaKey:Y,shiftKey:et,position:Tt}=x.detail;if(Kt){if(!cl(Kt)||is(Kt))return;if(et){let Pt=Math.abs(B.x),Mt=Math.abs(B.y);R==="x"&&(Mt-=64),R==="y"&&(Pt-=64),Pt>Mt?(B.y=0,R="x"):Mt>Pt&&(B.x=0,R="y")}else R=null;const Ct=E||Y;return fo?o.every(cl)?void fo.forEach(({shape:Pt,shapeOriginComputed:Mt})=>{wo(Pt,Mt,B,{...li(0,Mr,i,Pt)})}):void 0:wo(Kt,zn,B,{...li(Ct?0:Ui,Mr,i,Kt)})}Yt(x)},x=>{if(wa(),Kt){if(a)return;if(is(Kt)&&So(),x.detail.isTap&&Ni(Kt)&&n2(Kt)){const{position:B}=x.detail,E=Le(Ue(B));return void((Y,et)=>{const Tt=Y.points,Ct=[];for(let Lt=0;Lt<Tt.length-1;Lt++)Ct.push([Tt[Lt],Tt[Lt+1]]);Ct.push([Tt[Tt.length-1],Tt[0]]);const Pt=Ct.findIndex(([Lt,Vt])=>Lu(et,6,Lt,Vt));let Mt;const Rt=[];for(let Lt=0;Lt<Ct.length;Lt++)Rt.push(Ct[Lt][0]),Lt===Pt&&(Mt=Lt+1,Rt.push(et));Ii(Y,{points:Rt,selectedPoint:Mt})})(Kt,E)}x.detail.isTap&&Pn&&tr(Kt)&&Ol(Kt)!==!1&&Xr(Kt)}else Gt(x)},x=>{const B=bn&&x.detail.isTap,E=Pi&&Ze.includes(16);if(x.detail.isTap&&setTimeout(()=>{Fe({target:Kt||bn,position:re},0)}),Kt)return J(Kt),Y=Kt,et=ai,JSON.stringify(Y)!==JSON.stringify(et)&&xe(Kt),void n(142,Kt=void 0);var Y,et;let Tt=!0;if(!E){const Ct=fr();Tt=!Ct||mi(Ct,bn||void 0),Tt&&zi({storePrevious:!1})}hn(x),Tt&&B&&Bi(bn,!0,E)},Ua,x=>{n(143,Qi=!0),n(142,Kt=r),zn=u},x=>{if(!Kt)return void n(143,Qi=!1);const{translation:B,indexes:E,shiftKey:Y,ctrlKey:et,metaKey:Tt,isNudge:Ct}=x.detail;((Pt,Mt,Rt,Lt,Vt)=>{const{shiftKey:qe,snapThreshold:oe=0,gridSize:ne=0,gridRect:fe,snapTargets:$e=[]}=Vt||{},De=oe?(Ye,vn,ln)=>{const{snapTranslation:Fn,snapLines:pi}=eo(kr(Ye),$e,oe,ne,fe);Nr(vn,Fn),jr(pi);const Wn=xr(ln(),vn);Ye.x=Wn.x,Ye.y=Wn.y}:ae;if(ar(Pt)||Ni(Pt)&&Ee(Pt,"pathClose")){const[Ye]=Rt,vn=qe?Dr:(_n,wi)=>wi;let ln,Fn,pi;if(ar(Pt))Ye===0?(ln=()=>rs(Mt),Fn=_n=>vn(os(Mt),_n),pi=(_n,wi)=>{_n.x1=wi.x,_n.y1=wi.y}):Ye===1&&(ln=()=>os(Mt),Fn=_n=>vn(rs(Mt),_n),pi=(_n,wi)=>{_n.x2=wi.x,_n.y2=wi.y});else{const _n=Mt.points;ln=()=>({..._n[Ye]}),Fn=wi=>{const ri=_n[Vu(Ye-1,_n)],Zi=_n[Vu(Ye+1,_n)];vn(ri,wi),vn(Zi,wi)},pi=(wi,ri)=>wi.points=wi.points.map((Zi,di)=>Ye===di?ri:Zi)}const Wn=xr(ln(),Lt);De(Wn,Lt,ln),Fn(Wn),pi(Pt,Wn)}else if(al(Pt)||er(Pt)||vu(Pt)){let Ye,vn,ln=!1;if(er(Pt))Ye=Sp(Mt);else if(al(Pt))Ye=vs(Mt);else{ln=!0,Ye=vs(Mt);const ri=Do(Mt.text,Mt);Ye.height=ri.height}Pt.aspectRatio?vn=Pt.aspectRatio:Vt.shiftKey&&!ln&&(vn=Ye.width/Ye.height);const Fn=vs(Ye),pi=wn(Fn),Wn=Pt.rotation,_n=Mo(Fn),wi=$r(Fn,Wn);if(Rt.length===1){let ri=Rt[0];Pt.flipX&&(ri=ho[ri]),Pt.flipY&&(ri=Er[ri]);const[Zi,di,Vr,Ar]=_n,ao=Ht(wi[ri]),Ka=nr({...ao},Lt),pa=Le(Ka);De(pa,Lt,()=>Le(ao));const Hs=pt(pa.x-wi[ri].x,pa.y-wi[ri].y),Us=Gr(Ue(Hs),-Wn),Ca=pt(_n[ri].x+Us.x,_n[ri].y+Us.y);let Zo;ri===0&&(Zo=Vr),ri===1&&(Zo=Ar),ri===2&&(Zo=Zi),ri===3&&(Zo=di);const Hr=Vi([Zo,Ca]);if(vn){const{width:Ia,height:ha}=Kr(Hr,vn),[Ra,Ja,wr,jn]=pl(Hr);Hr.width=Ia,Hr.height=ha,Ca.y<Zo.y&&(Hr.y=wr-ha),Ca.x<Zo.x&&(Hr.x=Ja-Ia)}const Ma=$r(Hr,Wn,pi),ka=zo(Ma),Ea=Gr(Ma[0],-Wn,ka),Co=Gr(Ma[2],-Wn,ka),Pa=Vi([Ea,Co]);Lo(Pt,er(Pt)?Dm(Pa):Pa,Zt)}else{Rt=Rt.map(jn=>(Pt.flipX&&(jn=ho[jn]),Pt.flipY&&(jn=Er[jn]),jn));const[ri,Zi]=Rt.map(jn=>wi[jn]),di={x:ri.x+.5*(Zi.x-ri.x),y:ri.y+.5*(Zi.y-ri.y)},[Vr,Ar]=Rt.map(jn=>_n[jn]),[ao,Ka]=Rt.map(jn=>{const Xo=jn+2;return Xo<4?_n[Xo]:_n[Xo-4]}),pa={x:ao.x+.5*(Ka.x-ao.x),y:ao.y+.5*(Ka.y-ao.y)},Hs=Ht(di),Us=nr({...Hs},Lt),Ca=Le(Us);De(Ca,Lt,()=>Le(Hs));const Zo=pt(Ca.x-di.x,Ca.y-di.y),Hr=Gr(Ue(Zo),-Wn),Ma=Oi(Ue(Vr),Ar),ka=Eo(Ma,jn=>1-Math.abs(Math.sign(jn))),Ea=pt(Hr.x*ka.x,Hr.y*ka.y);nr(Vr,Ea),nr(Ar,Ea);const Co=Vi(_n);if(vn){let jn=Co.width,Xo=Co.height;ka.y===0?Xo=jn/vn:jn=Xo*vn,Co.width=jn,Co.height=Xo,ka.y===0?Co.y=pa.y-.5*Xo:Co.x=pa.x-.5*jn}const Pa=$r(Co,Wn,pi),Ia=zo(Pa),ha=Gr(Pa[0],-Wn,Ia),Ra=Gr(Pa[2],-Wn,Ia),Ja=Vi([ha,Ra]);let wr;er(Pt)?wr=Dm(Ja):al(Pt)?wr=Ja:ln&&(wr={x:Ja.x,y:Ja.y,width:Ja.width}),Lo(Pt,wr,Zt)}}Fi()})(Kt,zn,E,B,{shiftKey:!Ct&&Y,...li(et||Tt?0:Ui,Mr,i,Kt)}),Rp(Kt)&&yo(B)>16&&Ii(Kt,{selectedPoint:void 0})},x=>{if(!Kt)return void n(143,Qi=!1);Bi(Kt);const{isTap:B,translation:E,indexes:Y}=x.detail;B&&(Rp(Kt)&&Ii(Kt,{selectedPoint:Kt.selectedPoint===Y[0]?void 0:Y[0]}),J(Kt)),n(142,Kt=void 0),n(143,Qi=!1),xe(r)},x=>{Pr=Re(u).origin,n(143,Qi=!0),n(142,Kt=r),zn=u},x=>{if(!Kt)return void n(143,Qi=!1);const{translation:B,shiftKey:E}=x.detail;((Y,et,Tt,Ct)=>{const Pt=ee(Ai(Li(Y),Zt)),Mt=wn(Pt),Rt=xr(Pr,Tt);let Lt=Kd(Rt,Mt)+Math.PI/2;if(Ct.shiftKey){const Vt=Math.PI/16;Lt=Vt*Math.round(Lt/Vt)-Oe%Vt}Lo(Y,{rotation:Lt},Zt),Fi()})(Kt,0,B,{shiftKey:E})},()=>{Kt?(Bi(Kt),n(142,Kt=void 0),n(143,Qi=!1),xe(r)):n(143,Qi=!1)},x=>{const{key:B}=x,E=/escape/i.test(B);if(_i())return E?(x.preventDefault(),x.stopPropagation(),Ji(r)):void(gt&&B==="d"&&(x.metaKey||x.ctrlKey)&&(x.preventDefault(),x.stopPropagation(),Ql()))},x=>{const B=Ol(r,x);return B===!0?x:B},Rr,x=>{const{target:B,key:E}=x,Y=B.value||B.innerText,et=B.selectionStart||0,Tt=B.selectionEnd||Y.length,Ct=Y.substring(0,et)+E+Y.substring(Tt);if(Ol(r,Ct)!==Ct)return x.preventDefault()},x=>_u(r)&&/enter/i.test(x.code)&&r.disableNewline!==!1?x.preventDefault():/arrow/i.test(x.code)?x.stopPropagation():/escape/i.test(x.key)?So():void 0,x=>{const{key:B,ctrlKey:E,altKey:Y}=x;if(/enter/i.test(B)&&(E||Y))return Qn()},Qn,So,xl,x=>{const B=ca();B&&(B.find(is)||B.find(E=>!cl(E))||B.forEach(E=>{n(142,Kt=E),zn=Ai(Li(Kt),Zt),wo(Kt,zn,x.detail)}))},x=>{n(19,Vs=!0)},({relatedTarget:x})=>{x&&x.classList.contains("shape-selector__button")||n(19,Vs=!1)},x=>{if(x.pointerType==="touch"||x.target.className!=="PinturaShapeEditor")return void ke();(Qi||ie)&&vl(void 0);const B=Lh(x,Dn);n(145,qa=Ue(B));const E=Eo(Le(B),et=>Math.round(et));if(ws(E,bl)||(bl=Ue(E),se(Qi,B,E),Qi||ie)||p)return;const[Y]=sn(It,E,0,ga);Y&&lo(Y)||vl(Y)},x=>{x.pointerType!=="touch"&&ke()},Ae,We,de,Oe,Ne,_e,Je,kn,En,Zt,H,Wt,z,Qt,ce,ue,Yt,Gt,hn,Xe,on,xe,Me,Yn,Se,J,Xt,jt,se,Fe,ke,be,mi,si,ge,an,we,Ge,Le,Ht,Pe,Cn,Un,bi,Pi,Ui,yr,gr,Mr,ii,ui,un,rr,Jr,Ao,po,(x,B={})=>{let E,Y,et,Tt=er(x),Ct=tr(x),Pt=B.position==="relative";const Mt=Uo(),Rt=oe=>{if(!Ui)return oe;const ne=Le(oe),{snapTranslation:fe,snapLines:$e}=eo(kr(ne),Mt,Ui,Mr,i);return Nr(oe,fe),jr($e),oe},Lt=!!fr(),Vt=B.isSelection?de:xt,qe=B.inputMode==="step";if(Ni(x)){if(qe){let oe=!1;const ne=(fe,$e)=>{const De=ui(Vt),Ye=fe&&pt(gu(fe.x,Zt.width),gu(fe.y,Zt.height)),vn=Ye&&Ht(Ye);Ze.includes(16)&&vn&&Dr(vn,$e);const ln=Le($e),Fn=De.points.length?De.points[0]:ln,pi=pt(gu(Fn.x,Zt.width),gu(Fn.y,Zt.height)),Wn=Ht(pi),_n=yo(Wn,$e);if(!oe&&De.points.length===1&&_n<36)return rr(Vt);if(De.points.length>2&&_n<=256){De.pathClose=!0,ga(De)&&Bi(De);const Zi=Jr(Vt);return void on(Zi)}const wi=De.strokeWidth&&De.strokeColor&&(De.strokeColor[3]===void 0||De.strokeColor[3]>0),ri=yo(vn,$e);if(wi&&De.points.length>1&&ri<256){De.pathClose=!1,De.backgroundColor=[0,0,0,0],ga(De)&&Bi(De);const Zi=Jr(Vt);on(Zi)}else if(!(De.points.length>0&&ri<100))return Pt?Pc(ln,Zt):ln};return{start:fe=>{const $e=ui(Vt),{origin:De}=fe.detail;if(Y=4,E=Rt(Ue(De)),et=Ue(E),$e){const Ye=$e.points[$e.points.length-1],vn=ne(Ye,E);return vn&&($e.points=[...$e.points,vn]),void Ao({points:$e.points},Vt)}oe=!0},update:fe=>{if(!oe)return;const $e=ui(Vt);if(!$e)return;const De=$e.points[0],Ye=ne(De,pt(E.x+fe.detail.translation.x,E.y+fe.detail.translation.y));Ye&&($e.points[1]=Ye,Ao({points:$e.points},Vt))},release:fe=>fe.detail.preventInertia(),cancel:()=>{rr(Vt)},end:fe=>{if(!oe)return;const $e=Le(E),De=Pt?Pc($e,Zt):$e,{isTap:Ye}=fe.detail;if(Ye&&sn(It,$e,0,ga).length)return rr(Vt);un({...x,points:[De]},Vt)}}}return{start:oe=>{const{origin:ne}=oe.detail;Y=4,E=Ue(ne),et=Ue(E);const fe=Le(E),$e=Pt?Pc(fe,Zt):fe;un({...x,points:[$e]},Vt)},update:oe=>{const ne=ui(Vt);if(!ne)return;const{translation:fe}=oe.detail,$e=pt(E.x+fe.x,E.y+fe.y),De=Yr(et,$e);if(en(De,5)<=Y)return;const Ye=Kd($e,et),vn=Y-De;et.x+=vn*Math.cos(Ye),et.y+=vn*Math.sin(Ye);const ln=Le(et),Fn=Pt?Pc(ln,Zt):ln;Ao({points:ne.points.concat(Fn)},Vt)},release:oe=>oe.detail.preventInertia(),cancel:()=>{rr(Vt)},end:oe=>{const ne=ui(Vt);if(!ne)return;if(oe.detail.isTap){let $e=!1;if(ne.bitmap?(bn&&($e=!0),Lt&&($e=!0)):$e=!0,$e)return rr(Vt)}const fe=Jr(Vt);on(fe)}}}return Tt||Ct||ko(x)?{start:oe=>{const{origin:ne}=oe.detail;E=Rt(Ue(ne));const fe=Le(E),$e=Pt?Pc(fe,Zt):fe,De=-1*ci(Oe,Ne,_e),Ye={...x,rotation:De,...$e};Ye.flipX=Ne,Ye.flipY=_e,delete Ye.position,Ye.opacity=0,(Tt?["rx","ry"]:["width","height"]).forEach(vn=>{Ye[vn]=Pt?"0%":0}),un(Ye,Vt)},update:oe=>{const ne=ui(Vt);if(!ne)return;ne.opacity=1;let{aspectRatio:fe}=ne,{translation:$e,shiftKey:De,ctrlKey:Ye}=oe.detail;!fe&&De&&(fe=1);const vn=Rt(pt(E.x+$e.x,E.y+$e.y)),ln=Le(E),Fn=Le(vn);if(fe){const Vr=Vi([ln,Fn]),Ar=Kr(Vr,fe),ao=Fn.x<ln.x?-1:1,Ka=Fn.y<ln.y?-1:1;Fn.x=ln.x+Ar.width*ao,Fn.y=ln.y+Ar.height*Ka}const pi={x:ln.x+.5*(Fn.x-ln.x),y:ln.y+.5*(Fn.y-ln.y)},Wn=ci(Oe,Ne,_e);Gr(ln,Wn,pi),Gr(Fn,Wn,pi);const _n=Math.min(ln.x,Fn.x),wi=Math.min(ln.y,Fn.y);let ri=Math.max(ln.x,Fn.x)-_n,Zi=Math.max(ln.y,Fn.y)-wi,di={};Tt?(Ye?(di.x=ln.x,di.y=ln.y):(di.x=_n+.5*ri,di.y=wi+.5*Zi),di.rx=.5*ri,di.ry=.5*Zi):(Ye?(di.x=ln.x-.5*ri,di.y=ln.y-.5*Zi):(di.x=_n,di.y=wi),di.width=ri,di.height=Zi),Ao(di,Vt,(Vr,Ar)=>Lo(Vr,Ar,Zt))},release:oe=>{oe.detail.preventInertia()},cancel:()=>{rr(Vt)},end:oe=>{const ne=ui(Vt);if(ne){if(oe.detail.isTap){if(tr(ne)&&bi&&br||!tr(ne)||!bi||bn)return rr(Vt);delete ne.width,delete ne.height,ne.disableNewline!==!1&&delete ne.textAlign;const fe=Ai({...ne},Zt),$e=Do(ne.text,fe),De=Le({x:E.x,y:E.y-.5*$e.height}),Ye=Le({x:E.x+$e.width,y:E.y+.5*$e.height}),vn={x:De.x+.5*(Ye.x-De.x),y:De.y+.5*(Ye.y-De.y)},ln=ci(Oe,Ne,_e);Gr(De,ln,vn),Gr(Ye,ln,vn);let Fn=Math.min(De.x,Ye.x),pi=Math.min(De.y,Ye.y);Fn<0&&(Fn=0),pi<0&&(pi=0),Fn+$e.width>Zt.width&&(Fn=Zt.width-$e.width),pi+$e.height>Zt.height&&(pi=Zt.height-$e.height),ne.x=Qe(ne.x)?Ur(Fn,Zt.width):Fn,ne.y=Qe(ne.y)?Ur(pi,Zt.height):pi}if(ne.opacity=1,tr(ne))on(ne);else{const fe=Jr(Vt);on(fe)}ga(ne)&&Bi(ne),tr(ne)&&Xr(ne)}}}:ar(x)?{start:oe=>{const{origin:ne}=oe.detail,fe=Le(Rt(ne)),$e=Eo(fe,Kc);E=Ue(ne),un({...x,x1:Pt?Ur($e.x,Zt.width):$e.x,y1:Pt?Ur($e.y,Zt.height):$e.y,x2:Pt?Ur($e.x,Zt.width):$e.x,y2:Pt?Ur($e.y,Zt.height):$e.y,opacity:0},Vt)},update:oe=>{if(!ui(Vt))return;const{translation:ne}=oe.detail,fe=Rt(nr(Ue(E),ne));if(Ze.includes(16)){const De=Yr(E,fe),Ye=Kd(E,fe),vn=Math.PI/4,ln=vn*Math.round(Ye/vn);fe.x=E.x+De*Math.cos(ln),fe.y=E.y+De*Math.sin(ln)}const $e=Le(fe);Ao({x2:Pt?Ur($e.x,Zt.width):$e.x,y2:Pt?Ur($e.y,Zt.height):$e.y,opacity:1},Vt)},release:oe=>oe.detail.preventInertia(),cancel:()=>{rr(Vt)},end:oe=>{const ne=ui(Vt);if(!ne)return;if(oe.detail.isTap)return rr(Vt);ne.opacity=1;const fe=Jr(Vt);on(fe),ga(ne)&&Bi(fe)}}:void 0},()=>{let x,B;const E=Pe*Pe,Y=(et,Tt,Ct=!1)=>{const Pt=yo(et,Tt);if(!Ct&&Pt<2)return!1;const Mt=It.filter(Lt=>!Lt.disableErase);let Rt;return Rt=Pt<E?sn(It,Le(Tt),Pe):je(Mt,Le(et),Le(Tt),Pe),io(Rt).forEach(Se),!0};return{start:et=>{x=pt(Math.round(et.detail.origin.x),Math.round(et.detail.origin.y)),Y(x,x,!0),B=x},update:et=>{const{translation:Tt}=et.detail,Ct=pt(Math.round(x.x+Tt.x),Math.round(x.y+Tt.y));Y(B,Ct)&&(B=Ue(Ct))},release:et=>et.detail.preventInertia(),cancel:()=>{rr(collection)},end:()=>{}}},Wr,ji,x=>{if(!Wr())return mh(x),po(x)},An,Wi,(x={})=>({id:ba(),...x}),Fi,gi,Ii,Ki,(x,B,E=!0)=>{It.forEach(Y=>Ki(Y,x,B,!1)),E&&Fi()},Go,ca,mo,_i,zi,Ji,Xr,go,io,L,ee,sn,je,zr,Zr,Kt,Qi,mn,qa,p,rt,r,st,Jt,gt,mt,le,Bt,kt,C,qt,Nt,nt,Be,F,$t,a,o,q,c,ct,K,V,ot,W,i,N,it,M,y,I,O,h,l,w,m,s,It,lt,Ze,nn,function(x){aa.call(this,t,x)},x=>Bi(xt[x]),function(x){Nn[x?"unshift":"push"](()=>{xi=x,n(8,xi)})},function(){bt=this.value,n(24,bt),n(11,at),n(148,r),n(170,ot),n(0,xn),n(184,It)},function(x){Nn[x?"unshift":"push"](()=>{xi=x,n(8,xi)})},()=>{Ya&&Ya.focus()},x=>n(9,gs=x.detail),function(x){Nn[x?"unshift":"push"](()=>{Ya=x,n(20,Ya)})},x=>Lh(x,Dn)]}class dS extends Tn{constructor(e){super(),Sn(this,e,cS,lS,yn,{uid:58,ui:59,disabled:0,shapes:1,selection:60,offset:2,contextRotation:61,contextFlipX:62,contextFlipY:63,contextZoom:64,active:65,opacity:66,parentRect:67,rootRect:3,utilRect:68,hoverColor:69,caretColor:70,gridColor:71,snapColor:72,textInputMode:4,oninteractionstart:73,oninteractionupdate:74,oninteractionrelease:75,oninteractionend:76,oninteractioncancel:77,onaddshape:78,onupdateshape:79,onselectshape:80,onblurshape:81,onremoveshape:82,ontapshape:83,onhovershape:84,ontriggerhistorywrite:85,onhovercanvas:86,ontapcanvas:87,onleavecanvas:88,beforeSelectShape:89,beforeDeselectShape:90,beforeRemoveShape:91,beforeUpdateShape:92,willRenderShapeControls:93,willRenderShapeTextControls:94,willStartInteraction:95,mapEditorPointToImagePoint:96,mapImagePointToEditorPoint:97,eraseRadius:98,selectRadius:99,enableButtonFlipVertical:100,enableTapToAddText:101,enableMultiSelect:102,enableTextStyleControls:5,locale:6,snapThreshold:103,snapPointer:104,enableSnapToContext:105,gridSize:106,syncShapeCollection:107,getShapeDraft:108,addShapeDraft:109,discardShapeDraft:110,confirmShapeDraft:111,updateShapeDraft:112,addShape:113,createShape:114,eraseShape:115,getMarkupItemDraft:116,getMarkupItemDraftIndex:117,addMarkupItemDraft:118,confirmMarkupItemDraft:119,discardMarkupItemDraft:120,createMarkupItem:121,syncShapes:122,removeMarkupShapeProps:123,updateMarkupShape:124,updateMarkupShapeProperty:125,updateMarkupItemsShapeProperty:126,updateMarkupShapeItems:127,getActiveMarkupItems:128,getActiveMarkupItem:129,hasActiveMarkupItem:130,blurShapes:131,selectShape:7,deselectMarkupItem:132,editMarkupItem:133,finishEditMarkupItem:134,removeMarkupItems:135,getTextShapeRect:136,getMarkupShapeRect:137,getShapesNearPosition:138,getShapesBetweenPoints:139},null,[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1])}get syncShapeCollection(){return this.$$.ctx[107]}get getShapeDraft(){return this.$$.ctx[108]}get addShapeDraft(){return this.$$.ctx[109]}get discardShapeDraft(){return this.$$.ctx[110]}get confirmShapeDraft(){return this.$$.ctx[111]}get updateShapeDraft(){return this.$$.ctx[112]}get addShape(){return this.$$.ctx[113]}get createShape(){return this.$$.ctx[114]}get eraseShape(){return this.$$.ctx[115]}get getMarkupItemDraft(){return this.$$.ctx[116]}get getMarkupItemDraftIndex(){return this.$$.ctx[117]}get addMarkupItemDraft(){return this.$$.ctx[118]}get confirmMarkupItemDraft(){return this.$$.ctx[119]}get discardMarkupItemDraft(){return this.$$.ctx[120]}get createMarkupItem(){return this.$$.ctx[121]}get syncShapes(){return this.$$.ctx[122]}get removeMarkupShapeProps(){return this.$$.ctx[123]}get updateMarkupShape(){return this.$$.ctx[124]}get updateMarkupShapeProperty(){return this.$$.ctx[125]}get updateMarkupItemsShapeProperty(){return this.$$.ctx[126]}get updateMarkupShapeItems(){return this.$$.ctx[127]}get getActiveMarkupItems(){return this.$$.ctx[128]}get getActiveMarkupItem(){return this.$$.ctx[129]}get hasActiveMarkupItem(){return this.$$.ctx[130]}get blurShapes(){return this.$$.ctx[131]}get selectShape(){return this.$$.ctx[7]}get deselectMarkupItem(){return this.$$.ctx[132]}get editMarkupItem(){return this.$$.ctx[133]}get finishEditMarkupItem(){return this.$$.ctx[134]}get removeMarkupItems(){return this.$$.ctx[135]}get getTextShapeRect(){return this.$$.ctx[136]}get getMarkupShapeRect(){return this.$$.ctx[137]}get getShapesNearPosition(){return this.$$.ctx[138]}get getShapesBetweenPoints(){return this.$$.ctx[139]}}function uS(t){let e,n,i;return n=new vo({props:{items:t[2]}}),{c(){e=ft("ul"),zt(n.$$.fragment),S(e,"class","PinturaShapeStyleList")},m(r,o){tt(r,e,o),Ft(n,e,null),i=!0},p(r,o){const a={};4&o&&(a.items=r[2]),n.$set(a)},i(r){i||(k(n.$$.fragment,r),i=!0)},o(r){A(n.$$.fragment,r),i=!1},d(r){r&&Q(e),_t(n)}}}function pS(t){let e,n;return e=new us({props:{class:"PinturaShapeStyles",elasticity:t[0],$$slots:{default:[hS]},$$scope:{ctx:t}}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};1&r&&(o.elasticity=i[0]),131076&r&&(o.$$scope={dirty:r,ctx:i}),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function hS(t){let e,n,i;return n=new vo({props:{items:t[2]}}),{c(){e=ft("ul"),zt(n.$$.fragment),S(e,"class","PinturaShapeStyleList")},m(r,o){tt(r,e,o),Ft(n,e,null),i=!0},p(r,o){const a={};4&o&&(a.items=r[2]),n.$set(a)},i(r){i||(k(n.$$.fragment,r),i=!0)},o(r){A(n.$$.fragment,r),i=!1},d(r){r&&Q(e),_t(n)}}}function mS(t){let e,n,i,r;const o=[pS,uS],a=[];function s(l,c){return l[1]?0:1}return n=s(t),i=a[n]=o[n](t),{c(){e=ft("div"),i.c(),S(e,"style",t[3])},m(l,c){tt(l,e,c),a[n].m(e,null),r=!0},p(l,[c]){let d=n;n=s(l),n===d?a[n].p(l,c):(Te(),A(a[d],1,1,()=>{a[d]=null}),Ce(),i=a[n],i?i.p(l,c):(i=a[n]=o[n](l),i.c()),k(i,1),i.m(e,null)),(!r||8&c)&&S(e,"style",l[3])},i(l){r||(k(i),r=!0)},o(l){A(i),r=!1},d(l){l&&Q(e),a[n].d()}}}function gS(t,e,n){let i,r,o,a,s,l,{isActive:c=!1}=e,{controls:d=[]}=e,{locale:u}=e,{scrollElasticity:p}=e,{scrollEnable:h=!0}=e,{hideTitles:y=!1}=e,{willRenderControls:m=ni}=e;const f=yi("redrawTrigger");D(t,f,T=>n(14,a=T));const b=yi("env");D(t,b,T=>n(13,o=T));const v=yi("isAnimated");D(t,v,T=>n(16,l=T));const w=fn(0,{stiffness:.25,damping:.9});return D(t,w,T=>n(15,s=T)),t.$$set=T=>{"isActive"in T&&n(8,c=T.isActive),"controls"in T&&n(9,d=T.controls),"locale"in T&&n(10,u=T.locale),"scrollElasticity"in T&&n(0,p=T.scrollElasticity),"scrollEnable"in T&&n(1,h=T.scrollEnable),"hideTitles"in T&&n(11,y=T.hideTitles),"willRenderControls"in T&&n(12,m=T.willRenderControls)},t.$$.update=()=>{65792&t.$$.dirty&&w.set(c?1:0,{hard:l===!1}),33024&t.$$.dirty&&n(3,i=`opacity:${s};${c?"":"pointer-events:none;"}${s<=0?"visibility:hidden":""}`),32256&t.$$.dirty&&n(2,r=a&&m(d.map(T=>["ShapeStyle",T.id,{title:T.componentProps.title,locale:u,hideTitle:y,items:[[T.component,T.id,T.componentProps]]}]),o,()=>f.set({})))},[p,h,r,i,f,b,v,w,c,d,u,y,m,o,a,s,l]}class fS extends Tn{constructor(e){super(),Sn(this,e,gS,mS,yn,{isActive:8,controls:9,locale:10,scrollElasticity:0,scrollEnable:1,hideTitles:11,willRenderControls:12})}}function J$(t,e,n){const i=t.slice();return i[15]=e[n].key,i[6]=e[n].controls,i[16]=e[n].isActive,i}function Q$(t,e){let n,i,r;return i=new fS({props:{isActive:e[16],controls:e[6],locale:e[1],scrollElasticity:e[2],scrollEnable:e[3],hideTitles:e[4],willRenderControls:e[5]}}),{key:t,first:null,c(){n=Ei(),zt(i.$$.fragment),this.first=n},m(o,a){tt(o,n,a),Ft(i,o,a),r=!0},p(o,a){e=o;const s={};128&a&&(s.isActive=e[16]),128&a&&(s.controls=e[6]),2&a&&(s.locale=e[1]),4&a&&(s.scrollElasticity=e[2]),8&a&&(s.scrollEnable=e[3]),16&a&&(s.hideTitles=e[4]),32&a&&(s.willRenderControls=e[5]),i.$set(s)},i(o){r||(k(i.$$.fragment,o),r=!0)},o(o){A(i.$$.fragment,o),r=!1},d(o){o&&Q(n),_t(i,o)}}}function $S(t){let e,n,i,r=[],o=new Map,a=t[7];const s=l=>l[15];for(let l=0;l<a.length;l+=1){let c=J$(t,a,l),d=s(c);o.set(d,r[l]=Q$(d,c))}return{c(){e=ft("div");for(let l=0;l<r.length;l+=1)r[l].c();S(e,"class",n=rn(["PinturaShapeStyleEditor",!t[3]&&"PinturaShapeStyleEditorOverflow",t[0]]))},m(l,c){tt(l,e,c);for(let d=0;d<r.length;d+=1)r[d].m(e,null);i=!0},p(l,[c]){190&c&&(a=l[7],Te(),r=Va(r,c,s,1,l,a,o,e,_s,Q$,null,J$),Ce()),(!i||9&c&&n!==(n=rn(["PinturaShapeStyleEditor",!l[3]&&"PinturaShapeStyleEditorOverflow",l[0]])))&&S(e,"class",n)},i(l){if(!i){for(let c=0;c<a.length;c+=1)k(r[c]);i=!0}},o(l){for(let c=0;c<r.length;c+=1)A(r[c]);i=!1},d(l){l&&Q(e);for(let c=0;c<r.length;c+=1)r[c].d()}}}function yS(t,e,n){let i,r,o,{class:a}=e,{controls:s={}}=e,{shapeProps:l}=e,{onchange:c}=e,{locale:d}=e,{scrollElasticity:u}=e,{scrollEnable:p=!0}=e,{hideTitles:h=!1}=e,{willRenderControls:y}=e;const m=[];return t.$$set=f=>{"class"in f&&n(0,a=f.class),"controls"in f&&n(6,s=f.controls),"shapeProps"in f&&n(8,l=f.shapeProps),"onchange"in f&&n(9,c=f.onchange),"locale"in f&&n(1,d=f.locale),"scrollElasticity"in f&&n(2,u=f.scrollElasticity),"scrollEnable"in f&&n(3,p=f.scrollEnable),"hideTitles"in f&&n(4,h=f.hideTitles),"willRenderControls"in f&&n(5,y=f.willRenderControls)},t.$$.update=()=>{64&t.$$.dirty&&n(11,i=Object.keys(s).filter(f=>s[f])),2304&t.$$.dirty&&n(10,r=l&&Object.keys(l).length&&i&&gh(l)?(f=>i.filter(b=>b.split("_").every(v=>Ee(f,v)&&gh(f,v))).map(b=>{const v=(f.settings&&f.settings[b]||{}).control||b,w=b.split("_"),T=w.length>1?w.map(C=>f[C]):f[b];if(Si(s[v])){const{title:C,component:F}=s[v](T,G=>{c({[b]:G})},{selectedShapeId:f.id});return{id:v,component:vo,componentProps:{title:C,items:F}}}let[I,P]=s[v];if(Qe(I)&&s[I]){const C={...P};[I,P]=s[I],P={...P,...C}}const _=Si(P.options)?P.options(f):P.options;return I==="RadioGroup"&&(P.selectedIndex=-1),{id:v,component:I,componentProps:{...P,options:_,locale:d,value:T,optionLabelClass:"PinturaButtonLabel",onchange:C=>{const F=Fs(C)&&!qi(C)?C.value:C;P.onchange&&P.onchange(F,f);const G=w.length>1?w.reduce((O,$,N)=>({...O,[$]:Array.isArray(F)?F[N]:F}),{}):{[b]:F};c(G)}}}}).filter(Boolean))(l):[]),1280&t.$$.dirty&&n(7,o=((f,b)=>{let v=m.find(w=>w.key===f);return v||(v={key:f,controls:b},m.push(v)),m.forEach(w=>w.isActive=!1),v.controls=b,v.isActive=!0,m})(l&&Object.keys(l).length?Object.keys(l).join("_"):"none",r||[]))},[a,d,u,p,h,y,s,o,l,c,r,i]}class k0 extends Tn{constructor(e){super(),Sn(this,e,yS,$S,yn,{class:0,controls:6,shapeProps:8,onchange:9,locale:1,scrollElasticity:2,scrollEnable:3,hideTitles:4,willRenderControls:5})}}var xS=t=>/<svg /.test(t);function bS(t){let e,n;return e=new vo({props:{items:t[10]}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};1024&r&&(o.items=i[10]),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function vS(t){let e,n,i,r;const o=[SS,wS],a=[];function s(l,c){return l[8]?0:1}return e=s(t),n=a[e]=o[e](t),{c(){n.c(),i=Ei()},m(l,c){a[e].m(l,c),tt(l,i,c),r=!0},p(l,c){let d=e;e=s(l),e===d?a[e].p(l,c):(Te(),A(a[d],1,1,()=>{a[d]=null}),Ce(),n=a[e],n?n.p(l,c):(n=a[e]=o[e](l),n.c()),k(n,1),n.m(i.parentNode,i))},i(l){r||(k(n),r=!0)},o(l){A(n),r=!1},d(l){a[e].d(l),l&&Q(i)}}}function wS(t){let e,n,i,r,o=t[10]&&ty(t);return i=new us({props:{scrollAutoCancel:t[9],elasticity:t[0],$$slots:{default:[TS]},$$scope:{ctx:t}}}),{c(){e=ft("div"),o&&o.c(),n=pe(),zt(i.$$.fragment),S(e,"class","PinturaShapePresetsFlat")},m(a,s){tt(a,e,s),o&&o.m(e,null),Et(e,n),Ft(i,e,null),r=!0},p(a,s){a[10]?o?(o.p(a,s),1024&s&&k(o,1)):(o=ty(a),o.c(),k(o,1),o.m(e,n)):o&&(Te(),A(o,1,1,()=>{o=null}),Ce());const l={};512&s&&(l.scrollAutoCancel=a[9]),1&s&&(l.elasticity=a[0]),536871070&s&&(l.$$scope={dirty:s,ctx:a}),i.$set(l)},i(a){r||(k(o),k(i.$$.fragment,a),r=!0)},o(a){A(o),A(i.$$.fragment,a),r=!1},d(a){a&&Q(e),o&&o.d(),_t(i)}}}function SS(t){let e,n,i,r,o;n=new us({props:{elasticity:t[0],class:"PinturaShapePresetsGroups",$$slots:{default:[kS]},$$scope:{ctx:t}}});const a=[{class:"PinturaControlPanels"},{panelClass:"PinturaControlPanel"},{panels:t[11]},t[12]];let s={$$slots:{default:[PS,({panel:l,panelIsActive:c})=>({26:l,27:c}),({panel:l,panelIsActive:c})=>(l?67108864:0)|(c?134217728:0)]},$$scope:{ctx:t}};for(let l=0;l<a.length;l+=1)s=ki(s,a[l]);return r=new Qu({props:s}),{c(){e=ft("div"),zt(n.$$.fragment),i=pe(),zt(r.$$.fragment),S(e,"class","PinturaShapePresetsGrouped")},m(l,c){tt(l,e,c),Ft(n,e,null),Et(e,i),Ft(r,e,null),o=!0},p(l,c){const d={};1&c&&(d.elasticity=l[0]),536876128&c&&(d.$$scope={dirty:c,ctx:l}),n.$set(d);const u=6144&c?Tr(a,[a[0],a[1],2048&c&&{panels:l[11]},4096&c&&_r(l[12])]):{};738206239&c&&(u.$$scope={dirty:c,ctx:l}),r.$set(u)},i(l){o||(k(n.$$.fragment,l),k(r.$$.fragment,l),o=!0)},o(l){A(n.$$.fragment,l),A(r.$$.fragment,l),o=!1},d(l){l&&Q(e),_t(n),_t(r)}}}function ty(t){let e,n;return e=new vo({props:{items:t[10]}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};1024&r&&(o.items=i[10]),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function TS(t){let e,n;return e=new y0({props:{items:t[7],onclickitem:t[1],ongrabitem:t[2],ondragitem:t[3],ondropitem:t[4]}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};128&r&&(o.items=i[7]),2&r&&(o.onclickitem=i[1]),4&r&&(o.ongrabitem=i[2]),8&r&&(o.ondragitem=i[3]),16&r&&(o.ondropitem=i[4]),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function ey(t){let e,n;return e=new vo({props:{items:t[10]}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};1024&r&&(o.items=i[10]),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function ny(t){let e,n;return e=new Vo({props:{$$slots:{default:[CS]},$$scope:{ctx:t}}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};805306368&r&&(o.$$scope={dirty:r,ctx:i}),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function CS(t){let e,n=t[28].icon+"";return{c(){e=Or("g")},m(i,r){tt(i,e,r),e.innerHTML=n},p(i,r){268435456&r&&n!==(n=i[28].icon+"")&&(e.innerHTML=n)},d(i){i&&Q(e)}}}function iy(t){let e,n,i=t[28].label+"";return{c(){e=ft("span"),n=Mi(i)},m(r,o){tt(r,e,o),Et(e,n)},p(r,o){268435456&o&&i!==(i=r[28].label+"")&&Yi(n,i)},d(r){r&&Q(e)}}}function MS(t){let e,n,i,r=t[28].icon&&ny(t),o=!t[28].hideLabel&&iy(t);return{c(){r&&r.c(),e=pe(),o&&o.c(),n=Ei()},m(a,s){r&&r.m(a,s),tt(a,e,s),o&&o.m(a,s),tt(a,n,s),i=!0},p(a,s){a[28].icon?r?(r.p(a,s),268435456&s&&k(r,1)):(r=ny(a),r.c(),k(r,1),r.m(e.parentNode,e)):r&&(Te(),A(r,1,1,()=>{r=null}),Ce()),a[28].hideLabel?o&&(o.d(1),o=null):o?o.p(a,s):(o=iy(a),o.c(),o.m(n.parentNode,n))},i(a){i||(k(r),i=!0)},o(a){A(r),i=!1},d(a){r&&r.d(a),a&&Q(e),o&&o.d(a),a&&Q(n)}}}function kS(t){let e,n,i,r=t[10]&&ey(t);const o=[{class:"PinturaControlList"},{tabs:t[5]},t[12],{layout:"compact"}];let a={$$slots:{default:[MS,({tab:s})=>({28:s}),({tab:s})=>s?268435456:0]},$$scope:{ctx:t}};for(let s=0;s<o.length;s+=1)a=ki(a,o[s]);return n=new Ju({props:a}),n.$on("select",t[18]),{c(){r&&r.c(),e=pe(),zt(n.$$.fragment)},m(s,l){r&&r.m(s,l),tt(s,e,l),Ft(n,s,l),i=!0},p(s,l){s[10]?r?(r.p(s,l),1024&l&&k(r,1)):(r=ey(s),r.c(),k(r,1),r.m(e.parentNode,e)):r&&(Te(),A(r,1,1,()=>{r=null}),Ce());const c=4128&l?Tr(o,[o[0],32&l&&{tabs:s[5]},4096&l&&_r(s[12]),o[3]]):{};805306368&l&&(c.$$scope={dirty:l,ctx:s}),n.$set(c)},i(s){i||(k(r),k(n.$$.fragment,s),i=!0)},o(s){A(r),A(n.$$.fragment,s),i=!1},d(s){r&&r.d(s),s&&Q(e),_t(n,s)}}}function ES(t){let e,n;return e=new y0({props:{items:t[13][t[26]].items,disabled:t[13][t[26]].disabled,onclickitem:t[1],ongrabitem:t[2],ondragitem:t[3],ondropitem:t[4]}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};67117056&r&&(o.items=i[13][i[26]].items),67117056&r&&(o.disabled=i[13][i[26]].disabled),2&r&&(o.onclickitem=i[1]),4&r&&(o.ongrabitem=i[2]),8&r&&(o.ondragitem=i[3]),16&r&&(o.ondropitem=i[4]),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function PS(t){let e,n;return e=new us({props:{scroll:t[27]?{scrollOffset:0,animate:!1}:void 0,scrollAutoCancel:t[9],elasticity:t[0],$$slots:{default:[ES]},$$scope:{ctx:t}}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};134217728&r&&(o.scroll=i[27]?{scrollOffset:0,animate:!1}:void 0),512&r&&(o.scrollAutoCancel=i[9]),1&r&&(o.elasticity=i[0]),603987998&r&&(o.$$scope={dirty:r,ctx:i}),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function IS(t){let e,n,i,r;const o=[vS,bS],a=[];function s(l,c){return l[9]?0:l[10]?1:-1}return~(n=s(t))&&(i=a[n]=o[n](t)),{c(){e=ft("div"),i&&i.c(),S(e,"class","PinturaShapePresetsPalette")},m(l,c){tt(l,e,c),~n&&a[n].m(e,null),r=!0},p(l,[c]){let d=n;n=s(l),n===d?~n&&a[n].p(l,c):(i&&(Te(),A(a[d],1,1,()=>{a[d]=null}),Ce()),~n?(i=a[n],i?i.p(l,c):(i=a[n]=o[n](l),i.c()),k(i,1),i.m(e,null)):i=null)},i(l){r||(k(i),r=!0)},o(l){A(i),r=!1},d(l){l&&Q(e),~n&&a[n].d()}}}function RS(t,e,n){let i,r,o,a,s,l,c,d,u,{locale:p}=e,{presets:h}=e,{scrollElasticity:y}=e,{enableSelectImage:m=!0}=e,{willRenderPresetToolbar:f=ni}=e,{onaddpreset:b=ae}=e,{ongrabpreset:v}=e,{ondragpreset:w}=e,{ondroppreset:T}=e;const I="presets-"+ba(),P=(G,O="")=>xS(G)?G:Fu(G)?qy(G,O):`<img src="${G}" alt="${O}"/>`,_=G=>Iy(Gh(G)),C=["src","alt","thumb","shape","id","mount","disabled"],F=G=>G.map(O=>($=>qi($)&&Qe($[0])&&qi($[1]))(O)?{...O[2],id:`${I}-${O[0].toLowerCase()}`,label:O[0],items:F(O[1])}:($=>{let N,it,M,W,ot,at,q,ct=$;return Qe($)?Fu($)?(N=$,ot=$,W=P(N,ot)):(N=$,ot=_(N),W=P(N,ot)):(N=$.src,ot=$.alt||(Qe(N)?_(N):Qe($.thumb)?_($.thumb):void 0),W=P($.thumb||N,ot),it=$.shape,at=$.mount,q=$.disabled,M=Object.keys($).reduce((V,ut)=>(C.includes(ut)||(V[ut]=$[ut]),V),{})),{id:ct,src:N,thumb:W,shape:it,shapeProps:M,alt:ot,title:ot,mount:at,disabled:q}})(O));return t.$$set=G=>{"locale"in G&&n(14,p=G.locale),"presets"in G&&n(15,h=G.presets),"scrollElasticity"in G&&n(0,y=G.scrollElasticity),"enableSelectImage"in G&&n(16,m=G.enableSelectImage),"willRenderPresetToolbar"in G&&n(17,f=G.willRenderPresetToolbar),"onaddpreset"in G&&n(1,b=G.onaddpreset),"ongrabpreset"in G&&n(2,v=G.ongrabpreset),"ondragpreset"in G&&n(3,w=G.ondragpreset),"ondroppreset"in G&&n(4,T=G.ondroppreset)},t.$$.update=()=>{32768&t.$$.dirty&&n(7,i=F(h)),128&t.$$.dirty&&n(9,r=i.length),640&t.$$.dirty&&n(8,o=r&&i.some(G=>!!G.items)),384&t.$$.dirty&&n(5,a=o&&i),384&t.$$.dirty&&n(13,s=o&&i.reduce((G,O)=>(G[O.id]=O,G),{})),96&t.$$.dirty&&n(6,l=l||a&&(a.find(G=>!G.disabled)||{}).id),64&t.$$.dirty&&n(12,c={name:I,selected:l}),32&t.$$.dirty&&n(11,d=a&&a.map(G=>G.id)),212994&t.$$.dirty&&n(10,u=p&&f([m&&["Button","browse",{label:p.shapeLabelButtonSelectSticker,icon:p.shapeIconButtonSelectSticker,onclick:()=>{ux().then(G=>{G&&b(G)})}}]]))},[y,b,v,w,T,a,l,i,o,r,u,d,c,s,p,h,m,f,({detail:G})=>n(6,l=G)]}class Mx extends Tn{constructor(e){super(),Sn(this,e,RS,IS,yn,{locale:14,presets:15,scrollElasticity:0,enableSelectImage:16,willRenderPresetToolbar:17,onaddpreset:1,ongrabpreset:2,ondragpreset:3,ondroppreset:4})}}function AS(t){let e,n,i,r;return e=new vo({props:{items:t[30]}}),i=new k0({props:{locale:t[4],shapeProps:t[49],onchange:t[85],controls:t[9],scrollEnable:!1,hideTitles:!0,willRenderControls:t[165]}}),{c(){zt(e.$$.fragment),n=pe(),zt(i.$$.fragment)},m(o,a){Ft(e,o,a),tt(o,n,a),Ft(i,o,a),r=!0},p(o,a){const s={};1073741824&a[0]&&(s.items=o[30]),e.$set(s);const l={};16&a[0]&&(l.locale=o[4]),262144&a[1]&&(l.shapeProps=o[49]),512&a[0]&&(l.controls=o[9]),i.$set(l)},i(o){r||(k(e.$$.fragment,o),k(i.$$.fragment,o),r=!0)},o(o){A(e.$$.fragment,o),A(i.$$.fragment,o),r=!1},d(o){_t(e,o),o&&Q(n),_t(i,o)}}}function LS(t){let e,n,i;return n=new Sx({props:{$$slots:{default:[AS]},$$scope:{ctx:t}}}),{c(){e=ft("div"),zt(n.$$.fragment),S(e,"slot","header")},m(r,o){tt(r,e,o),Ft(n,e,null),i=!0},p(r,o){const a={};1073742352&o[0]|262144&o[1]|67108864&o[6]&&(a.$$scope={dirty:o,ctx:r}),n.$set(a)},i(r){i||(k(n.$$.fragment,r),i=!0)},o(r){A(n.$$.fragment,r),i=!1},d(r){r&&Q(e),_t(n)}}}function ry(t){let e,n;const i=[{locale:t[4]},{ui:t[69]},{shapes:t[5]},{selection:t[58]},{uid:t[20]},{parentRect:t[37]},{rootRect:t[55]},{utilRect:t[39]},{offset:t[50]},{disabled:t[38]},{contextRotation:t[23]},{contextFlipX:t[24]},{contextFlipY:t[25]},{contextZoom:t[36]?t[36].scale:void 0},{active:t[35]},{opacity:t[56]},{hoverColor:t[57]},{caretColor:t[57]},{snapColor:t[57]},{gridColor:[1,1,1,.125]},{eraseRadius:t[47]},{selectRadius:t[6]},{enableButtonFlipVertical:t[10]},{enableMultiSelect:t[14]},{mapEditorPointToImagePoint:t[21]},{mapImagePointToEditorPoint:t[22]},{enableTapToAddText:t[13]},{textInputMode:t[8]},{snapThreshold:t[16]},{snapPointer:!t[48]},{enableSnapToContext:t[17]},{gridSize:t[15]},{willStartInteraction:t[95]},{oninteractionstart:t[79]},{oninteractionupdate:t[80]},{oninteractionrelease:t[81]},{oninteractionend:t[83]},{oninteractioncancel:t[82]},{onleavecanvas:t[87]},{onhovercanvas:t[86]},{onhovershape:t[89]},{ontapcanvas:t[88]},{onaddshape:t[156]},{onselectshape:t[157]},{onblurshape:t[158]},{ontapshape:t[159]},{onupdateshape:t[160]},{onremoveshape:t[161]},{ontriggerhistorywrite:t[162]},t[42]];let r={};for(let o=0;o<i.length;o+=1)r=ki(r,i[o]);return e=new dS({props:r}),t[163](e),{c(){zt(e.$$.fragment)},m(o,a){Ft(e,o,a),n=!0},p(o,a){const s=66315632&a[0]|252381681&a[1]|255721600&a[2]|12&a[3]?Tr(i,[16&a[0]&&{locale:o[4]},128&a[2]&&{ui:o[69]},32&a[0]&&{shapes:o[5]},134217728&a[1]&&{selection:o[58]},1048576&a[0]&&{uid:o[20]},64&a[1]&&{parentRect:o[37]},16777216&a[1]&&{rootRect:o[55]},256&a[1]&&{utilRect:o[39]},524288&a[1]&&{offset:o[50]},128&a[1]&&{disabled:o[38]},8388608&a[0]&&{contextRotation:o[23]},16777216&a[0]&&{contextFlipX:o[24]},33554432&a[0]&&{contextFlipY:o[25]},32&a[1]&&{contextZoom:o[36]?o[36].scale:void 0},16&a[1]&&{active:o[35]},33554432&a[1]&&{opacity:o[56]},67108864&a[1]&&{hoverColor:o[57]},67108864&a[1]&&{caretColor:o[57]},67108864&a[1]&&{snapColor:o[57]},i[19],65536&a[1]&&{eraseRadius:o[47]},64&a[0]&&{selectRadius:o[6]},1024&a[0]&&{enableButtonFlipVertical:o[10]},16384&a[0]&&{enableMultiSelect:o[14]},2097152&a[0]&&{mapEditorPointToImagePoint:o[21]},4194304&a[0]&&{mapImagePointToEditorPoint:o[22]},8192&a[0]&&{enableTapToAddText:o[13]},256&a[0]&&{textInputMode:o[8]},65536&a[0]&&{snapThreshold:o[16]},131072&a[1]&&{snapPointer:!o[48]},131072&a[0]&&{enableSnapToContext:o[17]},32768&a[0]&&{gridSize:o[15]},4&a[3]&&{willStartInteraction:o[95]},131072&a[2]&&{oninteractionstart:o[79]},262144&a[2]&&{oninteractionupdate:o[80]},524288&a[2]&&{oninteractionrelease:o[81]},2097152&a[2]&&{oninteractionend:o[83]},1048576&a[2]&&{oninteractioncancel:o[82]},33554432&a[2]&&{onleavecanvas:o[87]},16777216&a[2]&&{onhovercanvas:o[86]},134217728&a[2]&&{onhovershape:o[89]},67108864&a[2]&&{ontapcanvas:o[88]},1&a[1]|8&a[3]&&{onaddshape:o[156]},1&a[1]&&{onselectshape:o[157]},1&a[1]&&{onblurshape:o[158]},1&a[1]&&{ontapshape:o[159]},1&a[1]|8&a[3]&&{onupdateshape:o[160]},1&a[1]|8&a[3]&&{onremoveshape:o[161]},8&a[3]&&{ontriggerhistorywrite:o[162]},2048&a[1]&&_r(o[42])]):{};e.$set(s)},i(o){n||(k(e.$$.fragment,o),n=!0)},o(o){A(e.$$.fragment,o),n=!1},d(o){t[163](null),_t(e,o)}}}function OS(t){let e,n,i,r,o,a=t[51]&&ry(t);return{c(){e=ft("div"),a&&a.c(),S(e,"slot","main"),S(e,"style",n="cursor:"+t[46])},m(s,l){tt(s,e,l),a&&a.m(e,null),t[164](e),i=!0,r||(o=[St(e,"keydown",t[84]),qn(q2.call(null,e)),St(e,"dropfiles",function(){Hn(t[12]?t[94]:ae)&&(t[12]?t[94]:ae).apply(this,arguments)}),qn(Cr.call(null,e)),St(e,"measure",t[152])],r=!0)},p(s,l){(t=s)[51]?a?(a.p(t,l),1048576&l[1]&&k(a,1)):(a=ry(t),a.c(),k(a,1),a.m(e,null)):a&&(Te(),A(a,1,1,()=>{a=null}),Ce()),(!i||32768&l[1]&&n!==(n="cursor:"+t[46]))&&S(e,"style",n)},i(s){i||(k(a),i=!0)},o(s){A(a),i=!1},d(s){s&&Q(e),a&&a.d(),t[164](null),r=!1,Zn(o)}}}function FS(t){let e,n;return e=new Mx({props:{locale:t[4],presets:t[19],enableSelectImage:t[11],willRenderPresetToolbar:t[43],onaddpreset:t[93],ongrabpreset:t[90],ondragpreset:t[91],ondroppreset:t[92],scrollElasticity:t[44]}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};16&r[0]&&(o.locale=i[4]),524288&r[0]&&(o.presets=i[19]),2048&r[0]&&(o.enableSelectImage=i[11]),4096&r[1]&&(o.willRenderPresetToolbar=i[43]),8192&r[1]&&(o.scrollElasticity=i[44]),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function _S(t){let e,n,i,r=t[7]==="stack"&&oy(t),o=(t[53]&&t[34]||t[7]==="row")&&ay(t);return{c(){r&&r.c(),e=pe(),o&&o.c(),n=Ei()},m(a,s){r&&r.m(a,s),tt(a,e,s),o&&o.m(a,s),tt(a,n,s),i=!0},p(a,s){a[7]==="stack"?r?(r.p(a,s),128&s[0]&&k(r,1)):(r=oy(a),r.c(),k(r,1),r.m(e.parentNode,e)):r&&(Te(),A(r,1,1,()=>{r=null}),Ce()),a[53]&&a[34]||a[7]==="row"?o?(o.p(a,s),128&s[0]|4194312&s[1]&&k(o,1)):(o=ay(a),o.c(),k(o,1),o.m(n.parentNode,n)):o&&(Te(),A(o,1,1,()=>{o=null}),Ce())},i(a){i||(k(r),k(o),i=!0)},o(a){A(r),A(o),i=!1},d(a){r&&r.d(a),a&&Q(e),o&&o.d(a),a&&Q(n)}}}function oy(t){let e,n,i,r;const o=[zS,DS],a=[];function s(l,c){return l[45]?0:1}return n=s(t),i=a[n]=o[n](t),{c(){e=ft("div"),i.c(),S(e,"class","PinturaControlPanels")},m(l,c){tt(l,e,c),a[n].m(e,null),r=!0},p(l,c){let d=n;n=s(l),n===d?a[n].p(l,c):(Te(),A(a[d],1,1,()=>{a[d]=null}),Ce(),i=a[n],i?i.p(l,c):(i=a[n]=o[n](l),i.c()),k(i,1),i.m(e,null))},i(l){r||(k(i),r=!0)},o(l){A(i),r=!1},d(l){l&&Q(e),a[n].d()}}}function DS(t){let e,n,i;return n=new k0({props:{locale:t[4],shapeProps:t[49],onchange:t[85],controls:t[9],scrollElasticity:t[44],willRenderControls:t[18]}}),{c(){e=ft("div"),zt(n.$$.fragment),S(e,"class","PinturaControlPanel")},m(r,o){tt(r,e,o),Ft(n,e,null),i=!0},p(r,o){const a={};16&o[0]&&(a.locale=r[4]),262144&o[1]&&(a.shapeProps=r[49]),512&o[0]&&(a.controls=r[9]),8192&o[1]&&(a.scrollElasticity=r[44]),262144&o[0]&&(a.willRenderControls=r[18]),n.$set(a)},i(r){i||(k(n.$$.fragment,r),i=!0)},o(r){A(n.$$.fragment,r),i=!1},d(r){r&&Q(e),_t(n)}}}function zS(t){let e,n,i;return n=new Mx({props:{locale:t[4],presets:t[19],enableSelectImage:t[11],willRenderPresetToolbar:t[43],onaddpreset:t[93],ongrabpreset:t[90],ondragpreset:t[91],ondroppreset:t[92],scrollElasticity:t[44]}}),{c(){e=ft("div"),zt(n.$$.fragment),S(e,"class","PinturaControlPanel")},m(r,o){tt(r,e,o),Ft(n,e,null),i=!0},p(r,o){const a={};16&o[0]&&(a.locale=r[4]),524288&o[0]&&(a.presets=r[19]),2048&o[0]&&(a.enableSelectImage=r[11]),4096&o[1]&&(a.willRenderPresetToolbar=r[43]),8192&o[1]&&(a.scrollElasticity=r[44]),n.$set(a)},i(r){i||(k(n.$$.fragment,r),i=!0)},o(r){A(n.$$.fragment,r),i=!1},d(r){r&&Q(e),_t(n)}}}function ay(t){let e,n;return e=new us({props:{class:"PinturaControlListScroller",elasticity:t[44],$$slots:{default:[WS]},$$scope:{ctx:t}}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};8192&r[1]&&(o.elasticity=i[44]),262801&r[0]|262154&r[1]|67108864&r[6]&&(o.$$scope={dirty:r,ctx:i}),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function sy(t){let e,n;return e=new fl({props:{locale:t[4],class:"PinturaControlList",optionClass:"PinturaControlListOption",layout:"row",options:t[32],selectedIndex:t[32].findIndex(t[153]),onchange:t[78],$$slots:{option:[NS,({option:i})=>({211:i}),({option:i})=>[0,0,0,0,0,0,i?33554432:0]]},$$scope:{ctx:t}}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};16&r[0]&&(o.locale=i[4]),2&r[1]&&(o.options=i[32]),1&r[0]|2&r[1]&&(o.selectedIndex=i[32].findIndex(i[153])),16&r[0]|100663296&r[6]&&(o.$$scope={dirty:r,ctx:i}),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function ly(t){let e,n;return e=new Vo({props:{$$slots:{default:[BS]},$$scope:{ctx:t}}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};16&r[0]|100663296&r[6]&&(o.$$scope={dirty:r,ctx:i}),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function BS(t){let e,n=(Si(t[211].icon)?t[211].icon(t[4]):t[211].icon)+"";return{c(){e=Or("g")},m(i,r){tt(i,e,r),e.innerHTML=n},p(i,r){16&r[0]|33554432&r[6]&&n!==(n=(Si(i[211].icon)?i[211].icon(i[4]):i[211].icon)+"")&&(e.innerHTML=n)},d(i){i&&Q(e)}}}function cy(t){let e,n,i=(Si(t[211].label)?t[211].label(t[4]):t[211].label)+"";return{c(){e=ft("span"),n=Mi(i)},m(r,o){tt(r,e,o),Et(e,n)},p(r,o){16&o[0]|33554432&o[6]&&i!==(i=(Si(r[211].label)?r[211].label(r[4]):r[211].label)+"")&&Yi(n,i)},d(r){r&&Q(e)}}}function NS(t){let e,n,i,r=t[211].icon&&ly(t),o=!t[211].hideLabel&&cy(t);return{c(){e=ft("div"),r&&r.c(),n=pe(),o&&o.c(),S(e,"slot","option")},m(a,s){tt(a,e,s),r&&r.m(e,null),Et(e,n),o&&o.m(e,null),i=!0},p(a,s){a[211].icon?r?(r.p(a,s),33554432&s[6]&&k(r,1)):(r=ly(a),r.c(),k(r,1),r.m(e,n)):r&&(Te(),A(r,1,1,()=>{r=null}),Ce()),a[211].hideLabel?o&&(o.d(1),o=null):o?o.p(a,s):(o=cy(a),o.c(),o.m(e,null))},i(a){i||(k(r),i=!0)},o(a){A(r),i=!1},d(a){a&&Q(e),r&&r.d(),o&&o.d()}}}function dy(t){let e,n;return e=new k0({props:{locale:t[4],shapeProps:t[49],onchange:t[85],controls:t[9],scrollEnable:!1,hideTitles:!0,willRenderControls:t[154]}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};16&r[0]&&(o.locale=i[4]),262144&r[1]&&(o.shapeProps=i[49]),512&r[0]&&(o.controls=i[9]),262144&r[0]&&(o.willRenderControls=i[154]),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function WS(t){let e,n,i,r=t[34]&&sy(t),o=t[7]==="row"&&dy(t);return{c(){r&&r.c(),e=pe(),o&&o.c(),n=Ei()},m(a,s){r&&r.m(a,s),tt(a,e,s),o&&o.m(a,s),tt(a,n,s),i=!0},p(a,s){a[34]?r?(r.p(a,s),8&s[1]&&k(r,1)):(r=sy(a),r.c(),k(r,1),r.m(e.parentNode,e)):r&&(Te(),A(r,1,1,()=>{r=null}),Ce()),a[7]==="row"?o?(o.p(a,s),128&s[0]&&k(o,1)):(o=dy(a),o.c(),k(o,1),o.m(n.parentNode,n)):o&&(Te(),A(o,1,1,()=>{o=null}),Ce())},i(a){i||(k(r),k(o),i=!0)},o(a){A(r),A(o),i=!1},d(a){r&&r.d(a),a&&Q(e),o&&o.d(a),a&&Q(n)}}}function uy(t){let e,n;return e=new us({props:{class:"PinturaControlListScroller",elasticity:t[44],$$slots:{default:[US]},$$scope:{ctx:t}}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};8192&r[1]&&(o.elasticity=i[44]),134217744&r[0]|8388608&r[1]|67108864&r[6]&&(o.$$scope={dirty:r,ctx:i}),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function py(t){let e,n;return e=new Vo({props:{$$slots:{default:[VS]},$$scope:{ctx:t}}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};16&r[0]|100663296&r[6]&&(o.$$scope={dirty:r,ctx:i}),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function VS(t){let e,n=(Si(t[211].icon)?t[211].icon(t[4]):t[211].icon)+"";return{c(){e=Or("g")},m(i,r){tt(i,e,r),e.innerHTML=n},p(i,r){16&r[0]|33554432&r[6]&&n!==(n=(Si(i[211].icon)?i[211].icon(i[4]):i[211].icon)+"")&&(e.innerHTML=n)},d(i){i&&Q(e)}}}function HS(t){let e,n,i,r,o,a=(Si(t[211].label)?t[211].label(t[4]):t[211].label)+"",s=t[211].icon&&py(t);return{c(){e=ft("div"),s&&s.c(),n=pe(),i=ft("span"),r=Mi(a),S(e,"slot","option")},m(l,c){tt(l,e,c),s&&s.m(e,null),Et(e,n),Et(e,i),Et(i,r),o=!0},p(l,c){l[211].icon?s?(s.p(l,c),33554432&c[6]&&k(s,1)):(s=py(l),s.c(),k(s,1),s.m(e,n)):s&&(Te(),A(s,1,1,()=>{s=null}),Ce()),(!o||16&c[0]|33554432&c[6])&&a!==(a=(Si(l[211].label)?l[211].label(l[4]):l[211].label)+"")&&Yi(r,a)},i(l){o||(k(s),o=!0)},o(l){A(s),o=!1},d(l){l&&Q(e),s&&s.d()}}}function US(t){let e,n;return e=new fl({props:{locale:t[4],class:"PinturaControlList",optionClass:"PinturaControlListOption",layout:"row",options:t[54],selectedIndex:t[54].findIndex(t[155]),onchange:t[77],$$slots:{option:[HS,({option:i})=>({211:i}),({option:i})=>[0,0,0,0,0,0,i?33554432:0]]},$$scope:{ctx:t}}}),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};16&r[0]&&(o.locale=i[4]),8388608&r[1]&&(o.options=i[54]),134217728&r[0]|8388608&r[1]&&(o.selectedIndex=i[54].findIndex(i[155])),16&r[0]|100663296&r[6]&&(o.$$scope={dirty:r,ctx:i}),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function GS(t){let e,n,i,r,o;const a=[_S,FS],s=[];function l(d,u){return d[52]?0:d[45]?1:-1}~(n=l(t))&&(i=s[n]=a[n](t));let c=t[33]&&uy(t);return{c(){e=ft("div"),i&&i.c(),r=pe(),c&&c.c(),S(e,"slot","footer"),S(e,"style",t[40])},m(d,u){tt(d,e,u),~n&&s[n].m(e,null),Et(e,r),c&&c.m(e,null),o=!0},p(d,u){let p=n;n=l(d),n===p?~n&&s[n].p(d,u):(i&&(Te(),A(s[p],1,1,()=>{s[p]=null}),Ce()),~n?(i=s[n],i?i.p(d,u):(i=s[n]=a[n](d),i.c()),k(i,1),i.m(e,r)):i=null),d[33]?c?(c.p(d,u),4&u[1]&&k(c,1)):(c=uy(d),c.c(),k(c,1),c.m(e,null)):c&&(Te(),A(c,1,1,()=>{c=null}),Ce()),(!o||512&u[1])&&S(e,"style",d[40])},i(d){o||(k(i),k(c),o=!0)},o(d){A(i),A(c),o=!1},d(d){d&&Q(e),~n&&s[n].d(),c&&c.d()}}}function jS(t){let e,n;return e=new i1({props:{hasHeader:t[41],$$slots:{footer:[GS],main:[OS],header:[LS]},$$scope:{ctx:t}}}),e.$on("measure",t[166]),{c(){zt(e.$$.fragment)},m(i,r){Ft(e,i,r),n=!0},p(i,r){const o={};1024&r[1]&&(o.hasHeader=i[41]),2080374769&r[0]|134216703&r[1]|67108864&r[6]&&(o.$$scope={dirty:r,ctx:i}),e.$set(o)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){_t(e,i)}}}function ZS(t,e,n){let i,r,o,a,s,l,c,d,u,p,h,y,m,f,b,v,w,T,I,P,_,C,F,G,O,$,N,it,M,W,ot,at,q,ct,V,ut,bt,K,vt,X,Z,mt,Bt,st,gt,Jt,le,rt,kt,Nt,$t,Be,nt,Ut,qt,Dt,ve,It,Ie,lt,Ze,nn,he,Ke,Ae,We,xn,xt,de=tn,Ve=()=>(de(),de=xo(H,L=>n(35,gt=L)),H),Oe=tn,Ne=()=>(Oe(),Oe=xo(ye,L=>n(145,kt=L)),ye),_e=tn,Je=()=>(_e(),_e=xo(Ui,L=>n(37,Dt=L)),Ui),kn=tn,En=()=>(kn(),kn=xo(z,L=>n(151,Ke=L)),z),Zt=tn,Dn=()=>(Zt(),Zt=xo(Wt,L=>n(56,xn=L)),Wt);t.$$.on_destroy.push(()=>de()),t.$$.on_destroy.push(()=>Oe()),t.$$.on_destroy.push(()=>_e()),t.$$.on_destroy.push(()=>kn()),t.$$.on_destroy.push(()=>Zt());let{isActive:H}=e;Ve();let{isActiveFraction:Wt}=e;Dn();let{isVisible:z}=e;En();let{stores:Qt}=e,{locale:ce={}}=e,{shapes:ye}=e;Ne();let{toolbar:ue=[]}=e,{toolShapes:Yt={}}=e,{toolActive:Gt}=e,{toolSelectRadius:hn}=e,{toolRetainStyles:Xe=!1}=e,{toolbarLayout:on="stack"}=e,{textInputMode:xe}=e,{shapeControls:Me={}}=e,{enableButtonFlipVertical:Yn=!1}=e,{enablePresetSelectImage:Se=!0}=e,{enablePresetDropImage:J=!0}=e,{enableSelectToolToAddShape:Xt=!1}=e,{enableAutoSelectMoveTool:jt=["line","arrow","path","rectangle","ellipse","text"]}=e,{enableTapToAddText:se=!1}=e,{enableMoveTool:Fe=!1}=e,{enableViewTool:ke=!1}=e,{enableToolShareStyles:be=!0}=e,{enableMultiSelect:mi=!1}=e,{gridSize:si=0}=e,{snapThreshold:ge=0}=e,{enableSnapToContext:an=!0}=e,{willRenderHeaderTools:we=ni}=e,{willRenderPresetToolbar:Ge}=e,{willRenderShapeStyleControls:Le}=e,{willStartInteraction:Ht}=e,{shapePresets:Pe=[]}=e,{utilKey:Cn}=e,{mapScreenPointToImagePoint:Un}=e,{mapImagePointToScreenPoint:bi}=e,{imageRotation:Pi=0}=e,{imageFlipX:Hi=!1}=e,{imageFlipY:Xn=!1}=e,{parentRect:Ui}=e;Je();let{hooks:yr={}}=e;const gr=yi("selection");D(t,gr,L=>n(150,Ze=L));const Mr=yi("isAnimated");D(t,Mr,L=>n(142,Jt=L));const Uo=yi("elasticityMultiplier");D(t,Uo,L=>n(146,Nt=L));const li=yi("ui");D(t,li,L=>n(176,nn=L));const uo=yi("keysPressed");let ii;D(t,uo,L=>n(149,lt=L));const{env:ui,history:un,rootRect:rr,rootColorSecondary:Jr,enablePanInput:Ao,enablePanInputStatus:po,enableZoomInput:Lo,stageRect:Dr,utilRectPadded:Gi,scrollElasticity:ci,imageOverlayMarkup:jr,imagePreviewModifiers:Qr,imageCropRect:zr,shapePreprocessor:Zr,stageScalar:xr,imageSelectionRect:to,imageTransformsInterpolated:kr,imageSelectionPan:Br,imageSize:eo,allowPan:Nr,allowZoom:wo,allowZoomControls:ho,allowPlayPause:Er}=Qt;D(t,ui,L=>n(143,le=L)),D(t,rr,L=>n(55,We=L)),D(t,Jr,L=>n(57,xt=L)),D(t,po,L=>n(38,It=L)),D(t,Dr,L=>n(147,$t=L)),D(t,Gi,L=>n(39,he=L)),D(t,Qr,L=>n(177,Ae=L)),D(t,zr,L=>n(175,ve=L)),D(t,xr,L=>n(173,Ut=L)),D(t,to,L=>n(174,qt=L)),D(t,kr,L=>n(36,Be=L)),D(t,Br,L=>n(172,nt=L)),D(t,eo,L=>n(148,Ie=L));let Pr=0,Ir={};const Wr=L=>{const[ee,sn]=ii[L];let je,re,ie=sn.position==="relative";const bn=ie?"0%":0,Kt=ie?"0%":0;ko(ee)||tr(ee)?(re=ie?"20%":.2*Dt.width,je=Li(ee),je.x=bn,je.y=Kt,Da(je,{width:re,height:re},Dt)):er(ee)?(re=ie?"10%":.1*Dt.width,je=Li(ee),je.x=bn,je.y=Kt,Da(je,{rx:re,ry:re},Dt)):ar(ee)&&(re=ie?"10%":.1*Dt.width,je=Li(ee),je.x1=bn,je.y1=Kt,je.x2=bn,je.y2=Kt),je&&Promise.resolve().then(()=>{zi(Oo(je,void 0,re))})},ji=L=>Un(Lh(L,We));let An,Wi={},Fi,gi;const Ii=L=>{if(!(Ni(L)&&Ee(L,"pathClose")))return;const ee=[...L.strokeColor];ee[3]=1,An.updateMarkupShape(L,{pathClose:!1,strokeColor:ee},!1),An.removeMarkupShapeProps(L,["backgroundColor"],!1),An.confirmMarkupItemDraft(),An.selectShape(L),bt("addshape",L),un.write()};let Ki;const Go=(L,ee)=>{const sn={};return Object.entries(L).forEach(([je,re])=>{Ee(ee,je)&&(sn[je]=re)}),sn},ca=(L,ee)=>{if(dn(L))return L;if(L.endsWith("%"))return parseFloat(L)/100*ee.width};let mo,_i,Di;const Oo=(L,ee,sn)=>{let je=!1;ee||(je=!0,ee=ut?Un(wn($t)):wn(ve)),ee.x-=Dt.x||0,ee.y-=Dt.y||0,(Hi||Xn)&&(L.flipX=Hi,L.flipY=Xn);const re=An.getShapesNearPosition(kt,ee);if(je&&re.length){const ie=.1*Math.min(ve.width,ve.height);ee.x+=Math.round(-ie+Math.random()*ie*2),ee.y+=Math.round(-ie+Math.random()*ie*2)}if(Pi!==0&&(L.rotation=Hi&&Xn?-Pi:Hi||Xn?Pi:-Pi),Ee(L,"width")&&Ee(L,"height")){const{width:ie,height:bn}=Wl(L,["width","height"],Dt);Da(L,{x:ee.x-.5*ie,y:ee.y-.5*bn},Dt)}else if(er(L))Da(L,{x:ee.x,y:ee.y},Dt);else if(ar(L)){const{x1:ie,y1:bn,x2:Kt,y2:ai}=Wl(L,["x1","y1","x2","y2"],Dt),zn=Yr(pt(ie,bn),pt(Kt,ai)),Pn=Qe(sn)?yh(sn,Dt.width):zn;Da(L,{x1:ee.x-Pn,y1:ee.y+Pn,x2:ee.x+Pn,y2:ee.y-Pn},Dt)}else if(Ni(L)){const{points:ie}=Wl(L,["points"],Dt),bn=zo(ie);Da(L,{points:ie.map(Kt=>({x:Kt.x+ee.x-bn.x,y:Kt.y+ee.y-bn.y}))},Dt)}return L},no=(L,ee)=>{const sn=Oo(sg(L,ve),ee);return L.shape&&(Ee(L.shape,"x")&&(sn.x=L.shape.x),Ee(L.shape,"y")&&(sn.y=L.shape.y)),zi(sn)},zi=L=>{const{beforeAddShape:ee=()=>!0}=yr;if(ee(L))return An.addShape(L),An.selectShape(L),bt("addshape",L),un.write(),L};let fr=!1;const Bi=()=>{un.write()};let Ji;const Xr=yi("redrawTrigger");D(t,Xr,L=>n(144,rt=L));const go=[],io=fn(Jt?20:0);return D(t,io,L=>n(141,st=L)),t.$$set=L=>{"isActive"in L&&Ve(n(1,H=L.isActive)),"isActiveFraction"in L&&Dn(n(2,Wt=L.isActiveFraction)),"isVisible"in L&&En(n(3,z=L.isVisible)),"stores"in L&&n(100,Qt=L.stores),"locale"in L&&n(4,ce=L.locale),"shapes"in L&&Ne(n(5,ye=L.shapes)),"toolbar"in L&&n(101,ue=L.toolbar),"toolShapes"in L&&n(102,Yt=L.toolShapes),"toolActive"in L&&n(0,Gt=L.toolActive),"toolSelectRadius"in L&&n(6,hn=L.toolSelectRadius),"toolRetainStyles"in L&&n(103,Xe=L.toolRetainStyles),"toolbarLayout"in L&&n(7,on=L.toolbarLayout),"textInputMode"in L&&n(8,xe=L.textInputMode),"shapeControls"in L&&n(9,Me=L.shapeControls),"enableButtonFlipVertical"in L&&n(10,Yn=L.enableButtonFlipVertical),"enablePresetSelectImage"in L&&n(11,Se=L.enablePresetSelectImage),"enablePresetDropImage"in L&&n(12,J=L.enablePresetDropImage),"enableSelectToolToAddShape"in L&&n(104,Xt=L.enableSelectToolToAddShape),"enableAutoSelectMoveTool"in L&&n(105,jt=L.enableAutoSelectMoveTool),"enableTapToAddText"in L&&n(13,se=L.enableTapToAddText),"enableMoveTool"in L&&n(106,Fe=L.enableMoveTool),"enableViewTool"in L&&n(107,ke=L.enableViewTool),"enableToolShareStyles"in L&&n(108,be=L.enableToolShareStyles),"enableMultiSelect"in L&&n(14,mi=L.enableMultiSelect),"gridSize"in L&&n(15,si=L.gridSize),"snapThreshold"in L&&n(16,ge=L.snapThreshold),"enableSnapToContext"in L&&n(17,an=L.enableSnapToContext),"willRenderHeaderTools"in L&&n(109,we=L.willRenderHeaderTools),"willRenderPresetToolbar"in L&&n(110,Ge=L.willRenderPresetToolbar),"willRenderShapeStyleControls"in L&&n(18,Le=L.willRenderShapeStyleControls),"willStartInteraction"in L&&n(111,Ht=L.willStartInteraction),"shapePresets"in L&&n(19,Pe=L.shapePresets),"utilKey"in L&&n(20,Cn=L.utilKey),"mapScreenPointToImagePoint"in L&&n(21,Un=L.mapScreenPointToImagePoint),"mapImagePointToScreenPoint"in L&&n(22,bi=L.mapImagePointToScreenPoint),"imageRotation"in L&&n(23,Pi=L.imageRotation),"imageFlipX"in L&&n(24,Hi=L.imageFlipX),"imageFlipY"in L&&n(25,Xn=L.imageFlipY),"parentRect"in L&&Je(n(26,Ui=L.parentRect)),"hooks"in L&&n(112,yr=L.hooks)},t.$$.update=()=>{var L,ee,sn,je;if(33554432&t.$$.dirty[4]&&n(124,i=lt.includes(18)),1049088&t.$$.dirty[3]&&(ii&&Yt===ii||n(113,ii=Yt)),16&t.$$.dirty[1]&&Nr.set(gt),16&t.$$.dirty[1]&&wo.set(gt),16&t.$$.dirty[1]&&ho.set(gt),256&t.$$.dirty[3]&&n(33,r=Array.isArray(ue)&&ue.length>1&&Array.isArray(ue[0][1])),4&t.$$.dirty[1]|256&t.$$.dirty[3]&&n(54,o=r?ue.map((re,ie)=>[ie,re[0]]):[]),134217728&t.$$.dirty[0]|4&t.$$.dirty[1]|256&t.$$.dirty[3]&&n(140,a=r?ue[Pr][1]:ue),524288&t.$$.dirty[0]|155648&t.$$.dirty[3]|65536&t.$$.dirty[4]&&n(32,s=((re,{willRenderPresetToolbar:ie,shapePresets:bn,enableViewTool:Kt,enableMoveTool:ai})=>{let zn=bn.length!==0||ie?re:re.filter(Pn=>Pn[0]!=="preset");return r&&(zn=[["move",Pn=>Pn.shapeLabelToolMove,{icon:Pn=>Pn.shapeIconToolMove}],["view",Pn=>Pn.shapeLabelToolView,{icon:Pn=>Pn.shapeIconToolView}],...zn]),zn=ai?zn:zn.filter(Pn=>Pn[0]!=="move"),Kt?zn:zn.filter(Pn=>Pn[0]!=="view")})(a,{willRenderPresetToolbar:Ge,shapePresets:Pe,enableMoveTool:Fe,enableViewTool:ke})),2&t.$$.dirty[1]&&n(138,d=!!s.length),1&t.$$.dirty[0]|2&t.$$.dirty[1]|16384&t.$$.dirty[4]&&d&&Gt===void 0&&n(0,Gt=s[0][0]),134217729&t.$$.dirty[0]|4&t.$$.dirty[1]|2097152&t.$$.dirty[3]|65536&t.$$.dirty[4]&&r&&n(114,Ir={...Ir,[Pr]:a.map(([re])=>re).includes(Gt)?Gt:Ir[Pr]||a[0][0]}),512&t.$$.dirty[0]&&n(137,l=!!Object.keys(Me).length),2&t.$$.dirty[1]&&n(34,c=s.length>1),12&t.$$.dirty[1]&&n(53,u=c||r),1&t.$$.dirty[0]&&n(139,p=Gt!==void 0),57344&t.$$.dirty[4]&&n(52,h=(!p||d)&&l),536870912&t.$$.dirty[0]&&n(31,bt=Ji&&(L=Ji,(re,ie)=>{L.dispatchEvent(bs(re,ie))})),1&t.$$.dirty[0]|17&t.$$.dirty[1]&&gt&&bt&&bt("selectcontrol",Gt),16&t.$$.dirty[1]&&(gt?At(Qr,Ae[Cn]={maskMarkupOpacity:.85},Ae):delete Ae[Cn]),1&t.$$.dirty[0]|1048576&t.$$.dirty[3]&&n(136,y=Gt&&ii[Gt]?ii[Gt][1]:void 0),4096&t.$$.dirty[4]&&n(125,m=y&&y.isSelection?"selection":"shapes"),3&t.$$.dirty[4]&&(re=>{if(!An)return;const ie=An.getShapeDraft(gr);ie&&(re&&(Fi=ie.drawMode),An.updateShapeDraft({drawMode:re?"subtract":Fi},gr))})(m==="selection"&&i),268435457&t.$$.dirty[0]&&Gt&&An){const re=An.getMarkupItemDraft();re&&Ii(re)}if(1&t.$$.dirty[0]&&Gt&&An&&Gt!=="move"&&An.blurShapes(),16&t.$$.dirty[1]|134217728&t.$$.dirty[4]&&n(51,f=Ke&&gt),256&t.$$.dirty[1]|8388608&t.$$.dirty[4]&&n(50,b=he&&pt($t.x-he.x,$t.y-he.y)),512&t.$$.dirty[0]&&n(135,v=Object.keys(Me)),16384&t.$$.dirty[0]|16&t.$$.dirty[1]|2097152&t.$$.dirty[4]&&n(122,w=mi?gt&&kt.filter($a):[]),536870912&t.$$.dirty[3]&&n(123,T=w.length>1),16&t.$$.dirty[1]|2097152&t.$$.dirty[4]&&n(119,I=gt&&kt.filter($a)[0]),16&t.$$.dirty[1]|2097152&t.$$.dirty[4]&&n(130,P=gt&&kt.find(re=>Pp(re))),16&t.$$.dirty[1]|2097152&t.$$.dirty[4]&&n(133,_=gt&&kt.find(re=>lo(re))),1&t.$$.dirty[0]|16&t.$$.dirty[1]|1048576&t.$$.dirty[3]&&n(127,C=gt&&ii[Gt]?i2(Li({...ii[Gt][0],...nn[Cn]?nn[Cn][Gt]:{}})):{}),1048576&t.$$.dirty[3]&&ii&&n(115,Wi={}),1&t.$$.dirty[0]|4227072&t.$$.dirty[3]|2056&t.$$.dirty[4]&&n(126,F=C&&Object.keys(C).reduce((re,ie)=>{const bn=ie==="disableStyle",Kt=ie==="settings",ai=!!v.find(br=>br.split("_").includes(ie));if(!bn&&!Kt&&!ai||C[ie]===void 0||C.disableStyle===!0||C.disableStyle&&C.disableStyle.includes(ie))return re;if(ie==="strokeWidth"&&Object.keys(Wi).includes("strokeWidth")&&Wi[ie]===void 0&&Ee(C,"points"))return re[ie]=C[ie],re;const{share:zn=!0}=C.settings&&C.settings[ie]||{},Pn=be&&zn?Wi:Wi[Gt]||{};return re[ie]=Ee(Pn,ie)?Pn[ie]:C[ie],re},{})),1048577&t.$$.dirty[0]|1024&t.$$.dirty[3]|4&t.$$.dirty[4]&&(Xe?((re,ie,bn)=>{const Kt=nn[re],ai=Kt?Kt[ie]:{};li.set({...nn,[re]:{...Kt,[ie]:{...ai,...bn}}})})(Cn,Gt,F):(ee=Cn,li.set({[ee]:{}}))),16&t.$$.dirty[1]|67108864&t.$$.dirty[3]|67108868&t.$$.dirty[4]&&n(134,G=Ze&&gt?I||F:void 0),1610612736&t.$$.dirty[3]|1536&t.$$.dirty[4]&&n(49,O=T?function(re){const ie={};return re.forEach(bn=>{Object.entries(bn).filter(([Kt])=>!Kt.startsWith("_")).forEach(([Kt,ai])=>{Ee(ie,Kt)?Kt==="disableStyle"&&ie[Kt].push(...ai):ie[Kt]=ai})}),ie}(w):G||_),1&t.$$.dirty[0]|8&t.$$.dirty[4]&&n(48,$=Ee(C,"eraseRadius")||Ee(C,"points")&&!Ee(C,"pathClose")||Gt==="move"||Gt==="view"),64&t.$$.dirty[1]|8&t.$$.dirty[4]&&n(47,N=C&&C.eraseRadius!==void 0?ca(C.eraseRadius,Dt):void 0),16&t.$$.dirty[1]|33554432&t.$$.dirty[4]&&n(131,it=gt&&lt.includes(32)),1&t.$$.dirty[0]|16&t.$$.dirty[1]&&n(132,M=gt&&Gt==="view"),384&t.$$.dirty[4]&&n(129,W=M||it),96&t.$$.dirty[4]&&n(128,ot=!!W&&(!!P||ml(document.activeElement))),16&t.$$.dirty[1]|48&t.$$.dirty[4]&&Ao.set(!gt||W&&!ot),16&t.$$.dirty[1]|16&t.$$.dirty[4]&&Lo.set(!gt||!ot),64&t.$$.dirty[1]|12&t.$$.dirty[4]&&n(120,at=C.cursorStyle?(({cursorStyle:re,cursorSize:ie},bn,Kt)=>{let ai;const zn=bn[ie];if(zn===void 0?ai=ca(ie,Kt):dn(zn)?ai=zn:Qe(zn)&&(ai=$v(ie,bn[ie],Kt),ie==="strokeWidth"&&(ai*=.5)),!(ai<=0||ai===void 0))return{size:ai,style:re}})(C,{...C,...F},Dt):void 0),33554432&t.$$.dirty[3]|16777216&t.$$.dirty[4]&&n(121,q=Di&&(je=Ie,(sn=Di).x>=0&&sn.y>=0&&sn.x<=je.width&&sn.y<=je.height)),1048576&t.$$.dirty[0]|160&t.$$.dirty[1]|427819008&t.$$.dirty[3]|3&t.$$.dirty[4])if(q&&!mo&&at&&!It){const re=at.size*Be.scale,ie={id:"cursor-"+Cn,x:_i.x,y:_i.y,strokeWidth:.5,strokeColor:[0,0,0]};at.style==="ellipse"&&(ie.rx=re,ie.ry=re);const bn={strokeWidth:2.5,strokeColor:[1,1,1],opacity:.75},Kt=[{...ie,...bn},ie];if(m==="selection"&&i){const ai=re,zn=_i.x+ai,Pn=_i.y+ai+4,br={id:"cursor-"+Cn,strokeWidth:.75,strokeColor:[0,0,0],points:[{x:zn,y:Pn},{x:zn+4,y:Pn}]};Kt.push({...br,...bn,strokeWidth:2,points:[{x:zn-.5,y:Pn},{x:zn+4.5,y:Pn}]},br)}(ai=>{jr.update(zn=>[...zn.filter(Pn=>Pn.id!=="cursor-"+Cn),...ai])})(Kt)}else jr.update(re=>re.filter(ie=>ie.id!=="cursor-"+Cn));1&t.$$.dirty[0]|128&t.$$.dirty[1]|478150656&t.$$.dirty[3]&&n(46,ct=q?((re,ie,bn,Kt,ai,zn)=>{if(Kt)return ai?"grabbing":"grab";if(re&&!ie)return"none";if(!ie)return zn==="move"?"default":"crosshair";let Pn=ie||bn;return $a(Pn)?Pp(Pn)?xe==="modal"?"default":"text":!cl(Pn)||T&&!w.every(cl)?"default":"move":"default"})(at,mo,I,It,!1,Gt):"default"),526337&t.$$.dirty[0]|131072&t.$$.dirty[3]&&n(45,V=Gt==="preset"&&(Pe.length>0||Se||Ge)),64&t.$$.dirty[1]&&(ut=!Ee(Dt,"x")&&!Ee(Dt,"y")),4194304&t.$$.dirty[4]&&n(44,K=Nt*ci),131072&t.$$.dirty[3]|1572864&t.$$.dirty[4]&&n(43,vt=rt&&Ge?re=>Wu(()=>Ge(re,no,{...le},()=>Xr.set({}))):ni),524288&t.$$.dirty[3]&&n(42,X=Object.keys(yr).reduce((re,ie)=>(ie==="beforeAddShape"||yr[ie]===void 0||(re[ie]=yr[ie]),re),{})),16&t.$$.dirty[1]&&(re=>{kt&&ye.update(ie=>ie.map(bn=>(bn._prerender=!!re&&Pp(bn),bn)))})(gt),65536&t.$$.dirty[3]|1572864&t.$$.dirty[4]&&n(30,Z=rt&&we([],le,()=>Xr.set({}))),1073742336&t.$$.dirty[0]&&n(41,mt=!!Z.length||!!Object.keys(Me).some(re=>go.includes(re))),16&t.$$.dirty[1]|262144&t.$$.dirty[4]&&Jt&&io.set(gt?0:20),131072&t.$$.dirty[4]&&n(40,Bt=st?`transform: translateY(${st}px)`:void 0)},Er.set(!1),[Gt,H,Wt,z,ce,ye,hn,on,xe,Me,Yn,Se,J,se,mi,si,ge,an,Le,Pe,Cn,Un,bi,Pi,Hi,Xn,Ui,Pr,An,Ji,Z,bt,s,r,c,gt,Be,Dt,It,he,Bt,mt,X,vt,K,V,ct,N,$,O,b,f,h,u,o,We,xn,xt,gr,Mr,Uo,li,uo,ui,rr,Jr,po,Dr,Gi,jr,Qr,zr,xr,to,kr,Br,eo,({index:L},ee)=>{n(27,Pr=L),n(0,Gt=Ir[L])},({value:L},ee)=>{n(0,Gt=L),(Xt||/enter/i.test(ee.key))&&Wr(L)},L=>{if(Gt==="eraser")gi=An.eraseShape();else if(Gt&&ii[Gt]){const[ee,sn={}]=ii[Gt],{drawMode:je}=G;m==="selection"&&je==="new"&&gr.set([]);let re={};m==="selection"&&(bt("selectiondown",[...Ze]),i&&(Fi=ee.drawMode,re.drawMode="subtract")),gi=An.createShape({...ee,...F,...re},sn)}else gi=void 0;return!!gi&&(gi.start(L),!0)},L=>!!gi&&(gi.update(L),!0),L=>!!gi&&(gi.release(L),!0),L=>!!gi&&(gi.cancel(L),gi=void 0,!0),L=>{if(!gi)return!1;if(gi.end(L),gi=void 0,m==="selection"){if(L.detail.isTap){const[je]=ii[Gt];je.bitmap||gr.set([])}bt("selectionup",[...Ze])}const ee=An.getMarkupItemDraft(),sn=Fe&&(jt===!0||Array.isArray(jt)&&jt.includes(Gt));return ee&&!ee.isEditing||!sn||n(0,Gt="move"),!0},L=>{const{key:ee}=L,sn=An.getMarkupItemDraft();/escape/i.test(ee)&&sn&&(L.preventDefault(),L.stopPropagation(),An.discardMarkupItemDraft(),gi=void 0),/enter/i.test(ee)&&sn&&(L.preventDefault(),L.stopPropagation(),Ii(sn),gi=void 0)},function(L){Object.keys(L).forEach(ee=>{const{retain:sn=!0,share:je=!0}=C.settings&&C.settings[ee]||{};sn&&(be&&je?n(115,Wi[ee]=L[ee],Wi):(Wi[Gt]||n(115,Wi[Gt]={},Wi),n(115,Wi[Gt][ee]=L[ee],Wi)))}),bt("selectstyle",L),I&&(T?w.forEach(ee=>{An.updateMarkupShape(ee,Go(L,ee))}):An.updateMarkupShape(I,L),clearTimeout(Ki),Ki=setTimeout(()=>{Bi()},200))},(L,ee,sn)=>{n(117,_i=ee),n(118,Di=sn)},()=>{n(118,Di=void 0),n(117,_i=void 0)},L=>{bt("markuptap",L)},L=>n(116,mo=L),()=>{fr=!1},(L,ee)=>{if(fr)return;const{beforeAddShape:sn=()=>!0}=yr,je=ji(ee),re=An.getMarkupItemDraft(),ie=Ru(ve,{x:je.x+(Dt.x||0),y:je.y+(Dt.y||0)});if(re&&!ie&&An.discardMarkupItemDraft(),ie){if(!re){const bn=sg(L,ve),Kt=Oo(bn,je);return sn(Kt)?(mh(Kt),void An.addShape(Kt)):(fr=!0,void ee.preventDefault())}ko(re)&&(je.x-=.5*re.width,je.y-=.5*re.height),L.shape&&(Ee(L.shape,"x")&&(je.x=L.shape.x),Ee(L.shape,"y")&&(je.y=L.shape.y)),An.updateMarkupShape(re,je)}},(L,ee)=>{if(fr)return;const sn=ji(ee);if(!Ru(ve,{x:sn.x+(Dt.x||0),y:sn.y+(Dt.y||0)}))return void An.discardMarkupItemDraft();const je=An.confirmMarkupItemDraft();An.selectShape(je),bt("addshape",je),un.write()},L=>no(L),L=>{return ee=L.detail.resources,sn=ji(L.detail.event),ee.forEach(je=>no(je,sn));var ee,sn},L=>{if(!Ht)return!0;const ee=rectClone(qt);return rectScale(ee,1/Ut),rectTranslate(ee,nt),rectScale(ee,Be.scale),Ht(L,{...ee,x:ee.x+$t.x,y:ee.y+$t.y})},Bi,Xr,go,io,Qt,ue,Yt,Xe,Xt,jt,Fe,ke,be,we,Ge,Ht,yr,ii,Ir,Wi,mo,_i,Di,I,at,q,w,T,i,m,F,C,ot,W,P,it,M,_,G,v,y,l,d,p,a,st,Jt,le,rt,kt,Nt,$t,Ie,lt,Ze,Ke,function(L){aa.call(this,t,L)},L=>L[0]===Gt,(L,ee,sn)=>{const je=L.filter(([,re])=>!go.includes(re));return Le?Le(je,ee,sn):je},L=>L[0]===Pr,L=>{Promise.resolve().then(()=>{bt("addshape",L),Bi()})},L=>{bt("selectshape",L)},L=>{Promise.resolve().then(()=>{bt("blurshape",L)})},L=>{bt("tapshape",L)},L=>{bt("updateshape",L),Bi()},L=>{bt("removeshape",L),Bi()},()=>{Bi()},function(L){Nn[L?"unshift":"push"](()=>{An=L,n(28,An)})},function(L){Nn[L?"unshift":"push"](()=>{Ji=L,n(29,Ji)})},L=>L.filter(([,ee])=>go.includes(ee)),function(L){aa.call(this,t,L)}]}class XS extends Tn{constructor(e){super(),Sn(this,e,ZS,jS,yn,{isActive:1,isActiveFraction:2,isVisible:3,stores:100,locale:4,shapes:5,toolbar:101,toolShapes:102,toolActive:0,toolSelectRadius:6,toolRetainStyles:103,toolbarLayout:7,textInputMode:8,shapeControls:9,enableButtonFlipVertical:10,enablePresetSelectImage:11,enablePresetDropImage:12,enableSelectToolToAddShape:104,enableAutoSelectMoveTool:105,enableTapToAddText:13,enableMoveTool:106,enableViewTool:107,enableToolShareStyles:108,enableMultiSelect:14,gridSize:15,snapThreshold:16,enableSnapToContext:17,willRenderHeaderTools:109,willRenderPresetToolbar:110,willRenderShapeStyleControls:18,willStartInteraction:111,shapePresets:19,utilKey:20,mapScreenPointToImagePoint:21,mapImagePointToScreenPoint:22,imageRotation:23,imageFlipX:24,imageFlipY:25,parentRect:26,hooks:112},null,[-1,-1,-1,-1,-1,-1,-1])}get isActive(){return this.$$.ctx[1]}set isActive(e){this.$$set({isActive:e}),U()}get isActiveFraction(){return this.$$.ctx[2]}set isActiveFraction(e){this.$$set({isActiveFraction:e}),U()}get isVisible(){return this.$$.ctx[3]}set isVisible(e){this.$$set({isVisible:e}),U()}get stores(){return this.$$.ctx[100]}set stores(e){this.$$set({stores:e}),U()}get locale(){return this.$$.ctx[4]}set locale(e){this.$$set({locale:e}),U()}get shapes(){return this.$$.ctx[5]}set shapes(e){this.$$set({shapes:e}),U()}get toolbar(){return this.$$.ctx[101]}set toolbar(e){this.$$set({toolbar:e}),U()}get toolShapes(){return this.$$.ctx[102]}set toolShapes(e){this.$$set({toolShapes:e}),U()}get toolActive(){return this.$$.ctx[0]}set toolActive(e){this.$$set({toolActive:e}),U()}get toolSelectRadius(){return this.$$.ctx[6]}set toolSelectRadius(e){this.$$set({toolSelectRadius:e}),U()}get toolRetainStyles(){return this.$$.ctx[103]}set toolRetainStyles(e){this.$$set({toolRetainStyles:e}),U()}get toolbarLayout(){return this.$$.ctx[7]}set toolbarLayout(e){this.$$set({toolbarLayout:e}),U()}get textInputMode(){return this.$$.ctx[8]}set textInputMode(e){this.$$set({textInputMode:e}),U()}get shapeControls(){return this.$$.ctx[9]}set shapeControls(e){this.$$set({shapeControls:e}),U()}get enableButtonFlipVertical(){return this.$$.ctx[10]}set enableButtonFlipVertical(e){this.$$set({enableButtonFlipVertical:e}),U()}get enablePresetSelectImage(){return this.$$.ctx[11]}set enablePresetSelectImage(e){this.$$set({enablePresetSelectImage:e}),U()}get enablePresetDropImage(){return this.$$.ctx[12]}set enablePresetDropImage(e){this.$$set({enablePresetDropImage:e}),U()}get enableSelectToolToAddShape(){return this.$$.ctx[104]}set enableSelectToolToAddShape(e){this.$$set({enableSelectToolToAddShape:e}),U()}get enableAutoSelectMoveTool(){return this.$$.ctx[105]}set enableAutoSelectMoveTool(e){this.$$set({enableAutoSelectMoveTool:e}),U()}get enableTapToAddText(){return this.$$.ctx[13]}set enableTapToAddText(e){this.$$set({enableTapToAddText:e}),U()}get enableMoveTool(){return this.$$.ctx[106]}set enableMoveTool(e){this.$$set({enableMoveTool:e}),U()}get enableViewTool(){return this.$$.ctx[107]}set enableViewTool(e){this.$$set({enableViewTool:e}),U()}get enableToolShareStyles(){return this.$$.ctx[108]}set enableToolShareStyles(e){this.$$set({enableToolShareStyles:e}),U()}get enableMultiSelect(){return this.$$.ctx[14]}set enableMultiSelect(e){this.$$set({enableMultiSelect:e}),U()}get gridSize(){return this.$$.ctx[15]}set gridSize(e){this.$$set({gridSize:e}),U()}get snapThreshold(){return this.$$.ctx[16]}set snapThreshold(e){this.$$set({snapThreshold:e}),U()}get enableSnapToContext(){return this.$$.ctx[17]}set enableSnapToContext(e){this.$$set({enableSnapToContext:e}),U()}get willRenderHeaderTools(){return this.$$.ctx[109]}set willRenderHeaderTools(e){this.$$set({willRenderHeaderTools:e}),U()}get willRenderPresetToolbar(){return this.$$.ctx[110]}set willRenderPresetToolbar(e){this.$$set({willRenderPresetToolbar:e}),U()}get willRenderShapeStyleControls(){return this.$$.ctx[18]}set willRenderShapeStyleControls(e){this.$$set({willRenderShapeStyleControls:e}),U()}get willStartInteraction(){return this.$$.ctx[111]}set willStartInteraction(e){this.$$set({willStartInteraction:e}),U()}get shapePresets(){return this.$$.ctx[19]}set shapePresets(e){this.$$set({shapePresets:e}),U()}get utilKey(){return this.$$.ctx[20]}set utilKey(e){this.$$set({utilKey:e}),U()}get mapScreenPointToImagePoint(){return this.$$.ctx[21]}set mapScreenPointToImagePoint(e){this.$$set({mapScreenPointToImagePoint:e}),U()}get mapImagePointToScreenPoint(){return this.$$.ctx[22]}set mapImagePointToScreenPoint(e){this.$$set({mapImagePointToScreenPoint:e}),U()}get imageRotation(){return this.$$.ctx[23]}set imageRotation(e){this.$$set({imageRotation:e}),U()}get imageFlipX(){return this.$$.ctx[24]}set imageFlipX(e){this.$$set({imageFlipX:e}),U()}get imageFlipY(){return this.$$.ctx[25]}set imageFlipY(e){this.$$set({imageFlipY:e}),U()}get parentRect(){return this.$$.ctx[26]}set parentRect(e){this.$$set({parentRect:e}),U()}get hooks(){return this.$$.ctx[112]}set hooks(e){this.$$set({hooks:e}),U()}}var qS=(t,e,n,i,r,o,a,s,l)=>{const c=Ue(t),d=.5*n.width,u=.5*n.height,p=.5*e.width,h=.5*e.height,y=r.x+i.x,m=r.y+i.y;s&&(c.x=n.width-c.x),l&&(c.y=n.height-c.y);const f=Math.cos(o),b=Math.sin(o);c.x-=d,c.y-=u;const v=c.x*f-c.y*b,w=c.x*b+c.y*f;c.x=d+v,c.y=u+w,c.x*=a,c.y*=a,c.x+=p,c.y+=h,c.x+=y,c.y+=m,c.x-=d*a,c.y-=u*a;const T=(r.x-y)*a,I=(r.y-m)*a,P=T*f-I*b,_=T*b+I*f;return c.x+=P,c.y+=_,c},YS=(t,e,n,i,r,o,a,s,l)=>{const c=Ue(t),d=ul(n),u=ul(e),p=pt(r.x+i.x,r.y+i.y),h=Math.cos(o),y=Math.sin(o);c.x-=u.x,c.y-=u.y;const m=(r.x-p.x)*a,f=(r.y-p.y)*a,b=m*h-f*y,v=m*y+f*h;c.x-=b,c.y-=v,c.x-=p.x,c.y-=p.y,c.x/=a,c.y/=a;const w=c.x*h+c.y*y,T=c.x*y-c.y*h;return c.x=w,c.y=-T,c.x+=d.x,c.y+=d.y,s&&(c.x=n.width-c.x),l&&(c.y=n.height-c.y),c},hy=t=>typeof t=="boolean";function KS(t){let e,n,i;function r(a){t[60](a)}let o={utilKey:t[1],stores:t[5],locale:t[6],isActive:t[2],isActiveFraction:t[3],isVisible:t[4],mapScreenPointToImagePoint:t[46],mapImagePointToScreenPoint:t[45],imageRotation:t[47],imageFlipX:t[44],imageFlipY:t[43],shapes:t[49],toolbar:t[21]||t[7],toolShapes:t[22]||t[8],toolRetainStyles:t[9],enableSelectToolToAddShape:t[31],enableTapToAddText:t[32],enableViewTool:t[30],enableMoveTool:t[34],enableAutoSelectMoveTool:t[33],enableMultiSelect:t[35],snapThreshold:t[16],gridSize:dn(t[18])?t[18]:t[15],enableSnapToContext:hy(t[19])?t[19]:t[17],enableToolShareStyles:t[13],shapeControls:t[23]||t[10],shapePresets:t[27],enableButtonFlipVertical:t[24],parentRect:t[50],enablePresetDropImage:t[26],enablePresetSelectImage:t[25],toolSelectRadius:t[11],textInputMode:t[12],willStartInteraction:t[14],willRenderPresetToolbar:t[28]||t[20],willRenderShapeStyleControls:t[29],hooks:{willRenderShapeControls:t[36],willRenderShapeTextControls:t[37],beforeAddShape:t[38],beforeRemoveShape:t[39],beforeDeselectShape:t[40],beforeSelectShape:t[41],beforeUpdateShape:t[42]}};return t[0]!==void 0&&(o.toolActive=t[0]),e=new XS({props:o}),Nn.push(()=>Ro(e,"toolActive",r)),e.$on("measure",t[61]),{c(){zt(e.$$.fragment)},m(a,s){Ft(e,a,s),i=!0},p(a,s){const l={};32&s[0]&&(l.stores=a[5]),64&s[0]&&(l.locale=a[6]),4&s[0]&&(l.isActive=a[2]),8&s[0]&&(l.isActiveFraction=a[3]),16&s[0]&&(l.isVisible=a[4]),32768&s[1]&&(l.mapScreenPointToImagePoint=a[46]),16384&s[1]&&(l.mapImagePointToScreenPoint=a[45]),65536&s[1]&&(l.imageRotation=a[47]),8192&s[1]&&(l.imageFlipX=a[44]),4096&s[1]&&(l.imageFlipY=a[43]),2097280&s[0]&&(l.toolbar=a[21]||a[7]),4194560&s[0]&&(l.toolShapes=a[22]||a[8]),512&s[0]&&(l.toolRetainStyles=a[9]),1&s[1]&&(l.enableSelectToolToAddShape=a[31]),2&s[1]&&(l.enableTapToAddText=a[32]),1073741824&s[0]&&(l.enableViewTool=a[30]),8&s[1]&&(l.enableMoveTool=a[34]),4&s[1]&&(l.enableAutoSelectMoveTool=a[33]),16&s[1]&&(l.enableMultiSelect=a[35]),65536&s[0]&&(l.snapThreshold=a[16]),294912&s[0]&&(l.gridSize=dn(a[18])?a[18]:a[15]),655360&s[0]&&(l.enableSnapToContext=hy(a[19])?a[19]:a[17]),8192&s[0]&&(l.enableToolShareStyles=a[13]),8389632&s[0]&&(l.shapeControls=a[23]||a[10]),134217728&s[0]&&(l.shapePresets=a[27]),16777216&s[0]&&(l.enableButtonFlipVertical=a[24]),67108864&s[0]&&(l.enablePresetDropImage=a[26]),33554432&s[0]&&(l.enablePresetSelectImage=a[25]),2048&s[0]&&(l.toolSelectRadius=a[11]),4096&s[0]&&(l.textInputMode=a[12]),16384&s[0]&&(l.willStartInteraction=a[14]),269484032&s[0]&&(l.willRenderPresetToolbar=a[28]||a[20]),536870912&s[0]&&(l.willRenderShapeStyleControls=a[29]),4064&s[1]&&(l.hooks={willRenderShapeControls:a[36],willRenderShapeTextControls:a[37],beforeAddShape:a[38],beforeRemoveShape:a[39],beforeDeselectShape:a[40],beforeSelectShape:a[41],beforeUpdateShape:a[42]}),!n&&1&s[0]&&(n=!0,l.toolActive=a[0],Wo(()=>n=!1)),e.$set(l)},i(a){i||(k(e.$$.fragment,a),i=!0)},o(a){A(e.$$.fragment,a),i=!1},d(a){_t(e,a)}}}function JS(t,e,n){let i,r,o,a,s,l,c,d,u,{isActive:p}=e,{isActiveFraction:h}=e,{isVisible:y}=e,{stores:m}=e,{locale:f={}}=e,{markupEditorToolbar:b}=e,{markupEditorToolStyles:v}=e,{markupEditorToolRetainStyles:w}=e,{markupEditorShapeStyleControls:T}=e,{markupEditorToolSelectRadius:I}=e,{markupEditorTextInputMode:P}=e,{markupEditorToolShareStyles:_}=e,{markupEditorWillStartInteraction:C}=e,{markupEditorGridSize:F=0}=e,{markupEditorSnapThreshold:G=0}=e,{markupEditorSnapToContext:O=!1}=e,{annotateGridSize:$}=e,{annotateSnapToContext:N}=e,{willRenderShapePresetToolbar:it}=e,{annotateTools:M}=e,{annotateToolShapes:W}=e,{annotateShapeControls:ot}=e,{annotateActiveTool:at}=e,{annotateEnableButtonFlipVertical:q=!1}=e,{annotateEnableSelectImagePreset:ct=!1}=e,{annotateEnableDropImagePreset:V=!0}=e,{annotatePresets:ut=[]}=e,{annotateWillRenderShapePresetToolbar:bt}=e,{annotateWillRenderShapeStyleControls:K}=e,{enableViewTool:vt}=e,{enableSelectToolToAddShape:X}=e,{enableTapToAddText:Z}=e,{enableAutoSelectMoveTool:mt}=e,{enableMoveTool:Bt}=e,{enableMultiSelect:st}=e,{willRenderShapeControls:gt}=e,{willRenderShapeTextControls:Jt}=e,{beforeAddShape:le}=e,{beforeRemoveShape:rt}=e,{beforeDeselectShape:kt}=e,{beforeSelectShape:Nt}=e,{beforeUpdateShape:$t}=e;const{rootRect:Be,imageAnnotation:nt,imageSize:Ut,imageRotation:qt,imageFlipX:Dt,imageFlipY:ve,imageTransforms:It,imageTransformsInterpolated:Ie}=m;return D(t,Be,lt=>n(59,d=lt)),D(t,Ut,lt=>n(58,c=lt)),D(t,qt,lt=>n(47,u=lt)),D(t,Dt,lt=>n(44,a=lt)),D(t,ve,lt=>n(43,o=lt)),D(t,It,lt=>n(57,l=lt)),D(t,Ie,lt=>n(56,s=lt)),t.$$set=lt=>{"isActive"in lt&&n(2,p=lt.isActive),"isActiveFraction"in lt&&n(3,h=lt.isActiveFraction),"isVisible"in lt&&n(4,y=lt.isVisible),"stores"in lt&&n(5,m=lt.stores),"locale"in lt&&n(6,f=lt.locale),"markupEditorToolbar"in lt&&n(7,b=lt.markupEditorToolbar),"markupEditorToolStyles"in lt&&n(8,v=lt.markupEditorToolStyles),"markupEditorToolRetainStyles"in lt&&n(9,w=lt.markupEditorToolRetainStyles),"markupEditorShapeStyleControls"in lt&&n(10,T=lt.markupEditorShapeStyleControls),"markupEditorToolSelectRadius"in lt&&n(11,I=lt.markupEditorToolSelectRadius),"markupEditorTextInputMode"in lt&&n(12,P=lt.markupEditorTextInputMode),"markupEditorToolShareStyles"in lt&&n(13,_=lt.markupEditorToolShareStyles),"markupEditorWillStartInteraction"in lt&&n(14,C=lt.markupEditorWillStartInteraction),"markupEditorGridSize"in lt&&n(15,F=lt.markupEditorGridSize),"markupEditorSnapThreshold"in lt&&n(16,G=lt.markupEditorSnapThreshold),"markupEditorSnapToContext"in lt&&n(17,O=lt.markupEditorSnapToContext),"annotateGridSize"in lt&&n(18,$=lt.annotateGridSize),"annotateSnapToContext"in lt&&n(19,N=lt.annotateSnapToContext),"willRenderShapePresetToolbar"in lt&&n(20,it=lt.willRenderShapePresetToolbar),"annotateTools"in lt&&n(21,M=lt.annotateTools),"annotateToolShapes"in lt&&n(22,W=lt.annotateToolShapes),"annotateShapeControls"in lt&&n(23,ot=lt.annotateShapeControls),"annotateActiveTool"in lt&&n(0,at=lt.annotateActiveTool),"annotateEnableButtonFlipVertical"in lt&&n(24,q=lt.annotateEnableButtonFlipVertical),"annotateEnableSelectImagePreset"in lt&&n(25,ct=lt.annotateEnableSelectImagePreset),"annotateEnableDropImagePreset"in lt&&n(26,V=lt.annotateEnableDropImagePreset),"annotatePresets"in lt&&n(27,ut=lt.annotatePresets),"annotateWillRenderShapePresetToolbar"in lt&&n(28,bt=lt.annotateWillRenderShapePresetToolbar),"annotateWillRenderShapeStyleControls"in lt&&n(29,K=lt.annotateWillRenderShapeStyleControls),"enableViewTool"in lt&&n(30,vt=lt.enableViewTool),"enableSelectToolToAddShape"in lt&&n(31,X=lt.enableSelectToolToAddShape),"enableTapToAddText"in lt&&n(32,Z=lt.enableTapToAddText),"enableAutoSelectMoveTool"in lt&&n(33,mt=lt.enableAutoSelectMoveTool),"enableMoveTool"in lt&&n(34,Bt=lt.enableMoveTool),"enableMultiSelect"in lt&&n(35,st=lt.enableMultiSelect),"willRenderShapeControls"in lt&&n(36,gt=lt.willRenderShapeControls),"willRenderShapeTextControls"in lt&&n(37,Jt=lt.willRenderShapeTextControls),"beforeAddShape"in lt&&n(38,le=lt.beforeAddShape),"beforeRemoveShape"in lt&&n(39,rt=lt.beforeRemoveShape),"beforeDeselectShape"in lt&&n(40,kt=lt.beforeDeselectShape),"beforeSelectShape"in lt&&n(41,Nt=lt.beforeSelectShape),"beforeUpdateShape"in lt&&n(42,$t=lt.beforeUpdateShape)},t.$$.update=()=>{503328768&t.$$.dirty[1]&&n(46,i=lt=>YS(lt,d,c,s.origin,s.translation,l.rotation.z,s.scale,a,o)),503328768&t.$$.dirty[1]&&n(45,r=lt=>qS(lt,d,c,s.origin,s.translation,l.rotation.z,s.scale,a,o))},[at,"annotate",p,h,y,m,f,b,v,w,T,I,P,_,C,F,G,O,$,N,it,M,W,ot,q,ct,V,ut,bt,K,vt,X,Z,mt,Bt,st,gt,Jt,le,rt,kt,Nt,$t,o,a,r,i,u,Be,nt,Ut,qt,Dt,ve,It,Ie,s,l,c,d,function(lt){at=lt,n(0,at)},function(lt){aa.call(this,t,lt)}]}var QS={util:["annotate",class extends Tn{constructor(t){super(),Sn(this,t,JS,KS,yn,{name:1,isActive:2,isActiveFraction:3,isVisible:4,stores:5,locale:6,markupEditorToolbar:7,markupEditorToolStyles:8,markupEditorToolRetainStyles:9,markupEditorShapeStyleControls:10,markupEditorToolSelectRadius:11,markupEditorTextInputMode:12,markupEditorToolShareStyles:13,markupEditorWillStartInteraction:14,markupEditorGridSize:15,markupEditorSnapThreshold:16,markupEditorSnapToContext:17,annotateGridSize:18,annotateSnapToContext:19,willRenderShapePresetToolbar:20,annotateTools:21,annotateToolShapes:22,annotateShapeControls:23,annotateActiveTool:0,annotateEnableButtonFlipVertical:24,annotateEnableSelectImagePreset:25,annotateEnableDropImagePreset:26,annotatePresets:27,annotateWillRenderShapePresetToolbar:28,annotateWillRenderShapeStyleControls:29,enableViewTool:30,enableSelectToolToAddShape:31,enableTapToAddText:32,enableAutoSelectMoveTool:33,enableMoveTool:34,enableMultiSelect:35,willRenderShapeControls:36,willRenderShapeTextControls:37,beforeAddShape:38,beforeRemoveShape:39,beforeDeselectShape:40,beforeSelectShape:41,beforeUpdateShape:42},null,[-1,-1])}get name(){return this.$$.ctx[1]}get isActive(){return this.$$.ctx[2]}set isActive(t){this.$$set({isActive:t}),U()}get isActiveFraction(){return this.$$.ctx[3]}set isActiveFraction(t){this.$$set({isActiveFraction:t}),U()}get isVisible(){return this.$$.ctx[4]}set isVisible(t){this.$$set({isVisible:t}),U()}get stores(){return this.$$.ctx[5]}set stores(t){this.$$set({stores:t}),U()}get locale(){return this.$$.ctx[6]}set locale(t){this.$$set({locale:t}),U()}get markupEditorToolbar(){return this.$$.ctx[7]}set markupEditorToolbar(t){this.$$set({markupEditorToolbar:t}),U()}get markupEditorToolStyles(){return this.$$.ctx[8]}set markupEditorToolStyles(t){this.$$set({markupEditorToolStyles:t}),U()}get markupEditorToolRetainStyles(){return this.$$.ctx[9]}set markupEditorToolRetainStyles(t){this.$$set({markupEditorToolRetainStyles:t}),U()}get markupEditorShapeStyleControls(){return this.$$.ctx[10]}set markupEditorShapeStyleControls(t){this.$$set({markupEditorShapeStyleControls:t}),U()}get markupEditorToolSelectRadius(){return this.$$.ctx[11]}set markupEditorToolSelectRadius(t){this.$$set({markupEditorToolSelectRadius:t}),U()}get markupEditorTextInputMode(){return this.$$.ctx[12]}set markupEditorTextInputMode(t){this.$$set({markupEditorTextInputMode:t}),U()}get markupEditorToolShareStyles(){return this.$$.ctx[13]}set markupEditorToolShareStyles(t){this.$$set({markupEditorToolShareStyles:t}),U()}get markupEditorWillStartInteraction(){return this.$$.ctx[14]}set markupEditorWillStartInteraction(t){this.$$set({markupEditorWillStartInteraction:t}),U()}get markupEditorGridSize(){return this.$$.ctx[15]}set markupEditorGridSize(t){this.$$set({markupEditorGridSize:t}),U()}get markupEditorSnapThreshold(){return this.$$.ctx[16]}set markupEditorSnapThreshold(t){this.$$set({markupEditorSnapThreshold:t}),U()}get markupEditorSnapToContext(){return this.$$.ctx[17]}set markupEditorSnapToContext(t){this.$$set({markupEditorSnapToContext:t}),U()}get annotateGridSize(){return this.$$.ctx[18]}set annotateGridSize(t){this.$$set({annotateGridSize:t}),U()}get annotateSnapToContext(){return this.$$.ctx[19]}set annotateSnapToContext(t){this.$$set({annotateSnapToContext:t}),U()}get willRenderShapePresetToolbar(){return this.$$.ctx[20]}set willRenderShapePresetToolbar(t){this.$$set({willRenderShapePresetToolbar:t}),U()}get annotateTools(){return this.$$.ctx[21]}set annotateTools(t){this.$$set({annotateTools:t}),U()}get annotateToolShapes(){return this.$$.ctx[22]}set annotateToolShapes(t){this.$$set({annotateToolShapes:t}),U()}get annotateShapeControls(){return this.$$.ctx[23]}set annotateShapeControls(t){this.$$set({annotateShapeControls:t}),U()}get annotateActiveTool(){return this.$$.ctx[0]}set annotateActiveTool(t){this.$$set({annotateActiveTool:t}),U()}get annotateEnableButtonFlipVertical(){return this.$$.ctx[24]}set annotateEnableButtonFlipVertical(t){this.$$set({annotateEnableButtonFlipVertical:t}),U()}get annotateEnableSelectImagePreset(){return this.$$.ctx[25]}set annotateEnableSelectImagePreset(t){this.$$set({annotateEnableSelectImagePreset:t}),U()}get annotateEnableDropImagePreset(){return this.$$.ctx[26]}set annotateEnableDropImagePreset(t){this.$$set({annotateEnableDropImagePreset:t}),U()}get annotatePresets(){return this.$$.ctx[27]}set annotatePresets(t){this.$$set({annotatePresets:t}),U()}get annotateWillRenderShapePresetToolbar(){return this.$$.ctx[28]}set annotateWillRenderShapePresetToolbar(t){this.$$set({annotateWillRenderShapePresetToolbar:t}),U()}get annotateWillRenderShapeStyleControls(){return this.$$.ctx[29]}set annotateWillRenderShapeStyleControls(t){this.$$set({annotateWillRenderShapeStyleControls:t}),U()}get enableViewTool(){return this.$$.ctx[30]}set enableViewTool(t){this.$$set({enableViewTool:t}),U()}get enableSelectToolToAddShape(){return this.$$.ctx[31]}set enableSelectToolToAddShape(t){this.$$set({enableSelectToolToAddShape:t}),U()}get enableTapToAddText(){return this.$$.ctx[32]}set enableTapToAddText(t){this.$$set({enableTapToAddText:t}),U()}get enableAutoSelectMoveTool(){return this.$$.ctx[33]}set enableAutoSelectMoveTool(t){this.$$set({enableAutoSelectMoveTool:t}),U()}get enableMoveTool(){return this.$$.ctx[34]}set enableMoveTool(t){this.$$set({enableMoveTool:t}),U()}get enableMultiSelect(){return this.$$.ctx[35]}set enableMultiSelect(t){this.$$set({enableMultiSelect:t}),U()}get willRenderShapeControls(){return this.$$.ctx[36]}set willRenderShapeControls(t){this.$$set({willRenderShapeControls:t}),U()}get willRenderShapeTextControls(){return this.$$.ctx[37]}set willRenderShapeTextControls(t){this.$$set({willRenderShapeTextControls:t}),U()}get beforeAddShape(){return this.$$.ctx[38]}set beforeAddShape(t){this.$$set({beforeAddShape:t}),U()}get beforeRemoveShape(){return this.$$.ctx[39]}set beforeRemoveShape(t){this.$$set({beforeRemoveShape:t}),U()}get beforeDeselectShape(){return this.$$.ctx[40]}set beforeDeselectShape(t){this.$$set({beforeDeselectShape:t}),U()}get beforeSelectShape(){return this.$$.ctx[41]}set beforeSelectShape(t){this.$$set({beforeSelectShape:t}),U()}get beforeUpdateShape(){return this.$$.ctx[42]}set beforeUpdateShape(t){this.$$set({beforeUpdateShape:t}),U()}}]};const my='<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M18 6L6 18M6 6l12 12"></path></path></g>',oh='<path fill="none" d="M9 15 L12 9 L15 15 M10 13.5 h3" stroke="currentColor" stroke-width=".125em"/>';var t8={labelReset:"Reset",labelDefault:"Default",labelAuto:"Auto",labelNone:"None",labelEdit:"Edit",labelClose:"Close",labelSupportError:t=>t.join(", ")+" not supported on this browser",labelColor:"Color",labelWidth:"Width",labelSize:"Size",labelOffset:"Offset",labelAmount:"Amount",labelInset:"Inset",labelRadius:"Radius",labelColorPalette:"Color palette",labelSizeExtraSmall:"Extra small",labelSizeSmall:"Small",labelSizeMediumSmall:"Medium small",labelSizeMedium:"Medium",labelSizeMediumLarge:"Medium large",labelSizeLarge:"Large",labelSizeExtraLarge:"Extra large",labelButtonCancel:"Cancel",labelButtonUndo:"Undo",labelButtonRedo:"Redo",labelButtonRevert:"Revert",labelButtonExport:"Done",labelZoomIn:"Zoom in",labelZoomOut:"Zoom out",labelZoomFit:"Fit to view",labelZoomActual:"Actual size",iconZoomIn:'<path stroke="currentColor" stroke-width=".125em" d="M8 12 h8 M12 8 v8" />',iconZoomOut:'<path stroke="currentColor" stroke-width=".125em" d="M9 12 h6" />',iconSupportError:'<g fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><g><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></g>',iconButtonClose:my,iconButtonRevert:'<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M7.388 18.538a8 8 0 10-2.992-9.03"/><path fill="currentColor" d="M2.794 11.696L2.37 6.714l5.088 3.18z"/><path d="M12 8v4M12 12l4 2"/></g>',iconButtonUndo:'<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M10 8h4c2.485 0 5 2 5 5s-2.515 5-5 5h-4"/><path fill="currentColor" d="M5 8l4-3v6z"/></g>',iconButtonRedo:'<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M14 8h-4c-2.485 0-5 2-5 5s2.515 5 5 5h4"/><path fill="currentColor" d="M19 8l-4-3v6z"/></g>',iconButtonExport:'<polyline points="20 6 9 17 4 12" fill="none" stroke="currentColor" stroke-width=".125em"></polyline>',statusLabelButtonClose:"Close",statusIconButtonClose:my,statusLabelLoadImage:t=>t&&t.task?t.error?t.error.code==="IMAGE_TOO_SMALL"?"Minimum image size is {minWidth} &times; {minHeight}":"Error loading image":t.task==="blob-to-bitmap"?"Preparing image&hellip;":"Loading image&hellip;":"Waiting for image",statusLabelProcessImage:t=>{if(t&&t.task)return t.task==="store"?t.error?"Error uploading image":"Uploading image&hellip;":t.error?"Error processing image":"Processing image&hellip;"}};const e8={shapeLabelButtonSelectSticker:"Select image",shapeIconButtonSelectSticker:'<g fill="none" stroke="currentColor" stroke-width="0.0625em"><path d="M8 21 L15 11 L19 15"/><path d="M15 2 v5 h5"/><path d="M8 2 h8 l4 4 v12 q0 4 -4 4 h-8 q-4 0 -4 -4 v-12 q0 -4 4 -4z"/></g><circle fill="currentColor" cx="10" cy="8" r="1.5"/>',shapeIconButtonFlipHorizontal:'<g stroke="currentColor" stroke-width=".125em"><path fill="none" d="M6 6.5h5v11H6z"/><path fill="currentColor" d="M15 6.5h3v11h-3z"/><path d="M11 4v16" fill="currentColor"/></g>',shapeIconButtonFlipVertical:'<g stroke="currentColor" stroke-width=".125em"><rect x="7" y="8" width="11" height="5" fill="none"/><rect x="7" y="17" width="11" height="2" fill="currentColor"/><line x1="5" y1="13" x2="20" y2="13"/></g>',shapeIconButtonRemove:'<g fill="none" fill-rule="evenodd"><path stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M7.5 7h9z"/><path d="M7.916 9h8.168a1 1 0 01.99 1.14l-.972 6.862a2 2 0 01-1.473 1.653c-.877.23-1.753.345-2.629.345-.876 0-1.752-.115-2.628-.345a2 2 0 01-1.473-1.653l-.973-6.862A1 1 0 017.916 9z" fill="currentColor"/><rect fill="currentColor" x="10" y="5" width="4" height="3" rx="1"/></g>',shapeIconButtonDuplicate:'<g fill="none" fill-rule="evenodd"><path d="M15 13.994V16a2 2 0 01-2 2H8a2 2 0 01-2-2v-5a2 2 0 012-2h2.142" stroke="currentColor" stroke-width=".125em"/><path d="M15 9V8a1 1 0 00-2 0v1h-1a1 1 0 000 2h1v1a1 1 0 002 0v-1h1a1 1 0 000-2h-1zm-4-4h6a2 2 0 012 2v6a2 2 0 01-2 2h-6a2 2 0 01-2-2V7a2 2 0 012-2z" fill="currentColor"/></g>',shapeIconButtonMoveToFront:'<g fill="none" fill-rule="evenodd"><rect fill="currentColor" x="11" y="13" width="8" height="2" rx="1"/><rect fill="currentColor" x="9" y="17" width="10" height="2" rx="1"/><path d="M11.364 8H10a5 5 0 000 10M12 6.5L14.5 8 12 9.5z" stroke="currentColor" stroke-width=".125em" stroke-linecap="round"/></g>',shapeIconButtonTextLayoutAutoWidth:""+oh,shapeIconButtonTextLayoutAutoHeight:'<g fill="currentColor"><circle cx="4" cy="12" r="1.5"/><circle cx="20" cy="12" r="1.5"/></g>'+oh,shapeIconButtonTextLayoutFixedSize:'<g fill="currentColor"><circle cx="5" cy="6" r="1.5"/><circle cx="19" cy="6" r="1.5"/><circle cx="19" cy="19" r="1.5"/><circle cx="5" cy="19" r="1.5"/></g>'+oh,shapeTitleButtonTextLayoutAutoWidth:"Auto width",shapeTitleButtonTextLayoutAutoHeight:"Auto height",shapeTitleButtonTextLayoutFixedSize:"Fixed size",shapeTitleButtonFlipHorizontal:"Flip Horizontal",shapeTitleButtonFlipVertical:"Flip Vertical",shapeTitleButtonRemove:"Remove",shapeTitleButtonDuplicate:"Duplicate",shapeTitleButtonMoveToFront:"Move to front",shapeLabelInputText:"Edit text",shapeIconInputCancel:'<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M18 6L6 18M6 6l12 12"/></g>',shapeIconInputConfirm:'<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><polyline points="20 6 9 17 4 12"/></g>',shapeLabelInputCancel:"Cancel",shapeLabelInputConfirm:"Confirm",shapeLabelStrokeNone:"No outline",shapeLabelFontStyleNormal:"Normal",shapeLabelFontStyleBold:"Bold",shapeLabelFontStyleItalic:"Italic",shapeLabelFontStyleItalicBold:"Bold Italic",shapeTitleBackgroundColor:"Fill color",shapeTitleCornerRadius:"Corner radius",shapeTitleFontFamily:"Font",shapeTitleFontSize:"Font size",shapeTitleFontStyle:"Font style",shapeTitleLineHeight:"Line height",shapeTitleLineStart:"Start",shapeTitleLineEnd:"End",shapeTitleStrokeWidth:"Line width",shapeTitleStrokeColor:"Line color",shapeTitleLineDecorationBar:"Bar",shapeTitleLineDecorationCircle:"Circle",shapeTitleLineDecorationSquare:"Square",shapeTitleLineDecorationArrow:"Arrow",shapeTitleLineDecorationCircleSolid:"Circle solid",shapeTitleLineDecorationSquareSolid:"Square solid",shapeTitleLineDecorationArrowSolid:"Arrow solid",shapeIconLineDecorationBar:'<g stroke="currentColor" stroke-linecap="round" stroke-width=".125em"><path d="M5,12 H16"/><path d="M16,8 V16"/></g>',shapeIconLineDecorationCircle:'<g stroke="currentColor" stroke-linecap="round"><path stroke-width=".125em" d="M5,12 H12"/><circle fill="none" stroke-width=".125em" cx="16" cy="12" r="4"/></g>',shapeIconLineDecorationSquare:'<g stroke="currentColor" stroke-linecap="round"><path stroke-width=".125em" d="M5,12 H12"/><rect fill="none" stroke-width=".125em" x="12" y="8" width="8" height="8"/></g>',shapeIconLineDecorationArrow:'<g stroke="currentColor" stroke-linecap="round" stroke-width=".125em"><path d="M5,12 H16 M13,7 l6,5 l-6,5" fill="none"/></g>',shapeIconLineDecorationCircleSolid:'<g stroke="currentColor" stroke-linecap="round"><path stroke-width=".125em" d="M5,12 H12"/><circle fill="currentColor" cx="16" cy="12" r="4"/></g>',shapeIconLineDecorationSquareSolid:'<g stroke="currentColor" stroke-linecap="round"><path stroke-width=".125em" d="M5,12 H12"/><rect fill="currentColor" x="12" y="8" width="8" height="8"/></g>',shapeIconLineDecorationArrowSolid:'<g stroke="currentColor" stroke-linecap="round" stroke-width=".125em"><path d="M5,12 H16"/><path d="M13,7 l6,5 l-6,5z" fill="currentColor"/></g>',shapeTitleColorTransparent:"Transparent",shapeTitleColorWhite:"White",shapeTitleColorSilver:"Silver",shapeTitleColorGray:"Gray",shapeTitleColorBlack:"Black",shapeTitleColorNavy:"Navy",shapeTitleColorBlue:"Blue",shapeTitleColorAqua:"Aqua",shapeTitleColorTeal:"Teal",shapeTitleColorOlive:"Olive",shapeTitleColorGreen:"Green",shapeTitleColorYellow:"Yellow",shapeTitleColorOrange:"Orange",shapeTitleColorRed:"Red",shapeTitleColorMaroon:"Maroon",shapeTitleColorFuchsia:"Fuchsia",shapeTitleColorPurple:"Purple",shapeTitleTextOutline:"Text outline",shapeTitleTextOutlineWidth:"Width",shapeTitleTextShadow:"Text shadow",shapeTitleTextShadowBlur:"Blur",shapeTitleTextColor:"Font color",shapeTitleTextAlign:"Text align",shapeTitleTextAlignLeft:"Left align text",shapeTitleTextAlignCenter:"Center align text",shapeTitleTextAlignRight:"Right align text",shapeIconTextAlignLeft:'<g stroke-width=".125em" stroke="currentColor"><line x1="5" y1="8" x2="15" y2="8"/><line x1="5" y1="12" x2="19" y2="12"/><line x1="5" y1="16" x2="14" y2="16"/></g>',shapeIconTextAlignCenter:'<g stroke-width=".125em" stroke="currentColor"><line x1="7" y1="8" x2="17" y2="8"/><line x1="5" y1="12" x2="19" y2="12"/><line x1="8" y1="16" x2="16" y2="16"/></g>',shapeIconTextAlignRight:'<g stroke-width=".125em" stroke="currentColor"><line x1="9" y1="8" x2="19" y2="8"/><line x1="5" y1="12" x2="19" y2="12"/><line x1="11" y1="16" x2="19" y2="16"/></g>',shapeLabelToolMove:"Move",shapeLabelToolView:"View",shapeLabelToolSharpie:"Sharpie",shapeLabelToolEraser:"Eraser",shapeLabelToolPath:"Path",shapeLabelToolRectangle:"Rectangle",shapeLabelToolEllipse:"Ellipse",shapeLabelToolArrow:"Arrow",shapeLabelToolLine:"Line",shapeLabelToolText:"Text",shapeLabelToolPreset:"Stickers",shapeIconToolView:'<g stroke-width=".125em" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path d="M10.98 9.703V2.567c0-1.19 1.19-1.785 1.784-1.785.595 0 1.784.595 1.784 1.785v3.568"/><path d="M14.548 9.703V4.35c0-1.19 1.19-1.784 1.784-1.784.595 0 1.784.594 1.784 1.784v2.973"/><path d="M18.116 10.244V7.271c0-1.19 1.19-1.784 1.784-1.784.595 0 1.785.595 1.785 1.784 0 1.19 0 8.92-1.19 12.488-1.19 3.569-10.704 4.758-13.678 0-2.973-4.757-2.973-4.757-4.163-6.541-1.189-1.784-1.153-2.974-.594-3.568.558-.595 1.784-1.19 2.973.594 1.277 1.916 2.07 2.907 2.379 2.974V5.487c0-1.19 1.19-1.784 1.784-1.784.595 0 1.784.595 1.784 1.784V8.46"/></g>',shapeIconToolMove:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M6 2 L6 19 L18 13 Z M13 18 L16 24" stroke="currentColor" stroke-width=".125em" fill="none" fill-rule="evenodd" stroke-linejoin="round"/></g>',shapeIconToolSharpie:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M2.025 5c5.616-2.732 8.833-3.857 9.65-3.374C12.903 2.351.518 12.666 2.026 14 3.534 15.334 16.536.566 17.73 2.566 18.924 4.566 3.98 17.187 4.831 18c.851.813 9.848-6 11.643-6 1.087 0-2.53 5.11-2.92 7-.086.41 3.323-1.498 4.773-1 .494.17.64 2.317 1.319 3 .439.443 1.332.776 2.679 1" stroke="currentColor" stroke-width=".125em" fill="none" fill-rule="evenodd" stroke-linejoin="round"/></g>',shapeIconToolEraser:'<g stroke-width=".125em" stroke="currentColor" stroke-linecap="round" fill="none"><g transform="translate(3, 15) rotate(-45)"><rect x="0" y="0" width="18" height="10" rx="3"/></g><line x1="11" y1="21" x2="18" y2="21"/><line x1="20" y1="21" x2="22" y2="21"/></g>',shapeIconToolPath:'<g stroke-width=".125em" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" fill="none"><circle cx="21" cy="3" r="2"/><circle cx="9" cy="9" r="2"/><circle cx="3" cy="21" r="2"/><path d="M19 4 11 8 M8 11 4 19"/></g>',shapeIconToolRectangle:'<g stroke-width=".125em" stroke="currentColor" fill="none"><rect x="1" y="1" width="22" height="22" rx="4"/></g>',shapeIconToolEllipse:'<g stroke-width=".125em" stroke="currentColor" fill="none"><circle cx="12" cy="12" r="11"/></g>',shapeIconToolArrow:'<g stroke-width=".125em" stroke="currentColor" fill="none"><line x1="20" y1="3" x2="6" y2="21"/><path d="m10 6 L21.5 1 L20 13.5" fill="currentColor" stroke="none"/></g>',shapeIconToolLine:'<g stroke-width=".125em" stroke="currentColor" fill="none"><line x1="20" y1="3" x2="6" y2="21"/></g>',shapeIconToolText:'<g stroke="none" fill="currentColor" transform="translate(6,0)"><path d="M8.14 20.085c.459 0 .901-.034 1.329-.102a8.597 8.597 0 001.015-.21v1.984c-.281.135-.695.247-1.242.336a9.328 9.328 0 01-1.477.133c-3.312 0-4.968-1.745-4.968-5.235V6.804H.344v-1.25l2.453-1.078L3.89.819h1.5v3.97h4.97v2.015H5.39v10.078c0 1.031.245 1.823.735 2.375s1.161.828 2.015.828z"/>',shapeIconToolPreset:'<g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M12 22c2.773 0 1.189-5.177 3-7 1.796-1.808 7-.25 7-3 0-5.523-4.477-10-10-10S2 6.477 2 12s4.477 10 10 10z"></path><path d="M20 17c-3 3-5 5-8 5"></path></g>',shapeTitleSelectionMode:"Selection mode",shapeTitleBrushSize:"Brush size",shapeLabelSelectionModeNew:"New",shapeLabelSelectionModeAdd:"Add",shapeLabelSelectionModeSubtract:"Remove",shapeLabelToolSelectionBrush:"Brush",shapeLabelToolSelectionLassoo:"Lassoo",shapeLabelToolSelectionRectangle:"Rectangle marquee",shapeLabelToolSelectionEllipse:"Ellipse marquee",shapeIconSelectionModeNew:'<g fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"><path d="M6.5 17H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v1.5"/><rect width="12" height="12" x="9" y="9" fill="currentColor" fill-opacity=".25" rx="2"/></g>',shapeIconSelectionModeAdd:'<g fill="none" fill-rule="evenodd" stroke="currentColor"><path fill="currentColor" fill-opacity=".25" stroke-linecap="round" stroke-linejoin="round" d="M15 3a2 2 0 0 1 2 2v4h2a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-8a2 2 0 0 1-2-2v-2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h10Z"/><path d="M13 15h4M15 13v4"/></g>',shapeIconSelectionModeSubtract:'<g fill="none" fill-rule="evenodd" stroke="currentColor"><path fill="currentColor" fill-opacity=".25" stroke-linecap="round" stroke-linejoin="round" d="M15 3a2 2 0 0 1 2 2v4h-6a2 2 0 0 0-1.995 1.85L9 11v6H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h10Z"/><rect width="12" height="12" x="9" y="9" stroke-linecap="round" stroke-linejoin="round" rx="2"/><path d="M13 15h4"/></g>',shapeIconToolSelectionBrush:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M2.025 5c5.616-2.732 8.833-3.857 9.65-3.374C12.903 2.351.518 12.666 2.026 14 3.534 15.334 16.536.566 17.73 2.566 18.924 4.566 3.98 17.187 4.831 18c.851.813 9.848-6 11.643-6 1.087 0-2.53 5.11-2.92 7-.086.41 3.323-1.498 4.773-1 .494.17.64 2.317 1.319 3 .439.443 1.332.776 2.679 1" stroke="currentColor" fill-rule="evenodd" stroke-linejoin="round"/></g>',shapeIconToolSelectionLassoo:'<g fill="none" fill-rule="evenodd" stroke-width=".125em" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M11.428 17.702a18.46 18.46 0 0 0 4.085-1.595c5.851-3.112 9.019-8.599 7.074-12.256-1.945-3.657-8.265-4.1-14.116-.988C2.619 5.974-.55 11.46 1.396 15.118c.63 1.186 1.72 2.033 3.105 2.532"/><ellipse cx="8" cy="18.5" rx="3.5" ry="2.833" transform="rotate(-15 8 18.5)"/><path stroke-linecap="round" d="M5 18c3.347 1.048 5.514 1.881 6.5 2.5.859.54 1.517.994 1.5 2.364"/></g>',shapeIconToolSelectionRectangle:'<g stroke-width=".125em" stroke="currentColor"><path d="M9 1 h6 m4 0 h4v4 m0 4 v6 m0 4 v4h-4 m-4 0 h-6 m-4 0 h-4v-4 m0 -4 v-6 m0 -4 v-4h4" fill="none" /></g>',shapeIconToolSelectionEllipse:'<path stroke-width=".125em" stroke="currentColor" d="M1.21 9.853a11.054 11.054 0 0 0 0 4.294m1.643 3.965a11.054 11.054 0 0 0 3.035 3.035m3.965 1.644a11.054 11.054 0 0 0 4.294 0m3.965-1.644a11.054 11.054 0 0 0 3.035-3.035m1.644-3.965a11.054 11.054 0 0 0 0-4.294m-1.644-3.965a11.054 11.054 0 0 0-3.035-3.035m-3.965-1.644a11.054 11.054 0 0 0-4.294 0M5.888 2.853a11.054 11.054 0 0 0-3.035 3.035"/>'};var n8={cropLabel:"Crop",cropIcon:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M23 17H9a2 2 0 0 1-2-2v-5m0-3V1 M1 7h14a2 2 0 0 1 2 2v7m0 4v3"/></g>',cropIconButtonRecenter:'<path stroke="currentColor" fill="none" stroke-width="2" stroke-linejoin="bevel" d="M1.5 7.5v-6h6M1.5 16.5v6h6M22.5 16.5v6h-6M22.5 7.5v-6h-6"/><circle cx="12" cy="12" r="3.5" fill="currentColor" stroke="none"/>',cropIconButtonRotateLeft:'<g stroke="none" fill="currentColor"><path fill="none" d="M-1-1h582v402H-1z"/><rect x="3" rx="1" height="12" width="12" y="9"/><path d="M15 5h-1a5 5 0 015 5 1 1 0 002 0 7 7 0 00-7-7h-1.374l.747-.747A1 1 0 0011.958.84L9.603 3.194a1 1 0 000 1.415l2.355 2.355a1 1 0 001.415-1.414l-.55-.55H15z"/></g>',cropIconButtonRotateRight:'<g stroke="none" fill="currentColor"><path fill="none" d="M-1-1h582v402H-1z"/><path d="M11.177 5H10a5 5 0 00-5 5 1 1 0 01-2 0 7 7 0 017-7h1.374l-.747-.747A1 1 0 0112.042.84l2.355 2.355a1 1 0 010 1.415l-2.355 2.354a1 1 0 01-1.415-1.414l.55-.55z"/><rect rx="1" height="12" width="12" y="9" x="9"/></g>',cropIconButtonFlipVertical:'<g stroke="none" fill="currentColor"><path d="M19.993 12.143H7a1 1 0 0 1-1-1V5.994a1 1 0 0 1 1.368-.93l12.993 5.15a1 1 0 0 1-.368 1.93z"/><path d="M19.993 14a1 1 0 0 1 .368 1.93L7.368 21.078A1 1 0 0 1 6 20.148V15a1 1 0 0 1 1-1h12.993z" opacity=".6"/></g>',cropIconButtonFlipHorizontal:'<g stroke="none" fill="currentColor"><path d="M11.93 7.007V20a1 1 0 0 1-1 1H5.78a1 1 0 0 1-.93-1.368l5.15-12.993a1 1 0 0 1 1.929.368z"/><path d="M14 7.007V20a1 1 0 0 0 1 1h5.149a1 1 0 0 0 .93-1.368l-5.15-12.993A1 1 0 0 0 14 7.007z" opacity=".6"/></g>',cropIconSelectPreset:(t,e)=>{const[n,i,r]=e?[e<1?1:.3,e===1?.85:.5,e>1?1:.3]:[.2,.3,.4];return`<g fill="currentColor">
            <rect opacity="${n}" x="2" y="4" width="10" height="18" rx="1"/>
            <rect opacity="${i}" x="4" y="8" width="14" height="14" rx="1"/>
            <rect opacity="${r}" x="6" y="12" width="17" height="10" rx="1"/>
        </g>`},cropIconCropBoundary:(t,e)=>{const[n,i,r,o]=e?[.3,1,0,0]:[0,0,.3,1];return`<g fill="currentColor">
            <rect opacity="${n}" x="2" y="3" width="20" height="20" rx="1"/>
            <rect opacity="${i}" x="7" y="8" width="10" height="10" rx="1"/>
            <rect opacity="${r}" x="4" y="8" width="14" height="14" rx="1"/>
            <rect opacity="${o}" x="12" y="4" width="10" height="10" rx="1"/>
        </g>`},cropLabelButtonRecenter:"Recenter",cropLabelButtonRotateLeft:"Rotate left",cropLabelButtonRotateRight:"Rotate right",cropLabelButtonFlipHorizontal:"Flip horizontal",cropLabelButtonFlipVertical:"Flip vertical",cropLabelSelectPreset:"Crop shape",cropLabelCropBoundary:"Crop boundary",cropLabelCropBoundaryEdge:"Edge of image",cropLabelCropBoundaryNone:"None",cropLabelTabRotation:"Rotation",cropLabelTabZoom:"Scale"},Hu=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t);Object.keys(n).forEach(i=>{n[i].get?Object.defineProperty(e,i,{get:()=>t[i],set:r=>t[i]=r}):e[i]=t[i]})},kx=t=>{const e={},{sub:n,pub:i}=za();ir()&&document.doctype!==null||console.warn("Browser is in quirks mode, add <!DOCTYPE html> to page to fix render issues");const r=L2();Hu(r,e);const o=((c,d)=>{const u={},p=new m$({target:c,props:{stores:d,pluginComponents:Array.from(Ah)}});let h=!1;const y=()=>{h||(ir()&&window.removeEventListener("pagehide",y),p&&(h=!0,p.$destroy()))};th||(th=new Set($0(m$).filter(f=>!q5.includes(f)))),th.forEach(f=>{Object.defineProperty(u,f,{get:()=>p[f],set:Y5.includes(f)?b=>{p[f]={...p[f],...b}}:b=>p[f]=b})}),Object.defineProperty(u,"previewImageData",{get:()=>p.imagePreviewCurrent}),px.forEach(f=>{const b=Cu[f],v=b[0];Object.defineProperty(u,f,{get:()=>p.pluginInterface[v][f],set:w=>{const T=b.reduce((I,P)=>(I[P]={...p.pluginOptions[P],[f]:w},I),{});p.pluginOptions={...p.pluginOptions,...T}}})}),Object.defineProperty(u,"element",{get:()=>p.root,set:()=>{}});const m=p.history;return Yc(u,{on:(f,b)=>{if(h)return()=>{};if(/undo|redo|revert|writehistory/.test(f))return m.on(f,b);const v=[p.sub(f,b),p.$on(f,w=>b(w instanceof CustomEvent&&!w.detail?void 0:w))].filter(Boolean);return()=>v.forEach(w=>w())},updateImagePreview:f=>{p.imagePreviewSrc=f},close:()=>!h&&p.pub("close"),destroy:y}),Object.defineProperty(u,"history",{get:()=>({undo:()=>m.undo(),redo:()=>m.redo(),revert:()=>m.revert(),get:()=>m.get(),getCollapsed:()=>m.get().splice(0,m.index+1),set:f=>m.set(f),write:f=>m.write(f),get length(){return m.length()},get index(){return m.index},set index(f){m.index=f}})}),ir()&&window.addEventListener("pagehide",y),u})(t,r.stores);Hu(o,e);const a=["loadImage","processImage","abortProcessImage","abortLoadImage"].map(c=>o.on(c,d=>{const u=r[c](d&&d.detail);u instanceof Promise&&u.catch(ae)})),s=(c,d)=>{const u=n(c,d),p=r.on(c,d),h=o.on(c,d);return()=>{u(),p(),h()}};e.handleEvent=ae;const l=hx.map(c=>s(c,d=>e.handleEvent(c,d)));return Yc(e,{on:s,updateImage:c=>new Promise((d,u)=>{const p=e.history.get(),h=e.history.index,y=e.imageState;r.loadImage(c).then(m=>{e.history.set(p),e.history.index=h,e.imageState=y,d(m)}).catch(u)}),close:()=>{i("close")},destroy:()=>{[...a,...l].forEach(c=>c()),o.destroy(),r.destroy(),i("destroy")}}),setTimeout(()=>i("init",e),0),e};ir();const{document:gy,window:Mu}=a0;function i8(t){let e,n,i,r;return hl(t[27]),{c(){e=pe(),n=ft("div"),S(n,"class",t[4]),S(n,"style",t[5])},m(o,a){tt(o,e,a),tt(o,n,a),t[28](n),i||(r=[St(Mu,"keydown",t[10]),St(Mu,"orientationchange",t[11]),St(Mu,"resize",t[27]),St(gy.body,"focusin",function(){Hn(!t[1]&&t[7])&&(!t[1]&&t[7]).apply(this,arguments)}),St(gy.body,"focusout",function(){Hn(t[2]&&t[8])&&(t[2]&&t[8]).apply(this,arguments)}),St(n,"wheel",t[9],{passive:!1})],i=!0)},p(o,a){t=o,16&a[0]&&S(n,"class",t[4]),32&a[0]&&S(n,"style",t[5])},i:tn,o:tn,d(o){o&&Q(e),o&&Q(n),t[28](null),i=!1,Zn(r)}}}function r8(t,e,n){let i,r,o,a,s,l,c,d;const u=la();let{root:p}=e,{preventZoomViewport:h=!0}=e,{preventScrollBodyIfNeeded:y=!0}=e,{preventFooterOverlapIfNeeded:m=!0}=e,{class:f}=e,b=!0,v=!1,w=!1,T=ir()&&document.documentElement,I=ir()&&document.body,P=ir()&&document.head;const _=fn(0,{precision:.001,damping:.5});D(t,_,K=>n(26,d=K));const C=_.subscribe(K=>{w&&K>=1?(n(19,w=!1),n(1,b=!1),u("show")):v&&K<=0&&(n(18,v=!1),n(1,b=!0),u("hide"))});let F=!1,G,O,$;const N=()=>document.querySelector("meta[name=viewport]"),it=()=>Array.from(document.querySelectorAll("meta[name=theme-color]"));let M;const W=(K,vt)=>{const X=()=>{K()?vt():requestAnimationFrame(X)};requestAnimationFrame(X)};let ot,at,q=0,ct;const V=()=>{at||(at=fi("div",{style:"position:fixed;height:100vh;top:0"}),I.append(at))};ds(()=>{m&&Io()&&V()}),S2(()=>{at&&(n(21,ct=at.offsetHeight),at.remove(),at=void 0)});let ut;const bt=()=>T.style.setProperty("--pintura-document-height",window.innerHeight+"px");return Ho(()=>{T.classList.remove("PinturaModalBodyLock"),C()}),t.$$set=K=>{"root"in K&&n(0,p=K.root),"preventZoomViewport"in K&&n(12,h=K.preventZoomViewport),"preventScrollBodyIfNeeded"in K&&n(13,y=K.preventScrollBodyIfNeeded),"preventFooterOverlapIfNeeded"in K&&n(14,m=K.preventFooterOverlapIfNeeded),"class"in K&&n(15,f=K.class)},t.$$.update=()=>{67895298&t.$$.dirty[0]&&n(25,i=w||v?d:b?0:1),4096&t.$$.dirty[0]&&(r="width=device-width,height=device-height,initial-scale=1"+(h?",maximum-scale=1,user-scalable=0":"")),786434&t.$$.dirty[0]&&n(22,o=!w&&!b&&!v),12&t.$$.dirty[0]&&(F||n(20,ot=q)),2097160&t.$$.dirty[0]&&n(24,a=dn(ct)?"--viewport-pad-footer:"+(ct>q?0:1):""),51380224&t.$$.dirty[0]&&n(5,s=`opacity:${i};height:${ot}px;--editor-modal:1;${a}`),32768&t.$$.dirty[0]&&n(4,l=rn(["pintura-editor","PinturaModal",f])),8192&t.$$.dirty[0]&&n(23,c=y&&Io()&&/15_/.test(navigator.userAgent)),12582912&t.$$.dirty[0]&&c&&(K=>{K?(ut=window.scrollY,T.classList.add("PinturaDocumentLock"),bt(),window.addEventListener("resize",bt)):(window.removeEventListener("resize",bt),T.classList.remove("PinturaDocumentLock"),dn(ut)&&window.scrollTo(0,ut),ut=void 0)})(o)},[p,b,F,q,l,s,_,K=>{ml(K.target)&&(n(2,F=!0),M=q)},K=>{if(ml(K.target))if(clearTimeout(void 0),M===q)n(2,F=!1);else{const vt=q;W(()=>q!==vt,()=>n(2,F=!1))}},K=>{K.target&&/PinturaStage/.test(K.target.className)&&K.preventDefault()},K=>{const{key:vt}=K;if(!/escape/i.test(vt))return;const X=K.target;if(X&&/input|textarea/i.test(X.nodeName))return;const Z=document.querySelectorAll(".PinturaModal");Z[Z.length-1]===p&&u("close")},V,h,y,m,f,()=>{if(w||!b)return;n(19,w=!0);const K=N()||fi("meta",{name:"viewport"});G=!G&&K.getAttribute("content"),K.setAttribute("content",r+(/cover/.test(G)?",viewport-fit=cover":"")),K.parentNode||P.append(K);const vt=getComputedStyle(p).getPropertyValue("--color-background"),X=it();if(X.length)O=X.map(Z=>Z.getAttribute("content"));else{const Z=fi("meta",{name:"theme-color"});P.append(Z),X.push(Z)}X.forEach(Z=>Z.setAttribute("content",`rgb(${vt})`)),clearTimeout($),$=setTimeout(()=>_.set(1),250)},()=>{if(v||b)return;clearTimeout($),n(18,v=!0);const K=N();G?K.setAttribute("content",G):K.remove();const vt=it();O?vt.forEach((X,Z)=>{X.setAttribute("content",O[Z])}):vt.forEach(X=>X.remove()),_.set(0)},v,w,ot,ct,o,c,a,i,d,function(){n(3,q=Mu.innerHeight)},function(K){Nn[K?"unshift":"push"](()=>{p=K,n(0,p)})}]}class o8 extends Tn{constructor(e){super(),Sn(this,e,r8,i8,yn,{root:0,preventZoomViewport:12,preventScrollBodyIfNeeded:13,preventFooterOverlapIfNeeded:14,class:15,show:16,hide:17},null,[-1,-1])}get root(){return this.$$.ctx[0]}set root(e){this.$$set({root:e}),U()}get preventZoomViewport(){return this.$$.ctx[12]}set preventZoomViewport(e){this.$$set({preventZoomViewport:e}),U()}get preventScrollBodyIfNeeded(){return this.$$.ctx[13]}set preventScrollBodyIfNeeded(e){this.$$set({preventScrollBodyIfNeeded:e}),U()}get preventFooterOverlapIfNeeded(){return this.$$.ctx[14]}set preventFooterOverlapIfNeeded(e){this.$$set({preventFooterOverlapIfNeeded:e}),U()}get class(){return this.$$.ctx[15]}set class(e){this.$$set({class:e}),U()}get show(){return this.$$.ctx[16]}get hide(){return this.$$.ctx[17]}}typeof window<"u"&&(t=>{if(!t)return;const[e,n,i,r]=[[108,111,99,97,116,105,111,110],[82,101,103,69,120,112],[116,101,115,116],[112,113,105,110,97,92,46,110,108]].map(o=>o.map(a=>String.fromCharCode(a)).join(""));t._l052uvt=new t[n](r)[i](t[e])})(window);const a8=j2,s8=Z2,l8=()=>({read:Ib,apply:Ty}),c8={markupEditorToolbar:P3(),markupEditorToolStyles:E3(),markupEditorShapeStyleControls:Y3()},d8=K5,u8=z6,p8=U6,h8=K6,m8=QS,g8=T3,f8=p3,$8=t8,y8=e8,x8=n8,b8={filterLabel:"Filter",filterIcon:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M18.347 9.907a6.5 6.5 0 1 0-1.872 3.306M3.26 11.574a6.5 6.5 0 1 0 2.815-1.417 M10.15 17.897A6.503 6.503 0 0 0 16.5 23a6.5 6.5 0 1 0-6.183-8.51"/></g>',filterLabelChrome:"Chrome",filterLabelFade:"Fade",filterLabelCold:"Cold",filterLabelWarm:"Warm",filterLabelPastel:"Pastel",filterLabelMonoDefault:"Mono",filterLabelMonoNoir:"Noir",filterLabelMonoWash:"Wash",filterLabelMonoStark:"Stark",filterLabelSepiaDefault:"Sepia",filterLabelSepiaBlues:"Blues",filterLabelSepiaRust:"Rust",filterLabelSepiaColor:"Color"},v8={finetuneLabel:"Finetune",finetuneIcon:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M4 1v5.5m0 3.503V23M12 1v10.5m0 3.5v8M20 1v15.5m0 3.5v3M2 7h4M10 12h4M18 17h4"/></g>',finetuneLabelBrightness:"Brightness",finetuneLabelContrast:"Contrast",finetuneLabelSaturation:"Saturation",finetuneLabelExposure:"Exposure",finetuneLabelTemperature:"Temperature",finetuneLabelGamma:"Gamma",finetuneLabelClarity:"Clarity",finetuneLabelVignette:"Vignette"},w8={annotateLabel:"Annotate",annotateIcon:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M17.086 2.914a2.828 2.828 0 1 1 4 4l-14.5 14.5-5.5 1.5 1.5-5.5 14.5-14.5z"/></g>'},S8=(t={},e)=>{const{sub:n,pub:i}=za(),r={},o=((p={},h)=>new o8({target:h||document.body,props:{class:p.class,preventZoomViewport:p.preventZoomViewport,preventScrollBodyIfNeeded:p.preventScrollBodyIfNeeded,preventFooterOverlapIfNeeded:p.preventFooterOverlapIfNeeded}}))(t,e),a=()=>{o.hide&&o.hide()},s=()=>{o.show&&o.show()},l=kx(o.root);Hu(l,r),r.handleEvent=ae,l.handleEvent=(p,h)=>{if(p==="init")return r.handleEvent(p,r);r.handleEvent(p,h)},l.on("close",async()=>{const{willClose:p}=t;if(!p)return a();await p()&&a()});const c=(p,h)=>/show|hide/.test(p)?n(p,h):l.on(p,h),d=["show","hide"].map(p=>c(p,h=>r.handleEvent(p,h))),u=()=>{d.forEach(p=>p()),a(),o.$destroy(),l.destroy()};return Yc(r,{on:c,destroy:u,hide:a,show:s}),Object.defineProperty(r,"modal",{get:()=>o.root,set:()=>{}}),o.$on("close",l.close),o.$on("show",()=>i("show")),o.$on("hide",()=>{i("hide"),t.enableAutoDestroy!==!1&&u()}),t.enableAutoHide!==!1&&l.on("process",a),l.on("loadstart",s),t.enableButtonClose!==!1&&(t.enableButtonClose=!0),delete t.class,Object.assign(r,t),r};/*!
 * FilePondPluginFilePoster 2.5.1
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */const fy={type:"spring",stiffness:.5,damping:.45,mass:10},T8=t=>t.utils.createView({name:"file-poster",tag:"div",ignoreRect:!0,create:({root:e})=>{e.ref.image=document.createElement("img"),e.element.appendChild(e.ref.image)},write:t.utils.createRoute({DID_FILE_POSTER_LOAD:({root:e,props:n})=>{const{id:i}=n,r=e.query("GET_ITEM",{id:n.id});if(!r)return;const o=r.getMetadata("poster");e.ref.image.src=o,e.dispatch("DID_FILE_POSTER_DRAW",{id:i})}}),mixins:{styles:["scaleX","scaleY","opacity"],animations:{scaleX:fy,scaleY:fy,opacity:{type:"tween",duration:750}}}}),C8=(t,e)=>{e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0)},M8=t=>t.utils.createView({name:"file-poster-overlay",tag:"canvas",ignoreRect:!0,create:({root:e,props:n})=>{C8(n.template,e.element)},mixins:{styles:["opacity"],animations:{opacity:{type:"spring",mass:25}}}}),k8=(t,e)=>{let n=new Image;n.onload=()=>{const i=n.naturalWidth,r=n.naturalHeight;n=null,e(i,r)},n.src=t},E8=t=>-.5*(Math.cos(Math.PI*t)-1),P8=(t,e,n=1,i=E8,r=10,o=0)=>{const a=1-o,s=e.join(",");for(let l=0;l<=r;l++){const c=l/r,d=o+a*c;t.addColorStop(d,`rgba(${s}, ${i(c)*n})`)}},I8=10,R8=10,A8=t=>{const e=Math.min(I8/t.width,R8/t.height),n=document.createElement("canvas"),i=n.getContext("2d"),r=n.width=Math.ceil(t.width*e),o=n.height=Math.ceil(t.height*e);i.drawImage(t,0,0,r,o);let a=null;try{a=i.getImageData(0,0,r,o).data}catch{return null}const s=a.length;let l=0,c=0,d=0,u=0;for(;u<s;u+=4)l+=a[u]*a[u],c+=a[u+1]*a[u+1],d+=a[u+2]*a[u+2];return l=ah(l,s),c=ah(c,s),d=ah(d,s),{r:l,g:c,b:d}},ah=(t,e)=>Math.floor(Math.sqrt(t/(e/4))),Hl=(t,e,n,i,r)=>{t.width=e,t.height=n;const o=t.getContext("2d"),a=e*.5,s=o.createRadialGradient(a,n+110,n-100,a,n+110,n+100);P8(s,i,r,void 0,8,.4),o.save(),o.translate(-e*.5,0),o.scale(2,1),o.fillStyle=s,o.fillRect(0,0,e,n),o.restore()},r1=typeof navigator<"u",Ul=500,Gl=200,Oh=r1&&document.createElement("canvas"),Fh=r1&&document.createElement("canvas"),_h=r1&&document.createElement("canvas");let ku=[40,40,40],Eu=[196,78,71],Pu=[54,151,99];r1&&(Hl(Oh,Ul,Gl,ku,.85),Hl(Fh,Ul,Gl,Eu,1),Hl(_h,Ul,Gl,Pu,1));const L8=(t,e)=>new Promise((n,i)=>{const r=new Image;typeof crossOrigin=="string"&&(r.crossOrigin=e),r.onload=()=>{n(r)},r.onerror=o=>{i(o)},r.src=t}),O8=t=>{const e=M8(t),n=({root:c,props:d})=>{const{id:u}=d,p=c.query("GET_ITEM",u);if(!p)return;const h=p.getMetadata("poster"),y=m=>{const f=c.query("GET_FILE_POSTER_CALCULATE_AVERAGE_IMAGE_COLOR")?A8(m):null;p.setMetadata("color",f,!0),c.dispatch("DID_FILE_POSTER_LOAD",{id:u,data:m})};k8(h,(m,f)=>{c.dispatch("DID_FILE_POSTER_CALCULATE_SIZE",{id:u,width:m,height:f}),L8(h,c.query("GET_FILE_POSTER_CROSS_ORIGIN_ATTRIBUTE_VALUE")).then(y)})},i=({root:c})=>{c.ref.overlayShadow.opacity=1},r=({root:c})=>{const{image:d}=c.ref;d.scaleX=1,d.scaleY=1,d.opacity=1},o=({root:c})=>{c.ref.overlayShadow.opacity=1,c.ref.overlayError.opacity=0,c.ref.overlaySuccess.opacity=0},a=({root:c})=>{c.ref.overlayShadow.opacity=.25,c.ref.overlayError.opacity=1},s=({root:c})=>{c.ref.overlayShadow.opacity=.25,c.ref.overlaySuccess.opacity=1},l=({root:c,props:d})=>{const u=c.query("GET_FILE_POSTER_ITEM_OVERLAY_SHADOW_COLOR"),p=c.query("GET_FILE_POSTER_ITEM_OVERLAY_ERROR_COLOR"),h=c.query("GET_FILE_POSTER_ITEM_OVERLAY_SUCCESS_COLOR");u&&u!==ku&&(ku=u,Hl(Oh,Ul,Gl,ku,.85)),p&&p!==Eu&&(Eu=p,Hl(Fh,Ul,Gl,Eu,1)),h&&h!==Pu&&(Pu=h,Hl(_h,Ul,Gl,Pu,1));const y=T8(t);c.ref.image=c.appendChildView(c.createChildView(y,{id:d.id,scaleX:1.25,scaleY:1.25,opacity:0})),c.ref.overlayShadow=c.appendChildView(c.createChildView(e,{template:Oh,opacity:0})),c.ref.overlaySuccess=c.appendChildView(c.createChildView(e,{template:_h,opacity:0})),c.ref.overlayError=c.appendChildView(c.createChildView(e,{template:Fh,opacity:0}))};return t.utils.createView({name:"file-poster-wrapper",create:l,write:t.utils.createRoute({DID_FILE_POSTER_LOAD:i,DID_FILE_POSTER_DRAW:r,DID_FILE_POSTER_CONTAINER_CREATE:n,DID_THROW_ITEM_LOAD_ERROR:a,DID_THROW_ITEM_PROCESSING_ERROR:a,DID_THROW_ITEM_INVALID:a,DID_COMPLETE_ITEM_PROCESSING:s,DID_START_ITEM_PROCESSING:o,DID_REVERT_ITEM_PROCESSING:o})})},Ex=t=>{const{addFilter:e,utils:n}=t,{Type:i,createRoute:r}=n,o=O8(t);return e("CREATE_VIEW",a=>{const{is:s,view:l,query:c}=a;if(!s("file")||!c("GET_ALLOW_FILE_POSTER"))return;const d=({root:m,props:f})=>{p(m,f)},u=({root:m,props:f,action:b})=>{/poster/.test(b.change.key)&&p(m,f)},p=(m,f)=>{const{id:b}=f,v=c("GET_ITEM",b);!v||!v.getMetadata("poster")||v.archived||m.ref.previousPoster!==v.getMetadata("poster")&&(m.ref.previousPoster=v.getMetadata("poster"),c("GET_FILE_POSTER_FILTER_ITEM")(v)&&(m.ref.filePoster&&l.removeChildView(m.ref.filePoster),m.ref.filePoster=l.appendChildView(l.createChildView(o,{id:b})),m.dispatch("DID_FILE_POSTER_CONTAINER_CREATE",{id:b})))},h=({root:m,action:f})=>{m.ref.filePoster&&(m.ref.imageWidth=f.width,m.ref.imageHeight=f.height,m.ref.shouldUpdatePanelHeight=!0,m.dispatch("KICK"))},y=({root:m})=>{let f=m.query("GET_FILE_POSTER_HEIGHT");if(f)return f;const b=m.query("GET_FILE_POSTER_MIN_HEIGHT"),v=m.query("GET_FILE_POSTER_MAX_HEIGHT");if(b&&m.ref.imageHeight<b)return b;let w=m.rect.element.width*(m.ref.imageHeight/m.ref.imageWidth);return b&&w<b?b:v&&w>v?v:w};l.registerWriter(r({DID_LOAD_ITEM:d,DID_FILE_POSTER_CALCULATE_SIZE:h,DID_UPDATE_ITEM_METADATA:u},({root:m,props:f})=>{m.ref.filePoster&&(m.rect.element.hidden||m.ref.shouldUpdatePanelHeight&&(m.dispatch("DID_UPDATE_PANEL_HEIGHT",{id:f.id,height:y({root:m})}),m.ref.shouldUpdatePanelHeight=!1))}))}),{options:{allowFilePoster:[!0,i.BOOLEAN],filePosterHeight:[null,i.INT],filePosterMinHeight:[null,i.INT],filePosterMaxHeight:[null,i.INT],filePosterFilterItem:[()=>!0,i.FUNCTION],filePosterCalculateAverageImageColor:[!1,i.BOOLEAN],filePosterCrossOriginAttributeValue:["Anonymous",i.STRING],filePosterItemOverlayShadowColor:[null,i.ARRAY],filePosterItemOverlayErrorColor:[null,i.ARRAY],filePosterItemOverlaySuccessColor:[null,i.ARRAY]}}},F8=typeof window<"u"&&typeof window.document<"u";F8&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:Ex}));const Dh=t=>t instanceof File,Px=t=>/^image/.test(t.type),E0=(t,e,n=[])=>{const i=document.createElement(t),r=Object.getOwnPropertyDescriptors(i.__proto__);for(const o in e)o==="style"?i.style.cssText=e[o]:r[o]&&r[o].set||/textContent|innerHTML/.test(o)||typeof e[o]=="function"?i[o]=e[o]:i.setAttribute(o,e[o]);return n.forEach(o=>i.appendChild(o)),i};let sh=null;const Yl=()=>(sh===null&&(sh=typeof window<"u"&&typeof window.document<"u"),sh),_8=Yl()&&!!Node.prototype.replaceChildren,D8=_8?(t,e)=>t.replaceChildren(e):(t,e)=>{for(;t.lastChild;)t.removeChild(t.lastChild);e!==void 0&&t.append(e)},fu=Yl()&&E0("div",{class:"PinturaMeasure",style:"position:absolute;left:0;top:0;width:99999px;height:0;pointer-events:none;contain:strict;margin:0;padding:0;"});let $y;const z8=t=>(D8(fu,t),fu.parentNode||document.body.append(fu),clearTimeout($y),$y=setTimeout(()=>{fu.remove()},500),t);let lh=null;const B8=()=>(lh===null&&(lh=Yl()&&/^((?!chrome|android).)*(safari|iphone|ipad)/i.test(navigator.userAgent)),lh),N8=t=>new Promise((e,n)=>{let i=!1;!t.parentNode&&B8()&&(i=!0,t.style.cssText="position:absolute;visibility:hidden;pointer-events:none;left:0;top:0;width:0;height:0;",z8(t));const r=()=>{const a=t.naturalWidth,s=t.naturalHeight;a&&s&&(i&&t.remove(),clearInterval(o),e({width:a,height:s}))};t.onerror=a=>{clearInterval(o),n(a)};const o=setInterval(r,1);r()}),W8=t=>new Promise((e,n)=>{const i=()=>{e({width:t.videoWidth,height:t.videoHeight})};if(t.readyState>=1)return i();t.onloadedmetadata=i,t.onerror=()=>n(t.error)}),V8=t=>typeof t=="string",H8=t=>new Promise(e=>{const n=V8(t)?t:URL.createObjectURL(t),i=()=>{const o=new Image;o.src=n,e(o)};if(t instanceof Blob&&Px(t))return i();const r=document.createElement("video");r.preload="metadata",r.onloadedmetadata=()=>e(r),r.onerror=i,r.src=n}),U8=t=>t.nodeName==="VIDEO",G8=async t=>{let e;t.src?e=t:e=await H8(t);let n;try{n=U8(e)?await W8(e):await N8(e)}finally{Dh(t)&&URL.revokeObjectURL(e.src)}return n},yy=t=>t instanceof Blob&&!(t instanceof File),xy=(...t)=>{},Ix=t=>{t.width=1,t.height=1;const e=t.getContext("2d");e&&e.clearRect(0,0,1,1)};let Ic=null;const j8=()=>{if(Ic===null)if("WebGL2RenderingContext"in window){let t;try{t=E0("canvas"),Ic=!!t.getContext("webgl2")}catch{Ic=!1}t&&Ix(t),t=void 0}else Ic=!1;return Ic},Z8=(t,e)=>j8()?t.getContext("webgl2",e):t.getContext("webgl",e)||t.getContext("experimental-webgl",e);let ch=null;const X8=()=>{if(ch===null){let t=E0("canvas");ch=!!Z8(t),Ix(t),t=void 0}return ch},q8=()=>Object.prototype.toString.call(window.operamini)==="[object OperaMini]",Y8=()=>"Promise"in window,K8=()=>"URL"in window&&"createObjectURL"in window.URL,J8=()=>"visibilityState"in document,Q8=()=>"performance"in window,tT=()=>"File"in window;let dh=null;const by=()=>(dh===null&&(dh=Yl()&&!q8()&&J8()&&Y8()&&tT()&&K8()&&Q8()),dh),Rx=t=>{const{addFilter:e,utils:n,views:i}=t,{Type:r,createRoute:o}=n,{fileActionButton:a}=i,s=(({parallel:m=1,autoShift:f=!0})=>{const b=[];let v=0;const w=()=>{if(!b.length)return I.oncomplete();v++,b.shift()(()=>{v--,v<m&&T()})},T=()=>{for(let P=0;P<m-v;P++)w()},I={queue:P=>{b.push(P),f&&T()},runJobs:T,oncomplete:()=>{}};return I})({parallel:1}),l=m=>m===null?{}:m;e("SHOULD_REMOVE_ON_REVERT",(m,{item:f,query:b})=>new Promise(v=>{const{file:w}=f,T=b("GET_ALLOW_IMAGE_EDITOR")&&b("GET_IMAGE_EDITOR_ALLOW_EDIT")&&b("GET_IMAGE_EDITOR_SUPPORT_EDIT")&&b("GET_IMAGE_EDITOR_SUPPORT_IMAGE")(w);v(!T)})),e("DID_LOAD_ITEM",(m,{query:f,dispatch:b})=>new Promise((v,w)=>{if(m.origin>1){v(m);return}const{file:T}=m;if(!f("GET_ALLOW_IMAGE_EDITOR")||!f("GET_IMAGE_EDITOR_INSTANT_EDIT")||!f("GET_IMAGE_EDITOR_SUPPORT_IMAGE")(T))return v(m);const I=()=>{if(!c.length)return;const{item:_,resolve:C,reject:F}=c[0];b("EDIT_ITEM",{id:_.id,handleEditorResponse:P(_,C,F)})},P=(_,C,F)=>G=>{c.shift(),G?C(_):F(_),b("KICK"),I()};d({item:m,resolve:v,reject:w}),c.length===1&&I()})),e("DID_CREATE_ITEM",(m,{query:f,dispatch:b})=>{m.getMetadata("color")&&m.setMetadata("colors",m.getMetadata("color")),m.extend("edit",()=>{b("EDIT_ITEM",{id:m.id})})});const c=[],d=m=>(c.push(m),m),u=m=>{const{imageProcessor:f,imageReader:b,imageWriter:v}=l(m("GET_IMAGE_EDITOR"));return m("GET_IMAGE_EDITOR_WRITE_IMAGE")&&m("GET_IMAGE_EDITOR_SUPPORT_WRITE_IMAGE")&&f&&b&&v},p=(m,f)=>{const b=m("GET_FILE_POSTER_HEIGHT"),v=m("GET_FILE_POSTER_MAX_HEIGHT");return b?(f.width=b*2,f.height=b*2):v&&(f.width=v*2,f.height=v*2),f},h=(m,f,b=()=>{})=>{if(!f)return;if(!m("GET_FILE_POSTER_FILTER_ITEM")(f))return b();const{imageProcessor:v,imageReader:w,imageWriter:T,editorOptions:I,legacyDataToImageState:P,imageState:_}=l(m("GET_IMAGE_EDITOR"));if(!v)return;const[C,F]=w,[G=xy,O]=T,$=f.file,N=f.getMetadata("imageState"),it=p(m,{width:512,height:512}),M={...I,imageReader:C(F),imageWriter:G({...O||{},canvasMemoryLimit:it.width*it.height*2,preprocessImageState:(W,ot,at,q)=>!N&&P?{...W,...P(void 0,q.size,{...f.getMetadata()})}:W}),imageState:{..._,...N}};s.queue(W=>{v($,M).then(({dest:ot})=>{f.setMetadata("poster",URL.createObjectURL(ot),!0),W(),b()})})};e("CREATE_VIEW",m=>{const{is:f,view:b,query:v}=m;if(!v("GET_ALLOW_IMAGE_EDITOR")||!v("GET_IMAGE_EDITOR_SUPPORT_WRITE_IMAGE"))return;const w=v("GET_ALLOW_FILE_POSTER");if(!(f("file-info")&&!w||f("file")&&w))return;const{createEditor:T,imageReader:I,imageWriter:P,editorOptions:_,legacyDataToImageState:C,imageState:F}=l(v("GET_IMAGE_EDITOR"));if(!I||!P||!_||!_.locale)return;delete _.imageReader,delete _.imageWriter;const[G,O]=I,$=q=>{const{id:ct}=q;return v("GET_ITEM",ct)},N=q=>{if(!v("GET_ALLOW_FILE_POSTER"))return!1;const ct=$(q);return ct?v("GET_FILE_POSTER_FILTER_ITEM")(ct)?!!ct.getMetadata("poster"):!1:void 0},it=({root:q,props:ct,action:V})=>{const{handleEditorResponse:ut}=V,bt=$(ct),K=Dh(bt.file)||yy(bt.file),vt=K?bt.file:bt.source,X=T({..._,imageReader:G(O),src:vt});X.on("load",({size:Z})=>{let mt=bt.getMetadata("imageState");!mt&&C&&(mt=C(X,Z,bt.getMetadata())),X.imageState={...F,...mt}}),X.on("process",({src:Z,imageState:mt})=>{K||bt.setFile(Z),bt.setMetadata("imageState",mt),ut&&ut(!0)}),X.on("close",()=>{ut&&ut(!1)})},M=({root:q,props:ct})=>{const{id:V}=ct,ut=v("GET_ITEM",V);if(!ut)return;const bt=ut.file;v("GET_IMAGE_EDITOR_SUPPORT_IMAGE")(bt)&&(v("GET_ALLOW_FILE_POSTER")&&!ut.getMetadata("poster")&&q.dispatch("REQUEST_CREATE_IMAGE_POSTER",{id:V}),!(!v("GET_IMAGE_EDITOR_ALLOW_EDIT")||!v("GET_IMAGE_EDITOR_SUPPORT_EDIT"))&&W(q,ct))},W=(q,ct)=>{if(q.ref.handleEdit||(q.ref.handleEdit=V=>{V.stopPropagation(),q.dispatch("EDIT_ITEM",{id:ct.id})}),N(ct)){q.ref.editButton&&q.ref.editButton.parentNode&&q.ref.editButton.parentNode.removeChild(q.ref.editButton);const V=b.createChildView(a,{label:"edit",icon:v("GET_IMAGE_EDITOR_ICON_EDIT"),opacity:0});V.element.classList.add("filepond--action-edit-item"),V.element.dataset.align=v("GET_STYLE_IMAGE_EDITOR_BUTTON_EDIT_ITEM_POSITION"),V.on("click",q.ref.handleEdit),q.ref.buttonEditItem=b.appendChildView(V)}else{q.ref.buttonEditItem&&q.removeChildView(q.ref.buttonEditItem);const V=b.element.querySelector(".filepond--file-info-main"),ut=document.createElement("button");ut.className="filepond--action-edit-item-alt",ut.type="button",ut.innerHTML=v("GET_IMAGE_EDITOR_ICON_EDIT")+"<span>edit</span>",ut.addEventListener("click",q.ref.handleEdit),V.appendChild(ut),q.ref.editButton=ut}},ot=({root:q,props:ct,action:V})=>{if(/imageState/.test(V.change.key)&&v("GET_ALLOW_FILE_POSTER"))return q.dispatch("REQUEST_CREATE_IMAGE_POSTER",{id:ct.id});/poster/.test(V.change.key)&&(!v("GET_IMAGE_EDITOR_ALLOW_EDIT")||!v("GET_IMAGE_EDITOR_SUPPORT_EDIT")||W(q,ct))};b.registerDestroyer(({root:q})=>{q.ref.buttonEditItem&&q.ref.buttonEditItem.off("click",q.ref.handleEdit),q.ref.editButton&&q.ref.editButton.removeEventListener("click",q.ref.handleEdit)});const at={EDIT_ITEM:it,DID_LOAD_ITEM:M,DID_UPDATE_ITEM_METADATA:ot,DID_REMOVE_ITEM:({props:q})=>{const{id:ct}=q,V=v("GET_ITEM",ct);if(!V)return;const ut=V.getMetadata("poster");ut&&URL.revokeObjectURL(ut)},REQUEST_CREATE_IMAGE_POSTER:({root:q,props:ct})=>h(q.query,$(ct)),DID_FILE_POSTER_LOAD:void 0};if(w){const q=({root:ct})=>{ct.ref.buttonEditItem&&(ct.ref.buttonEditItem.opacity=1)};at.DID_FILE_POSTER_LOAD=q}b.registerWriter(o(at))}),e("SHOULD_PREPARE_OUTPUT",(m,{query:f,change:b,item:v})=>new Promise(w=>{if(!f("GET_IMAGE_EDITOR_SUPPORT_IMAGE")(v.file)||b&&!/imageState/.test(b.key))return w(!1);w(!f("IS_ASYNC"))}));const y=(m,f,b)=>new Promise(v=>{if(!u(m)||b.archived||!Dh(f)&&!yy(f)||!m("GET_IMAGE_EDITOR_SUPPORT_IMAGE")(f))return v(!1);G8(f).then(()=>{const w=m("GET_IMAGE_TRANSFORM_IMAGE_FILTER");if(w){const T=w(f);if(typeof T=="boolean")return v(T);if(typeof T.then=="function")return T.then(v)}v(!0)}).catch(()=>{const w=m("GET_IMAGE_EDITOR_SUPPORT_IMAGE_FORMAT");if(w&&w(f)){v(!0);return}v(!1)})});return e("PREPARE_OUTPUT",(m,{query:f,item:b})=>{const v=w=>new Promise((T,I)=>{const P=()=>{s.queue(_=>{const C=b.getMetadata("imageState"),{imageProcessor:F,imageReader:G,imageWriter:O,editorOptions:$,imageState:N}=l(f("GET_IMAGE_EDITOR"));if(!F||!G||!O||!$)return;const[it,M]=G,[W=xy,ot]=O;F(w,{...$,imageReader:it(M),imageWriter:W(ot),imageState:{...N,...C}}).then(T).catch(I).finally(_)})};f("GET_ALLOW_FILE_POSTER")&&!b.getMetadata("poster")?h(f,b,P):P()});return new Promise(w=>{y(f,m,b).then(T=>{if(!T)return w(m);v(m).then(I=>{const P=f("GET_IMAGE_EDITOR_AFTER_WRITE_IMAGE");if(P)return Promise.resolve(P(I)).then(w);w(I.dest)})})})}),{options:{allowImageEditor:[!0,r.BOOLEAN],imageEditorInstantEdit:[!1,r.BOOLEAN],imageEditorAllowEdit:[!0,r.BOOLEAN],imageEditorSupportEdit:[Yl()&&by()&&X8(),r.BOOLEAN],imageEditorSupportImage:[Px,r.FUNCTION],imageEditorSupportImageFormat:[null,r.FUNCTION],imageEditorSupportWriteImage:[by(),r.BOOLEAN],imageEditorWriteImage:[!0,r.BOOLEAN],imageEditorBeforeOpenImage:[void 0,r.FUNCTION],imageEditorAfterWriteImage:[void 0,r.FUNCTION],imageEditor:[null,r.OBJECT],imageEditorIconEdit:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"><path d="M8.5 17h1.586l7-7L15.5 8.414l-7 7V17zm-1.707-2.707l8-8a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1 0 1.414l-8 8A1 1 0 0 1 10.5 19h-3a1 1 0 0 1-1-1v-3a1 1 0 0 1 .293-.707z" fill="currentColor" fill-rule="nonzero"/></svg>',r.STRING],styleImageEditorButtonEditItemPosition:["bottom center",r.STRING]}}};Yl()&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:Rx}));d8(u8,h8,p8,m8);const eT=Sb(Mb,Cb,Rx,Ex,Tb),nT={props:{inspection_uuid:{type:String,required:!0},evidence:{type:Object,required:!1},position:{type:Number,required:!1}},data(){return{myFiles:[],myEditor:{legacyDataToImageState:g3,createEditor:S8,imageReader:[a8],imageWriter:[s8],imageProcessor:O2,editorOptions:{utils:["crop","finetune","filter","annotate"],imageOrienter:l8(),...g8,...f8,...c8,locale:{...$8,...x8,...v8,...b8,...w8,...y8}}},action:"create",dialogDelete:!1,isHoveredDelete:!1,form:{inspection_uuid:this.inspection_uuid,evidence_store:null,evidence_store_secondary:null,title:"Título",title_secondary:null,description:"Descripción",description_secondary:null,inspection_evidence_secondary:null},formDefault:{inspection_uuid:this.inspection_uuid,evidence_store:null,evidence_store_secondary:null,title:"Título",title_secondary:null,description:"Descripción",description_secondary:null,inspection_evidence_secondary:null},serverConfig:{process:(t,e,n,i,r,o,a)=>{this.form.evidence_store=e;const l=Al.CancelToken.source();this.form.title||(Lm.error("El título es requerido"),this.abort(l)),this.save(l,i,r,o)}}}},mounted(){this.evidence&&(this.action="update",this.form.evidence_store=this.evidence.inspection_evidence,this.form.title=this.evidence.title,this.form.description=this.evidence.description,this.myFiles=[{source:this.evidence.inspection_evidence,options:{type:"remote"}}])},methods:{handleFilePondInit(){},save(t,e,n,i){this.form.position=this.position,this.action==="create"?Al.post("api/inspection/evidences",this.form,{headers:{"Content-Type":"multipart/form-data"},cancelToken:t.token,onUploadProgress:r=>{i(r.lengthComputable,r.loaded,r.total)}}).then(r=>{e(r.data.fileId),setTimeout(()=>{this.myFiles=[],this.form=this.formDefault,this.$emit("getEvidences")},2e3)}).catch(r=>{Al.isCancel(r)?this.abort(t):(n("Error al subir la información."),this.handleErrors(r))}):this.action==="update"&&Al.post("api/inspection/evidences/update/"+this.evidence.inspection_evidence_uuid,this.form,{headers:{"Content-Type":"multipart/form-data"},cancelToken:t.token,onUploadProgress:r=>{i(r.lengthComputable,r.loaded,r.total)}}).then(r=>{e(r.data.fileId),setTimeout(()=>{console.log("Se actualizó la evidencia"),this.$emit("getEvidences")},2e3)}).catch(r=>{Al.isCancel(r)?this.abort(t):(n("Error al subir la información."),this.handleErrors(r))})},abort(){source.cancel("Operación cancelada por el usuario.")},deleteEvidence(){console.log("Entro a eliminar"),Al.delete("api/inspection/evidences/"+this.evidence.inspection_evidence_uuid).then(t=>{Lm.success("Evidencia eliminada"),this.$emit("getEvidences")}).catch(t=>{this.handleErrors(t)})}},components:{FilePond:eT,Toaster:fb}};function iT(t,e,n,i,r,o){const a=Oa("file-pond"),s=Oa("v-text-field"),l=Oa("v-card-title"),c=Oa("v-textarea"),d=Oa("v-icon"),u=Oa("v-btn"),p=Oa("v-card-actions"),h=Oa("v-card"),y=Oa("v-spacer"),m=Oa("v-dialog");return Om(),$b(yb,null,[so(h,{class:"pb-0",border:"dashed thin dark md"},{default:Jo(()=>[so(a,{name:"evidence",ref:"pond","label-idle":"Arrastra y suelta tu archivo o <span class='filepond--label-action'>selecciona</span>","allow-multiple":!1,"accepted-file-types":"image/jpeg, image/png",files:r.myFiles,onInit:o.handleFilePondInit,server:r.serverConfig,instantUpload:"false",allowProcess:"true",allowReplace:"true",allowImagePreview:"true",labelInvalidField:"Tipo de archivo no permitido",labelFileLoading:"Cargando",labelFileLoadError:"Error al subir el archivo",labelFileProcessing:"Procesando",labelFileProcessingComplete:"Proceso completado",labelFileProcessingAborted:"Proceso abortado",labelFileProcessingError:"Error al procesar",labelTapToCancel:"Toca para cancelar",labelTapToRetry:"Toca para reintentar",labelTapToUndo:"Toca para deshacer",labelButtonAbortItemLoad:"Cancelar",labelButtonRetryItemLoad:"Reintentar",labelButtonAbortItemProcessing:"Cancelar",labelButtonProcessItem:"Subir",class:xb(n.evidence?"min-height":""),imageEditor:r.myEditor,allowImageEditor:"true",imageEditorAllowEdit:"true",imageEditorWriteImage:"true"},null,8,["files","onInit","server","class","imageEditor"]),so(l,null,{default:Jo(()=>[so(s,{label:"Título",modelValue:r.form.title,"onUpdate:modelValue":e[0]||(e[0]=f=>r.form.title=f),variant:"outlined","hide-details":"",density:"compact"},null,8,["modelValue"])]),_:1}),so(l,{class:"pb-0"},{default:Jo(()=>[so(c,{label:"Descripción",modelValue:r.form.description,"onUpdate:modelValue":e[1]||(e[1]=f=>r.form.description=f),variant:"outlined",rows:"2","hide-details":"",density:"compact"},null,8,["modelValue"])]),_:1}),so(p,{class:"p-0 m-0"},{default:Jo(()=>[n.evidence?(Om(),bb(u,{key:0,color:"error",onClick:e[2]||(e[2]=f=>r.dialogDelete=!0),block:"",onMouseover:e[3]||(e[3]=f=>r.isHoveredDelete=!0),onMouseleave:e[4]||(e[4]=f=>r.isHoveredDelete=!1)},{default:Jo(()=>[so(d,{left:"",class:"text-h5 primary-color"},{default:Jo(()=>[qd(vb(r.isHoveredDelete?"mdi-delete-empty-outline":"mdi-delete-outline"),1)]),_:1})]),_:1})):wb("",!0)]),_:1})]),_:1}),so(m,{modelValue:r.dialogDelete,"onUpdate:modelValue":e[7]||(e[7]=f=>r.dialogDelete=f),"max-width":"500px"},{default:Jo(()=>[so(h,null,{default:Jo(()=>[so(l,{class:"text-h5 text-center"},{default:Jo(()=>[qd("¿Estás seguro de eliminar?")]),_:1}),so(p,null,{default:Jo(()=>[so(y),so(u,{color:"blue-darken-1",variant:"text",onClick:e[5]||(e[5]=f=>r.dialogDelete=!1)},{default:Jo(()=>[qd("Cancelar")]),_:1}),so(u,{color:"blue-darken-1",variant:"text",onClick:e[6]||(e[6]=f=>o.deleteEvidence())},{default:Jo(()=>[qd("Si, eliminar")]),_:1}),so(y)]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}const lT=kb(nT,[["render",iT],["__scopeId","data-v-1c4a0719"]]);export{lT as default};
